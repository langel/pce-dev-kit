#[1]   makehes.s
   10                     
   11           0001                      .ifdef HUC
#[5]   huc.inc
   12                                      .include "huc.inc"      ; HUC
    1                     ;
    2                     ; Hu-C internal include file
    3                     ;
    4                     
    5                     
    6                     ; variables
    7                     ; ----
    8                     
    9           2000                 .zp
   10  --:2000            __sp
   11  --:2000            __stack    .ds 2
   12  --:2002            __arg_idx  .ds 1
   13  --:2003            __temp     .ds 8
   14  --:200B            __ptr      .ds 2
   15  --:200D            __fbank    .ds 1
   16  --:200E            __fptr     .ds 2
   17  --:2010            __expr     .ds 2
   18                     
   19                     
   20                     ; macros
   21                     ; ----
   22                     
   23                             .macro __farptr
   24                              ldy    #bank(\1)
   25                              sty    \2
   26                              ldy    #low(\1)
   27                              sty    \3
   28                              ldy    #high(\1)
   29                              sty    \3+1
   30                             .endm
   31                     
   32                             .macro __farptr_i
   33                              sax
   34                              add    #low(\1)
   35                             .if (\# = 3)
   36                              sta    <\3
   37                             .else
   38                              sta    <__fptr
   39                             .endif
   40                              sax
   41                              adc    #high(\1) & $1F
   42                             .if (\# = 3)
   43                              sta    <\3+1
   44                             .else
   45                              tax
   46                             .endif
   47                              rol    A
   48                              rol    A
   49                              rol    A
   50                              rol    A
   51                              and    #$F
   52                              add    #bank(\1)
   53                             .if (\# = 3)
   54                              sta    <\2
   55                             .endif
   56                             .endm
   57                     
   58                             .macro __farptr_get
   59                              stx    <\1
   60                              ldy    #2
   61                              lda    [__ptr],Y
   62                              sta    <\2
   63                              iny
   64                              lda    [__ptr],Y
   65                              sta    <\2+1
   66                             .endm
   67                     
   68                             .macro __fgetb
   69                              tam    #3
   70                              txa
   71                              and    #$1F
   72                              ora    #$60
   73                              sta    <__fptr+1
   74                              lda    [__fptr]
   75                              tax
   76                              cla
   77                             .endm
   78                     
   79                     __ldb   .macro
   80                             .if (\# = 2)
   81                              clx
   82                              lda    \1
   83                              clc
   84                              adc    #low(\2)
   85                              sax
   86                              adc    #high(\2)
   87                             .else
   88                              ldx    \1
   89                            __extw
   90                             .endif
   91                             .endm
   92                     
   93                     __ldbp  .macro
   94                              lda    [\1]
   95                              tax
   96                            __extw
   97                             .endm
   98                     
   99                     __stbps .macro
  100                            __stw    <__temp
  101                            __ldwp    __stack
  102                            __stw    <__ptr
  103                            __ldw    <__temp
  104                              sax
  105                              sta    [__ptr]
  106                              sax
  107                            __addmi  2,__stack
  108                             .endm
  109                     
  110                     __ldw   .macro
  111                             .if (\# = 2)
  112                              lda    \1
  113                              clc
  114                              adc    #low(\2)
  115                              tax
  116                              lda    \1+1
  117                              adc    #high(\2)
  118                             .else
  119                              ldx    \1
  120                              lda    \1+1
  121                             .endif
  122                             .endm
  123                     
  124                     __ldwp  .macro
  125                              lda    [\1]
  126                              tax
  127                              ldy    #1
  128                              lda    [\1],Y
  129                             .endm
  130                     
  131                     __ldwi  .macro
  132                              ldx    #low(\1)
  133                              lda    #high(\1)
  134                             .endm
  135                     
  136                     __stw   .macro
  137                              stx    \1
  138                              sta    \1+1
  139                             .endm
  140                     
  141                     __stwp  .macro
  142                              sax
  143                              sta    [\1]
  144                              sax
  145                              ldy    #1
  146                              sta    [\1],Y
  147                             .endm
  148                     
  149                     __stwps .macro
  150                            __stw    <__temp
  151                            __ldwp    __stack
  152                            __stw    <__ptr
  153                            __ldw    <__temp
  154                            __stwp    __ptr
  155                            __addmi  2,__stack
  156                             .endm
  157                     
  158                     __pushw .macro
  159                            __submi  2,__stack
  160                              sax
  161                              sta    [__stack]
  162                              sax
  163                              ldy    #1
  164                              sta    [__stack],Y
  165                             .endm
  166                     
  167                     __popw  .macro
  168                              lda    [__stack]
  169                              tax
  170                              ldy    #1
  171                              lda    [__stack],Y
  172                            __addmi  2,__stack
  173                             .endm
  174                     
  175                     __calls .macro
  176                              pha
  177                              ldy    #\1
  178                              lda    [__stack],Y
  179                              sta    <__ptr
  180                              incw   <__stack
  181                              lda    [__stack],Y
  182                              sta    <__ptr+1
  183                              incw   <__stack
  184                              pla
  185                              jsr    hook
  186                             .endm
  187                     
  188                     __swapw .macro
  189                              pha
  190                              ldy    #1
  191                              lda    [__stack],Y
  192                              sta    <__temp
  193                              lda    [__stack]
  194                              sax
  195                              sta    [__stack]
  196                              pla
  197                              sta    [__stack],Y
  198                              lda    <__temp
  199                             .endm
  200                     
  201                     
  202                     ; TODO : check if we need pha/pla or not
  203                     __tstw  .macro
  204                              ; pha
  205                              stx    <__temp
  206                              ora    <__temp
  207                              ; pla
  208                             .endm
  209                     
  210                     __lsrw  .macro
  211                             lsr     A
  212                             sax
  213                             ror     A
  214                             sax
  215                             .endm
  216                     
  217                     __aslw  .macro
  218                              sax
  219                              asl    A
  220                              sax
  221                              rol    A
  222                             .endm
  223                     
  224                     __aslws .macro
  225                              asl    [__stack]
  226                              ldy    #1
  227                              rol    [__stack],Y
  228                             .endm
  229                     
  230                     __asrw  .macro
  231                              cmp    #$80
  232                              ror    A
  233                              sax
  234                              ror    A
  235                              sax
  236                             .endm
  237                     
  238                     __extw  .macro
  239                     ;        txa    ; signed
  240                     ;        cla
  241                     ;        bpl    .x_\@
  242                     ;        dec    A
  243                     ;.x_\@:
  244                              cla    ; unsigned
  245                             .endm
  246                     
  247                     __comw  .macro
  248                              sax
  249                              eor    #$FF
  250                              sax
  251                              eor    #$FF
  252                             .endm
  253                     
  254                     __negw  .macro
  255                              sax
  256                              eor    #$FF
  257                              clc
  258                              adc    #1
  259                              sax
  260                              eor    #$FF
  261                              adc    #0
  262                             .endm
  263                     
  264                     __boolw .macro
  265                              stx    <__temp
  266                              ora    <__temp
  267                              clx
  268                              beq    .x\@
  269                              inx
  270                     .x\@     cla
  271                             .endm
  272                     
  273                     __notw  .macro
  274                              stx    <__temp
  275                              ora    <__temp
  276                              clx
  277                              bne    .x\@
  278                              inx
  279                     .x\@     cla
  280                             .endm
  281                     
  282                     __addw  .macro
  283                              clc
  284                              sax
  285                              adc    \1
  286                              sax
  287                              adc    \1+1
  288                             .endm   
  289                     
  290                     __addwi .macro
  291                              clc
  292                              sax
  293                              adc    #low(\1)
  294                              sax
  295                              adc    #high(\1)
  296                             .endm   
  297                     
  298                     __addmi .macro
  299                              pha
  300                              clc
  301                              lda    <\2
  302                              adc    #low(\1)
  303                              sta    <\2
  304                              lda    <\2+1
  305                              adc    #high(\1)
  306                              sta    <\2+1
  307                              pla
  308                             .endm   
  309                     
  310                     __subw  .macro
  311                              sec
  312                              sax
  313                              sbc    \1
  314                              sax
  315                              sbc    \1+1
  316                             .endm   
  317                     
  318                     __subwi .macro
  319                              sec
  320                              sax
  321                              sbc    #low(\1)
  322                              sax
  323                              sbc    #high(\1)
  324                             .endm   
  325                     
  326                     __submi .macro
  327                              pha
  328                              sec
  329                              lda    <\2
  330                              sbc    #low(\1)
  331                              sta    <\2
  332                              lda    <\2+1
  333                              sbc    #high(\1)
  334                              sta    <\2+1
  335                              pla
  336                             .endm   
  337                     
  338                     __addws .macro
  339                              sax
  340                              clc
  341                              adc    [__stack]
  342                              sax
  343                              ldy    #1
  344                              adc    [__stack],Y
  345                            __addmi 2, __stack
  346                             .endm
  347                     
  348                     __subws .macro
  349                             stx     <__temp
  350                             sta     <__temp+1
  351                             sec
  352                             lda     [__stack]
  353                             sbc     <__temp
  354                             tax
  355                             ldy     #1
  356                             lda     [__stack],Y
  357                             sbc     <__temp+1
  358                             __addmi 2, __stack
  359                             .endm
  360                     
  361                     __orws  .macro
  362                              sax
  363                              ora    [__stack]
  364                              sax
  365                              ldy    #1
  366                              ora    [__stack],Y
  367                            __addmi  2,__stack
  368                             .endm
  369                     
  370                     __orwi  .macro
  371                              sax
  372                              ora    #low(\1)
  373                              sax
  374                              ora    #high(\1)
  375                             .endm   
  376                     
  377                     __orw   .macro
  378                              sax
  379                              ora    \1
  380                              sax
  381                              ora    \1+1
  382                             .endm   
  383                     
  384                     __andws .macro
  385                              sax
  386                              and    [__stack]
  387                              sax
  388                              ldy    #1
  389                              and    [__stack],Y
  390                            __addmi  2,__stack
  391                             .endm
  392                     
  393                     __andwi .macro
  394                              sax
  395                              and    #low(\1)
  396                              sax
  397                              and    #high(\1)
  398                             .endm   
  399                     
  400                     __andw  .macro
  401                              sax
  402                              and    \1
  403                              sax
  404                              and    \1+1
  405                             .endm   
  406                     
  407                     __eorws .macro
  408                              sax
  409                              eor    [__stack]
  410                              sax
  411                              ldy    #1
  412                              eor    [__stack],Y
  413                            __addmi  2,__stack
  414                             .endm
  415                     
  416                     __lbra  .macro
  417                              jmp    \1
  418                             .endm
  419                     
  420                     __lbeq  .macro
  421                              bne    .x\@
  422                              jmp    \1
  423                     .x\@
  424                             .endm
  425                     
  426                     __lbne  .macro
  427                              beq    .x\@
  428                              jmp    \1
  429                     .x\@
  430                             .endm
  431                     
  432                     __call  .macro
  433                              call   \1
  434                             .endm
  435                     
  436                     _set_bgpal .macro
  437                              set_bgpal \1,\2,\3
  438                             .endm
  439                     
  440                     _set_sprpal .macro
  441                              set_sprpal \1,\2,\3
  442                             .endm
  443                     
  444                     _load_background .macro
  445                              vload $1000,\1,#$4000
  446                              vsync
  447                              set_bgpal #0, \2,#16
  448                              batcpy #$0, \3, \4, \5
  449                             .endm
  450                     
#[4]   sup_hes.asm
#[5]   huc_opt.inc
   13                                      .include "huc_opt.inc"
    1                     ;
    2                     ; Hu-C internal include file
    3                     ;
    4                     
    5                     ; optimized macros
    6                     ; ----
    7                     
    8                     ; phw
    9                     ;
   10                             .macro __phw
   11                              ; #1 (bytes :  9, cycles : 16)
   12                              ; #2 (bytes : 16, cycles : 28)
   13                     
   14                             .if (\# = 2)
   15                              tay
   16                              lda    <__arg_idx
   17                              add    #\2
   18                              sta    <__arg_idx
   19                              say
   20                             .else
   21                              ldy    <__arg_idx
   22                             .endif
   23                     
   24                              sta    __arg-(\1),Y
   25                              txa
   26                              sta    __arg-(\1-1),Y
   27                             .endm
   28                     
   29                     ; phb
   30                     ;
   31                             .macro __phb
   32                              ; #1 (bytes :  6, cycles : 11)
   33                              ; #2 (bytes : 12, cycles : 21)
   34                     
   35                             .if (\# = 2)
   36                              lda    <__arg_idx
   37                              add    #\2
   38                              sta    <__arg_idx
   39                              tay
   40                             .else
   41                              ldy    <__arg_idx
   42                             .endif
   43                     
   44                              txa
   45                              sta    __arg-(\1),Y
   46                             .endm
   47                     
   48                     ; plw
   49                     ;
   50                             .macro __plw
   51                              ; (bytes : 9/12, cycles : 16/22)
   52                     
   53                              dey
   54                              lda    __arg,Y
   55                             .if (\#)
   56                              sta    \1
   57                             .else
   58                              tax
   59                             .endif
   60                              dey
   61                              lda    __arg,Y
   62                             .if (\#)
   63                              sta    \1+1
   64                             .endif
   65                             .endm
   66                     
   67                     ; plb
   68                     ;
   69                             .macro __plb
   70                              ; (bytes : 6/7, cycles : 11/12)
   71                     
   72                             .if (\# = 2)
   73                              dey
   74                              ldx    __arg,Y
   75                              stx    \1
   76                             .else
   77                              dey
   78                              lda    __arg,Y
   79                             .if (\#)
   80                              sta    \1
   81                             .endif
   82                             .endif
   83                             .endm
   84                     
   85                     ; lea_s
   86                     ;
   87                             .macro __lea_s
   88                              ; (bytes : 10, cycles : 16)
   89                     
   90                              lda    <__sp
   91                              clc
   92                              adc    #LOW(\1)
   93                              tax
   94                              lda    <__sp+1
   95                              adc    #HIGH(\1)
   96                             .endm
   97                     
   98                     ; pea_s
   99                     ;
  100                             .macro __pea_s
  101                              ; (bytes : 25, cycles : 44)
  102                     
  103                              lda    <__sp
  104                              sec
  105                              sbc    #2
  106                              bcs    .x_\@
  107                              dec    <__sp+1
  108                     .x_\@:   sta    <__sp
  109                              clc
  110                              adc    #LOW(\1+2)
  111                              sta    [__sp]
  112                              tax
  113                              lda    <__sp+1
  114                              adc    #HIGH(\1+2)
  115                              ldy    #1
  116                              sta    [__sp],Y
  117                             .endm
  118                     
  119                     ; ldb_s
  120                     ;
  121                             .macro __ldb_s
  122                             .if (\1 < 256)
  123                              ; short index (bytes :  9, cycles : 13/17)
  124                     
  125                              ldy    #\1
  126                              lda    [__sp],Y
  127                              tax
  128                              cla
  129                     ;        bpl    .x_\@   ; signed
  130                     ;        dec    A
  131                     ;.x_\@:
  132                             .else
  133                              ; long index  (bytes : 20, cycles : 37/41)
  134                     
  135                              addw   #\1,<__sp,<__ptr        ; 13,26
  136                              lda    [__ptr]
  137                              tax
  138                              cla
  139                     ;        bpl    .x_\@   ; signed
  140                     ;        dec    A
  141                     ;.x_\@:
  142                             .endif
  143                             .endm
  144                     
  145                     ; ldb_p
  146                     ;
  147                             .macro __ldb_p
  148                              ; (bytes : 11, cycles : 19/23)
  149                              stx    <__ptr
  150                              sta    <__ptr+1
  151                              lda    [__ptr]
  152                              tax
  153                              cla
  154                     ;        bpl    .x_\@   ; signed
  155                     ;        dec    A
  156                     ;.x_\@:
  157                             .endm
  158                     
  159                     ; ldw_s
  160                     ;
  161                             .macro __ldw_s
  162                             .if (\1 < 255)
  163                              ; short index (bytes :  7/8, cycles : 18/20)
  164                              .if (\1 = 0)
  165                               lda   [__sp]
  166                               tax
  167                               ldy   #1
  168                               lda   [__sp],Y
  169                              .else
  170                               ldy   #\1
  171                               lda   [__sp],Y
  172                               tax
  173                               iny
  174                               lda   [__sp],Y
  175                              .endif
  176                             .else
  177                              ; long index  (bytes : 20, cycles : 44)
  178                     
  179                              addw   #\1,<__sp,<__ptr        ; 13,26
  180                              lda    [__ptr]
  181                              tax
  182                              ldy    #1
  183                              lda    [__ptr],Y
  184                             .endif
  185                             .endm
  186                     
  187                     ; stbi_s
  188                     ;
  189                             .macro __stbi_s
  190                             .if (\2 < 256)
  191                              ; short index (bytes :  8/ 9, cycles : 15)
  192                     
  193                              lda    #LOW(\1)
  194                              ldy    #\2
  195                              sta    [__sp],Y
  196                              tax
  197                     ;        lda    #HIGH(\1)
  198                              cla
  199                             .else
  200                              ; long index  (bytes : 19/20, cycles : 39)
  201                     
  202                              addw   #\2,<__sp,<__ptr        ; 13,26
  203                              lda    #LOW(\1)
  204                              sta    [__ptr]
  205                              tax
  206                     ;        lda    #HIGH(\1)
  207                              cla
  208                             .endif
  209                             .endm
  210                     
  211                     ; stwi_s
  212                     ;
  213                             .macro __stwi_s
  214                             .if (\2 < 255)
  215                              ; short index (bytes : 12, cycles : 24)
  216                     
  217                              lda    #LOW(\1)
  218                              ldy    #\2
  219                              sta    [__sp],Y
  220                              tax
  221                              lda    #HIGH(\1)
  222                              iny
  223                              sta    [__sp],Y
  224                             .else
  225                              ; long index  (bytes : 24, cycles : 48)
  226                     
  227                              addw   #\2,<__sp,<__ptr        ; 13,26
  228                              lda    #LOW(\1)
  229                              sta    [__ptr]
  230                              tax
  231                              lda    #HIGH(\1)
  232                              ldy    #1
  233                              sta    [__ptr],Y
  234                             .endif
  235                             .endm
  236                     
  237                     ; stb_s
  238                     ;
  239                             .macro __stb_s
  240                             .if (\1 < 255)
  241                              ; short index (bytes :  6, cycles : 13)
  242                     
  243                              sax
  244                              ldy    #\1
  245                              sta    [__sp],Y
  246                              sax
  247                             .else
  248                              ; long index  (bytes : 18, cycles : 42)
  249                     
  250                              pha
  251                              addw   #\1,<__sp,<__ptr        ; 13,26
  252                              txa
  253                              sta    [__ptr]
  254                              pla
  255                             .endif
  256                             .endm
  257                     
  258                     ; stw_s
  259                     ;
  260                             .macro __stw_s
  261                             .if (\1 < 255)
  262                              ; short index (bytes :  9, cycles : 22)
  263                     
  264                              sax
  265                              ldy    #\1
  266                              sta    [__sp],Y
  267                              sax
  268                              iny
  269                              sta    [__sp],Y
  270                             .else
  271                              ; long index  (bytes : 22, cycles : 51)
  272                     
  273                              pha
  274                              addw   #\1,<__sp,<__ptr        ; 13,26
  275                              txa
  276                              sta    [__ptr]
  277                              pla
  278                              ldy    #1
  279                              sta    [__ptr],Y
  280                             .endif
  281                             .endm
  282                     
  283                     ; addw_s
  284                     ;
  285                             .macro __addw_s
  286                             .if (\1 < 255)
  287                              ; short index (bytes : 10, cycles : 24)
  288                     
  289                              ldy    #\1
  290                              clc
  291                              sax
  292                              adc    [__sp],Y
  293                              sax
  294                              iny
  295                              adc    [__sp],Y
  296                             .else
  297                              ; long index  (bytes : 24, cycles : 55)
  298                     
  299                              pha                            ;  1, 3
  300                              addw   #\1,<__sp,<__ptr        ; 13,26
  301                              pla                            ;  1, 4
  302                              clc
  303                              sax
  304                              adc    [__ptr]
  305                              sax
  306                              ldy    #1
  307                              adc    [__ptr],Y
  308                             .endif
  309                             .endm
  310                     
  311                     ; incw_s
  312                     ;
  313                             .macro __incw_s
  314                              ; (bytes : 16, cycles : 24/40)
  315                     
  316                              pha
  317                              ldy    #\1
  318                              txa
  319                              inc    A
  320                              sta    [__sp],Y
  321                              bne    .x_\@
  322                              iny
  323                              lda    [__sp],Y
  324                              inc    A
  325                              sta    [__sp],Y
  326                     .x_\@:
  327                              pla
  328                             .endm
  329                     
  330                     ; ldd_i
  331                     ;
  332                             .macro __ldd_i
  333                              stw    #(\1) & 0xFFFF,<\2
  334                              stw    #(\1) >> 16,<\3
  335                              ldx    #low(\2)
  336                              lda    #high(\2)
  337                             .endm
  338                     
  339                     ; ldd_b
  340                     ;
  341                             .macro __ldd_b
  342                              lda     \1
  343                              sta    <\2
  344                              stz    <\2+1
  345                              stwz   <\3
  346                              ldx    #low(\2)
  347                              lda    #high(\2)
  348                             .endm
  349                     
  350                     ; ldd_w
  351                     ;
  352                             .macro __ldd_w
  353                              stw     \1,<\2
  354                              stwz   <\3
  355                              ldx    #low(\2)
  356                              lda    #high(\2)
  357                             .endm
  358                     
  359                     ; ldd_s_b
  360                     ;
  361                             .macro __ldd_s_b
  362                            __ldb_s  \1
  363                              stx    <\2
  364                              sta    <\2+1
  365                              stwz   <\3
  366                              ldx    #low(\2)
  367                              lda    #high(\2)
  368                             .endm
  369                     
  370                     ; ldd_s_w
  371                     ;
  372                             .macro __ldd_s_w
  373                            __ldw_s  \1
  374                              stx    <\2
  375                              sta    <\2+1
  376                              stwz   <\3
  377                              ldx    #low(\2)
  378                              lda    #high(\2)
  379                             .endm
  380                     
#[4]   sup_hes.asm
   14                                     .endif  ; HUC
   15                     
#[5]   standard.inc
   16                                     .include  "standard.inc" ; HUCARD
    1                     ;
    2                     ; STANDARD.INC  -  MagicKit standard include file
    3                     ;
#[6]   equ.inc
    4                             .include        "equ.inc"
    1                     ;
    2                     ; EQU.INC  -  MagicKit Standard Equates
    3                     ;
    4                     ;
    5                     
    6                     
    7                     ; --------
    8                     ; This block defines standard system variables
    9                     ; in zero-page.
   10                     ;
   11                     
   12           20F3      vdc_crl = $20F3 ; VDC control register   (copy of)
   13           20F4      vdc_crh = $20F4 ;
   14           20F5      irq_m   = $20F5 ; interrupt control mask (copy of)
   15           20F6      vdc_sr  = $20F6 ; VDC status register    (copy of)
   16           20F7      vdc_reg = $20F7 ; VDC register index     (copy of)
   17                     
   18                             ; old aliases (for compatibility only, don't use them)
   19                     
   20           0000              .ifndef HUC
   24                             .endif
   25                     
   26                     ; --------
   27                     ; This block defines standard parameter-passing
   28                     ; areas (in zero-page) for subroutines.
   29                     ;
   30                     
   31           20EC      _bp     = $20EC ; base pointer
   32           20EE      _si     = $20EE ; source address
   33           20F0      _di     = $20F0 ; destination address
   34           20F8      _ax     = $20F8
   35           20F8      _al     = $20F8
   36           20F9      _ah     = $20F9
   37           20FA      _bx     = $20FA
   38           20FA      _bl     = $20FA
   39           20FB      _bh     = $20FB
   40           20FC      _cx     = $20FC
   41           20FC      _cl     = $20FC
   42           20FD      _ch     = $20FD
   43           20FE      _dx     = $20FE
   44           20FE      _dl     = $20FE
   45           20FF      _dh     = $20FF
   46                     
   47                     
   48                     ; --------
   49                     ; This block defines names for standard
   50                     ; devices and equipment on the PC-Engine.
   51                     ; (they should be self-explanatory...)
   52                     ;
   53                     
   54                         ; ----
   55                         ; VDC (Video Display Controller)
   56                     
   57           0000      videoport    .equ $0000
   58                     
   59           0000      video_reg    .equ  videoport
   60           0000      video_reg_l  .equ  video_reg
   61           0001      video_reg_h  .equ  video_reg+1
   62                     
   63           0002      video_data   .equ  videoport+2
   64           0002      video_data_l .equ  video_data
   65           0003      video_data_h .equ  video_data+1
   66                     
   67                     
   68                         ; ----
   69                         ; VCE (Video Color Encoder)
   70                     
   71           0400      colorport    .equ $0400
   72           0400      color_ctrl   .equ  colorport
   73                     
   74           0402      color_reg    .equ  colorport+2
   75           0402      color_reg_l  .equ  color_reg
   76           0403      color_reg_h  .equ  color_reg+1
   77                     
   78           0404      color_data   .equ  colorport+4
   79           0404      color_data_l .equ  color_data
   80           0405      color_data_h .equ  color_data+1
   81                     
   82           0001                   .ifdef HUC
   83           0402      _color_reg   .equ  colorport+2
   84           0404      _color_data  .equ  colorport+4
   85                                  .endif
   86                     
   87                         ; ----
   88                         ; PSG (Programmable Sound Generator)
   89                     
   90           0800      psgport      .equ  $0800
   91           0800      psg_ch       .equ  psgport
   92           0801      psg_mainvol  .equ  psgport+1
   93           0802      psg_freqlo   .equ  psgport+2
   94           0803      psg_freqhi   .equ  psgport+3
   95           0804      psg_ctrl     .equ  psgport+4
   96           0805      psg_pan      .equ  psgport+5
   97           0806      psg_wavebuf  .equ  psgport+6
   98           0807      psg_noise    .equ  psgport+7
   99           0808      psg_lfofreq  .equ  psgport+8
  100           0809      psg_lfoctrl  .equ  psgport+9
  101                     
  102                     
  103                         ; ----
  104                         ; TIMER
  105                     
  106           0C00      timerport    .equ  $0C00
  107           0C00      timer_cnt    .equ  timerport
  108           0C01      timer_ctrl   .equ  timerport+1        
  109                     
  110                     
  111                         ; ----
  112                         ; I/O port
  113                     
  114           1000      joyport      .equ  $1000
  115                     
  116                     
  117                         ; ----
  118                         ; IRQ ports
  119                     
  120           1400      irqport      .equ  $1400
  121           1402      irq_disable  .equ  irqport+2
  122           1403      irq_status   .equ  irqport+3
  123                     
  124                         ; ----
  125                         ; CDROM/Expansion ports
  126                     
  127           1800      cd_port       .equ  $1800
  128                     
  129           1803      bram_lock    .equ  cd_port+3  ; a read access here will do it
  130           1807      bram_unlock  .equ  cd_port+7  ; actually, bit #$80 of this byte
  131                     
  132                         ; ----
  133                         ; Arcade Card ports
  134                     
  135           1A00      ac_port        .equ  $1A00
  136           1A00      ac_data1       .equ  ac_port
  137           1A01      ac_data1_alt   .equ  ac_port+1
  138           1A02      ac_base1_l     .equ  ac_port+2
  139           1A03      ac_base1_m     .equ  ac_port+3
  140           1A04      ac_base1_h     .equ  ac_port+4
  141           1A05      ac_offset1_l   .equ  ac_port+5
  142           1A06      ac_offset1_m   .equ  ac_port+6
  143           1A09      ac_cntrol1     .equ  ac_port+9
  144           1A0A      ac_addoffset1  .equ  ac_port+$0A
  145                     
  146           1AE0      ac_shftreg    .equ  $1AE0       ; actually, probably rotate register
  147           1AE0      ac_shftreg_0  .equ  ac_shftreg
  148           1AE1      ac_shftreg_1  .equ  ac_shftreg+1
  149           1AE2      ac_shftreg_2  .equ  ac_shftreg+2
  150           1AE3      ac_shftreg_3  .equ  ac_shftreg+3
  151           1AE4      ac_shft_bits  .equ  ac_shftreg+4        ; positive = shift left
  152                     
  153           1AFD      ac_identbase  .equ  $1AFD
  154           1AFD      ac_identver_l .equ  ac_identbase
  155           1AFE      ac_identver_h .equ  ac_identbase+1
  156           1AFF      ac_identflag  .equ  ac_identbase+2
  157                     
  158           0051      AC_IDENT      .equ  $51 ; if ac_identflag = AC_IDENT, then AC in use
  159                     
  160                     
  161                     ; --------
  162                     ; This block defines names for macro
  163                     ; argument types (\?x).
  164                     ;
  165                     
  166           0000      ARG_NONE        .equ 0
  167           0001      ARG_REG         .equ 1
  168           0002      ARG_IMMED       .equ 2
  169           0003      ARG_ABS         .equ 3
  170           0003      ARG_ABSOLUTE    .equ 3
  171           0004      ARG_INDIRECT    .equ 4
  172           0005      ARG_STRING      .equ 5
  173           0006      ARG_LABEL       .equ 6
  174                     
#[5]   standard.inc
#[6]   macro.inc
    5                             .include        "macro.inc"
    1                     ;
    2                     ; MACRO.INC  -  MagicKit standard MACRO definitions
    3                     ;
    4                     
    5                     map     .macro                  ; map a memory bank into
    6                              lda   #bank(\1)        ; addressable memory
    7                              tam   #page(\1)
    8                             .endm
    9                     
   10                     ;
   11                     ; MAPLIBFUNC - Re-map a library function into $A000-space if it's
   12                     ;              not in library bank #1
   13                     ;
   14                     maplibfunc      .macro
   15                              tay
   16                              tma  #page(\1)
   17                              pha
   18                              lda  #bank(\1)
   19                              tam  #page(\1)
   20                              tya
   21                              jsr  \1
   22                              tay
   23                              pla
   24                              tam  #page(\1)
   25                              tya
   26                             .endm
   27                     
   28                     
   29                     ;
   30                     ; STWZ - store a word-sized zero value at stated memory location
   31                     ;
   32                     stwz    .macro
   33                              stz    LOW_BYTE \1
   34                              stz    HIGH_BYTE \1
   35                             .endm
   36                     
   37                     ;
   38                     ; STW - store a word-sized value at stated memory location
   39                     ;
   40                     stw     .macro
   41                              lda    LOW_BYTE \1
   42                              sta    LOW_BYTE \2
   43                              lda    HIGH_BYTE \1
   44                              sta    HIGH_BYTE \2
   45                             .endm
   46                     
   47                     stb     .macro
   48                              lda    \1
   49                              sta    \2
   50                             .endm
   51                     
   52                     ;
   53                     ; ADDW - add word-sized value to value at stated memory location,
   54                     ;        storing result back into stated memory location (or into
   55                     ;        another destination memory location - third arg)
   56                     ;
   57                     addw    .macro
   58                             .if     (\# = 3)
   59                              ; 3-arg mode
   60                              ;
   61                              clc
   62                              lda    LOW_BYTE \2
   63                              adc    LOW_BYTE \1
   64                              sta    LOW_BYTE \3
   65                              lda    HIGH_BYTE \2
   66                              adc    HIGH_BYTE \1
   67                              sta    HIGH_BYTE \3
   68                             .else
   69                              ; 2-arg mode
   70                              ;
   71                              clc
   72                              lda    LOW_BYTE \2
   73                              adc    LOW_BYTE \1
   74                              sta    LOW_BYTE \2
   75                              lda    HIGH_BYTE \2
   76                              adc    HIGH_BYTE \1
   77                              sta    HIGH_BYTE \2
   78                             .endif
   79                             .endm
   80                     
   81                     ;
   82                     ; ADCW - add word-sized value plus carry to value at stated memory location,
   83                     ;        storing result back into stated memory location
   84                     ;
   85                     adcw    .macro
   86                              lda    LOW_BYTE \2
   87                              adc    LOW_BYTE \1
   88                              sta    LOW_BYTE \2
   89                              lda    HIGH_BYTE \2
   90                              adc    HIGH_BYTE \1
   91                              sta    HIGH_BYTE \2
   92                             .endm
   93                     
   94                     ;
   95                     ; SUBW - substract word-sized value from value at stated memory location,
   96                     ;        storing result back into stated memory location
   97                     ;
   98                     subw    .macro
   99                              sec
  100                              lda    LOW_BYTE \2
  101                              sbc    LOW_BYTE \1
  102                              sta    LOW_BYTE \2
  103                              lda    HIGH_BYTE \2
  104                              sbc    HIGH_BYTE \1
  105                              sta    HIGH_BYTE \2
  106                             .endm
  107                     
  108                     ;
  109                     ; SBCW - substract word-sized value plus carry from value at stated memory
  110                     ;        location, storing result back into stated memory location
  111                     ;
  112                     sbcw    .macro
  113                              lda    LOW_BYTE \2
  114                              sbc    LOW_BYTE \1
  115                              sta    LOW_BYTE \2
  116                              lda    HIGH_BYTE \2
  117                              sbc    HIGH_BYTE \1
  118                              sta    HIGH_BYTE \2
  119                             .endm
  120                     
  121                     cmpw    .macro
  122                              lda    HIGH_BYTE \2
  123                              cmp    HIGH_BYTE \1
  124                              bne    .x_\@
  125                              lda    LOW_BYTE \2
  126                              cmp    LOW_BYTE \1
  127                     .x_\@:
  128                             .endm
  129                     
  130                     tstw    .macro                  ; test if the word-sized 
  131                              lda   \1               ; value at stated memory
  132                              ora   \1+1             ; location is zero
  133                             .endm
  134                     
  135                     incw    .macro                  ; increment a word-sized
  136                              inc    \1              ; value at stated memory
  137                              bne    .x_\@           ; location
  138                              inc    \1+1
  139                     .x_\@:
  140                             .endm
  141                     
  142                     decw    .macro                  ; decrement a word-sized
  143                              sec                    ; value at stated memory
  144                              lda    \1              ; location
  145                              sbc    #1
  146                              sta    \1
  147                              lda    \1+1
  148                              sbc    #0
  149                              sta    \1+1
  150                             .endm
  151                     
  152                     rolw    .macro                  ; rotate word-sized value
  153                              rol    \1              ; (at stated memory location)
  154                              rol    \1+1
  155                             .endm
  156                     
  157                     aslw    .macro                  ; arithmetic shift-left
  158                              asl    \1              ; word-sized value (at stated
  159                              rol    \1+1            ; memory location)
  160                             .endm
  161                     
  162                     lsrw    .macro                  ; logical shift-right word-sized
  163                              lsr    \1+1            ; value (at stated memory
  164                              ror    \1              ; location)
  165                             .endm
  166                     
  167                     rorw    .macro                  ; rotate right word-sized value
  168                              ror    \1+1            ; (at stated memory location)
  169                              ror    \1
  170                             .endm
  171                     
  172                     negw    .macro                  ; negate word-sized value
  173                              cla                    ; (at stated memory location)
  174                              sub    \1              ; 2's complement
  175                              sta    \1
  176                              cla
  177                              sbc    \1+1
  178                              sta    \1+1
  179                             .endm
  180                     
  181                     neg     .macro                  ; negate byte-sized value
  182                              eor    #$FF            ; in register A
  183                              inc    A               ; 2's complement
  184                             .endm
  185                     
  186                     add     .macro                  ; add byte-sized value to
  187                             .if (\# = 2)            ; register A (handle carry
  188                              lda    \2              ; flag)
  189                              clc
  190                              adc    \1
  191                              sta    \2
  192                             .else
  193                              clc
  194                              adc    \1
  195                             .endif
  196                             .endm
  197                     
  198                     sub     .macro                  ; subtract byte-sized value
  199                             .if (\# = 2)            ; from register A (handle
  200                              lda    \2              ; carry flag)
  201                              sec
  202                              sbc    \1
  203                              sta    \2
  204                             .else
  205                              sec
  206                              sbc    \1
  207                             .endif
  208                             .endm
  209                     
  210                     blo     .macro                  ; branch if 'lower'
  211                              bcc    \1
  212                             .endm
  213                     
  214                     bhs     .macro                  ; branch if 'higher or same'
  215                              bcs    \1
  216                             .endm
  217                     
  218                     bhi     .macro                  ; branch if 'higher'
  219                              beq    .x_\@
  220                              bcs    \1
  221                     .x_\@:
  222                             .endm
  223                     
  224                     ;-------------------------------
  225                     
  226                     ;
  227                     ; Long branch MACROs
  228                     ;
  229                     
  230                     lbne    .macro
  231                              beq    .x_\@
  232                              jmp    \1
  233                     .x_\@
  234                             .endm
  235                     
  236                     lbeq    .macro
  237                              bne    .x_\@
  238                              jmp    \1
  239                     .x_\@
  240                             .endm
  241                     
  242                     lbpl    .macro
  243                              bmi    .x_\@
  244                              jmp    \1
  245                     .x_\@
  246                             .endm
  247                     
  248                     lbmi    .macro
  249                              bpl    .x_\@
  250                              jmp    \1
  251                     .x_\@
  252                             .endm
  253                     
  254                     lbcc    .macro
  255                              bcs    .x_\@
  256                              jmp    \1
  257                     .x_\@
  258                             .endm
  259                     
  260                     lbcs    .macro
  261                              bcc    .x_\@
  262                              jmp    \1
  263                     .x_\@
  264                             .endm
  265                     
  266                     lblo    .macro
  267                              bcs    .x_\@
  268                              jmp    \1
  269                     .x_\@
  270                             .endm
  271                     
  272                     lbhs    .macro
  273                              bcc    .x_\@
  274                              jmp    \1
  275                     .x_\@
  276                             .endm
  277                     
  278                     
  279                     ;-------------------------------
  280                     
  281                     ;
  282                     ; These MACROs are the same as the MACROs
  283                     ; without an underscore; the difference
  284                     ; is these MACROs preserve the state of
  285                     ; the registers they use (at the expense
  286                     ; of speed)
  287                     ;
  288                     
  289                     _stw    .macro
  290                              pha
  291                              stw    \1,\2
  292                              pla
  293                             .endm
  294                     
  295                     _addw   .macro
  296                              pha
  297                              addw   \1,\2
  298                              pla
  299                             .endm
  300                     
  301                     _adcw   .macro
  302                              pha
  303                              adcw   \1,\2
  304                              pla
  305                             .endm
  306                     
  307                     _subw   .macro
  308                              pha
  309                              subw   \1,\2
  310                              pla
  311                             .endm
  312                     
  313                     _sbcw   .macro
  314                              pha
  315                              sbcw   \1,\2
  316                              pla
  317                             .endm
  318                     
  319                     _cmpw   .macro
  320                              pha
  321                              cmpw   \1,\2
  322                              pla
  323                             .endm
  324                     
  325                     _tstw   .macro
  326                              pha
  327                              tstw   \1
  328                              pla
  329                             .endm
  330                     
  331                     _incw   .macro
  332                              incw   \1
  333                             .endm
  334                     
  335                     _decw   .macro
  336                              pha
  337                              decw   \1
  338                              pla
  339                             .endm
  340                     
#[5]   standard.inc
#[6]   func.inc
    6                             .include        "func.inc"
    1                     ;
    2                     ; FUNC.INC  -  MagicKit Standard Functions
    3                     ;
    4                     ;
    5                     
    6                     ; ----
    7                     ; BATVAL - create a value for the BAT map
    8                     ;
    9                     ; parameters:
   10                     ; \1 = palette (0-15)
   11                     ; \2 = VRAM address of tile
   12                     
   13                     BATVAL   .func  (\1<<12)|(\2>>4)
   14                     
   15                     
   16                     ; ----
   17                     ; CHAR - create a BAT value for a character defined
   18                     ;        using '.defchar' (uses default palette)
   19                     ;
   20                     ; parameters:
   21                     ; \1 = name of character
   22                     ;
   23                     CHAR     .func  (PAL(\1)<<12|VRAM(\1)>>4)
   24                     
   25                     ; ----
   26                     ; SPR_VRAM - return shifted value of sprite-pattern VRAM address
   27                     ;
   28                     ; parameters:
   29                     ; \1 = VRAM address of sprite
   30                     ;
   31                     SPR_VRAM .func  (VRAM(\1)>>5)
   32                     
#[5]   standard.inc
#[6]   library.inc
    7                             .include        "library.inc"
    1                     ;
    2                     ; LIBRARY.INC  -  MagicKit include-interface to LIBRARY.ASM
    3                     ;
    4                     
    5                     ;
    6                     ; These MACROs are just simple one-line setups to the
    7                     ; back-end library subroutines.  They simply setup
    8                     ; calling parameters, and call the subroutine
    9                     ;
   10                     
   11                     
   12                     ; set video memory read and write address:
   13                     ;
   14                     ; setvraddr(addr)
   15                     ; ----
   16                     ; addr,  new address in VRAM to read at
   17                     ;
   18                             .macro setvraddr
   19                              stw  #\1,<_di
   20                              jsr  set_read
   21                             .endm
   22                     
   23                     ; setvwaddr(addr)
   24                     ; ----
   25                     ; addr,  new address in VRAM to write at
   26                     ;
   27                             .macro setvwaddr
   28                              stw  #\1,<_di
   29                              jsr  set_write
   30                             .endm
   31                     
   32                     ; set_bgpal(index, data [, nb])
   33                     ; ----
   34                     ; index, sub-palette index (0-15)
   35                     ; data,  color data memory address
   36                     ; nb,    number of sub-palette to load (optional, one by default)
   37                     
   38                             .macro set_bgpal
   39                              lda   \1
   40                              sta   <_al
   41                             .if (\?2 = ARG_LABEL)
   42                              stb   #BANK(\2),<_bl
   43                             .else
   44                              stb   #$FE,<_bl
   45                             .endif
   46                              stw   #\2,<_si
   47                             .if \?3
   48                              lda   \3
   49                             .else
   50                              lda   #1
   51                             .endif
   52                              sta   <_cl
   53                              jsr   load_palette
   54                             .endm
   55                     
   56                     ; set_sprpal(index, data [, nb])
   57                     ; ----
   58                     ; index, sub-palette index (0-15)
   59                     ; data,  palette data memory address
   60                     ; nb,    number of sub-palette to update (optional, one by default)
   61                     
   62                             .macro set_sprpal
   63                              lda   \1
   64                              add   #16
   65                              sta   <_al
   66                             .if (\?2 = ARG_LABEL)
   67                              stb   #BANK(\2),<_bl
   68                             .else
   69                              stb   #$FE,<_bl
   70                             .endif
   71                              stw   #\2,<_si
   72                             .if \?3
   73                              lda   \3
   74                             .else
   75                              lda   #1
   76                             .endif
   77                              sta   <_cl
   78                              jsr   load_palette
   79                             .endm
   80                     
   81                     ; setcolor(index, r, g, b)
   82                     ; ----
   83                     ; index, color index
   84                     ; r,     red   (0-7)
   85                     ; g,     green (0-7)
   86                     ; b,     blue  (0-7)
   87                     
   88                             .macro setcolor
   89                              stw   \1,color_reg
   90                              stw   #(((\3) << 6) + ((\2) << 3) + (\4)),color_data
   91                             .endm
   92                     
   93                     ; vload([vram,] data, size)
   94                     ; ----
   95                     ; vram, VRAM base address
   96                     ; data, video data memory address
   97                     ; size, number of words to copy
   98                     
   99                             .macro vload
  100                             .if (\# = 3)
  101                              stw   #\1,<_di
  102                             .if (\?2 = ARG_LABEL)
  103                              stb   #BANK(\2),<_bl
  104                             .else
  105                              stb   #$FE,<_bl
  106                             .endif
  107                              stw   #\2,<_si
  108                              stw    \3,<_cx
  109                             .else
  110                              stw   #VRAM(\1),<_di
  111                              stb   #BANK(\1),<_bl
  112                              stw   #\1,<_si
  113                              stw   #\2,<_cx
  114                             .endif
  115                              jsr   load_vram
  116                             .endm
  117                     
  118                     ; batcpy(vram, bat, w, h)
  119                     ; ----
  120                     ; vram,   VRAM base address
  121                     ; bat,    BAT address in memory
  122                     ; w,      nb of column to copy
  123                     ; h,      nb of row
  124                     
  125                             .macro batcpy
  126                             .if (\# = 5)
  127                              .fail "batcpy syntax has changed, update your code!"
  128                             .endif
  129                              stw    \1,<_di
  130                             .if (\?2 = ARG_LABEL)
  131                              stb   #BANK(\2),<_bl
  132                             .else
  133                              stb   #$FE,<_bl
  134                             .endif
  135                              stw   #\2,<_si
  136                              lda   \3
  137                              sta   <_cl
  138                              lda   \4
  139                              sta   <_ch
  140                              jsr   load_bat
  141                             .endm
  142                     
  143                     ; setmap(map, tile, ctable, w ,h)
  144                     ; ----
  145                     ; map,    map base address
  146                     ; tile,   tile vram address
  147                     ; ctable, tile palette table address
  148                     ; w,      map width
  149                     ; h,      map height
  150                     
  151                             .macro setmap
  152                              stw   #BANK(\1),mapbank
  153                              stw   #\1,mapaddr
  154                              stw   #(\2)>>4,maptilebase
  155                              stw   #\3,mapctable
  156                              stb   #BANK(\3),mapctablebank
  157                              stw   \4,mapwidth
  158                              stw   \5,mapheight
  159                             .endm
  160                     
  161                     ; mapcpy(vram, x, y, w, h)
  162                     ; ----
  163                     ; vram, VRAM base address
  164                     ; x,    x start coordinate in the map
  165                     ; y,    y start coordinate
  166                     ; w,    nb of column to copy
  167                     ; h,    nb of row
  168                     
  169                             .macro mapcpy
  170                              stw   #\1,<_di
  171                              lda   \2
  172                              sta   <_cl
  173                              lda   \3
  174                              sta   <_ch
  175                              lda   \4
  176                              sta   <_dl
  177                              lda   \5
  178                              sta   <_dh
  179                              jsr   load_map
  180                             .endm
  181                     
  182                     ; fntcpy(vram, font, color, bg, nb)
  183                     ; ----
  184                     ; vram,  VRAM base address
  185                     ; font,  font address in memory
  186                     ; color, character color
  187                     ; bg,    bg color
  188                     ; nb,    nb of char. to copy
  189                     
  190                             .macro fntcpy   
  191                              stw   #\1,<_di
  192                              stb   #BANK(\2),<_bl
  193                              stw   #\2,<_si
  194                              lda   \3
  195                              sta   <_al
  196                              lda   \4
  197                              sta   <_ah
  198                              lda   \4
  199                              sta   <_cl
  200                              jsr   load_font
  201                             .endm
  202                     
  203                     ; scroll(num, x, y, top, bottom, cr)
  204                     ; ----
  205                     ; num,    scroll number (0-3)
  206                     ; x,      BAT x position
  207                     ; y,      BAT y position
  208                     ; top,    screen window top
  209                     ; bottom, screen window bottom
  210                     ; cr,     screen window display control (bg/sp)
  211                     
  212                             .macro scroll
  213                              lda   \1
  214                              tax
  215                              lda   LOW_BYTE  \2
  216                              sta   scroll_xl,X
  217                              lda   HIGH_BYTE \2
  218                              sta   scroll_xh,X
  219                              lda   LOW_BYTE  \3
  220                              sta   scroll_yl,X
  221                              lda   HIGH_BYTE \3
  222                              sta   scroll_yh,X
  223                              lda   \4
  224                              sta   scroll_top,X
  225                              lda   \5
  226                              sta   scroll_bottom,X
  227                              lda   \6
  228                              ora   #$01
  229                              sta   scroll_cr,X
  230                             .endm
  231                     
  232                     ; scroll_disable(num)
  233                     ; ----
  234                     ; num,    scroll number (0-3)
  235                     
  236                             .macro scroll_disable
  237                              lda   \1
  238                              tax
  239                              lda   scroll_cr,X
  240                              and   #$fe
  241                              sta   scroll_cr,X
  242                             .endm
  243                     
  244                     ; setxres (xres)
  245                     ; ----
  246                     ; xres,    horizontal display resolution
  247                     
  248                             .macro setxres
  249                              stw   #\1,<_ax
  250                              jsr   set_xres
  251                             .endm
  252                     
#[5]   standard.inc
#[6]   sprites.inc
    8                             .include        "sprites.inc"
    1                     ;
    2                     ; SPRITES.INC  -  MagicKit sprite MACRO definitions
    3                     ;
    4                     
    5                     
    6                     ; load_sprites(vram_addr, spr_bank, #nb_group)
    7                     ; ----
    8                     ; vram_addr, destination address in VRAM
    9                     ; spr_bank,  sprite bank address
   10                     ; nb_group,  number of 32x64 patterns to copy
   11                     
   12                             .macro load_sprites
   13                     
   14                             ; put the VRAM address in _di
   15                     
   16                              stw   #\1,<_di
   17                     
   18                             ; put the sprite bank address in _si/_bl
   19                     
   20                              stw   #\2,<_si
   21                              stb   #BANK(\2),<_bl
   22                     
   23                             ; get the number of patterns to copy, multiply it by $200 -
   24                             ; the size in words of a 32x64 pattern (remember that
   25                             ; 'load_vram' need a size in words), and put it in _cx
   26                     
   27                              lda   \3
   28                              asl   A
   29                              stz   <_cx
   30                              sta   <_cx+1
   31                     
   32                             ; call the 'load_vram' function
   33                     
   34                              jsr load_vram
   35                             .endm
   36                     
   37                     
   38                     ; spr_set(#sprite, satb)
   39                     ; ----
   40                     ; sprite, the sprite number (0-63)
   41                     ; satb,   the address of the SATB in RAM
   42                     
   43                             .macro spr_set
   44                     
   45                             ; multiply the sprite number by 8 (the size of a SATB entry)
   46                             ; and put the result in _si
   47                     
   48                              stz   <_si+1
   49                              lda   \1
   50                              asl   A
   51                              asl   A
   52                              asl   A
   53                              rol   <_si+1
   54                              sta   <_si
   55                     
   56                             ; add the satb address to _si
   57                     
   58                              addw  #\2,<_si
   59                             .endm
   60                     
   61                     
   62                     ; spr_x(#x [,offset])
   63                     ; ----
   64                     ; x, the new x coordinate
   65                     
   66                             .macro spr_x
   67                              ldy   #2
   68                              .if (\# = 2)
   69                               lda   LOW_BYTE \1
   70                               clc
   71                               adc   LOW_BYTE \2
   72                               sta   [_si],Y
   73                               lda   HIGH_BYTE \1
   74                               adc   HIGH_BYTE \2
   75                              .else
   76                               lda   LOW_BYTE \1
   77                               sta   [_si],Y
   78                               lda   HIGH_BYTE \1
   79                              .endif
   80                              iny
   81                              sta   [_si],Y
   82                             .endm
   83                     
   84                     
   85                     ; spr_y(#y [,offset])
   86                     ; ----
   87                     ; y, the new y coordinate
   88                     
   89                             .macro spr_y
   90                              .if (\# = 2)
   91                               lda   LOW_BYTE \1
   92                               clc
   93                               adc   LOW_BYTE \2
   94                               sta   [_si]
   95                               lda   HIGH_BYTE \1
   96                               adc   HIGH_BYTE \2
   97                              .else
   98                               lda   LOW_BYTE \1
   99                               sta   [_si]
  100                               lda   HIGH_BYTE \1
  101                              .endif
  102                              ldy   #1
  103                              sta   [_si],Y
  104                             .endm
  105                     
  106                     
  107                     ; spr_pattern(#addr)
  108                     ; ----
  109                     ; addr, address of the sprite pattern in VRAM
  110                     
  111                             .macro spr_pattern
  112                              ldy   #4
  113                              .if (\?1 = ARG_IMMED)
  114                               lda   #LOW((\1) >> 5)
  115                               sta   [_si],Y
  116                               lda   #HIGH((\1) >> 5)
  117                              .else
  118                               lda   \1
  119                               sta   [_si],Y
  120                               lda   \1+1
  121                              .endif
  122                              iny
  123                              sta   [_si],Y
  124                             .endm
  125                     
  126                     
  127                     ; spr_ctrl(#mask, #flag)
  128                     ; ----
  129                     ; mask, mask of the bits to change
  130                     ; flag, new bit value
  131                     
  132                             .macro spr_ctrl
  133                              ldy   #7
  134                              lda   \1
  135                              eor   #$FF
  136                              and   [_si],Y
  137                              ora   \2
  138                              sta   [_si],Y
  139                             .endm
  140                     
  141                     
  142                     ; spr_pri(#flag)
  143                     ; ----
  144                     ; flag, new priority (1 = in foreground, 0 = in background)
  145                     
  146                             .macro spr_pri
  147                              ldy   #6
  148                              lda   [_si],Y
  149                              and   #$7F
  150                              ldx   \1
  151                              beq   .x\@
  152                              ora   #$80
  153                     .x\@:
  154                              sta [_si],Y
  155                             .endm
  156                     
  157                     
  158                     ; spr_pal(#index)
  159                     ; ----
  160                     ; index, palette index (0-15)
  161                     
  162                             .macro spr_pal
  163                              ldy   #6
  164                              lda   [_si],Y
  165                              and   #$F0
  166                              ora   \1
  167                              sta   [_si],Y
  168                             .endm
  169                     
  170                     
  171                     ; init_satb(addr)
  172                     ; ----
  173                     ; addr, the address of the local RAM SATB
  174                     
  175                             .macro init_satb
  176                              stz \1
  177                              tii \1,\1+1,511
  178                             .endm
  179                     
  180                     
  181                     ; update_satb(satb[, addr] [,nb_sprite])
  182                     ; ----
  183                     ; satb,      the address of the local RAM SATB
  184                     ; addr,      the address where to copy the SATB in VRAM ($7F00 by default)
  185                     ; nb_sprite, number of sprite entry to copy (64 by default)
  186                     
  187                             .macro update_satb
  188                              stw   #\1,<_si
  189                              stb   #BANK(\1),<_bl
  190                              .if (\?2)
  191                               stw   #\2,<_di
  192                              .else
  193                               stw   #$7F00,<_di
  194                              .endif
  195                              .if (\?3)
  196                               stw   #(\3)*4,<_cx
  197                              .else
  198                               stw   #$100,<_cx
  199                              .endif
  200                              jsr   load_vram
  201                             .endm
  202                     
  203                     
  204                     ; ----
  205           0008      FLIP_X_MASK .equ $08
  206           0080      FLIP_Y_MASK .equ $80
  207           0088      FLIP_MASK   .equ $88
  208           0031      SIZE_MASK   .equ $31
  209                     
  210           0000      NO_FLIP    .equ 0
  211           0000      NO_FLIP_X  .equ 0
  212           0000      NO_FLIP_Y  .equ 0
  213           0008      FLIP_X     .equ $08
  214           0080      FLIP_Y     .equ $80
  215           0000      SIZE_16x16 .equ 0
  216           0010      SIZE_16x32 .equ $10
  217           0030      SIZE_16x64 .equ $30
  218           0001      SIZE_32x16 .equ $01
  219           0011      SIZE_32x32 .equ $11
  220           0031      SIZE_32x64 .equ $31
  221                     
#[5]   standard.inc
#[6]   vdc.inc
    9                             .include        "vdc.inc"
    1                     ;
    2                     ; VDC.INC  -  MagicKit PC-Engine video MACRO definitions
    3                     ;
    4                     
    5                     
    6                     ;
    7                     ; VREG - set up video register to be read/written
    8                     ;
    9                     
   10                             .macro vreg
   11                              lda    \1
   12                              sta    <vdc_reg
   13                              .if (\?1 = ARG_IMMED)
   14                               st0   \1
   15                              .else
   16                               sta   video_reg
   17                              .endif
   18                             .endm
   19                     
   20                     ;
   21                     ; SETVINC - set VRAM auto-increment step
   22                     ;
   23                     
   24                             .macro setvinc
   25                              vreg  #5
   26                              .if (\?1 = ARG_IMMED)
   27                               st2   \1
   28                              .else
   29                               lda   \1
   30                               sta   video_data_h
   31                              .endif
   32                             .endm
   33                     
   34                             ; standard increment step
   35                     
   36           0000      VADDR_INC_1   = %00_000
   37           0008      VADDR_INC_32  = %01_000
   38           0010      VADDR_INC_64  = %10_000
   39           0018      VADDR_INC_128 = %11_000
   40                     
   41                     ;
   42                     ; SETBGMAP - set the bgmap virtual size
   43                     ;
   44                     
   45                             .macro setbgmap
   46                              lda   \1
   47                              jsr   set_bat_size
   48                             .endm
   49                     
   50                             ; standard bgmap size
   51                     
   52           0000      BGMAP_SIZE_32x32  = %000
   53           0001      BGMAP_SIZE_64x32  = %001
   54           0003      BGMAP_SIZE_128x32 = %011
   55           0004      BGMAP_SIZE_32x64  = %100
   56           0005      BGMAP_SIZE_64x64  = %101
   57           0007      BGMAP_SIZE_128x64 = %111
   58                     
   59                     ;
   60                     ; These values represent a bit in the VCE which
   61                     ; does color-correction to fix leading/trailing
   62                     ; edges of images
   63                     ;
   64                     ; Default to XRES_SOFT
   65                     ;
   66           0004      XRES_SOFT       = 4
   67           0000      XRES_SHARP      = 0
#[5]   standard.inc
#[6]   startup.inc
   10                             .include        "startup.inc"
    1                     ;
    2                     ; STARTUP.INC  -  MagicKit startup code equates and macros
    3                     ;
    4                     
    5                     ; ----
    6                     ; this block defines names for joypad
    7                     ; direction and button bits
    8                     
    9           0001      JOY_I           = $01
   10           0002      JOY_II          = $02
   11           0004      JOY_SEL         = $04
   12           0008      JOY_RUN         = $08
   13           0010      JOY_UP          = $10
   14           0020      JOY_RIGHT       = $20
   15           0040      JOY_DOWN        = $40
   16           0080      JOY_LEFT        = $80
   17                     
   18           0050      JOY_TYPE6       = $50
   19           0001      JOY_III         = $01
   20           0002      JOY_IV          = $02
   21           0004      JOY_V           = $04
   22           0008      JOY_VI          = $08
   23                     
   24           0000      JOY_BITI        = $0
   25           0001      JOY_BITII       = $1
   26           0002      JOY_BITSEL      = $2
   27           0003      JOY_BITRUN      = $3
   28           0004      JOY_BITUP       = $4
   29           0005      JOY_BITRT       = $5
   30           0006      JOY_BITDN       = $6
   31           0007      JOY_BITLT       = $7
   32                     
   33           0000      JOY_BITIII      = $0
   34           0001      JOY_BITIV       = $1
   35           0002      JOY_BITV        = $2
   36           0003      JOY_BITVI       = $3
   37                     
   38                     ; ----
   39                     ; this block defines names for interrupt
   40                     ; vectors
   41                     ;
   42           0000      IRQ2            = 0
   43           0001      IRQ1            = 1
   44           0002      TIMER           = 2
   45           0003      NMI             = 3
   46           0004      VSYNC           = 4
   47           0005      HSYNC           = 5
   48           0006      SOFT_RESET      = 6
   49                     
   50                     
   51                     ; ----
   52                     ; setvec(num, addr)
   53                     ; ----
   54                     ; num,  vector number (see defines above)
   55                     ; addr, address of the new routine
   56                     ; ----
   57                     
   58                     setvec  .macro
   59                              lda  \1
   60                              ldx  #LOW(\2)
   61                              ldy  #HIGH(\2)
   62                              jsr  set_intvec
   63                             .endm
   64                     
   65                     ; ----
   66                     ; vec_on(num)
   67                     ; ----
   68                     ; num, vector to enable
   69                     ; ----
   70                     
   71                     vec_on  .macro
   72                             .if (\1 = 5)
   73                              smb  #6,<irq_m
   74                             .else
   75                              smb  \1,<irq_m
   76                             .endif
   77                             .endm
   78                     
   79                     ; ----
   80                     ; vec_off(num)
   81                     ; ----
   82                     ; num, vector to disable
   83                     ; ----
   84                     
   85                     vec_off .macro
   86                             .if (\1 = 5)
   87                              rmb  #6,<irq_m
   88                             .else
   89                              rmb  \1,<irq_m
   90                             .endif
   91                             .endm
   92                     
   93                     ; ----
   94                     ; vsync([nb])
   95                     ; ----
   96                     ; nb, number of frames to be sync'ed on
   97                     ; ----
   98                     
   99                     vsync   .macro
  100                             .if (\# = 0)
  101                              lda #1
  102                             .else
  103                              lda \1
  104                             .endif
  105                              jsr  wait_vsync
  106                             .endm
  107                     
  108                     
#[5]   standard.inc
   11                     
#[4]   sup_hes.asm
   17                     
   18                     
   19                     ; ----
   20                     ; setup flexible boundaries for startup code
   21                     ; and user program's "main".
   22                     ;
   23           0000      START_BANK      .equ    0
   24           0000      LIB1_BANK       .equ    START_BANK
   25           0001      LIB2_BANK       .equ    START_BANK+1
   26           0001                     .ifdef HUC
   27           0001      FONT_BANK       .equ    START_BANK+1
   28                     
   29           0000                      .if  (CDROM)
   32                                     .else
   33           0002      PSG_BANK         .equ   START_BANK+2
   34           0003      CONST_BANK       .equ   START_BANK+3
   35           0004      DATA_BANK        .equ   START_BANK+4
   36                                     .endif
   37                     
   38                                    .else
   42                                    .endif   ; HUC
   43                     
   44                     ; ----
   45                     ; if FONT_VADDR is not specified, then specify it
   46                     ; (VRAM address to load font into)
   47                     ;
   48           0000              .ifndef FONT_VADDR
   50                             .endif
   51                     
   52                     ; ----
   53                     ; system variables
   54                     ;
   55           2012                      .zp
   56  --:2012            zp_ptr1:        .ds 2
   57                     
   58                     
   59           2200                      .bss
   60                     
   61           0000              .if  (CDROM)    ; CDROM def's in system.inc
   65                             .else           ; ie HuCard
   66                     
   67           2200                      .org    $2200
   68  --:2200            user_jmptbl:            ; user interrupt vectors
   69  --:2200            irq2_jmp:       .ds 2   ; IRQ2 (BRK instruction and external IRQ)
   70  --:2202            irq1_jmp:       .ds 2   ; IRQ1 (VDC interrupt)
   71  --:2204            timer_jmp:      .ds 2   ; TIMER
   72  --:2206            nmi_jmp:        .ds 2   ; NMI (unused)
   73  --:2208            vsync_hook:     .ds 2   ; VDC vertical sync routine
   74  --:220A            hsync_hook:     .ds 2   ; VDC horizontal sync rountine
   75                     
   76  --:220C            bg_x1:          .ds 2
   77  --:220E            bg_x2:          .ds 2
   78  --:2210            bg_y1:          .ds 2
   79  --:2212            bg_y2:          .ds 2
   80                     
   81                     
   82           2227                      .org    $2227
   83  --:2227            joyena:         .ds 1   ; soft reset enable (bit 0/pad 1, bit 1/pad2, etc.)
   84  --:2228            joy:            .ds 5   ; 'current' pad values (pad #1-5)
   85  --:222D            joytrg:         .ds 5   ; 'delta' pad values (new keys hit)
   86  --:2232            joyold:         .ds 5   ; 'previous' pad values
   87                     
   88           2241                      .org    $2241
   89  --:2241            irq_cnt:        .ds 1   ; VDC interrupt counter; increased 60 times per second
   90                                             ; reset to zero when vsync() function called
   91  --:2242            vdc_mwr:        .ds 1
   92  --:2243            vdc_dcr:        .ds 1
   93                     
   94                             .endif
   95                     
   96           2244                      .org    $2244
   97  --:2244            scr_mode:       .ds 1   ; screen mode and dimensions - set by <ex_scrmod>
   98  --:2245            scr_w:          .ds 1
   99  --:2246            scr_h:          .ds 1
  100                     
  101           2284                      .org    $2284
  102  --:2284            soft_reset:     .ds 2   ; soft reset jump loc (run+select)
  103                     
  104           0001              .if  !(CDROM)
#[5]   sound.inc
  105                                     .include  "sound.inc"
    1                     ;
    2                     ; PSG.INC  -  MagicKit PSG Player Equates
    3                     ;
    4                     ;
    5                     
    6                     ; --------
    7                     ; defines
    8                     ;
    9                     
   10           0080      PSG_INHIBIT =   $80
   11           0040      PSG_DDA =       $40
   12                     
   13           0080      PSG_MAINPAUSE = $80
   14           0040      PSG_SUBPAUSE =  $40
   15                     
   16                     ;PSG_NOISE =    $80
   17                     ;PSG_LFO_ON =   $80
   18                     
   19                     
   20                     ; --------
   21                     ; useful macros:
   22                     ;
   23                     
   24                     ENV_RLS .macro
   25                              .db $fb
   26                              .dw \1
   27                             .endm
   28                     
   29                     ENV_LEV .macro
   30                              .db $fc
   31                              .dw \1
   32                             .endm
   33                     
   34                     ENV_DLY .macro
   35                              .db \1
   36                              .dw \2
   37                             .endm
   38                     
   39                     ENV_END .macro
   40                              .db $ff
   41                             .endm
   42                     
   43                     
   44                     ; --------
   45                     ; This block defines standard system variables
   46                     ; in zero-page.
   47                     ;
   48                     
   49           20E6      psg_irqflag     =       $20e6
   50           20E7      psg_inhibit     =       $20e7
   51           20E8      psg_tmpptr      =       $20e8
   52           20EA      psg_tmpptr1     =       $20ea
   53                     
   54                     
   55                     
   56           22D0                      .org    $22d0
   57                     
   58                     ; --------
   59                     ; "global" data (common to all voices)
   60                     ;
   61  --:22D0            psg_tempo       .ds     1
   62  --:22D1            psg_trkhdr      .ds     2
   63  --:22D3            psg_wavehdr     .ds     2
   64  --:22D5            psg_envhdr      .ds     2
   65  --:22D7            psg_percusshdr  .ds     2
   66  --:22D9            psg_fmhdr       .ds     2
   67  --:22DB            psg_pehdr       .ds     2
   68  --:22DD            psg_trkctrl     .ds     1
   69                     
   70  --:22DE            psg_ch_value    .ds     1
   71  --:22DF            psg_currvoice   .ds     1
   72  --:22E0            psg_song        .ds     1
   73  --:22E1            psg_bank1       .ds     1
   74  --:22E2            psg_bank2       .ds     1
   75                     
   76                     
   77                     ; "local" data array (one item for each voice)
   78                     ;
   79  --:22E3            psg_voicectrl   .ds     12
   80  --:22EF            psg_trkptr_l    .ds     12
   81  --:22FB            psg_trkptr_h    .ds     12
   82  --:2307            psg_savepoint_l .ds     12
   83  --:2313            psg_savepoint_h .ds     12
   84  --:231F            psg_cntdown     .ds     12
   85  --:232B            psg_octave      .ds     12
   86  --:2337            psg_freq_l      .ds     12
   87  --:2343            psg_freq_h      .ds     12
   88  --:234F            psg_perchvol    .ds     12
   89  --:235B            psg_keyonratio  .ds     12
   90  --:2367            psg_keycntdown  .ds     12
   91  --:2373            psg_transpose   .ds     12
   92  --:237F            psg_duratnmult  .ds     12
   93  --:238B            psg_envptr_l    .ds     12
   94  --:2397            psg_envptr_h    .ds     12
   95  --:23A3            psg_envptr_off  .ds     12
   96  --:23AF            psg_envlevel_l  .ds     12
   97  --:23BB            psg_envlevel_h  .ds     12
   98  --:23C7            psg_envduratn_l .ds     12
   99  --:23D3            psg_envduratn_h .ds     12
  100  --:23DF            psg_envduratn   .ds     12
  101  --:23EB            psg_envrels_l   .ds     12
  102  --:23F7            psg_envrels_h   .ds     12
  103  --:2403            psg_fmptr_l     .ds     12
  104  --:240F            psg_fmptr_h     .ds     12
  105  --:241B            psg_fmptr_off   .ds     12
  106  --:2427            psg_fmcorrect   .ds     12
  107  --:2433            psg_fmdelay     .ds     12
  108  --:243F            psg_fmdelcntdn  .ds     12
  109  --:244B            psg_peptr_l     .ds     12
  110  --:2457            psg_peptr_h     .ds     12
  111  --:2463            psg_peptr_off   .ds     12
  112  --:246F            psg_pedelay     .ds     12
  113  --:247B            psg_pedelcntdn  .ds     12
  114  --:2487            psg_detune      .ds     12
  115  --:2493            psg_volchg      .ds     12
  116  --:249F            psg_volchgaccum .ds     12
  117  --:24AB            psg_panpotchg   .ds     12
  118  --:24B7            psg_panpotaccum .ds     12
  119  --:24C3            psg_sweep       .ds     12
  120  --:24CF            psg_sweepamt_l  .ds     12
  121  --:24DB            psg_sweepamt_h  .ds     12
  122  --:24E7            psg_swptime     .ds     12
  123  --:24F3            psg_swptmcntdn  .ds     12
  124  --:24FF            psg_percuss_l   .ds     12
  125  --:250B            psg_percuss_h   .ds     12
  126                     
  127  --:2517            psg_stack_0     .ds     11
  128  --:2522            psg_stack_1     .ds     11
  129  --:252D            psg_stack_2     .ds     11
  130  --:2538            psg_stack_3     .ds     11
  131  --:2543            psg_stack_4     .ds     11
  132  --:254E            psg_stack_5     .ds     11
  133  --:2559            psg_stack_6     .ds     10
  134  --:2563            psg_stack_7     .ds     10
  135  --:256D            psg_stack_8     .ds     10
  136  --:2577            psg_stack_9     .ds     10
  137  --:2581            psg_stack_10    .ds     10
  138  --:258B            psg_stack_11    .ds     10
  139                     
  140  --:2595            psg_mode        .ds     12
  141  --:25A1            psg_stkoff      .ds     12
  142  --:25AD            psg_tone_l      .ds     12
  143  --:25B9            psg_tone_h      .ds     12
  144  --:25C5            psg_volume      .ds     12
  145  --:25D1            psg_panpot      .ds     12
  146  --:25DD            psg_wavenum     .ds     12
  147  --:25E9            psg_noisefreq   .ds     12
  148  --:25F5            psg_strikephase .ds     12
  149  --:2601            psg_fadespeed   .ds     2
  150  --:2603            psg_fadecount   .ds     2
  151  --:2605            psg_fadevolcut  .ds     2
  152                     
#[4]   sup_hes.asm
  106                             .endif
  107                     
  108           2680                      .org    $2680
  109  --:2680            vsync_cnt:      .ds 1   ; counter for 'wait_vsync' routine
  110                     
  111  --:2681            joybuf:         .ds 5   ; 'delta' pad values collector
  112  --:2686            joyhook:        .ds 2   ; 'read_joypad' routine hook
  113  --:2688            joycallback:    .ds 6   ; joypad enhanced callback support
  114  --:268E            disp_cr:        .ds 1   ; display control (1 = on, 0 = off)
  115  --:268F            clock_hh        .ds 1   ; system clock, hours since startup (0-255)
  116  --:2690            clock_mm        .ds 1   ; system clock, minutes since startup (0-59)
  117  --:2691            clock_ss        .ds 1   ; system clock, seconds since startup (0-59)
  118  --:2692            clock_tt        .ds 1   ; system clock, ticks (1/60th sec) since startup (0-59)
  119                     
  120  --:2693            joy6:           .ds 5   ; second byte for 6-button joysticks
  121  --:2698            joytrg6:        .ds 5
  122  --:269D            joyold6:        .ds 5
  123  --:26A2            joybuf6:        .ds 5
  124                     
  125  --:26A7            joytmp:         .ds 5
  126  --:26AC            joytmp6:        .ds 5
  127                     
  128           0000              .if (CDROM)
  135                             .endif  ; (CDROM)
  136                     
  137                     ;[ STARTUP CODE ]
  138                     
  139                     ; Let's prepare this secondary libray bank first, for use later.
  140                     ; The reason, as you will see, is because code for a given function
  141                     ; which sits together in a file, may have things in zero-page,
  142                     ; bss, LIB1_BANK (ie. START_BANK), and LIB2_BANK.
  143                     ;
  144                     ; The assembler must know beforehand what address etc. to use as a basis.
  145                     ;
  146           E000              .data
  147           0001              .bank LIB2_BANK,"Base Library 2/Font"
  148           6000              .org  $6000
#[5]   font.inc
  149                              .include "font.inc"
    1                     ; 8x8 monochrome font(s)
    2                     
    3  01:6000            font_1:
    4  01:6000  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;SPACE
       01:6003  00 00 00  
       01:6006  00 00     
    5  01:6008  CC CC CC          .db $cc,$cc,$cc,$88,$88,$00,$cc,$00     ;!
       01:600B  88 88 00  
       01:600E  CC 00     
    6  01:6010  6C 6C D8          .db $6c,$6c,$d8,$00,$00,$00,$00,$00     ;"
       01:6013  00 00 00  
       01:6016  00 00     
    7  01:6018  6C FE 6C          .db $6c,$fe,$6c,$6c,$6c,$fe,$6c,$00     ;#
       01:601B  6C 6C FE  
       01:601E  6C 00     
    8  01:6020  10 38 40          .db $10,$38,$40,$38,$04,$38,$10,$00     ;$
       01:6023  38 04 38  
       01:6026  10 00     
    9  01:6028  42 A4 48          .db $42,$a4,$48,$10,$24,$4a,$84,$00     ;%
       01:602B  10 24 4A  
       01:602E  84 00     
   10  01:6030  20 50 20          .db $20,$50,$20,$54,$88,$94,$62,$00     ;&
       01:6033  54 88 94  
       01:6036  62 00     
   11  01:6038  18 30 60          .db $18,$30,$60,$00,$00,$00,$00,$00     ;'
       01:603B  00 00 00  
       01:603E  00 00     
   12  01:6040  18 30 60          .db $18,$30,$60,$60,$60,$30,$18,$00     ;(
       01:6043  60 60 30  
       01:6046  18 00     
   13  01:6048  30 18 0C          .db $30,$18,$0c,$0c,$0c,$18,$30,$00     ;)
       01:604B  0C 0C 18  
       01:604E  30 00     
   14  01:6050  54 38 7C          .db $54,$38,$7c,$38,$54,$00,$00,$00     ;*
       01:6053  38 54 00  
       01:6056  00 00     
   15  01:6058  00 10 10          .db $00,$10,$10,$7c,$10,$10,$00,$00     ;+
       01:605B  7C 10 10  
       01:605E  00 00     
   16  01:6060  00 00 00          .db $00,$00,$00,$18,$18,$08,$10,$00     ;,
       01:6063  18 18 08  
       01:6066  10 00     
   17  01:6068  00 00 00          .db $00,$00,$00,$78,$00,$00,$00,$00     ;-
       01:606B  78 00 00  
       01:606E  00 00     
   18  01:6070  00 00 00          .db $00,$00,$00,$00,$60,$60,$00,$00     ;.
       01:6073  00 60 60  
       01:6076  00 00     
   19  01:6078  06 0C 18          .db $06,$0c,$18,$30,$60,$c0,$00,$00     ;/
       01:607B  30 60 C0  
       01:607E  00 00     
   20                     
   21  01:6080  38 4C C6          .db $38,$4c,$c6,$c6,$c6,$64,$38,$00     ;0
       01:6083  C6 C6 64  
       01:6086  38 00     
   22  01:6088  18 78 18          .db $18,$78,$18,$18,$18,$18,$7e,$00     ;1
       01:608B  18 18 18  
       01:608E  7E 00     
   23  01:6090  7C C6 0E          .db $7c,$c6,$0e,$3c,$78,$e0,$fe,$00     ;2
       01:6093  3C 78 E0  
       01:6096  FE 00     
   24  01:6098  FE 0C 18          .db $fe,$0c,$18,$7c,$06,$c6,$7c,$00     ;3
       01:609B  7C 06 C6  
       01:609E  7C 00     
   25  01:60A0  3C 6C CC          .db $3c,$6c,$cc,$cc,$cc,$fe,$0c,$00     ;4
       01:60A3  CC CC FE  
       01:60A6  0C 00     
   26  01:60A8  FE C0 FC          .db $fe,$c0,$fc,$06,$06,$c6,$7c,$00     ;5
       01:60AB  06 06 C6  
       01:60AE  7C 00     
   27  01:60B0  3C 60 C0          .db $3c,$60,$c0,$fc,$c6,$c6,$7c,$00     ;6
       01:60B3  FC C6 C6  
       01:60B6  7C 00     
   28  01:60B8  FE C6 0C          .db $fe,$c6,$0c,$18,$30,$30,$30,$00     ;7
       01:60BB  18 30 30  
       01:60BE  30 00     
   29  01:60C0  7C C6 C6          .db $7c,$c6,$c6,$7c,$c6,$c6,$7c,$00     ;8
       01:60C3  7C C6 C6  
       01:60C6  7C 00     
   30  01:60C8  7C C6 C6          .db $7c,$c6,$c6,$7e,$06,$0c,$78,$00     ;9
       01:60CB  7E 06 0C  
       01:60CE  78 00     
   31  01:60D0  00 18 18          .db $00,$18,$18,$00,$18,$18,$00,$00     ;:
       01:60D3  00 18 18  
       01:60D6  00 00     
   32  01:60D8  00 18 18          .db $00,$18,$18,$00,$18,$18,$30,$00     ;;
       01:60DB  00 18 18  
       01:60DE  30 00     
   33  01:60E0  0C 18 30          .db $0c,$18,$30,$60,$30,$18,$0c,$00     ;<
       01:60E3  60 30 18  
       01:60E6  0C 00     
   34  01:60E8  00 00 7C          .db $00,$00,$7c,$00,$7c,$00,$00,$00     ;=
       01:60EB  00 7C 00  
       01:60EE  00 00     
   35  01:60F0  60 30 18          .db $60,$30,$18,$0c,$18,$30,$60,$00     ;>
       01:60F3  0C 18 30  
       01:60F6  60 00     
   36  01:60F8  7C C6 9E          .db $7c,$c6,$9e,$38,$20,$00,$30,$00     ;?
       01:60FB  38 20 00  
       01:60FE  30 00     
   37                     
   38  01:6100  3C 42 9A          .db $3c,$42,$9a,$aa,$aa,$5c,$00,$00     ;@
       01:6103  AA AA 5C  
       01:6106  00 00     
   39  01:6108  38 6C C6          .db $38,$6c,$c6,$c6,$fe,$c6,$c6,$00     ;A
       01:610B  C6 FE C6  
       01:610E  C6 00     
   40  01:6110  FC C6 C6          .db $fc,$c6,$c6,$fc,$c6,$c6,$fc,$00     ;B
       01:6113  FC C6 C6  
       01:6116  FC 00     
   41  01:6118  3C 66 C0          .db $3c,$66,$c0,$c0,$c0,$66,$3c,$00     ;C
       01:611B  C0 C0 66  
       01:611E  3C 00     
   42  01:6120  F8 CC C6          .db $f8,$cc,$c6,$c6,$c6,$cc,$f8,$00     ;D
       01:6123  C6 C6 CC  
       01:6126  F8 00     
   43  01:6128  FE C0 C0          .db $fe,$c0,$c0,$fc,$c0,$c0,$fe,$00     ;E
       01:612B  FC C0 C0  
       01:612E  FE 00     
   44  01:6130  FE C0 C0          .db $fe,$c0,$c0,$fc,$c0,$c0,$c0,$00     ;F
       01:6133  FC C0 C0  
       01:6136  C0 00     
   45  01:6138  3C 66 C0          .db $3c,$66,$c0,$ce,$c6,$66,$3e,$00     ;G
       01:613B  CE C6 66  
       01:613E  3E 00     
   46  01:6140  C6 C6 C6          .db $c6,$c6,$c6,$fe,$c6,$c6,$c6,$00     ;H
       01:6143  FE C6 C6  
       01:6146  C6 00     
   47  01:6148  7E 18 18          .db $7e,$18,$18,$18,$18,$18,$7e,$00     ;I
       01:614B  18 18 18  
       01:614E  7E 00     
   48  01:6150  06 06 06          .db $06,$06,$06,$06,$06,$c6,$7c,$00     ;J
       01:6153  06 06 C6  
       01:6156  7C 00     
   49  01:6158  C6 CC D8          .db $c6,$cc,$d8,$f0,$d8,$cc,$c6,$00     ;K
       01:615B  F0 D8 CC  
       01:615E  C6 00     
   50  01:6160  C0 C0 C0          .db $c0,$c0,$c0,$c0,$c0,$c0,$fe,$00     ;L
       01:6163  C0 C0 C0  
       01:6166  FE 00     
   51  01:6168  82 C6 EE          .db $82,$c6,$ee,$fe,$d6,$c6,$c6,$00     ;M
       01:616B  FE D6 C6  
       01:616E  C6 00     
   52  01:6170  86 C6 E6          .db $86,$c6,$e6,$f6,$de,$ce,$c6,$00     ;N
       01:6173  F6 DE CE  
       01:6176  C6 00     
   53  01:6178  7C C6 C6          .db $7c,$c6,$c6,$c6,$c6,$c6,$7c,$00     ;O
       01:617B  C6 C6 C6  
       01:617E  7C 00     
   54                     
   55  01:6180  FC C6 C6          .db $fc,$c6,$c6,$c6,$fc,$c0,$c0,$00     ;P
       01:6183  C6 FC C0  
       01:6186  C0 00     
   56  01:6188  7C C6 C6          .db $7c,$c6,$c6,$c6,$de,$cc,$76,$00     ;Q
       01:618B  C6 DE CC  
       01:618E  76 00     
   57  01:6190  FC C6 C6          .db $fc,$c6,$c6,$fc,$d8,$cc,$c6,$00     ;R
       01:6193  FC D8 CC  
       01:6196  C6 00     
   58  01:6198  7C C6 F0          .db $7c,$c6,$f0,$7c,$1e,$c6,$7c,$00     ;S
       01:619B  7C 1E C6  
       01:619E  7C 00     
   59  01:61A0  7E 18 18          .db $7e,$18,$18,$18,$18,$18,$18,$00     ;T
       01:61A3  18 18 18  
       01:61A6  18 00     
   60  01:61A8  C6 C6 C6          .db $c6,$c6,$c6,$c6,$c6,$c6,$7c,$00     ;U
       01:61AB  C6 C6 C6  
       01:61AE  7C 00     
   61  01:61B0  C6 C6 C6          .db $c6,$c6,$c6,$c6,$c6,$6c,$38,$00     ;V
       01:61B3  C6 C6 6C  
       01:61B6  38 00     
   62  01:61B8  C6 C6 C6          .db $c6,$c6,$c6,$d6,$fe,$ee,$c6,$00     ;W
       01:61BB  D6 FE EE  
       01:61BE  C6 00     
   63  01:61C0  C6 EE 7C          .db $c6,$ee,$7c,$38,$7c,$ee,$c6,$00     ;X
       01:61C3  38 7C EE  
       01:61C6  C6 00     
   64  01:61C8  66 66 66          .db $66,$66,$66,$3c,$18,$18,$18,$00     ;Y
       01:61CB  3C 18 18  
       01:61CE  18 00     
   65  01:61D0  FE 0E 1C          .db $fe,$0e,$1c,$38,$70,$e0,$fe,$00     ;Z
       01:61D3  38 70 E0  
       01:61D6  FE 00     
   66  01:61D8  78 60 60          .db $78,$60,$60,$60,$60,$60,$78,$00     ;[
       01:61DB  60 60 60  
       01:61DE  78 00     
   67  01:61E0  C0 60 30          .db $c0,$60,$30,$18,$0c,$06,$00,$00     ;\
       01:61E3  18 0C 06  
       01:61E6  00 00     
   68  01:61E8  3C 0C 0C          .db $3c,$0c,$0c,$0c,$0c,$0c,$3c,$00     ;]
       01:61EB  0C 0C 0C  
       01:61EE  3C 00     
   69  01:61F0  10 28 44          .db $10,$28,$44,$00,$00,$00,$00,$00     ;^
       01:61F3  00 00 00  
       01:61F6  00 00     
   70  01:61F8  00 00 00          .db $00,$00,$00,$00,$00,$00,$fe,$00     ;_
       01:61FB  00 00 00  
       01:61FE  FE 00     
   71                     
   72  01:6200  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ; 
       01:6203  00 00 00  
       01:6206  00 00     
   73  01:6208  00 00 3C          .db $00,$00,$3c,$06,$7e,$c6,$7e,$00     ;a
       01:620B  06 7E C6  
       01:620E  7E 00     
   74  01:6210  C0 C0 FC          .db $c0,$c0,$fc,$c6,$c6,$c6,$fc,$00     ;b
       01:6213  C6 C6 C6  
       01:6216  FC 00     
   75  01:6218  00 00 7C          .db $00,$00,$7c,$c6,$c0,$c6,$7c,$00     ;c
       01:621B  C6 C0 C6  
       01:621E  7C 00     
   76  01:6220  06 06 7E          .db $06,$06,$7e,$c6,$c6,$c6,$7e,$00     ;d
       01:6223  C6 C6 C6  
       01:6226  7E 00     
   77  01:6228  00 00 7C          .db $00,$00,$7c,$c6,$fc,$c0,$7e,$00     ;e
       01:622B  C6 FC C0  
       01:622E  7E 00     
   78  01:6230  3E 60 60          .db $3e,$60,$60,$f8,$60,$60,$60,$00     ;f
       01:6233  F8 60 60  
       01:6236  60 00     
   79  01:6238  00 00 7C          .db $00,$00,$7c,$c6,$c6,$7e,$06,$7c     ;g
       01:623B  C6 C6 7E  
       01:623E  06 7C     
   80  01:6240  C0 C0 FC          .db $c0,$c0,$fc,$c6,$c6,$c6,$c6,$00     ;h
       01:6243  C6 C6 C6  
       01:6246  C6 00     
   81  01:6248  18 00 18          .db $18,$00,$18,$18,$18,$18,$18,$00     ;i
       01:624B  18 18 18  
       01:624E  18 00     
   82  01:6250  0C 0C 00          .db $0c,$0c,$00,$0c,$0c,$0c,$0c,$78     ;j
       01:6253  0C 0C 0C  
       01:6256  0C 78     
   83  01:6258  C0 C0 D8          .db $c0,$c0,$d8,$f0,$e0,$f0,$d8,$00     ;k
       01:625B  F0 E0 F0  
       01:625E  D8 00     
   84  01:6260  70 30 30          .db $70,$30,$30,$30,$30,$30,$78,$00     ;l
       01:6263  30 30 30  
       01:6266  78 00     
   85  01:6268  00 00 7C          .db $00,$00,$7c,$d6,$d6,$d6,$d6,$00     ;m
       01:626B  D6 D6 D6  
       01:626E  D6 00     
   86  01:6270  00 00 7C          .db $00,$00,$7c,$66,$66,$66,$66,$00     ;n
       01:6273  66 66 66  
       01:6276  66 00     
   87  01:6278  00 00 3C          .db $00,$00,$3c,$66,$66,$66,$3c,$00     ;o
       01:627B  66 66 66  
       01:627E  3C 00     
   88                     
   89  01:6280  00 00 7C          .db $00,$00,$7c,$66,$66,$7c,$60,$60     ;p
       01:6283  66 66 7C  
       01:6286  60 60     
   90  01:6288  00 00 3E          .db $00,$00,$3e,$66,$66,$3e,$06,$06     ;q
       01:628B  66 66 3E  
       01:628E  06 06     
   91  01:6290  00 00 D8          .db $00,$00,$d8,$fc,$e0,$c0,$c0,$00     ;r
       01:6293  FC E0 C0  
       01:6296  C0 00     
   92  01:6298  00 00 3C          .db $00,$00,$3c,$60,$38,$0c,$78,$00     ;s
       01:629B  60 38 0C  
       01:629E  78 00     
   93  01:62A0  30 30 78          .db $30,$30,$78,$30,$30,$30,$1c,$00     ;t
       01:62A3  30 30 30  
       01:62A6  1C 00     
   94  01:62A8  00 00 66          .db $00,$00,$66,$66,$66,$66,$3e,$00     ;u
       01:62AB  66 66 66  
       01:62AE  3E 00     
   95  01:62B0  00 00 C6          .db $00,$00,$c6,$c6,$6c,$38,$10,$00     ;v
       01:62B3  C6 6C 38  
       01:62B6  10 00     
   96  01:62B8  00 00 C6          .db $00,$00,$c6,$d6,$d6,$d6,$6c,$00     ;w
       01:62BB  D6 D6 D6  
       01:62BE  6C 00     
   97  01:62C0  00 00 C6          .db $00,$00,$c6,$6c,$10,$6c,$c6,$00     ;x
       01:62C3  6C 10 6C  
       01:62C6  C6 00     
   98  01:62C8  00 00 66          .db $00,$00,$66,$66,$66,$3e,$06,$3c     ;y
       01:62CB  66 66 3E  
       01:62CE  06 3C     
   99  01:62D0  00 00 FE          .db $00,$00,$fe,$0c,$38,$60,$fe,$00     ;z
       01:62D3  0C 38 60  
       01:62D6  FE 00     
  100  01:62D8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:62DB  00 00 00  
       01:62DE  00 00     
  101  01:62E0  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:62E3  00 00 00  
       01:62E6  00 00     
  102  01:62E8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:62EB  00 00 00  
       01:62EE  00 00     
  103  01:62F0  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:62F3  00 00 00  
       01:62F6  00 00     
  104  01:62F8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:62FB  00 00 00  
       01:62FE  00 00     
  105                     
  106  01:6300            font_2:
  107  01:6300  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;SPACE
       01:6303  00 00 00  
       01:6306  00 00     
  108  01:6308  04 0C 0C          .db $04,$0c,$0c,$08,$08,$00,$10,$00     ;!
       01:630B  08 08 00  
       01:630E  10 00     
  109  01:6310  36 12 24          .db $36,$12,$24,$00,$00,$00,$00,$00     ;"
       01:6313  00 00 00  
       01:6316  00 00     
  110  01:6318  12 3F 12          .db $12,$3f,$12,$22,$24,$7e,$24,$00     ;#
       01:631B  22 24 7E  
       01:631E  24 00     
  111  01:6320  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;$
       01:6323  00 00 00  
       01:6326  00 00     
  112  01:6328  00 31 32          .db $00,$31,$32,$04,$18,$26,$46,$00     ;%
       01:632B  04 18 26  
       01:632E  46 00     
  113  01:6330  08 14 14          .db $08,$14,$14,$38,$4a,$44,$3a,$00     ;&
       01:6333  38 4A 44  
       01:6336  3A 00     
  114  01:6338  18 08 10          .db $18,$08,$10,$00,$00,$00,$00,$00     ;'
       01:633B  00 00 00  
       01:633E  00 00     
  115  01:6340  0C 10 20          .db $0c,$10,$20,$20,$20,$10,$08,$00     ;(
       01:6343  20 20 10  
       01:6346  08 00     
  116  01:6348  10 08 04          .db $10,$08,$04,$04,$04,$08,$30,$00     ;)
       01:634B  04 04 08  
       01:634E  30 00     
  117  01:6350  00 08 2A          .db $00,$08,$2a,$1c,$1c,$2a,$08,$00     ;*
       01:6353  1C 1C 2A  
       01:6356  08 00     
  118  01:6358  00 08 08          .db $00,$08,$08,$3e,$08,$08,$00,$00     ;+
       01:635B  3E 08 08  
       01:635E  00 00     
  119  01:6360  00 00 00          .db $00,$00,$00,$00,$60,$60,$20,$40     ;,
       01:6363  00 60 60  
       01:6366  20 40     
  120  01:6368  00 00 00          .db $00,$00,$00,$1e,$00,$00,$00,$00     ;-
       01:636B  1E 00 00  
       01:636E  00 00     
  121  01:6370  00 00 00          .db $00,$00,$00,$00,$00,$60,$60,$00     ;.
       01:6373  00 00 60  
       01:6376  60 00     
  122  01:6378  00 02 04          .db $00,$02,$04,$08,$10,$20,$40,$00     ;/
       01:637B  08 10 20  
       01:637E  40 00     
  123                     
  124  01:6380  1C 22 22          .db $1c,$22,$22,$42,$42,$44,$38,$00     ;0
       01:6383  42 42 44  
       01:6386  38 00     
  125  01:6388  0C 1C 04          .db $0c,$1c,$04,$08,$08,$08,$3c,$00     ;1
       01:638B  08 08 08  
       01:638E  3C 00     
  126  01:6390  1C 22 02          .db $1c,$22,$02,$0c,$30,$40,$7c,$00     ;2
       01:6393  0C 30 40  
       01:6396  7C 00     
  127  01:6398  1C 22 02          .db $1c,$22,$02,$0c,$02,$44,$38,$00     ;3
       01:639B  0C 02 44  
       01:639E  38 00     
  128  01:63A0  0E 12 24          .db $0e,$12,$24,$44,$7f,$08,$08,$00     ;4
       01:63A3  44 7F 08  
       01:63A6  08 00     
  129  01:63A8  1F 10 20          .db $1f,$10,$20,$3c,$02,$42,$3c,$00     ;5
       01:63AB  3C 02 42  
       01:63AE  3C 00     
  130  01:63B0  1E 21 20          .db $1e,$21,$20,$7c,$42,$42,$3c,$00     ;6
       01:63B3  7C 42 42  
       01:63B6  3C 00     
  131  01:63B8  3E 22 44          .db $3e,$22,$44,$04,$08,$08,$10,$00     ;7
       01:63BB  04 08 08  
       01:63BE  10 00     
  132  01:63C0  1C 22 22          .db $1c,$22,$22,$3c,$42,$42,$3c,$00     ;8
       01:63C3  3C 42 42  
       01:63C6  3C 00     
  133  01:63C8  1C 22 22          .db $1c,$22,$22,$1e,$02,$44,$38,$00     ;9
       01:63CB  1E 02 44  
       01:63CE  38 00     
  134  01:63D0  00 00 08          .db $00,$00,$08,$00,$00,$00,$10,$00     ;:
       01:63D3  00 00 00  
       01:63D6  10 00     
  135  01:63D8  00 00 08          .db $00,$00,$08,$00,$00,$00,$10,$20     ;;
       01:63DB  00 00 00  
       01:63DE  10 20     
  136  01:63E0  00 04 08          .db $00,$04,$08,$10,$10,$08,$04,$00     ;<
       01:63E3  10 10 08  
       01:63E6  04 00     
  137  01:63E8  00 00 00          .db $00,$00,$00,$1e,$00,$1e,$00,$00     ;=
       01:63EB  1E 00 1E  
       01:63EE  00 00     
  138  01:63F0  00 10 08          .db $00,$10,$08,$04,$04,$08,$10,$00     ;>
       01:63F3  04 04 08  
       01:63F6  10 00     
  139  01:63F8  1C 22 02          .db $1c,$22,$02,$04,$08,$00,$10,$00     ;?
       01:63FB  04 08 00  
       01:63FE  10 00     
  140                     
  141  01:6400  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;@
       01:6403  00 00 00  
       01:6406  00 00     
  142  01:6408  0E 12 12          .db $0e,$12,$12,$22,$3e,$42,$42,$00     ;A
       01:640B  22 3E 42  
       01:640E  42 00     
  143  01:6410  1C 12 22          .db $1c,$12,$22,$3c,$22,$42,$7c,$00     ;B
       01:6413  3C 22 42  
       01:6416  7C 00     
  144  01:6418  1C 22 22          .db $1c,$22,$22,$40,$40,$44,$38,$00     ;C
       01:641B  40 40 44  
       01:641E  38 00     
  145  01:6420  18 14 22          .db $18,$14,$22,$22,$42,$44,$f8,$00     ;D
       01:6423  22 42 44  
       01:6426  F8 00     
  146  01:6428  1E 10 20          .db $1e,$10,$20,$3c,$20,$40,$7c,$00     ;E
       01:642B  3C 20 40  
       01:642E  7C 00     
  147  01:6430  1E 10 20          .db $1e,$10,$20,$3c,$20,$40,$40,$00     ;F
       01:6433  3C 20 40  
       01:6436  40 00     
  148  01:6438  1C 22 20          .db $1c,$22,$20,$40,$47,$44,$38,$00     ;G
       01:643B  40 47 44  
       01:643E  38 00     
  149  01:6440  11 11 22          .db $11,$11,$22,$3e,$22,$44,$44,$00     ;H
       01:6443  3E 22 44  
       01:6446  44 00     
  150  01:6448  1E 08 08          .db $1e,$08,$08,$10,$10,$20,$f0,$00     ;I
       01:644B  10 10 20  
       01:644E  F0 00     
  151  01:6450  1E 04 04          .db $1e,$04,$04,$08,$88,$90,$60,$00     ;J
       01:6453  08 88 90  
       01:6456  60 00     
  152  01:6458  10 12 24          .db $10,$12,$24,$38,$28,$44,$44,$00     ;K
       01:645B  38 28 44  
       01:645E  44 00     
  153  01:6460  10 10 20          .db $10,$10,$20,$20,$20,$40,$7c,$00     ;L
       01:6463  20 20 40  
       01:6466  7C 00     
  154  01:6468  21 27 5A          .db $21,$27,$5a,$52,$42,$84,$84,$00     ;M
       01:646B  52 42 84  
       01:646E  84 00     
  155  01:6470  21 21 52          .db $21,$21,$52,$52,$4a,$84,$84,$00     ;N
       01:6473  52 4A 84  
       01:6476  84 00     
  156  01:6478  1C 22 22          .db $1c,$22,$22,$42,$42,$44,$38,$00     ;O
       01:647B  42 42 44  
       01:647E  38 00     
  157                     
  158  01:6480  1C 12 22          .db $1c,$12,$22,$3c,$20,$40,$40,$00     ;P
       01:6483  3C 20 40  
       01:6486  40 00     
  159  01:6488  1C 22 22          .db $1c,$22,$22,$42,$4a,$44,$34,$02     ;Q
       01:648B  42 4A 44  
       01:648E  34 02     
  160  01:6490  1C 12 22          .db $1c,$12,$22,$3c,$28,$48,$46,$00     ;R
       01:6493  3C 28 48  
       01:6496  46 00     
  161  01:6498  1C 22 20          .db $1c,$22,$20,$18,$04,$44,$38,$00     ;S
       01:649B  18 04 44  
       01:649E  38 00     
  162  01:64A0  3E 08 10          .db $3e,$08,$10,$10,$10,$20,$20,$00     ;T
       01:64A3  10 10 20  
       01:64A6  20 00     
  163  01:64A8  22 22 42          .db $22,$22,$42,$44,$44,$44,$38,$00     ;U
       01:64AB  44 44 44  
       01:64AE  38 00     
  164  01:64B0  42 44 44          .db $42,$44,$44,$48,$50,$50,$60,$00     ;V
       01:64B3  48 50 50  
       01:64B6  60 00     
  165  01:64B8  41 41 42          .db $41,$41,$42,$52,$52,$6c,$44,$00     ;W
       01:64BB  52 52 6C  
       01:64BE  44 00     
  166  01:64C0  22 24 18          .db $22,$24,$18,$18,$28,$44,$44,$00     ;X
       01:64C3  18 28 44  
       01:64C6  44 00     
  167  01:64C8  42 42 24          .db $42,$42,$24,$18,$10,$20,$20,$00     ;Y
       01:64CB  18 10 20  
       01:64CE  20 00     
  168  01:64D0  3E 02 04          .db $3e,$02,$04,$18,$20,$40,$7c,$00     ;Z
       01:64D3  18 20 40  
       01:64D6  7C 00     
  169  01:64D8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;[
       01:64DB  00 00 00  
       01:64DE  00 00     
  170  01:64E0  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;\
       01:64E3  00 00 00  
       01:64E6  00 00     
  171  01:64E8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;]
       01:64EB  00 00 00  
       01:64EE  00 00     
  172  01:64F0  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;^
       01:64F3  00 00 00  
       01:64F6  00 00     
  173  01:64F8  00 00 00          .db $00,$00,$00,$00,$00,$00,$3e,$00     ;_
       01:64FB  00 00 00  
       01:64FE  3E 00     
  174                     
  175  01:6500  00 10 18          .db $00,$10,$18,$18,$00,$00,$00,$00     ; 
       01:6503  18 00 00  
       01:6506  00 00     
  176  01:6508  00 1C 02          .db $00,$1c,$02,$3c,$44,$48,$34,$00     ;a
       01:650B  3C 44 48  
       01:650E  34 00     
  177  01:6510  00 08 08          .db $00,$08,$08,$1c,$12,$22,$3c,$00     ;b
       01:6513  1C 12 22  
       01:6516  3C 00     
  178  01:6518  00 00 1C          .db $00,$00,$1c,$22,$40,$40,$38,$00     ;c
       01:651B  22 40 40  
       01:651E  38 00     
  179  01:6520  00 02 02          .db $00,$02,$02,$3c,$44,$48,$38,$00     ;d
       01:6523  3C 44 48  
       01:6526  38 00     
  180  01:6528  00 00 1C          .db $00,$00,$1c,$22,$7e,$40,$38,$00     ;e
       01:652B  22 7E 40  
       01:652E  38 00     
  181  01:6530  00 06 08          .db $00,$06,$08,$3c,$10,$20,$20,$00     ;f
       01:6533  3C 10 20  
       01:6536  20 00     
  182  01:6538  00 00 3A          .db $00,$00,$3a,$44,$44,$38,$08,$70     ;g
       01:653B  44 44 38  
       01:653E  08 70     
  183  01:6540  00 08 08          .db $00,$08,$08,$1c,$12,$22,$24,$00     ;h
       01:6543  1C 12 22  
       01:6546  24 00     
  184  01:6548  00 04 00          .db $00,$04,$00,$08,$08,$10,$10,$00     ;i
       01:654B  08 08 10  
       01:654E  10 00     
  185  01:6550  00 02 00          .db $00,$02,$00,$04,$44,$48,$38,$00     ;j
       01:6553  04 44 48  
       01:6556  38 00     
  186  01:6558  00 10 12          .db $00,$10,$12,$24,$38,$48,$46,$00     ;k
       01:655B  24 38 48  
       01:655E  46 00     
  187  01:6560  00 0C 04          .db $00,$0c,$04,$08,$08,$10,$10,$00     ;l
       01:6563  08 08 10  
       01:6566  10 00     
  188  01:6568  00 00 2A          .db $00,$00,$2a,$15,$25,$29,$4a,$00     ;m
       01:656B  15 25 29  
       01:656E  4A 00     
  189  01:6570  00 00 2C          .db $00,$00,$2c,$12,$12,$24,$26,$00     ;n
       01:6573  12 12 24  
       01:6576  26 00     
  190  01:6578  00 00 0C          .db $00,$00,$0c,$12,$22,$24,$18,$00     ;o
       01:657B  12 22 24  
       01:657E  18 00     
  191                     
  192  01:6580  00 0E 09          .db $00,$0e,$09,$11,$1e,$20,$20,$00     ;p
       01:6583  11 1E 20  
       01:6586  20 00     
  193  01:6588  00 1E 22          .db $00,$1e,$22,$24,$1c,$08,$08,$00     ;q
       01:658B  24 1C 08  
       01:658E  08 00     
  194  01:6590  00 00 2C          .db $00,$00,$2c,$12,$10,$20,$20,$00     ;r
       01:6593  12 10 20  
       01:6596  20 00     
  195  01:6598  00 00 1C          .db $00,$00,$1c,$22,$18,$44,$38,$00     ;s
       01:659B  22 18 44  
       01:659E  38 00     
  196  01:65A0  00 08 3C          .db $00,$08,$3c,$10,$20,$20,$18,$00     ;t
       01:65A3  10 20 20  
       01:65A6  18 00     
  197  01:65A8  00 00 22          .db $00,$00,$22,$42,$44,$48,$34,$00     ;u
       01:65AB  42 44 48  
       01:65AE  34 00     
  198  01:65B0  00 00 22          .db $00,$00,$22,$24,$28,$28,$10,$00     ;v
       01:65B3  24 28 28  
       01:65B6  10 00     
  199  01:65B8  00 00 21          .db $00,$00,$21,$41,$49,$5a,$2c,$00     ;w
       01:65BB  41 49 5A  
       01:65BE  2C 00     
  200  01:65C0  00 00 11          .db $00,$00,$11,$0a,$0c,$14,$22,$00     ;x
       01:65C3  0A 0C 14  
       01:65C6  22 00     
  201  01:65C8  00 00 11          .db $00,$00,$11,$21,$22,$1e,$04,$38     ;y
       01:65CB  21 22 1E  
       01:65CE  04 38     
  202  01:65D0  00 00 3E          .db $00,$00,$3e,$04,$18,$20,$7c,$00     ;z
       01:65D3  04 18 20  
       01:65D6  7C 00     
  203  01:65D8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:65DB  00 00 00  
       01:65DE  00 00     
  204  01:65E0  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:65E3  00 00 00  
       01:65E6  00 00     
  205  01:65E8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:65EB  00 00 00  
       01:65EE  00 00     
  206  01:65F0  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:65F3  00 00 00  
       01:65F6  00 00     
  207  01:65F8  00 00 00          .db $00,$00,$00,$00,$00,$00,$00,$00     ;
       01:65FB  00 00 00  
       01:65FE  00 00     
#[4]   sup_hes.asm
  150           E000              .code
  151           0001              .bank LIB2_BANK
  152           A600              .org  $A600
  153                     
  154                     
  155           6600              .data
  156           0003              .bank CONST_BANK,"Constants"
  157                     
  158           0000              .data
  159           0004              .bank DATA_BANK,"User Program"
  160           6000              .org  $6000
  161                     ;
  162                     ; place overlay array here
  163                     ; 50 entries, each containing
  164                     ; 2 bytes for start sector,
  165                     ; 2 bytes for # sectors
  166                     ;
  167  04:6000            ovlarray:       .ds     200
  168                     
  169                     
  170           A600              .code
  171           0000              .bank START_BANK,"Base Library 1"
  172                     
  173                     ; A little introduction to the boot sequence:
  174                     ;
  175                     ; A HuCard has its origin at bank 0, and is mapped at $E000
  176                     ; It needs to grab the interrupt vectors at $FFF6 and implement
  177                     ; implement handlers for them
  178                     ;
  179                     ; A CDROM will load at bank $80 ($68 for SCD), and the initial
  180                     ; loader will be mapped at $4000.  The current MagicKit sequence
  181                     ; also maps $C000 to this same bank.  However, the initial boot
  182                     ; sequence will execute at $4070, proceeding to load additional
  183                     ; code and data, and then jump to a post-boot section called
  184                     ; 'init_go'.  This is the point at which the loader explicitly
  185                     ; relinquishes the $4000 segment.  It should be noted that there
  186                     ; are library subroutines loaded as part of this initial segment,
  187                     ; and those routines are located in the $C000 range as well.
  188                     ;
  189                     ; Sectors are loaded, up to and including the first "DATA_BANK",
  190                     ; where the overlay array is stored - so that the CDROM error
  191                     ; overlay can be located and executed in the event of a CDROM
  192                     ; system version mismatch (ie. playing SCD games on CDROM)
  193                     ;
  194                     ; A second entry point is defined for overlays that are not
  195                     ; being booted (ie. they are loaded and executed from another
  196                     ; overlay).  This entry point is at $4000, after the segments
  197                     ; have all found their natural loading spots (ie. segment $68
  198                     ; for Super CDROMs).  This entry point maps the necessary
  199                     ; segments and resets the stack, without clearing memory or
  200                     ; performing other setup chores, and then maps and executes
  201                     ; _main() to run the module.  The user has no choice regarding
  202                     ; this function, although he can pass values through the global
  203                     ; variables which main() can use to decide what to do next.
  204                     ;
  205                     ; An additional "Hook" area has now been defined at $4028,
  206                     ; which is used at initial load time, in case a SCD overlay
  207                     ; program is run on plain CDROM hardware, and the author
  208                     ; wishes to override the default text error message by
  209                     ; loading and executing a plain CDROM program instead
  210                     ;
  211                         ; ----
  212                         ; interrupt vectors
  213                     
  214           0001             .if !(CDROM)
  215           FFF6              .org  $FFF6
  216                     
  217  00:FFF6  BF E1             .dw _irq2
  218  00:FFF8  C6 E1             .dw _irq1
  219  00:FFFA  63 E3             .dw _timer
  220  00:FFFC  B0 E3             .dw _nmi
  221  00:FFFE  AC E0             .dw _reset
  222                            .endif   ; !(CDROM)
  223                     
  224                         ; ----
  225                         ; develo startup code
  226                     
  227           0000             .if (DEVELO)
  237                            .endif   ; (DEVELO)
  238                     
  239                     
  240                     ; ----
  241                     ; reset
  242                     ; ----
  243                     ; things start here
  244                     ; ----
  245                     
  246                         ; ----
  247                         ; CDROM re-map library bank
  248                         ;
  249                     ;
  250                     ; overlay entry point
  251                     ;
  252                     ; assume MMR0, MMR1, MMR6, MMR7 are set.
  253                     ; set others & reset stack pointer
  254                     ;
  255           0000             .if (CDROM)
  356                            .else            ; (ie. if HuCard...)
  357                     
  358                     ;-----------[HES HEADER]-------------------------
  359           E000              .org  $E000
  360                     
  361  00:E000  48 45 53          db      "HESM",$00,$00
       00:E003  4D 00 00  
  362  00:E006  20 E0             dw      _hes_init
  363  00:E008  FF F8 01          db      $ff,$f8,$01,$02,$00,$05,$00,$00
       00:E00B  02 00 05  
       00:E00E  00 00     
  364  00:E010  44 41 54          db      "DATA"
       00:E013  41        
  365  00:E014  E0 3F             dw      ((_nb_bank%8)*$2000)-$20  ; size low
  366  00:E016  01 00             dw      (_nb_bank-1)/8 ; size high
  367  00:E018  20 00             dw      $0020      ; addr low
  368  00:E01A  00 00             dw      $0000      ; addr high
  369                     
  370  00:E01C  00 00             dw      $0000 ; Reserve
  371  00:E01E  00 00             dw      $0000
  372                     
  373                     
  374           E020              .org  $E020
  375  00:E020            _hes_init:
  376  00:E020  78                sei                     ; disable interrupts 
  377  00:E021  D4                csh                     ; select the 7.16 MHz clock
  378  00:E022  D8                cld                     ; clear the decimal flag 
  379  00:E023  A9 FF             lda   #$FF              ; map the I/O bank in the first page
  380  00:E025  53 01             tam   #0
  381  00:E027  A9 F8             lda   #$F8              ; and the RAM bank in the second page
  382  00:E029  53 02             tam   #1
  383                     
  384  00:C02B                    stw   #$4000,<__sp      ; init stack ptr first
  385                     
  386  00:E033  9C 01 0C          stz   timer_ctrl        ; init timer
  387                     
  388  00:E036  20 DE E5          jsr   init_psg          ; init sound
  389                     
  390  00:E039  20 E7 E4          jsr   init_vdc          ; init video
  391  00:E03C  A9 1F             lda   #$1F              ; init joypad
  392  00:E03E  8D 27 22          sta   joyena
  393                     
  394  00:E041  A2 04             ldx   #4                ; user vector table
  395  00:E043  C2                cly
  396  00:E044  A9 BE     .l2:    lda   #LOW(_rti)
  397  00:E046  99 00 22          sta   user_jmptbl,Y
  398  00:E049  C8                iny
  399  00:E04A  A9 E1             lda   #HIGH(_rti)
  400  00:E04C  99 00 22          sta   user_jmptbl,Y
  401  00:E04F  C8                iny
  402  00:E050  CA                dex
  403  00:E051  D0 F1             bne   .l2
  404                     
  405                     
  406  00:C053                    stw   #_reset,soft_reset ; soft reset
  407  00:C05D                    stw   #_rts,vsync_hook   ; user vsync routine
  408  00:C067                    stw   #_rts,hsync_hook   ; user hsync routine
  409                     
  410  00:E071  A9 01             lda   #$01               ; enable interrupts
  411  00:E073  8D 02 14          sta   irq_disable
  412  00:E076  9C 03 14          stz   irq_status
  413  00:E079  58                cli
  414                     
  415  00:C07A                    vreg  #5
  416  00:E080  A9 C8             lda   #$C8
  417  00:E082  85 F3             sta  <vdc_crl
  418  00:E084  8D 02 00          sta   video_data_l
  419  00:E087  23 00             st2   #$00
  420  00:E089  A9 01             lda   #$01
  421  00:E08B  8D 8E 26          sta   disp_cr
  422                     
  423  00:E08E  A9 E3             lda   #$E3              ; TIA instruction opcode
  424  00:E090  8D CC 26          sta   _ram_hdwr_tia
  425  00:E093  A9 60             lda   #$60              ; RTS instruction opcode
  426  00:E095  8D D3 26          sta   _ram_hdwr_tia_rts
  427                     
  428                     
  429  00:E098  A9 03             lda   #CONST_BANK+_bank_base    ; map string constants bank
  430  00:E09A  53 04             tam   #2                ; (ie. $4000-$5FFF)
  431  00:E09C  A9 09             lda   #_call_bank       ; map call bank
  432  00:E09E  53 10             tam   #4                ; (ie. $8000-$9FFF)
  433                     
  434  00:C0A0                    map   _drv_init
  435  00:E0A4  20 4B A6          jsr   _drv_init
  436                     
  437  00:E0A7  C7 F5             smb   #4,<irq_m
  438  00:E0A9  D7 F5             smb   #5,<irq_m         ; disable system card code
  439                     
  440  00:E0AB  60                rts
  441                     
  442  00:E0AC            _reset:
  443  00:E0AC  78                sei                     ; disable interrupts 
  444  00:E0AD  D4                csh                     ; select the 7.16 MHz clock
  445  00:E0AE  D8                cld                     ; clear the decimal flag 
  446  00:E0AF  A2 FF             ldx   #$FF              ; initialize the stack pointer
  447  00:E0B1  9A                txs 
  448  00:E0B2  A9 FF             lda   #$FF              ; map the I/O bank in the first page
  449  00:E0B4  53 01             tam   #0
  450  00:E0B6  A9 F8             lda   #$F8              ; and the RAM bank in the second page
  451  00:E0B8  53 02             tam   #1
  452  00:E0BA  9C 00 20          stz   $2000             ; clear all the RAM
  453  00:E0BD  73 00 20          tii   $2000,$2001,$1FFF
       00:E0C0  01 20 FF  
       00:E0C3  1F        
  454                     
  455                            .endif   ; (CDROM)
  456                     
  457                         ; ----
  458                         ; initialize the hardware
  459                     
  460  00:E0C4            _init:
  461           0000             .if (CDROM)
  466                            .else
  467  00:E0C4  9C 01 0C          stz   timer_ctrl        ; init timer
  468                            .endif   ; (CDROM)
  469                     
  470  00:E0C7  20 DE E5          jsr   init_psg          ; init sound
  471                     
  472  00:E0CA  20 E7 E4          jsr   init_vdc          ; init video
  473  00:E0CD  A9 1F             lda   #$1F              ; init joypad
  474  00:E0CF  8D 27 22          sta   joyena
  475                     
  476                         ; ----
  477                         ; initialize interrupt vectors
  478                     
  479           0000             .if  (CDROM)
  483                            .else
  484                     
  485  00:E0D2  A2 04             ldx   #4                ; user vector table
  486  00:E0D4  C2                cly
  487  00:E0D5  A9 BE     .l2:    lda   #LOW(_rti)
  488  00:E0D7  99 00 22          sta   user_jmptbl,Y
  489  00:E0DA  C8                iny
  490  00:E0DB  A9 E1             lda   #HIGH(_rti)
  491  00:E0DD  99 00 22          sta   user_jmptbl,Y
  492  00:E0E0  C8                iny
  493  00:E0E1  CA                dex
  494  00:E0E2  D0 F1             bne   .l2
  495                     
  496  00:C0E4                    stw   #_reset,soft_reset ; soft reset
  497  00:C0EE                    stw   #_rts,vsync_hook   ; user vsync routine
  498  00:C0F8                    stw   #_rts,hsync_hook   ; user hsync routine
  499                     
  500  00:E102  A9 01             lda   #$01               ; enable interrupts
  501  00:E104  8D 02 14          sta   irq_disable
  502  00:E107  9C 03 14          stz   irq_status
  503  00:E10A  58                cli
  504                     
  505                         ; ----
  506                         ; enable display and VSYNC interrupt
  507                     
  508  00:C10B                    vreg  #5
  509  00:E111  A9 C8             lda   #$C8
  510  00:E113  85 F3             sta  <vdc_crl
  511  00:E115  8D 02 00          sta   video_data_l
  512  00:E118  23 00             st2   #$00
  513  00:E11A  A9 01             lda   #$01
  514  00:E11C  8D 8E 26          sta   disp_cr
  515                     
  516                            .endif   ; (CDROM)
  517                     
  518                         ; ----
  519                         ; init TIA instruction in RAM (fast BLiTter to hardware)
  520                     
  521  00:E11F  A9 E3             lda   #$E3              ; TIA instruction opcode
  522  00:E121  8D CC 26          sta   _ram_hdwr_tia
  523  00:E124  A9 60             lda   #$60              ; RTS instruction opcode
  524  00:E126  8D D3 26          sta   _ram_hdwr_tia_rts
  525                     
  526                         ; ----
  527                         ; init random number generator
  528                     
  529  00:E129  A9 01             lda   #1
  530  00:E12B  20 C8 FC          jsr   wait_vsync        ; wait for one frame & randomize _rndseed
  531  00:C12E                    stw   #$03E7,<_cx       ; set random seed
  532  00:C136                    stw   _rndseed,<_dx
  533  00:E140  20 17 E8          jsr   srand
  534                     
  535           0000             .if (CDROM)
  629                            .endif   ; (CDROM)
  630                     
  631                         ; ----
  632                         ; jump to main routine
  633                     
  634                         ; ----
  635                         ; load font
  636                     
  637           0001             .ifdef HUC
  638  00:C143                    stw   #$4000,<__sp      ; init stack ptr first
  639                     
  640  00:C14B                    stw   #FONT_VADDR,<_di  ; Load Font @ VRAM addr
  641                     
  642                             ;
  643                             ; this section of font loading was stolen
  644                             ; from _load_default_font because the default
  645                             ; FONT segment number is not yet guaranteed
  646                             ; if the SCD is being run on a plain CDROM system
  647                             ; so we need to trick the segment pointer
  648                             ; with a reliable one
  649                             ;
  650  00:C153                  __ldw   <_di      ; stolen from _load_default_font
  651                                             ; because segment# default not reliable
  652                     
  653  00:E157  20 AE ED          jsr   _set_font_addr            ; set VRAM
  654                     
  655           0000             .if  (CDROM)
  658                            .else
  659  00:C15A                    stb   #FONT_BANK+_bank_base,<_bl
  660                            .endif
  661                     
  662  00:C15E                    stb   #96,<_cl
  663  00:C162                    stb   _font_color+1,<_ah
  664  00:E167  AD 71 27          lda   _font_color
  665  00:E16A  D0 01             bne   .fntld
  666  00:E16C  1A                inc   A
  667  00:E16D  85 F8     .fntld: sta   <_al
  668  00:E16F  82                clx
  669  00:E170  BD B7 E3          lda   font_table,X
  670  00:E173  85 EE             sta   <_si
  671  00:E175  E8                inx
  672  00:E176  BD B7 E3          lda   font_table,X
  673  00:E179  85 EF             sta   <_si+1
  674                     
  675                     
  676                             ; Now, load the font
  677                             ;
  678                             ;   Note for CDROM/Super CDROM:
  679                             ;
  680                             ; The 'REAL' mapping for the lib2_load_font function
  681                             ; maybe doesn't exist yet (we are executing from bank $80,
  682                             ; not from $68 if it's a Super CDROM)
  683                             ;
  684                             ; So we must map the version at bank ($80 + LIB2_BANK)
  685                             ; before executing it.  We remap the bank after completion,
  686                             ; 'just in case'
  687                     
  688           0000             .if  (CDROM)
  696                            .else
  697  00:E17B  20 4E E4          jsr   load_font
  698                            .endif
  699                     
  700                             ;
  701                             ; END stolen font-load
  702                             ;
  703                     
  704  00:E17E  20 62 ED          jsr   _cls
  705                     
  706  00:E181  9C 02 04          stz  color_reg  ; set color #0 = 0/0/0 rgb
  707  00:E184  9C 03 04          stz  color_reg+1
  708  00:E187  9C 04 04          stz  color_data
  709  00:E18A  9C 05 04          stz  color_data+1
  710                     
  711  00:E18D  A9 01             lda  #1         ; set color #1 = 7/7/7 rgb
  712  00:E18F  8D 02 04          sta  color_reg
  713  00:E192  9C 03 04          stz  color_reg+1
  714  00:E195  A2 FF             ldx  #$ff
  715  00:E197  8E 04 04          stx  color_data
  716  00:E19A  8D 05 04          sta  color_data+1
  717                     
  718                         ; ----
  719                         ; Super CDROM error message
  720                         ; ----
  721                     
  722           0000              .if (CDROM)
  770                             .endif          ; (CDROM)
  771                            .endif           ; (HUC)
  772                     
  773                     
  774           0001             .ifdef SUPPORT_MOUSE
  775  00:E19D  20 2F FC          jsr  mousinit           ; check existence of mouse
  776                            .endif   ; SUPPORT_MOUSE
  777                     
  778           0000             .if  (CDROM)
  800                            .endif   ; (CDROM)
  801                     
  802           0001             .ifdef HUC
  803                         ; ----
  804                         ; Map the final stuff before executing main()
  805                         ; ----
  806                     
  807  00:E1A0  A9 03             lda   #CONST_BANK+_bank_base    ; map string constants bank
  808  00:E1A2  53 04             tam   #2                ; (ie. $4000-$5FFF)
  809  00:E1A4  A9 09             lda   #_call_bank       ; map call bank
  810  00:E1A6  53 10             tam   #4                ; (ie. $8000-$9FFF)
  811                             ; ---
  812           0000              .if   (CDROM)
  815                             .endif
  816                             ; ---
  817  00:E1A8  9C 8F 26          stz   clock_hh          ; clear clock
  818  00:E1AB  9C 90 26          stz   clock_mm
  819  00:E1AE  9C 91 26          stz   clock_ss
  820  00:E1B1  9C 92 26          stz   clock_tt
  821                     
  822  00:C1B4                    map   _main
  823  00:E1B8  20 7A AC          jsr   _main             ; go!
  824  00:E1BB  80 FE             bra   *
  825                            .else
  828                            .endif   ; HUC
  829                     
  830                     
  831                     ; ----
  832                     ; system
  833                     ; ----
  834                     ; give back control to the Develo system
  835                     ; ----
  836                     
  837           0000             .if (DEVELO)
  873                            .endif   ; (DEVELO)
  874                     
  875                     ;[ INTERRUPT CODE ]
  876                     
  877  00:E1BD            _rts:
  878  00:E1BD  60                rts
  879  00:E1BE            _rti:
  880  00:E1BE  40                rti
  881                     
  882                     ; ----
  883                     ; irq2
  884                     ; ----
  885                     ; IRQ2 interrupt handler
  886                     ; ----
  887                     
  888           0001             .if !(CDROM)
  889  00:E1BF            _irq2:
  890  00:E1BF  8F F5 01          bbs0 <irq_m,.user
  891  00:E1C2  40                rti
  892  00:E1C3            .user:
  893  00:E1C3  6C 00 22          jmp   [irq2_jmp]
  894                            .endif   ; !(CDROM)
  895                     
  896                     ; ----
  897                     ; irq1
  898                     ; ----
  899                     ; VDC interrupt handler
  900                     ; ----
  901                     
  902           0001             .if !(CDROM)
  903                     
  904                     
  905  00:E1C6            _irq1:
  906  00:E1C6  9F F5 39          bbs1 <irq_m,user_irq1   ; jump to the user irq1 vector if bit set
  907                             ; --
  908  00:E1C9  48                pha                     ; save registers
  909  00:E1CA  DA                phx
  910  00:E1CB  5A                phy
  911                             ; --
  912  00:E1CC  AD 00 00          lda   video_reg         ; get VDC status register
  913  00:E1CF  85 F6             sta  <vdc_sr            ; save a copy
  914                     
  915                         ; ----
  916                         ; vsync interrupt
  917                         ;
  918  00:E1D1            .vsync:
  919  00:E1D1  5F F6 16          bbr5 <vdc_sr,.hsync
  920                             ; --
  921  00:E1D4  EE 41 22          inc   irq_cnt           ; increment IRQ counter
  922                             ; --
  923  00:E1D7  03 05             st0   #5                ; update display control (bg/sp)
  924  00:E1D9  A5 F3             lda  <vdc_crl
  925  00:E1DB  8D 02 00          sta   video_data_l
  926                             ; --
  927  00:E1DE  DF F5 03          bbs5 <irq_m,.l3
  928                             ; --
  929  00:E1E1  20 0B E2          jsr  _vsync_hndl
  930                             ; --
  931  00:E1E4  4F F5 03  .l3:    bbr4 <irq_m,.l4
  932  00:E1E7  20 08 E2          jsr  user_vsync         ; call user vsync routine
  933  00:E1EA            .l4:
  934                         ; ----
  935                         ; hsync interrupt
  936                         ;
  937  00:E1EA            .hsync:
  938  00:E1EA  2F F6 0C          bbr2 <vdc_sr,.exit
  939  00:E1ED  FF F5 03          bbs7 <irq_m,.l5
  940                             ; --
  941  00:E1F0  20 6D E2          jsr  _hsync_hndl
  942                             ; --
  943  00:E1F3  6F F5 03  .l5:    bbr6 <irq_m,.exit
  944  00:E1F6  20 05 E2          jsr  user_hsync         ; call user handler
  945                     
  946                         ; ----
  947                         ; exit interrupt
  948                         ;
  949  00:E1F9            .exit:
  950  00:E1F9  A5 F7             lda  <vdc_reg           ; restore VDC register index
  951  00:E1FB  8D 00 00          sta   video_reg
  952                             ; --
  953  00:E1FE  7A                ply
  954  00:E1FF  FA                plx
  955  00:E200  68                pla
  956  00:E201  40                rti
  957                     
  958                         ; ----
  959                         ; user routine hooks
  960                         ;
  961  00:E202            user_irq1:
  962  00:E202  6C 02 22          jmp   [irq1_jmp]
  963  00:E205            user_hsync:
  964  00:E205  6C 0A 22          jmp   [hsync_hook]
  965  00:E208            user_vsync:
  966  00:E208  6C 08 22          jmp   [vsync_hook]
  967                     
  968                            .endif   ; !(CDROM)
  969                     
  970                     
  971                     ; ----
  972                     ; _vsync_hndl
  973                     ; ----
  974                     ; Handle VSYNC interrupts
  975                     ; ----
  976  00:E20B            _vsync_hndl:
  977           0001             .if  !(CDROM)
  978  00:E20B  AE 8E 26          ldx   disp_cr           ; check display state (on/off)
  979  00:E20E  D0 09             bne  .l1
  980  00:E210  29 3F             and   #$3F              ; disable display
  981  00:E212  03 05             st0   #5                ; update display control (bg/sp)
  982  00:E214  8D 02 00          sta   video_data_l
  983  00:E217  80 03             bra  .l2
  984                             ; --    
  985                            .endif
  986  00:E219  20 BE E2  .l1:    jsr   rcr_init          ; init display list
  987                     
  988  00:E21C  03 07     .l2:    st0   #7                ; scrolling
  989  00:C21E                    stw   bg_x1,video_data
  990  00:E22A  03 08             st0   #8
  991  00:C22C                    stw   bg_y1,video_data
  992                     
  993                             ; --
  994  00:E238  AD 92 26          lda   clock_tt          ; keep track of time
  995  00:E23B  1A                inc   A
  996  00:E23C  C9 3C             cmp   #60
  997  00:E23E  D0 1C             bne   .lcltt
  998  00:E240  AD 91 26          lda   clock_ss
  999  00:E243  1A                inc   A
 1000  00:E244  C9 3C             cmp   #60
 1001  00:E246  D0 10             bne   .lclss
 1002  00:E248  AD 90 26          lda   clock_mm
 1003  00:E24B  1A                inc   A
 1004  00:E24C  C9 3C             cmp   #60
 1005  00:E24E  D0 04             bne   .lclmm
 1006  00:E250  EE 8F 26          inc   clock_hh
 1007  00:E253  62                cla
 1008  00:E254  8D 90 26  .lclmm: sta   clock_mm
 1009  00:E257  62                cla
 1010  00:E258  8D 91 26  .lclss: sta   clock_ss
 1011  00:E25B  62                cla
 1012  00:E25C  8D 92 26  .lcltt: sta   clock_tt
 1013                             ; --
 1014                     
 1015           0000             .if  (CDROM)
 1024                            .endif
 1025                     
 1026           0001             .ifdef SUPPORT_MOUSE
 1027  00:E25F  AD 84 29          lda   msflag            ; if mouse supported, and exists
 1028  00:E262  F0 05             beq  .l3                ; then read mouse instead of pad
 1029  00:E264  20 41 FC          jsr   mousread
 1030  00:E267  80 03             bra  .out
 1031                            .endif   ; SUPPORT_MOUSE
 1032                     
 1033  00:E269  20 3B FD  .l3:    jsr   read_joypad       ; else read joypad
 1034  00:E26C  60        .out:   rts
 1035                     
 1036                     
 1037                     ; ----
 1038                     ; _hsync_hndl
 1039                     ; ----
 1040                     ; Handle HSYNC interrupts
 1041                     ; ----
 1042                         ; ----
 1043                         ; hsync scrolling handler
 1044                         ;
 1045  00:E26D            _hsync_hndl:
 1046  00:E26D  AC FC 26          ldy   s_idx
 1047  00:E270  10 13             bpl  .r1
 1048                             ; --
 1049  00:E272  A5 F3             lda  <vdc_crl
 1050  00:E274  29 3F             and   #$3F
 1051  00:E276  85 F3             sta  <vdc_crl
 1052  00:E278  9C FC 26          stz   s_idx
 1053  00:E27B  AE 36 27          ldx   s_list
 1054  00:E27E  BD 25 27          lda   s_top,X
 1055  00:E281  20 26 E3          jsr   rcr5
 1056  00:E284  60                rts
 1057                             ; --
 1058  00:E285  BE 36 27  .r1:    ldx   s_list,Y
 1059  00:E288  A5 F3             lda  <vdc_crl
 1060  00:E28A  29 3F             and   #$3F
 1061  00:E28C  1D 1D 27          ora   s_cr,X
 1062  00:E28F  85 F3             sta  <vdc_crl
 1063                             ; --
 1064  00:E291  20 00 E3          jsr   rcr_set
 1065                             ; --
 1066  00:E294  BD 25 27          lda   s_top,X
 1067  00:E297  C9 FF             cmp   #$FF
 1068  00:E299  F0 22             beq  .out
 1069                             ; --
 1070  00:E29B  03 07             st0   #7
 1071  00:E29D  BD FD 26          lda   s_xl,X
 1072  00:E2A0  BC 05 27          ldy   s_xh,X
 1073  00:E2A3  8D 02 00          sta   video_data_l
 1074  00:E2A6  8C 03 00          sty   video_data_h
 1075  00:E2A9  03 08             st0   #8
 1076  00:E2AB  BD 0D 27          lda   s_yl,X
 1077  00:E2AE  BC 15 27          ldy   s_yh,X
 1078  00:C2B1                    sub   #1
 1079  00:E2B4  B0 01             bcs  .r2
 1080  00:E2B6  88                dey
 1081  00:E2B7  8D 02 00  .r2:    sta   video_data_l
 1082  00:E2BA  8C 03 00          sty   video_data_h
 1083  00:E2BD  60        .out:   rts
 1084                     
 1085                         ; ----
 1086                         ; init display list
 1087                         ;
 1088  00:E2BE            rcr_init:
 1089  00:C2BE                    maplibfunc   build_disp_list
 1090  00:E2CF  B0 01             bcs  .r3
 1091  00:E2D1  60                rts
 1092                             ; --
 1093  00:E2D2  F7 F3     .r3:    smb   #7,<vdc_crl
 1094  00:E2D4  A9 FF             lda   #$FF
 1095  00:E2D6  8D FC 26          sta   s_idx
 1096  00:E2D9  AE 36 27          ldx   s_list
 1097  00:E2DC  BC 25 27          ldy   s_top,X
 1098  00:E2DF  C0 FF             cpy   #$FF
 1099  00:E2E1  D0 43             bne   rcr5
 1100                             ; --
 1101  00:E2E3  BC FD 26          ldy   s_xl,X
 1102  00:E2E6  8C 0C 22          sty   bg_x1
 1103  00:E2E9  BC 05 27          ldy   s_xh,X
 1104  00:E2EC  8C 0D 22          sty   bg_x1+1
 1105  00:E2EF  BC 0D 27          ldy   s_yl,X
 1106  00:E2F2  8C 10 22          sty   bg_y1
 1107  00:E2F5  BC 15 27          ldy   s_yh,X
 1108  00:E2F8  8C 11 22          sty   bg_y1+1
 1109  00:E2FB  9C FC 26          stz   s_idx
 1110  00:E2FE  80 26             bra   rcr5
 1111                     
 1112                         ; ----
 1113                         ; program scanline interrupt
 1114                         ;
 1115  00:E300            rcr_set:
 1116  00:E300  C8                iny
 1117  00:E301  8C FC 26          sty   s_idx
 1118  00:E304  B9 36 27          lda   s_list,Y
 1119  00:E307  A8                tay
 1120  00:E308  B9 25 27          lda   s_top,Y
 1121  00:E30B  CD DA 26          cmp   scr_height
 1122  00:C30E                    bhs   rcr6
 1123  00:E310  DD 2E 27          cmp   s_bottom,X
 1124  00:C313                    blo   rcr5
 1125                             ; --
 1126  00:E315  BD 2E 27          lda   s_bottom,X
 1127  00:E318  3A        rcr4:   dec   A
 1128  00:E319  48                pha
 1129  00:E31A  A9 F0             lda   #$F0
 1130  00:E31C  9D 2E 27          sta   s_bottom,X
 1131  00:E31F  9E 1D 27          stz   s_cr,X
 1132  00:E322  CE FC 26          dec   s_idx
 1133  00:E325  68                pla
 1134                             ; --
 1135  00:E326  03 06     rcr5:   st0   #6                ; set scanline counter
 1136  00:C328                    add   #64
 1137  00:E32B  8D 02 00          sta   video_data_l
 1138  00:E32E  62                cla
 1139  00:E32F  69 00             adc   #0
 1140  00:E331  8D 03 00          sta   video_data_h
 1141  00:E334  80 0E             bra   __rcr_on
 1142                             ;--
 1143  00:E336  BD 2E 27  rcr6:   lda   s_bottom,X
 1144  00:E339  CD DA 26          cmp   scr_height
 1145  00:C33C                    blo   rcr4
 1146  00:E33E  80 14             bra   __rcr_off
 1147                     
 1148                     ; ----
 1149                     ; rcr_on
 1150                     ; ----
 1151                     ; enable scanline interrupt
 1152                     ; ----
 1153                     
 1154  00:E340              rcr_on:
 1155  00:E340             _rcr_on:
 1156  00:E340  A9 05             lda   #5
 1157  00:E342  85 F7             sta  <vdc_reg
 1158  00:E344            __rcr_on:
 1159  00:E344  03 05             st0   #5
 1160  00:E346  A5 F3             lda  <vdc_crl
 1161  00:E348  09 04             ora   #$04
 1162  00:E34A  85 F3             sta  <vdc_crl
 1163  00:E34C  8D 02 00          sta   video_data_l
 1164  00:E34F  60                rts
 1165                     
 1166                     ; ----
 1167                     ; rcr_off
 1168                     ; ----
 1169                     ; disable scanline interrupt
 1170                     ; ----
 1171                     
 1172  00:E350              rcr_off:
 1173  00:E350             _rcr_off:
 1174  00:E350  A9 05             lda   #5
 1175  00:E352  85 F7             sta  <vdc_reg
 1176  00:E354            __rcr_off:
 1177  00:E354  03 05             st0   #5
 1178  00:E356  A5 F3             lda  <vdc_crl
 1179  00:E358  29 FB             and   #$FB
 1180  00:E35A  85 F3             sta  <vdc_crl
 1181  00:E35C  8D 02 00          sta   video_data_l
 1182  00:E35F  60                rts
 1183                     
 1184                     
 1185                     
 1186                     ; ----
 1187                     ; timer
 1188                     ; ----
 1189                     ; timer interrupt handler
 1190                     ; ----
 1191                     
 1192           0001             .if  !(CDROM)
 1193  00:E360            _timer_user:
 1194  00:E360  6C 04 22          jmp   [timer_jmp]
 1195  00:E363            _timer:
 1196  00:E363  AF F5 FA          bbs2 <irq_m,_timer_user
 1197  00:E366  48                pha
 1198  00:E367  DA                phx
 1199  00:E368  5A                phy
 1200                     
 1201  00:E369  8D 03 14          sta   irq_status        ; acknowledge interrupt
 1202                     
 1203  00:E36C  A5 E6             lda   <psg_irqflag      ; is IRQ being serviced ?
 1204  00:E36E  D0 0B             bne   .exit
 1205                     
 1206  00:E370  E6 E6             inc   <psg_irqflag      ; IRQ being serviced
 1207  00:E372  58                cli                     ; but allow other interrupts to be processed
 1208                     
 1209  00:E373  A5 E7             lda   <psg_inhibit      ; if sound off, don't bother
 1210  00:E375  D0 02             bne   .exit2
 1211                     
 1212  00:E377  44 06             bsr   psg_driver        ; do all sound-related stuff
 1213                     
 1214  00:E379  64 E6     .exit2: stz   <psg_irqflag      ; allow IRQ processing again
 1215  00:E37B  7A        .exit:  ply
 1216  00:E37C  FA                plx
 1217  00:E37D  68                pla
 1218  00:E37E  40                rti
 1219                     
 1220  00:E37F            psg_driver:
 1221  00:E37F  43 40             tma   #page(psg_drive)  ; map out the code segment
 1222  00:E381  48                pha
 1223  00:E382  A9 02             lda   #bank(psg_drive)
 1224  00:E384  53 40             tam   #page(psg_drive)
 1225                     
 1226  00:E386  43 10             tma   #4                ; save data banks
 1227  00:E388  48                pha
 1228  00:E389  43 08             tma   #3
 1229  00:E38B  48                pha
 1230                     
 1231  00:E38C  AD E1 22          lda   psg_bank1         ; map PSG data banks
 1232  00:E38F  53 08             tam   #3
 1233  00:E391  AD E2 22          lda   psg_bank2
 1234  00:E394  53 10             tam   #4
 1235                     
 1236  00:E396  20 0B C2          jsr   psg_drive
 1237                     
 1238  00:E399  AD D0 22          lda   psg_tempo
 1239  00:E39C  30 08             bmi   .noreset
 1240                     
 1241  00:E39E  8D 00 0C          sta   timer_cnt
 1242  00:E3A1  09 80             ora   #$80
 1243  00:E3A3  8D D0 22          sta   psg_tempo
 1244                     
 1245  00:E3A6            .noreset:
 1246  00:E3A6  68                pla                     ; restore data banks
 1247  00:E3A7  53 08             tam   #3
 1248  00:E3A9  68                pla
 1249  00:E3AA  53 10             tam   #4
 1250                     
 1251  00:E3AC  68                pla
 1252  00:E3AD  53 40             tam   #page(psg_drive)  ; restore code bank
 1253  00:E3AF  60                rts
 1254                     
 1255                            .endif   ; !(CDROM)
 1256                     
 1257                     ; ----
 1258                     ; nmi
 1259                     ; ----
 1260                     ; NMI interrupt handler
 1261                     ; ----
 1262                     
 1263           0001             .if  !(CDROM)
 1264  00:E3B0            _nmi:
 1265  00:E3B0  BF F5 01          bbs3 <irq_m,.user
 1266  00:E3B3  40                rti
 1267  00:E3B4            .user:
 1268  00:E3B4  6C 06 22          jmp   [nmi_jmp]
 1269                     
 1270                            .endif   ; !(CDROM)
 1271                     
 1272                     
 1273                     ;[ DATA ]
 1274                     
 1275                     ; ----
 1276                     ; font
 1277                     ; ----
 1278                     
 1279           0001              .ifdef HUC
 1280  00:E3B7            font_table:
 1281  00:E3B7  00 60              .dw font_1
 1282  00:E3B9  00 63              .dw font_2
 1283  00:E3BB  00 60              .dw font_1
 1284  00:E3BD  00 60              .dw font_1
 1285                     
 1286                             .endif  ; HUC
 1287                     
 1288                     
 1289                     ;[ LIBRARY ]
 1290                     
 1291                     ; ----
 1292                     ; standard library
 1293                     ; ----
 1294                     
#[5]   library.asm
 1295                             .include "library.asm"
    1                     ;
    2                     ; LIBRARY.ASM  -  MagicKit Standard Library
    3                     ;
    4                     ;
    5                     
    6                     ; IMPORTANT NOTE:
    7                     ; ----
    8                     ; almost all the library functions have been changed to automaticaly
    9                     ; handle bank mapping (you don't have to map data yourself anymore),
   10                     ; the change will be transparent to you if you were using only library
   11                     ; macros to call functions, but you will have to update your code
   12                     ; in case you were directly calling those functions!
   13                     
   14                     
   15                     ; ----
   16                     ; map_data
   17                     ; ----
   18                     ; map data in page 3-4 ($6000-$9FFF)
   19                     ; ----
   20                     ; IN :  _BL = data bank
   21                     ;       _SI = data address
   22                     ; ----
   23                     ; OUT:  _BX = old banks
   24                     ;       _SI = remapped data address
   25                     ; ----
   26                     
   27  00:E3BF            map_data:
   28  00:E3BF  A6 FA             ldx   <_bl
   29                     
   30                         ; ----
   31                         ; save current bank mapping
   32                         ;
   33  00:E3C1  43 08             tma   #3
   34  00:E3C3  85 FA             sta   <_bl
   35  00:E3C5  43 10             tma   #4
   36  00:E3C7  85 FB             sta   <_bh
   37                             ; --
   38  00:E3C9  E0 FE             cpx   #$FE
   39  00:E3CB  D0 03             bne   .l1
   40                             ; --
   41  00:E3CD  86 EC             stx   <_bp
   42  00:E3CF  60                rts
   43                     
   44                         ; ----
   45                         ; map new bank
   46                         ;
   47  00:E3D0  64 EC     .l1:    stz   <_bp
   48                             ; --
   49  00:E3D2  8A                txa
   50  00:E3D3  53 08             tam   #3
   51  00:E3D5  1A                inc   A
   52  00:E3D6  53 10             tam   #4
   53                     
   54                         ; ----
   55                         ; remap data address to page 3
   56                         ;
   57  00:E3D8  A5 EF             lda   <_si+1
   58  00:E3DA  29 1F             and   #$1F
   59  00:E3DC  09 60             ora   #$60
   60  00:E3DE  85 EF             sta   <_si+1
   61  00:E3E0  60                rts
   62                     
   63                     
   64                     ; ----
   65                     ; unmap_data
   66                     ; ----
   67                     ; IN :  _BX = old banks
   68                     ; ----
   69                     
   70  00:E3E1            unmap_data:
   71                     
   72  00:E3E1  A5 FA             lda     <_bl
   73  00:E3E3  53 08             tam     #3
   74  00:E3E5  A5 FB             lda     <_bh
   75  00:E3E7  53 10             tam     #4
   76  00:E3E9  60                rts
   77                     
   78                     ; ----
   79                     ; remap_data
   80                     ; ----
   81                     
   82  00:E3EA            remap_data:
   83  00:E3EA  A5 EC             lda   <_bp
   84  00:E3EC  D0 10             bne   .l1
   85  00:E3EE  A5 EF             lda   <_si+1
   86  00:E3F0  10 0C             bpl   .l1
   87  00:C3F2                    sub   #$20
   88  00:E3F5  85 EF             sta   <_si+1
   89  00:E3F7  43 10             tma   #4
   90  00:E3F9  53 08             tam   #3
   91  00:E3FB  1A                inc   A
   92  00:E3FC  53 10             tam   #4
   93  00:E3FE            .l1:
   94  00:E3FE  60                rts
   95                     
   96                     
   97                     ; ----
   98                     ; load_palette
   99                     ; ----
  100                     ; initialize one or more sub-palette
  101                     ; ----
  102                     ; IN :  _AL = index of the first sub-palette (0-31)
  103                     ;       _BL = data bank
  104                     ;       _SI = address of data
  105                     ;       _CL = number of sub-palette to copy
  106                     ; ----
  107                     
  108           0001              .ifdef HUC
  109  00:E3FF            _load_palette.3:
  110                             .endif
  111  00:E3FF             load_palette:
  112  00:C3FF                    maplibfunc      lib2_load_palette
  113  00:E410  60                rts
  114                     
  115           0001              .bank   LIB2_BANK
  116  01:A600            lib2_load_palette:
  117                     
  118                         ; ----
  119                         ; map data
  120                         ;
  121  01:A600  20 BF E3          jsr   map_data
  122                     
  123                         ; ----
  124                         ; multiply the sub-palette index by 16
  125                         ; and set the VCE color index register
  126                         ;
  127  01:A603  A5 F8             lda   <_al
  128  01:A605  64 F9             stz   <_ah
  129  01:A607  0A                asl   A
  130  01:A608  0A                asl   A
  131  01:A609  0A                asl   A
  132  01:A60A  0A                asl   A
  133  01:A60B  26 F9             rol   <_ah
  134  01:A60D  8D 02 04          sta   color_reg_l
  135  01:A610  A5 F9             lda   <_ah
  136  01:A612  8D 03 04          sta   color_reg_h
  137                     
  138                         ; ----
  139                         ; load new colors
  140                         ;
  141                     
  142                     ; Use TIA, but BLiT 16 words at a time (32 bytes)
  143                     ; Because interrupt must not be deferred too much
  144                     ;
  145  01:4615                    stw   #32, _ram_hdwr_tia_size
  146  01:461F                    stw   #color_data, _ram_hdwr_tia_dest
  147                     
  148  01:A629            .loop_a:
  149  01:4629                    stw   <_si, _ram_hdwr_tia_src
  150  01:A633  20 CC 26          jsr   _ram_hdwr_tia
  151  01:4636                    addw  #32, <_si
  152  01:A643  C6 FC             dec   <_cl
  153  01:A645  D0 E2             bne   .loop_a
  154                     
  155                         ; ----
  156                         ; unmap data
  157                         ;
  158  01:A647  4C E1 E3          jmp   unmap_data
  159                     
  160           0000              .bank   LIB1_BANK
  161                     
  162                     
  163                     ; ----
  164                     ; load_bat
  165                     ; ----
  166                     ; transfer a BAT in VRAM
  167                     ; ----
  168                     ; IN :  _DI = VRAM base address
  169                     ;       _BL = BAT bank
  170                     ;       _SI = BAT memory location
  171                     ;       _CL = nb of column to copy
  172                     ;       _CH = nb of row
  173                     ; ----
  174                     
  175           0001              .ifdef HUC
  176  00:E411            _load_bat.4:
  177                             .endif
  178  00:E411             load_bat:
  179  00:C411                    maplibfunc      lib2_load_bat
  180  00:E422  60                rts
  181                     
  182           0001              .bank   LIB2_BANK
  183                     
  184  01:A64A            lib2_load_bat:
  185                     
  186                         ; ----
  187                         ; map data
  188                         ;
  189  01:A64A  20 BF E3          jsr   map_data
  190                     
  191                         ; ----
  192                         ; copy BAT
  193                         ;
  194  01:A64D  C2                cly
  195                             ; --
  196  01:A64E  20 A5 E4  .l1:    jsr   set_write
  197  01:A651  A6 FC             ldx   <_cl
  198                             ; --
  199  01:A653  B1 EE     .l2:    lda   [_si],Y
  200  01:A655  8D 02 00          sta   video_data_l
  201  01:A658  C8                iny
  202  01:A659  B1 EE             lda   [_si],Y
  203  01:A65B  8D 03 00          sta   video_data_h
  204  01:A65E  C8                iny
  205  01:A65F  D0 02             bne   .l3
  206  01:A661  E6 EF             inc   <_si+1
  207  01:A663  CA        .l3:    dex
  208  01:A664  D0 ED             bne   .l2
  209                             ; --
  210  01:A666  20 EA E3          jsr   remap_data
  211                             ; --
  212  01:4669                    addw  bat_width,<_di
  213  01:A678  C6 FD             dec   <_ch
  214  01:A67A  D0 D2             bne   .l1
  215                     
  216                         ; ----
  217                         ; unmap data
  218                         ;
  219  01:A67C  4C E1 E3          jmp   unmap_data
  220                     
  221           0000              .bank   LIB1_BANK
  222                     
  223                     ; ----
  224                     ; load_map_8/16
  225                     ; ----
  226                     ; transfer a tiled map in VRAM
  227                     ; ----
  228                     ; IN :  _AL = x screen coordinate (tile unit)
  229                     ;       _AH = y screen coordinate
  230                     ;       _CL = x start coordinate in the map
  231                     ;       _CH = y start coordinate
  232                     ;       _DL = nb of column to copy
  233                     ;       _DH = nb of row
  234                     ; ----
  235                     
  236           26B1                      .bss
  237  --:26B1            mapbank         .ds 1
  238  --:26B2            mapaddr         .ds 2
  239  --:26B4            mapwidth        .ds 2
  240  --:26B6            mapheight       .ds 2
  241  --:26B8            maptiletype     .ds 1
  242  --:26B9            maptilebank     .ds 1
  243  --:26BA            maptileaddr     .ds 2
  244  --:26BC            maptilebase     .ds 2
  245  --:26BE            mapnbtile       .ds 2
  246  --:26C0            mapctablebank   .ds 1
  247  --:26C1            mapctable       .ds 2
  248  --:26C3            mapwrap         .ds 1
  249  --:26C4            mapbat_ptr      .ds 2
  250  --:26C6            mapbat_top_base .ds 2
  251  --:26C8            mapbat_top      .ds 1
  252  --:26C9            mapbat_bottom   .ds 1
  253  --:26CA            mapbat_x        .ds 2
  254           E423                      .code
  255  00:E423            load_map:
  256  00:E423  AD B8 26          lda   maptiletype
  257  00:E426  C9 08             cmp   #8
  258  00:E428  F0 12             beq   .l1
  259                             ; --
  260  00:C42A                    maplibfunc      lib2_load_map_16
  261  00:E43B  60                rts
  262  00:C43C            .l1:    maplibfunc      lib2_load_map_8
  263  00:E44D  60                rts
  264                     
  265           0001              .bank   LIB2_BANK
  266                     
  267  01:A67F            lib2_load_map_16:
  268                     
  269                         ; ----
  270                         ; save bank mapping
  271                         ;
  272  01:A67F  43 04             tma   #2
  273  01:A681  48                pha
  274  01:A682  43 08             tma   #3
  275  01:A684  48                pha
  276  01:A685  43 10             tma   #4
  277  01:A687  48                pha
  278                     
  279                         ; ----
  280                         ; init
  281                         ;
  282  01:A688  20 13 A8          jsr   load_map_init
  283  01:A68B  A5 FD             lda   <_ch
  284  01:A68D  8D CB 26          sta   mapbat_x+1
  285                     
  286                         ; ----
  287                         ; vertical loop
  288                         ;
  289  01:A690  A4 F9     .l1:    ldy   <_ah
  290  01:A692  A5 FE             lda   <_dl
  291  01:A694  85 F8             sta   <_al
  292  01:A696  AD CB 26          lda   mapbat_x+1
  293  01:A699  8D CA 26          sta   mapbat_x
  294  01:A69C  80 43             bra   .l5
  295                     
  296                         ; ----
  297                         ; horizontal loop
  298                         ;
  299  01:A69E  AD CA 26  .l2:    lda   mapbat_x          ; bat wrapping
  300  01:46A1                    add   #2
  301  01:A6A4  2D D7 26          and   bat_hmask
  302  01:A6A7  8D CA 26          sta   mapbat_x
  303  01:A6AA  D0 0B             bne   .l3
  304                             ; --
  305  01:A6AC  AD D7 26          lda   bat_hmask
  306  01:A6AF  49 FF             eor   #$ff
  307  01:A6B1  25 F0             and   <_di
  308  01:A6B3  85 F0             sta   <_di
  309  01:A6B5  80 0C             bra   .l4
  310  01:A6B7            .l3:
  311  01:46B7                    incw  <_di
  312  01:46BD                    incw  <_di
  313  01:A6C3            .l4:
  314  01:A6C3  C8                iny
  315                             ; --
  316  01:A6C4  CC B4 26          cpy   mapwidth          ; horizontal map wrapping
  317  01:A6C7  D0 18             bne   .l5
  318  01:A6C9  C2                cly
  319  01:A6CA  AE C3 26          ldx   mapwrap
  320  01:A6CD  D0 12             bne   .l5
  321  01:A6CF  AC B4 26          ldy   mapwidth
  322  01:A6D2  AD BC 26          lda   maptilebase
  323  01:A6D5  85 FC             sta   <_cl
  324  01:A6D7  AD BD 26          lda   maptilebase+1
  325  01:A6DA  12 EC             ora   [_bp]
  326  01:A6DC  85 FD             sta   <_ch
  327  01:A6DE  88                dey
  328  01:A6DF  80 1C             bra   .l6
  329  01:A6E1            .l5:
  330  01:A6E1  B1 EE             lda   [_si],Y           ; get tile index
  331  01:A6E3  AA                tax                     ; calculate BAT value (tile + palette)
  332  01:A6E4  02                sxy
  333  01:A6E5  64 FD             stz   <_ch
  334  01:A6E7  0A                asl   A
  335  01:A6E8  26 FD             rol   <_ch
  336  01:A6EA  0A                asl   A
  337  01:A6EB  26 FD             rol   <_ch
  338  01:46ED                    add   maptilebase
  339  01:A6F1  85 FC             sta   <_cl
  340  01:A6F3  A5 FD             lda   <_ch
  341  01:A6F5  6D BD 26          adc   maptilebase+1
  342  01:A6F8  71 EC             adc   [_bp],Y
  343  01:A6FA  85 FD             sta   <_ch
  344  01:A6FC  02                sxy
  345  01:A6FD            .l6:
  346  01:46FD                    vreg  #0                ; copy tile
  347  01:4703                    stw   <_di,video_data
  348  01:470D                    vreg  #2
  349  01:4713                    stw   <_cx,video_data
  350  01:471D                    incw  <_cx
  351  01:4723                    stw   <_cx,video_data
  352  01:472D                    incw  <_cx
  353  01:4733                    vreg  #0
  354  01:4739                    addw  bat_width,<_di,video_data
  355  01:474A                    vreg  #2
  356  01:4750                    stw   <_cx,video_data
  357  01:475A                    incw  <_cx
  358  01:4760                    stw   <_cx,video_data
  359                     
  360  01:A76A  C6 F8             dec   <_al              ; next tile
  361  01:476C                    lbne  .l2
  362                     
  363                         ; ----
  364                         ; next line
  365                         ;
  366  01:A771  A2 02             ldx   #2
  367  01:A773  20 A0 A8          jsr   load_map_next_line
  368  01:A776  C6 FF             dec   <_dh
  369  01:4778                    lbne  .l1
  370                     
  371                         ; ----
  372                         ; restore bank mapping
  373                         ;
  374  01:A77D  4C 09 A8          jmp   load_map_exit
  375                     
  376  01:A780            lib2_load_map_8:
  377                     
  378                         ; ----
  379                         ; save bank mapping
  380                         ;
  381  01:A780  43 04             tma   #2
  382  01:A782  48                pha
  383  01:A783  43 08             tma   #3
  384  01:A785  48                pha
  385  01:A786  43 10             tma   #4
  386  01:A788  48                pha
  387                     
  388                         ; ----
  389                         ; init
  390                         ;
  391  01:A789  20 13 A8          jsr   load_map_init
  392  01:A78C  80 05             bra   .l2
  393                     
  394                         ; ----
  395                         ; vertical loop
  396                         ;
  397  01:A78E  A2 01     .l1:    ldx   #1
  398  01:A790  20 A0 A8          jsr   load_map_next_line
  399                             ; --
  400  01:A793  A4 F9     .l2:    ldy   <_ah
  401  01:A795  A5 FE             lda   <_dl
  402  01:A797  85 F8             sta   <_al
  403  01:A799  A5 FD             lda   <_ch
  404  01:A79B  85 FC             sta   <_cl
  405  01:479D                    vreg  #0                ; set vram write ptr
  406  01:47A3                    stw   <_di,video_data
  407  01:47AD                    vreg  #2
  408  01:A7B3  80 38             bra   .l5
  409                     
  410                         ; ----
  411                         ; horizontal loop
  412                         ;
  413  01:A7B5  A5 FC     .l3:    lda   <_cl              ; bat wrapping
  414  01:A7B7  1A                inc   A
  415  01:A7B8  2D D7 26          and   bat_hmask
  416  01:A7BB  85 FC             sta   <_cl
  417  01:A7BD  D0 1B             bne   .l4
  418                             ; --
  419  01:47BF                    vreg  #0
  420  01:A7C5  AD D7 26          lda   bat_hmask
  421  01:A7C8  49 FF             eor   #$ff
  422  01:A7CA  25 F0             and   <_di
  423  01:A7CC  8D 02 00          sta   video_data_l
  424  01:A7CF  A5 F1             lda   <_di+1
  425  01:A7D1  8D 03 00          sta   video_data_h
  426  01:47D4                    vreg  #2
  427  01:A7DA            .l4:
  428  01:A7DA  C8                iny                     ; next tile
  429                             ; --
  430  01:A7DB  CC B4 26          cpy   mapwidth          ; map wrapping
  431  01:A7DE  D0 0D             bne   .l5
  432                             ; --
  433  01:A7E0  C2                cly
  434  01:A7E1  AD C3 26          lda   mapwrap
  435  01:A7E4  D0 07             bne   .l5
  436  01:A7E6  AC B4 26          ldy   mapwidth
  437  01:A7E9  88                dey
  438  01:A7EA  62                cla
  439  01:A7EB  80 02             bra   .l6
  440  01:A7ED            .l5:
  441  01:A7ED  B1 EE             lda   [_si],Y           ; get tile index
  442  01:A7EF  AA        .l6:    tax                     ; calculate BAT value (tile + palette)
  443  01:A7F0  02                sxy
  444  01:47F1                    add   maptilebase
  445  01:A7F5  8D 02 00          sta   video_data_l
  446  01:A7F8  AD BD 26          lda   maptilebase+1
  447  01:A7FB  71 EC             adc   [_bp],Y
  448  01:A7FD  8D 03 00          sta   video_data_h
  449  01:A800  02                sxy
  450                     
  451  01:A801  C6 F8             dec   <_al
  452  01:A803  D0 B0             bne   .l3
  453                     
  454                         ; ----
  455                         ; next line
  456                         ;
  457  01:A805  C6 FF             dec   <_dh
  458  01:A807  D0 85             bne   .l1
  459                     
  460                         ; ----
  461                         ; restore bank mapping
  462                         ;
  463  01:A809            load_map_exit:
  464  01:A809  68                pla
  465  01:A80A  53 10             tam   #4
  466  01:A80C  68                pla
  467  01:A80D  53 08             tam   #3
  468  01:A80F  68                pla
  469  01:A810  53 04             tam   #2
  470  01:A812  60                rts
  471                     
  472                     
  473                     ; ----
  474                     ; load_map_init
  475                     ; ----
  476                     ; load_map sub routine
  477                     ; ----
  478                     ; OUT:  _DI = BAT address
  479                     ;       _SI = map address
  480                     ;       _BP = palette index table ptr
  481                     ;       _AH = map X pos
  482                     ;       _BH = map Y pos
  483                     ;       _CH = BAT X pos
  484                     ;       _BL = BAT Y pos
  485                     ; ----
  486                     
  487  01:A813            load_map_init:
  488                     
  489                         ; ----
  490                         ; calculate vram address
  491                         ;
  492  01:A813  A6 F8             ldx   <_al
  493  01:A815  A5 F9             lda   <_ah
  494  01:A817  AC B8 26          ldy   maptiletype
  495  01:A81A  C0 08             cpy   #8
  496  01:A81C  F0 04             beq   .l1
  497  01:A81E  0A                asl   A
  498  01:A81F  22                sax
  499  01:A820  0A                asl   A
  500  01:A821  22                sax
  501  01:A822  DA        .l1:    phx
  502  01:A823  48                pha
  503  01:A824  20 C2 E4          jsr   calc_vram_addr
  504  01:4827                    stw   <_di,mapbat_ptr
  505                     
  506                         ; ----
  507                         ; calculate map address
  508                         ;
  509  01:4831                    stb   mapaddr,<_si
  510  01:A836  AD B3 26          lda   mapaddr+1
  511  01:A839  29 1F             and   #$1F
  512  01:A83B  85 EF             sta   <_si+1
  513                             ; --
  514  01:A83D  A6 FC             ldx   <_cl
  515  01:A83F  86 F9             stx   <_ah
  516  01:A841  A4 FD             ldy   <_ch
  517  01:A843  84 FB             sty   <_bh
  518                             ; --
  519  01:A845  AD B5 26          lda   mapwidth+1
  520  01:A848  F0 08             beq   .l2
  521  01:A84A  98                tya
  522  01:484B                    add   <_si+1
  523  01:A84E  85 EF             sta   <_si+1
  524  01:A850  80 17             bra   .l3
  525                             ; --
  526  01:A852  84 F8     .l2:    sty   <_al
  527  01:A854  AD B4 26          lda   mapwidth
  528  01:A857  85 FA             sta   <_bl
  529  01:A859  20 77 E7          jsr   mulu8
  530  01:485C                    addw  <_cx,<_si
  531                     
  532                         ; ----
  533                         ; calculate map bank
  534                         ;
  535  01:A869  2A        .l3:    rol   A
  536  01:A86A  2A                rol   A
  537  01:A86B  2A                rol   A
  538  01:A86C  2A                rol   A
  539  01:A86D  29 0F             and   #$0F
  540  01:486F                    add   mapbank
  541                     
  542                         ; ----
  543                         ; map data
  544                         ;
  545  01:A873  53 08             tam   #3
  546  01:A875  1A                inc   A
  547  01:A876  53 10             tam   #4
  548  01:A878  AD C0 26          lda   mapctablebank
  549  01:A87B  53 04             tam   #2
  550                     
  551                         ; ----
  552                         ; adjust data addresses
  553                         ;
  554  01:A87D  A5 EF             lda   <_si+1            ; tile ptr
  555  01:A87F  29 1F             and   #$1F
  556  01:A881  09 60             ora   #$60
  557  01:A883  85 EF             sta   <_si+1
  558                             ; --
  559  01:4885                    stb   mapctable,<_bp    ; color table ptr
  560  01:A88A  AD C2 26          lda   mapctable+1
  561  01:A88D  29 1F             and   #$1F
  562  01:A88F  09 40             ora   #$40
  563  01:A891  85 ED             sta   <_bp+1
  564                     
  565                         ; ----
  566                         ; bat pos
  567                         ;
  568  01:A893  68                pla
  569  01:A894  2D D8 26          and   bat_vmask
  570  01:A897  85 FA             sta   <_bl
  571  01:A899  68                pla
  572  01:A89A  2D D7 26          and   bat_hmask
  573  01:A89D  85 FD             sta   <_ch
  574  01:A89F  60                rts
  575                     
  576                     
  577                     ; ----
  578                     ; load_map_next_line
  579                     ; ----
  580                     ; load_map sub routine
  581                     ; ----
  582                     ; IN :    X = BAT line inc value (1-2)
  583                     ; ----
  584                     ; OUT:  _DI = BAT address
  585                     ;       _SI = map address
  586                     ; ----
  587                     ; USE:  _BL = BAT Y pos
  588                     ;       _BH = map Y pos
  589                     ;       _SI = map address
  590                     ; ----
  591                     
  592  01:A8A0            load_map_next_line:
  593                     
  594                         ; ----
  595                         ; incremente vram address
  596                         ;
  597  01:A8A0  8A                txa
  598  01:48A1                    add   <_bl
  599  01:A8A4  CD C9 26          cmp   mapbat_bottom
  600  01:48A7                    blo   .l1
  601                             ; --
  602  01:48A9                    sub   mapbat_bottom     ; 1/ vram wrapping
  603  01:A8AD  AA                tax
  604  01:A8AE  E8                inx
  605  01:48AF                    add   mapbat_top
  606  01:A8B3  85 FA             sta   <_bl
  607  01:A8B5  AD C4 26          lda   mapbat_ptr
  608  01:A8B8  2D D7 26          and   bat_hmask
  609  01:48BB                    add   mapbat_top_base
  610  01:A8BF  8D C4 26          sta   mapbat_ptr
  611  01:A8C2  62                cla
  612  01:A8C3  6D C7 26          adc   mapbat_top_base+1
  613  01:A8C6  8D C5 26          sta   mapbat_ptr+1
  614  01:A8C9  80 13             bra   .l3
  615                             ; -- 
  616  01:A8CB  85 FA     .l1:    sta   <_bl              ; 2/ vram inc
  617  01:A8CD  AD D4 26  .l2:    lda   bat_width
  618  01:48D0                    add   mapbat_ptr
  619  01:A8D4  8D C4 26          sta   mapbat_ptr
  620  01:A8D7  62                cla
  621  01:A8D8  6D C5 26          adc   mapbat_ptr+1
  622  01:A8DB  8D C5 26          sta   mapbat_ptr+1
  623                             ; --
  624  01:A8DE  CA        .l3:    dex
  625  01:A8DF  D0 EC             bne   .l2
  626                             ; --
  627  01:48E1                    stw   mapbat_ptr,<_di
  628                     
  629                         ; ----
  630                         ; incremente map address
  631                         ;
  632  01:A8EB  E6 FB             inc   <_bh
  633  01:A8ED  A5 FB             lda   <_bh
  634  01:A8EF  CD B6 26          cmp   mapheight
  635  01:A8F2  D0 1A             bne   .l4
  636                             ; --
  637  01:A8F4  AD B1 26          lda   mapbank           ; 1/ map wrapping
  638  01:A8F7  53 08             tam   #3
  639  01:A8F9  1A                inc   A
  640  01:A8FA  53 10             tam   #4
  641  01:48FC                    stb   mapaddr,<_si
  642  01:A901  AD B3 26          lda   mapaddr+1
  643  01:A904  29 1F             and   #$1F
  644  01:A906  09 60             ora   #$60
  645  01:A908  85 EF             sta   <_si+1
  646  01:A90A  64 FB             stz   <_bh
  647  01:A90C  80 1F             bra   .l5
  648                             ; --
  649  01:490E            .l4:    addw  mapwidth,<_si     ; 2/ map inc
  650  01:A91D  C9 80             cmp   #$80
  651  01:491F                    blo   .l5
  652  01:4921                    sub   #$20
  653  01:A924  85 EF             sta   <_si+1
  654  01:A926  43 10             tma   #4
  655  01:A928  53 08             tam   #3
  656  01:A92A  1A                inc   A
  657  01:A92B  53 10             tam   #4
  658  01:A92D            .l5:
  659  01:A92D  60                rts
  660                     
  661                     
  662           0000              .bank   LIB1_BANK
  663                     
  664                     ; ----
  665                     ; load_font
  666                     ; ----
  667                     ; transfer a 8x8 monochrome font into VRAM, slow but can be useful
  668                     ; ----
  669                     ; IN :  _DI = VRAM base address
  670                     ;       _BL = font bank
  671                     ;       _SI = font memory location
  672                     ;       _AL = font color (0-15)
  673                     ;       _AH = bg color (0-15)
  674                     ;       _CL = number of characters to copy
  675                     ; ----
  676                     
  677  00:E44E            load_font:
  678  00:C44E                    maplibfunc      lib2_load_font
  679  00:E45F  60                rts
  680                     
  681           0001              .bank   LIB2_BANK
  682                     
  683                         ; ----
  684                         ; map data
  685                         ;
  686  01:A92E            lib2_load_font:
  687  01:A92E  20 BF E3          jsr   map_data
  688  01:A931  20 A5 E4          jsr   set_write
  689                     
  690                         ; ----
  691                         ; init bg color
  692                         ;
  693  01:A934  A5 FC             lda   <_cl
  694  01:A936  48                pha
  695                             ; --
  696  01:A937  A2 03             ldx   #3
  697  01:A939  62        .l1:    cla
  698  01:A93A  46 F9             lsr   <_ah
  699  01:A93C  90 02             bcc   .l2
  700  01:A93E  A9 FF             lda   #$FF
  701  01:A940  95 FC     .l2:    sta   <_cl,X
  702  01:A942  CA                dex
  703  01:A943  10 F4             bpl   .l1
  704                     
  705                         ; ----
  706                         ; character loop
  707                         ;
  708  01:A945  FA                plx
  709  01:A946            .copy:
  710                     
  711                         ; ----
  712                         ; plane 1
  713                         ;
  714  01:A946  C2                cly
  715  01:A947  8F F8 08  .p1:    bbs0  <_al,.p2
  716  01:A94A  B1 EE             lda   [_si],Y
  717  01:A94C  49 FF             eor   #$FF
  718  01:A94E  25 FF             and   <_dh
  719  01:A950  80 04             bra   .p3
  720                             ; --
  721  01:A952  A5 FF     .p2:    lda   <_dh
  722  01:A954  11 EE             ora   [_si],Y
  723  01:A956  8D 02 00  .p3:    sta   video_data_l
  724                     
  725                         ; ----
  726                         ; plane 2
  727                         ;
  728  01:A959  9F F8 08          bbs1  <_al,.p4
  729  01:A95C  B1 EE             lda   [_si],Y
  730  01:A95E  49 FF             eor   #$FF
  731  01:A960  25 FE             and   <_dl
  732  01:A962  80 04             bra   .p5
  733                             ; --
  734  01:A964  A5 FE     .p4:    lda   <_dl
  735  01:A966  11 EE             ora   [_si],Y
  736  01:A968  8D 03 00  .p5:    sta   video_data_h
  737                             ; --
  738  01:A96B  C8                iny
  739  01:A96C  C0 08             cpy   #8
  740  01:A96E  D0 D7             bne   .p1
  741                     
  742                         ; ----
  743                         ; plane 3
  744                         ;
  745  01:A970  C2                cly
  746  01:A971  AF F8 08  .t1:    bbs2  <_al,.t2
  747  01:A974  B1 EE             lda   [_si],Y
  748  01:A976  49 FF             eor   #$FF
  749  01:A978  25 FD             and   <_ch
  750  01:A97A  80 04             bra   .t3
  751                             ; --
  752  01:A97C  A5 FD     .t2:    lda   <_ch
  753  01:A97E  11 EE             ora   [_si],Y
  754  01:A980  8D 02 00  .t3:    sta   video_data_l
  755                     
  756                         ; ----
  757                         ; plane 4
  758                         ;
  759  01:A983  BF F8 08          bbs3  <_al,.t4
  760  01:A986  B1 EE             lda   [_si],Y
  761  01:A988  49 FF             eor   #$FF
  762  01:A98A  25 FC             and   <_cl
  763  01:A98C  80 04             bra   .t5
  764                             ; --
  765  01:A98E  A5 FC     .t4:    lda   <_cl
  766  01:A990  11 EE             ora   [_si],Y
  767  01:A992  8D 03 00  .t5:    sta   video_data_h
  768                             ; --
  769  01:A995  C8                iny
  770  01:A996  C0 08             cpy   #8
  771  01:A998  D0 D7             bne   .t1
  772                     
  773                         ; ----
  774                         ; next character
  775                         ;
  776  01:499A                    addw  #8,<_si
  777                             ; --
  778  01:A9A7  CA                dex
  779  01:A9A8  D0 9C             bne   .copy
  780                     
  781                         ; ----
  782                         ; unmap data
  783                         ;
  784  01:A9AA  4C E1 E3          jmp   unmap_data
  785                     
  786                         ; ----
  787                         ; restore bank mapping
  788                         ;
  789           0000              .bank   LIB1_BANK
  790                     
  791                     
  792                     ; ----
  793                     ; load_vram
  794                     ; ----
  795                     ; copy a block of memory to VRAM
  796                     ; ----
  797                     ; IN :  _DI = VRAM location
  798                     ;       _BL = data bank
  799                     ;       _SI = data memory location
  800                     ;       _CX = number of words to copy
  801                     ; ----
  802           26CC              .bss
  803                     
  804                     ; This actually places a 'TIA' command
  805                     ; into RAM, from which to execute
  806                     ; for BLiT to VRAM for SATB transfer
  807                     ; and other VRAM load functions
  808                     
  809  --:26CC            _ram_hdwr_tia           .ds     1
  810  --:26CD            _ram_hdwr_tia_src       .ds     2
  811  --:26CF            _ram_hdwr_tia_dest      .ds     2
  812  --:26D1            _ram_hdwr_tia_size      .ds     2
  813  --:26D3            _ram_hdwr_tia_rts       .ds     1
  814                     
  815           E460              .code
  816                     
  817           0001              .ifdef HUC
  818  00:E460            _load_vram.3:
  819                             .endif
  820  00:E460             load_vram:
  821                     
  822                         ; ----
  823                         ; map data
  824                         ;
  825  00:E460  20 BF E3          jsr   map_data
  826                     
  827                     ;    ; ----
  828                     ;    ; setup call to TIA operation (fastest transfer)
  829                     ;    ;
  830                     ;    ; (instruction setup done during bootup...)
  831                     ;
  832                     ;       stw   #video_data, _ram_hdwr_tia_dest
  833                     ;       stw   <_si, _ram_hdwr_tia_src
  834                     ;
  835                     ;        asl   <_cl             ; change from words to bytes (# to xfer)
  836                     ;       rol   <_ch
  837                     
  838                         ; ----
  839                         ; set vram address
  840                         ;
  841  00:E463  20 A5 E4          jsr   set_write
  842                     
  843                         ; ----
  844                         ; copy data
  845                         ;
  846  00:E466  C2                cly
  847  00:E467  A6 FC             ldx   <_cl
  848  00:E469  F0 16             beq   .l3
  849                             ; --
  850  00:E46B  B1 EE     .l1:    lda   [_si],Y
  851  00:E46D  8D 02 00          sta   video_data_l
  852  00:E470  C8                iny
  853  00:E471  B1 EE             lda   [_si],Y
  854  00:E473  8D 03 00          sta   video_data_h
  855  00:E476  C8                iny
  856  00:E477  D0 02             bne   .l2
  857  00:E479  E6 EF             inc   <_si+1
  858                             ; --
  859  00:E47B  CA        .l2:    dex
  860  00:E47C  D0 ED             bne   .l1
  861                             ; --
  862  00:E47E  20 EA E3          jsr   remap_data
  863                             ; --
  864  00:E481  C6 FD     .l3:    dec   <_ch
  865  00:E483  10 E6             bpl   .l1
  866                     
  867                     ;.l1:   lda   <_ch              ; if zero-transfer, exit
  868                     ;       ora   <_cl
  869                     ;       beq   .out
  870                     ;
  871                     ;       lda   <_ch
  872                     ;       cmp   #$20              ; if more than $2000, repeat xfers of $2000
  873                     ;        blo   .l2              ; while adjusting banks
  874                     ;       sub   #$20              ; reduce remaining transfer amount
  875                     ;       sta   <_ch
  876                     ;
  877                     ;       stw   #$2000, _ram_hdwr_tia_size
  878                     ;       jsr   _ram_hdwr_tia
  879                     ;
  880                     ;       lda   <_si+1            ; force bank adjust
  881                     ;       add   #$20              ; and next move starts at same location
  882                     ;       sta   <_si+1
  883                     ;
  884                     ;       jsr   remap_data        ; adjust banks
  885                     ;       bra   .l1
  886                     ;
  887                     ;.l2:   sta   HIGH_BYTE _ram_hdwr_tia_size      ; 'remainder' transfer of < $2000
  888                     ;       lda   <_cl
  889                     ;       sta   LOW_BYTE  _ram_hdwr_tia_size
  890                     ;       jsr   _ram_hdwr_tia
  891                     
  892                         ; ----
  893                         ; unmap data
  894                         ;
  895                     
  896  00:E485  4C E1 E3  .out:   jmp   unmap_data
  897                     
  898                     
  899                     
  900                     ; ----
  901                     ; set_read
  902                     ; ----
  903                     ; set the VDC VRAM read pointer
  904                     ; ----
  905                     ; IN :  _DI = VRAM location
  906                     ; ----
  907                     
  908  00:E488            set_read:
  909  00:C488                    vreg  #$01
  910  00:E48E  A5 F0             lda   <_di 
  911  00:E490  8D 02 00          sta   video_data_l
  912           0001              .ifdef HUC
  913  00:E493  8D 49 27           sta   _vdc+2
  914                             .endif
  915  00:E496  A5 F1             lda   <_di+1
  916  00:E498  8D 03 00          sta   video_data_h
  917           0001              .ifdef HUC
  918  00:E49B  8D 4A 27           sta   _vdc+3
  919                             .endif
  920  00:C49E                    vreg  #$02
  921  00:E4A4  60                rts 
  922                     
  923                     
  924                     ; ----
  925                     ; set_write
  926                     ; ----
  927                     ; set the VDC VRAM write pointer
  928                     ; ----
  929                     ; IN :  _DI = VRAM location
  930                     ; ----
  931                     
  932  00:E4A5            set_write:
  933  00:C4A5                    vreg  #$00
  934  00:E4AB  A5 F0             lda   <_di 
  935  00:E4AD  8D 02 00          sta   video_data_l
  936           0001              .ifdef HUC
  937  00:E4B0  8D 47 27           sta   _vdc
  938                             .endif
  939  00:E4B3  A5 F1             lda   <_di+1
  940  00:E4B5  8D 03 00          sta   video_data_h
  941           0001              .ifdef HUC
  942  00:E4B8  8D 48 27           sta   _vdc+1
  943                             .endif
  944  00:C4BB                    vreg  #$02
  945  00:E4C1  60                rts 
  946                     
  947                     
  948                     ; ----
  949                     ; calc_vram_addr
  950                     ; ----
  951                     ; calculate VRAM address
  952                     ; ----
  953                     ; IN :    X = x coordinates
  954                     ;         A = y     "
  955                     ; ----
  956                     ; OUT:  _DI = VRAM location
  957                     ; ----
  958                     
  959  00:E4C2            calc_vram_addr:
  960  00:E4C2  DA                phx
  961  00:E4C3  2D D8 26          and   bat_vmask
  962  00:E4C6  64 F0             stz   <_di
  963  00:E4C8  AE D4 26          ldx   bat_width
  964  00:E4CB  E0 40             cpx   #64
  965  00:E4CD  F0 07             beq   .s64
  966  00:E4CF  E0 80             cpx   #128
  967  00:E4D1  F0 06             beq   .s128
  968                             ; --
  969  00:E4D3  4A        .s32:   lsr   A
  970  00:E4D4  66 F0             ror   <_di
  971                             ; --
  972  00:E4D6  4A        .s64:   lsr   A
  973  00:E4D7  66 F0             ror   <_di
  974                             ; --
  975  00:E4D9  4A        .s128:  lsr   A
  976  00:E4DA  66 F0             ror   <_di
  977  00:E4DC  85 F1             sta   <_di+1
  978                             ; --
  979  00:E4DE  68                pla
  980  00:E4DF  2D D7 26          and   bat_hmask
  981  00:E4E2  05 F0             ora   <_di
  982  00:E4E4  85 F0             sta   <_di
  983  00:E4E6  60                rts
  984                     
  985                     ; ----
  986                     ; HSR(xres)
  987                     ; ----
  988                     ; macros to calculate the value of the HSR VDC register
  989                     ; ----
  990                     ; IN :  xres, horizontal screen resolution
  991                     ; ----
  992                     
  993                     HSR     .macro
  994                              .if (\1 < 268)
  995                               ; low res
  996                               .db $02
  997                               .db (18 - (\1 / 16))
  998                              .else
  999                               .if (\1 < 356)
 1000                                ; high res
 1001                                .db $03
 1002                                .db (25 - (\1 / 16))
 1003                               .else
 1004                                ; very high res
 1005                                .db $05
 1006                                .db (42 - (\1 / 16))
 1007                               .endif
 1008                              .endif
 1009                             .endm
 1010                     
 1011                     
 1012                     ; ----
 1013                     ; HDR(xres)
 1014                     ; ----
 1015                     ; macros to calculate the value of the HDR VDC register
 1016                     ; ----
 1017                     ; IN :  xres, horizontal screen resolution
 1018                     ; ----
 1019                     
 1020                     HDR     .macro
 1021                              .db ((\1 / 8) - 1)
 1022                              .if (\1 < 268)
 1023                               ; low res
 1024                               .db (38 - ((18 - (\1 / 16)) + (\1 / 8)))
 1025                              .else
 1026                               .if (\1 < 356)
 1027                                ; high res
 1028                                .db (51 - ((25 - (\1 / 16)) + (\1 / 8)))
 1029                               .else
 1030                                ; high res
 1031                                .db (82 - ((42 - (\1 / 16)) + (\1 / 8)))
 1032                               .endif
 1033                              .endif
 1034                             .endm
 1035                     
 1036                     
 1037                     ; ----
 1038                     ; init_vdc
 1039                     ; ----
 1040                     ; initialize the video controller
 1041                     ;  - 256x224 screen mode
 1042                     ;  - 64x32 virtual bgmap size
 1043                     ;  - display and sprites off
 1044                     ;  - interrupts disabled
 1045                     ;  - SATB at $7F00
 1046                     ;  - VRAM cleared
 1047                     ; ----
 1048                     
 1049           26D4                 .bss
 1050  --:26D4            bat_width  .ds 2
 1051  --:26D6            bat_height .ds 1
 1052  --:26D7            bat_hmask  .ds 1
 1053  --:26D8            bat_vmask  .ds 1
 1054  --:26D9            scr_width  .ds 1
 1055  --:26DA            scr_height .ds 1
 1056           E4E7                 .code
 1057                     
 1058  00:E4E7            init_vdc:
 1059                         ; ----
 1060                         ; default screen resolution
 1061                         ;
 1062           0000             .ifndef _xres
 1064                            .endif
 1065                     
 1066                         ; ----
 1067                         ; initialize the VDC registers
 1068                         ;
 1069  00:C4E7                    stw   #.table,<_si      ; register table address in '_si'
 1070  00:E4EF  C2                cly 
 1071  00:E4F0  B1 EE     .l1:    lda   [_si],Y           ; select the VDC register
 1072  00:E4F2  C8                iny
 1073  00:E4F3  85 F7             sta   <vdc_reg
 1074  00:E4F5  8D 00 00          sta   video_reg
 1075           0001              .ifdef HUC
 1076  00:E4F8  0A                 asl   A
 1077  00:E4F9  AA                 tax
 1078                             .endif
 1079  00:E4FA  B1 EE             lda   [_si],Y           ; send the 16-bit data
 1080  00:E4FC  C8                iny 
 1081  00:E4FD  8D 02 00          sta   video_data_l
 1082           0001              .ifdef HUC
 1083  00:E500  9D 47 27           sta   _vdc,X
 1084                             .endif
 1085  00:E503  B1 EE             lda   [_si],Y
 1086  00:E505  C8                iny 
 1087  00:E506  8D 03 00          sta   video_data_h
 1088           0001              .ifdef HUC
 1089  00:E509  9D 48 27           sta   _vdc+1,X
 1090                             .endif
 1091  00:E50C  C0 24             cpy   #36               ; loop if not at the end of the
 1092  00:E50E  D0 E0             bne   .l1               ; table
 1093                     
 1094                         ; ----
 1095                         ; set the screen mode
 1096                         ;
 1097           0001              .if (_xres < 268)
 1098  00:E510  A9 04              lda  #(0 | XRES_SOFT)
 1099                             .else
 1105                             .endif
 1106                     
 1107                     ; This stuff alters display position from HuCard position
 1108                     
 1109                     ;        .if (CDROM)
 1110                     ;
 1111                     ;        ldx  #_xres/8
 1112                     ;        ldy  #30
 1113                     ;        jsr  ex_scrmod
 1114                     ;        lda  #$01
 1115                     ;        jsr  ex_scrsiz
 1116                     ;        lda  #0
 1117                     ;        jsr  ex_imode
 1118                     ;
 1119                     ;        .else
 1120                     
 1121                              ; pixel clock frequency
 1122  00:E512  8D 00 04           sta  color_ctrl
 1123                     ;
 1124                     ;        .endif
 1125                     
 1126                     
 1127                         ; ----
 1128                         ; set the background & border colors to black
 1129                         ;
 1130  00:C515                    stw   #256,color_reg
 1131  00:C51F                    stwz  color_data
 1132  00:C525                    stwz  color_reg
 1133  00:C52B                    stwz  color_data
 1134                     
 1135           0000             .if (CDROM)
 1155                            .endif   ; (CDROM)
 1156                     
 1157                         ; ----
 1158                         ; clear the video RAM
 1159                         ;
 1160  00:E531  03 00             st0   #0
 1161  00:E533  13 00             st1   #0
 1162  00:E535  23 00             st2   #0
 1163  00:E537  03 02             st0   #2
 1164                     
 1165  00:E539  A2 80             ldx   #128
 1166  00:E53B  C2        .l2:    cly
 1167  00:E53C  13 00     .l3:    st1   #0
 1168  00:E53E  23 00             st2   #0
 1169  00:E540  88                dey
 1170  00:E541  D0 F9             bne   .l3
 1171  00:E543  CA                dex
 1172  00:E544  D0 F5             bne   .l2
 1173                     
 1174                         ; ----
 1175                         ; save screen infos
 1176                         ;
 1177  00:C546                    stw   #_xres,scr_width  ; resolution
 1178  00:C550                    stw   #224,scr_height
 1179                             ; --
 1180  00:E55A  A9 01             lda   #BGMAP_SIZE_64x32 ; virtual size
 1181  00:E55C  4C 95 E5          jmp   set_bat_size
 1182                     
 1183                         ; ----
 1184                         ; VDC register table
 1185                         ;
 1186  00:E55F  05 00 00  .table: .db $05,$00,$00         ; CR    control register
 1187  00:E562  06 00 00          .db $06,$00,$00         ; RCR   scanline interrupt counter
 1188  00:E565  07 00 00          .db $07,$00,$00         ; BXR   background horizontal scroll offset
 1189  00:E568  08 00 00          .db $08,$00,$00         ; BYR        "     vertical     "      "
 1190  00:E56B  09 10 00          .db $09,$10,$00         ; MWR   size of the virtual screen
 1191  00:E56E  0A                .db $0A                 ; HSR +
 1192  00:C56F                     HSR _xres              ;     |                 [$02,$02]
 1193  00:E571  0B                .db $0B                 ; HDR | display size
 1194  00:C572                     HDR _xres              ;     | and synchro     [$1F,$04]
 1195  00:E574  0C 02 17          .db $0C,$02,$17         ; VPR |
 1196  00:E577  0D DF 00          .db $0D,$DF,$00         ; VDW |
 1197  00:E57A  0E 0C 00          .db $0E,$0C,$00         ; VCR +
 1198  00:E57D  0F 10 00          .db $0F,$10,$00         ; DCR   DMA control register
 1199  00:E580  13 00 7F          .db $13,$00,$7F         ; SATB  address of the SATB
 1200                     
 1201                     
 1202                     ; ----
 1203                     ; set_xres
 1204                     ; ----
 1205                     ; set horizontal display resolution
 1206                     ; ----
 1207                     ; IN  : _AX = new x resolution (ie. 320)
 1208                     ;       _CL = 'blur bit' for color register
 1209                     ; USES: _BX
 1210                     ; ----
 1211                     
 1212  00:E583            set_xres:
 1213  00:C583                    maplibfunc      lib2_set_xres
 1214  00:E594  60                rts
 1215                     
 1216                     
 1217           0001              .bank   LIB2_BANK
 1218                     
 1219           26DB              .bss
 1220  --:26DB            vdc_blur  .ds 1         ; blur bit
 1221  --:26DC            hsw       .ds 1         ; temporary parameters for calculating video registers
 1222  --:26DD            hds       .ds 1
 1223  --:26DE            hdw       .ds 1
 1224  --:26DF            hde       .ds 1
 1225           A9AD              .code
 1226                     
 1227  01:A9AD            lib2_set_xres:
 1228  01:A9AD  A9 20             lda     #$20            ; reset resource-usage flag
 1229  01:A9AF  04 F5             tsb     <irq_m          ; to skip joystick read portion of vsync
 1230                                                     ; (temporarily disable VSYNC processing)
 1231  01:A9B1  A5 F9             lda     <_ah
 1232  01:A9B3  85 FB             sta     <_bh
 1233  01:A9B5  A5 F8             lda     <_al
 1234  01:A9B7  85 FA             sta     <_bl            ; bx now has x-res
 1235                     
 1236  01:A9B9  46 FB             lsr     <_bh
 1237  01:A9BB  66 FA             ror     <_bl
 1238  01:A9BD  46 FB             lsr     <_bh
 1239  01:A9BF  66 FA             ror     <_bl
 1240  01:A9C1  46 FA             lsr     <_bl            ; bl now has x/8
 1241                     
 1242  01:A9C3  C2                cly                     ; offset into numeric tables
 1243                                                     ; 0=low-res, 1=mid-res, 2=high-res
 1244                     
 1245  01:A9C4  A5 F9             lda     <_ah
 1246  01:A9C6  F0 1E             beq    .xres_calc       ; < 256
 1247  01:A9C8  C9 03             cmp     #3
 1248  01:49CA                    bhs   .xres_calc
 1249                     
 1250  01:49CC                    cmpw    #$10C,<_ax
 1251  01:49D6                    blo    .xres_calc       ; < 268
 1252                     
 1253  01:A9D8  C8                iny
 1254  01:49D9                    cmpw    #$164,<_ax
 1255  01:49E3                    blo    .xres_calc       ; < 356
 1256                     
 1257  01:A9E5  C8                iny                     ; 356 < x < 512
 1258                     
 1259  01:A9E6            .xres_calc:
 1260  01:A9E6  B9 52 AA          lda     .vce_tab,Y
 1261  01:A9E9  05 FC             ora     <_cl
 1262  01:A9EB  8D 00 04          sta     color_ctrl      ; dot-clock (x-resolution)
 1263                     
 1264  01:A9EE  B9 55 AA          lda     .hsw_tab,Y      ; example calc's (using "low-res" numbers)
 1265  01:A9F1  8D DC 26          sta     hsw             ; hsw = $2
 1266  01:A9F4  A5 FA             lda     <_bl
 1267  01:A9F6  8D DD 26          sta     hds             ; hds = (x/8) temporarily
 1268  01:A9F9  3A                dec     A
 1269  01:A9FA  8D DE 26          sta     hdw             ; hdw = (x/8)-1
 1270  01:A9FD  4E DD 26          lsr     hds             ; hds = (x/16) temporarily
 1271                     
 1272  01:AA00  B9 58 AA          lda     .hds_tab,Y
 1273  01:4A03                    sub     hds
 1274  01:AA07  8D DD 26          sta     hds             ; hds = 18 - (x/16)
 1275                     
 1276  01:AA0A  B9 5B AA          lda     .hde_tab,Y
 1277  01:4A0D                    sub     hds
 1278  01:4A11                    sub     <_bl            ; hde = (38 - ( (18-(x/16)) + (x/8) ))
 1279  01:AA14  8D DF 26          sta     hde
 1280                     
 1281  01:AA17            .xres_putit:
 1282  01:AA17  A9 0A             lda     #$0a
 1283  01:AA19  85 F7             sta     <vdc_reg
 1284  01:AA1B  8D 00 00          sta     video_reg
 1285           0001              .ifdef HUC
 1286  01:AA1E  0A                 asl    A
 1287  01:AA1F  22                 sax
 1288                             .endif
 1289  01:AA20  AD DC 26          lda     hsw
 1290  01:AA23  8D 02 00          sta     video_data_l
 1291           0001              .ifdef HUC
 1292  01:AA26  9D 47 27           sta    _vdc,X
 1293                             .endif
 1294  01:AA29  AD DD 26          lda     hds
 1295  01:AA2C  8D 03 00          sta     video_data_h
 1296           0001              .ifdef HUC
 1297  01:AA2F  9D 48 27           sta    _vdc+1,X
 1298                             .endif
 1299                     
 1300  01:AA32  A9 0B             lda     #$0b
 1301  01:AA34  85 F7             sta     <vdc_reg
 1302  01:AA36  8D 00 00          sta     video_reg
 1303           0001              .ifdef HUC
 1304  01:AA39  0A                 asl    A
 1305  01:AA3A  22                 sax
 1306                             .endif
 1307  01:AA3B  AD DE 26          lda     hdw
 1308  01:AA3E  8D 02 00          sta     video_data_l
 1309           0001              .ifdef HUC
 1310  01:AA41  9D 47 27           sta    _vdc,X
 1311                             .endif
 1312  01:AA44  AD DF 26          lda     hde
 1313  01:AA47  8D 03 00          sta     video_data_h
 1314           0001              .ifdef HUC
 1315  01:AA4A  9D 48 27           sta    _vdc+1,X
 1316                             .endif
 1317                     
 1318  01:AA4D            .xres_err:
 1319  01:AA4D  A9 20             lda     #$20
 1320  01:AA4F  14 F5             trb     <irq_m          ; re-enable VSYNC processing
 1321  01:AA51  60                rts
 1322                     
 1323  01:AA52  00 01 02  .vce_tab:       .db      0, 1, 2
 1324  01:AA55  02 03 05  .hsw_tab:       .db      2, 3, 5
 1325  01:AA58  12 19 2A  .hds_tab:       .db     18,25,42
 1326  01:AA5B  26 33 52  .hde_tab:       .db     38,51,82
 1327                     
 1328           0000              .bank   LIB1_BANK       ; restore bank context
 1329                     
 1330                     ; ----
 1331                     ; set_bat_size
 1332                     ; ----
 1333                     ; set bg map virtual size
 1334                     ; ----
 1335                     ; IN : A = new size (0-7)
 1336                     ; ----
 1337                     
 1338  00:E595            set_bat_size:
 1339  00:E595  29 07             and   #$07
 1340  00:E597  48                pha
 1341                             ; --
 1342           0000              .if (CDROM)
 1345                             .else
 1346  00:C598                     vreg  #9
 1347  00:E59E  68                 pla
 1348  00:E59F  AA                 tax
 1349  00:E5A0  0A                 asl   A
 1350  00:E5A1  0A                 asl   A
 1351  00:E5A2  0A                 asl   A
 1352  00:E5A3  0A                 asl   A
 1353           0001               .ifdef HUC
 1354  00:E5A4  8D 59 27            sta   _vdc+18
 1355                              .endif
 1356  00:E5A7  8D 02 00           sta   video_data_l
 1357                             .endif
 1358                             ; --
 1359  00:E5AA  BD CE E5          lda  .width,X
 1360  00:E5AD  8D D4 26          sta   bat_width
 1361  00:E5B0  9C D5 26          stz   bat_width+1
 1362  00:E5B3  3A                dec   A
 1363  00:E5B4  8D D7 26          sta   bat_hmask
 1364                             ; --
 1365  00:E5B7  BD D6 E5          lda  .height,X
 1366  00:E5BA  8D D6 26          sta   bat_height
 1367  00:E5BD  8D C9 26          sta   mapbat_bottom
 1368  00:E5C0  9C C8 26          stz   mapbat_top
 1369  00:E5C3  9C C6 26          stz   mapbat_top_base
 1370  00:E5C6  9C C7 26          stz   mapbat_top_base+1
 1371  00:E5C9  3A                dec   A
 1372  00:E5CA  8D D8 26          sta   bat_vmask
 1373  00:E5CD  60                rts
 1374                     
 1375  00:E5CE  20 40 80  .width:  .db $20,$40,$80,$80,$20,$40,$80,$80
       00:E5D1  80 20 40  
       00:E5D4  80 80     
 1376  00:E5D6  20 20 20  .height: .db $20,$20,$20,$20,$40,$40,$40,$40
       00:E5D9  20 40 40  
       00:E5DC  40 40     
 1377                     
 1378                     
 1379                     ; ----
 1380                     ; init_psg
 1381                     ; ----
 1382                     ; initialize the sound generator.
 1383                     ; ----
 1384                     
 1385  00:E5DE            init_psg:
 1386           0001             .if !(CDROM)
 1387  00:E5DE  64 E6             stz   <psg_irqflag      ; IRQ not running
 1388  00:E5E0  A9 01             lda   #1
 1389  00:E5E2  85 E7             sta   <psg_inhibit      ; inhibit PSG playing
 1390                            .endif
 1391                     
 1392  00:E5E4  9C 01 08          stz   psg_mainvol       ; main volume to zero
 1393  00:E5E7  9C 09 08          stz   psg_lfoctrl       ; disable the LFO
 1394                             
 1395  00:E5EA  A9 05             lda   #5                ; set volume to zero for each channel
 1396  00:E5EC  8D 00 08  .clear: sta   psg_ch            ; and disable them
 1397  00:E5EF  9C 04 08          stz   psg_ctrl
 1398  00:E5F2  9C 05 08          stz   psg_pan
 1399  00:E5F5  3A                dec   A
 1400  00:E5F6  10 F4             bpl   .clear
 1401                     
 1402  00:E5F8  A9 04             lda   #4                ; disable noise for channel 5 & 6
 1403  00:E5FA  8D 00 08          sta   psg_ch
 1404  00:E5FD  9C 07 08          stz   psg_noise
 1405  00:E600  A9 05             lda   #5
 1406  00:E602  8D 00 08          sta   psg_ch
 1407  00:E605  9C 07 08          stz   psg_noise
 1408  00:E608  60                rts
 1409                     
 1410                     
 1411                     ; ----------------------------------
 1412                     ; Some simple copy/compare functions
 1413                     ; ----------------------------------
 1414                     
 1415                     ; ----
 1416                     ; _strcpy(char *dest [di], char *src [si])
 1417                     ; _strcat(char *dest [di], char *src [si])
 1418                     ; ----
 1419                     ; Copy/Concatenate a string to another string
 1420                     ; ----
 1421                     ;
 1422  00:E609            _strcat.2:
 1423  00:E609  B2 F0     .endlp:   lda   [_di]           ; same as strcpy, but find end
 1424  00:E60B  F0 08               beq   _strcpy.2       ; of dest string first
 1425  00:C60D                      incw  <_di
 1426  00:E613  80 F4               bra   .endlp
 1427                     
 1428  00:E615            _strcpy.2:
 1429  00:E615  B2 EE     .cpylp:   lda   [_si]
 1430  00:E617  92 F0               sta   [_di]
 1431  00:E619  F0 0E               beq   .out
 1432  00:C61B                      incw  <_di
 1433  00:C621                      incw  <_si
 1434  00:E627  80 EC               bra   .cpylp
 1435  00:E629  60        .out:     rts
 1436                     
 1437                     
 1438                     ; ----
 1439                     ; _strncpy(char *dest [di], char *src [si], int count [acc])
 1440                     ; _strncat(char *dest [di], char *src [si], int count [acc])
 1441                     ; ----
 1442                     ; Copy/Concatenate a string to another string
 1443                     ; ----
 1444                     ;
 1445                     
 1446  00:E62A            _strncat.3:
 1447  00:C62A                    __stw   <_ax
 1448  00:E62E  B2 F0     .endlp:   lda   [_di]
 1449  00:E630  F0 08               beq   .cpylp
 1450  00:C632                      incw  <_di
 1451  00:E638  80 F4               bra   .endlp
 1452  00:E63A            .cpylp:
 1453  00:E63A  B2 EE               lda   [_si]
 1454  00:E63C  92 F0               sta   [_di]
 1455  00:E63E  F0 22               beq   .out
 1456  00:C640                      incw  <_di
 1457  00:C646                      incw  <_si
 1458  00:C64C                      decw  <_ax
 1459  00:C659                      tstw  <_ax
 1460  00:E65D  D0 DB               bne   .cpylp
 1461  00:E65F  62                  cla
 1462  00:E660  92 F0               sta   [_di]
 1463  00:E662  60        .out:     rts
 1464                     
 1465                     
 1466  00:E663            _strncpy.3:
 1467  00:C663                    __stw   <_ax
 1468  00:E667            .lp:
 1469  00:E667  B2 EE               lda   [_si]
 1470  00:E669  92 F0               sta   [_di]
 1471  00:E66B  F0 21               beq   .out
 1472  00:C66D                      incw  <_di
 1473  00:C673                      incw  <_si
 1474  00:C679                      decw  <_ax
 1475  00:C686                      tstw  <_ax
 1476  00:E68A  F0 02               beq   .out
 1477  00:E68C  80 D9               bra   .lp
 1478  00:E68E  60        .out:     rts
 1479                     
 1480                     
 1481                     ; ----
 1482                     ; _memcpy(char *dest [di], char *src [si], int count [acc])
 1483                     ; ----
 1484                     ; Copy memory
 1485                     ; ----
 1486                     ;
 1487  00:E68F            _memcpy.3:
 1488  00:C68F                    __stw   <_ax
 1489  00:E693  B2 EE     .cpylp:   lda   [_si]
 1490  00:E695  92 F0               sta   [_di]
 1491  00:C697                      incw  <_si
 1492  00:C69D                      incw  <_di
 1493  00:C6A3                      decw  <_ax
 1494  00:C6B0                      tstw  <_ax
 1495  00:E6B4  D0 DD               bne   .cpylp
 1496  00:E6B6  60                  rts
 1497                     
 1498                     ; ----
 1499                     ; _memcmp(char *dest [di], char *src [si], int count [acc])
 1500                     ; ----
 1501                     ; Compare memory
 1502                     ; ----
 1503                     ;
 1504  00:E6B7            _memcmp.3:
 1505  00:C6B7                    __stw   <_ax
 1506  00:E6BB  B2 F0     .cmplp:   lda   [_di]
 1507  00:C6BD                      sub   [_si]
 1508  00:E6C0  30 05               bmi   .minus
 1509  00:E6C2  F0 07               beq   .cont
 1510  00:E6C4  AA        .plus:    tax
 1511  00:E6C5  62                  cla
 1512  00:E6C6  60                  rts
 1513  00:E6C7  AA        .minus:   tax
 1514  00:E6C8  A9 FF               lda   #$ff
 1515  00:E6CA  60                  rts
 1516  00:C6CB            .cont:    incw  <_di
 1517  00:C6D1                      incw  <_si
 1518  00:C6D7                      decw  <_ax
 1519  00:C6E4                      tstw  <_ax
 1520  00:E6E8  D0 D1               bne   .cmplp
 1521  00:E6EA  82                  clx
 1522  00:E6EB  60                  rts
 1523                     
 1524                     ; ----
 1525                     ; _strcmp(char *dest [di], char *src [si])
 1526                     ; ----
 1527                     ; Compare strings
 1528                     ; ----
 1529                     ;
 1530  00:E6EC            _strcmp.2:
 1531  00:E6EC  B2 F0     .cmplp:   lda   [_di]
 1532  00:C6EE                      sub   [_si]
 1533  00:E6F1  30 05               bmi   .minus
 1534  00:E6F3  F0 07               beq   .cont
 1535  00:E6F5  AA        .plus:    tax
 1536  00:E6F6  62                  cla
 1537  00:E6F7  60                  rts
 1538  00:E6F8  AA        .minus:   tax
 1539  00:E6F9  A9 FF               lda   #$ff
 1540  00:E6FB  60                  rts
 1541  00:E6FC  B2 F0     .cont:    lda   [_di]
 1542  00:E6FE  F0 0E               beq   .out
 1543  00:C700                      incw  <_di
 1544  00:C706                      incw  <_si
 1545  00:E70C  80 DE               bra   .cmplp
 1546  00:E70E  82        .out:     clx
 1547  00:E70F  60                  rts
 1548                     
 1549                     ; ----
 1550                     ; _strncmp(char *dest [di], char *src [si], int count [acc])
 1551                     ; ----
 1552                     ; Compare strings
 1553                     ; ----
 1554                     ;
 1555  00:E710            _strncmp.3:
 1556  00:C710                    __stw   <_ax
 1557  00:E714  B2 F0     .cmplp:   lda   [_di]
 1558  00:C716                      sub   [_si]
 1559  00:E719  30 05               bmi   .minus
 1560  00:E71B  F0 07               beq   .cont
 1561  00:E71D  AA        .plus:    tax
 1562  00:E71E  62                  cla
 1563  00:E71F  60                  rts
 1564  00:E720  AA        .minus:   tax
 1565  00:E721  A9 FF               lda   #$ff
 1566  00:E723  60                  rts
 1567  00:E724  B2 F0     .cont:    lda   [_di]
 1568  00:E726  F0 1F               beq   .out
 1569  00:C728                      incw  <_di
 1570  00:C72E                      incw  <_si
 1571  00:C734                      decw  <_ax
 1572  00:C741                      tstw  <_ax
 1573  00:E745  D0 CD               bne   .cmplp
 1574  00:E747  82        .out      clx
 1575  00:E748  62                  cla
 1576  00:E749  60                  rts
 1577                     
#[4]   sup_hes.asm
#[5]   scroll.asm
 1296                             .include "scroll.asm"
    1                     ;
    2                     ; SCROLL.ASM  -  MagicKit Scrolling Library
    3                     ;
    4                     ;
    5                     
    6                     ; [ 28] user scrolling vars
    7           26E0                      .bss
    8  --:26E0            scroll_xl:      .ds 4   ; x       |
    9  --:26E4            scroll_xh:      .ds 4   ;         |
   10  --:26E8            scroll_yl:      .ds 4   ; y       |
   11  --:26EC            scroll_yh:      .ds 4   ;         | scrolling table
   12  --:26F0            scroll_top:     .ds 4   ; top     |
   13  --:26F4            scroll_bottom:  .ds 4   ; bottom  |
   14  --:26F8            scroll_cr:      .ds 4   ; control |
   15                     
   16                     ; [ 69] display list
   17           26FC                      .bss
   18  --:26FC            s_idx           .ds 1
   19  --:26FD            s_xl            .ds 8
   20  --:2705            s_xh            .ds 8
   21  --:270D            s_yl            .ds 8
   22  --:2715            s_yh            .ds 8
   23  --:271D            s_cr            .ds 8
   24  --:2725            s_top           .ds 9
   25  --:272E            s_bottom        .ds 8
   26  --:2736            s_list          .ds 8
   27  --:273E            s_work          .ds 3
   28                     
   29           E74A                      .code
   30           0001                      .bank   LIB2_BANK
   31                     ; ----
   32                     ; build_display_list
   33                     ; ----
   34                     
   35  01:AA5E            build_disp_list:
   36                     
   37                         ; ----
   38                         ; quick test
   39                         ;
   40  01:AA5E  AD F8 26          lda   scroll_cr
   41  01:AA61  0D F9 26          ora   scroll_cr+1
   42  01:AA64  0D FA 26          ora   scroll_cr+2
   43  01:AA67  0D FB 26          ora   scroll_cr+3
   44  01:AA6A  29 01             and   #$01
   45  01:AA6C  D0 02             bne   .l0
   46                             ; --
   47  01:AA6E  18                clc
   48  01:AA6F  60                rts
   49                     
   50                         ; ----
   51                         ; parse user scroll list
   52                         ;
   53  01:AA70  82        .l0:    clx
   54  01:AA71  C2                cly
   55                             ; --
   56  01:AA72  B9 F8 26  .l1:    lda   scroll_cr,Y
   57  01:AA75  29 01             and   #$01
   58  01:AA77  F0 38             beq   .l2
   59  01:AA79  B9 F0 26          lda   scroll_top,Y
   60  01:AA7C  CD DA 26          cmp   scr_height
   61  01:4A7F                    bhs   .l2
   62  01:AA81  3A                dec   A
   63  01:AA82  20 18 AB          jsr   .check_list
   64  01:AA85  B0 2A             bcs   .l2
   65                             ; -- copy scanline
   66  01:AA87  9D 25 27          sta   s_top,X
   67  01:AA8A  B9 F4 26          lda   scroll_bottom,Y
   68  01:AA8D  9D 2E 27          sta   s_bottom,X
   69                             ; -- copy display control bits
   70  01:AA90  B9 F8 26          lda   scroll_cr,Y
   71  01:AA93  29 C0             and   #$C0
   72  01:AA95  9D 1D 27          sta   s_cr,X
   73                             ; -- copy bat coordinates
   74  01:AA98  B9 E0 26          lda   scroll_xl,Y
   75  01:AA9B  9D FD 26          sta   s_xl,X
   76  01:AA9E  B9 E4 26          lda   scroll_xh,Y
   77  01:AAA1  9D 05 27          sta   s_xh,X
   78  01:AAA4  B9 E8 26          lda   scroll_yl,Y
   79  01:AAA7  9D 0D 27          sta   s_yl,X
   80  01:AAAA  B9 EC 26          lda   scroll_yh,Y
   81  01:AAAD  9D 15 27          sta   s_yh,X
   82  01:AAB0  E8                inx
   83  01:AAB1            .l2:
   84  01:AAB1  C8                iny
   85  01:AAB2  C0 04             cpy   #4
   86  01:4AB4                    blo   .l1
   87                     
   88                         ; ----
   89                         ; init display list
   90                         ;
   91  01:AAB6  A9 F0             lda   #$F0
   92  01:AAB8  9D 25 27          sta   s_top,X
   93  01:AABB  9D 2E 27          sta   s_bottom,X
   94  01:AABE  E8                inx
   95  01:AABF  8E FC 26          stx   s_idx
   96                             ; --
   97  01:AAC2  C2                cly
   98  01:AAC3  62                cla
   99  01:AAC4  99 36 27  .l3:    sta   s_list,Y
  100  01:AAC7  1A                inc   A
  101  01:AAC8  C8                iny
  102  01:AAC9  CA                dex
  103  01:AACA  D0 F8             bne   .l3
  104                     
  105                         ; ----
  106                         ; sort display list
  107                         ;
  108  01:AACC  AD FC 26          lda   s_idx
  109  01:AACF  8D 3E 27          sta   s_work
  110  01:AAD2  80 39             bra   .t4
  111  01:AAD4            .t1:
  112  01:AAD4  9C 3F 27          stz   s_work+1
  113  01:AAD7  A0 01             ldy   #1
  114  01:AAD9            .t2:
  115  01:AAD9  BE 35 27          ldx   s_list-1,Y
  116  01:AADC  BD 25 27          lda   s_top,X
  117  01:AADF  1A                inc   A
  118  01:AAE0  8D 40 27          sta   s_work+2
  119  01:AAE3  BE 36 27          ldx   s_list,Y
  120  01:AAE6  BD 25 27          lda   s_top,X
  121  01:AAE9  1A                inc   A
  122  01:AAEA  CD 40 27          cmp   s_work+2
  123  01:4AED                    bhs   .t3
  124                             ; --
  125  01:AAEF  B9 35 27          lda   s_list-1,Y
  126  01:AAF2  99 36 27          sta   s_list,Y
  127  01:AAF5  8A                txa
  128  01:AAF6  99 35 27          sta   s_list-1,Y
  129  01:AAF9  EE 3F 27          inc   s_work+1
  130  01:AAFC            .t3:
  131  01:AAFC  C8                iny
  132  01:AAFD  CC 3E 27          cpy   s_work
  133  01:4B00                    blo   .t2
  134  01:AB02  AD 3F 27          lda   s_work+1
  135  01:AB05  F0 0A             beq   .t5
  136  01:AB07  CE 3E 27          dec   s_work
  137  01:AB0A  AD 3E 27          lda   s_work
  138  01:AB0D  C9 02     .t4:    cmp   #2
  139  01:4B0F                    bhs   .t1
  140  01:AB11            .t5:
  141                         ; ----
  142                         ; return
  143                         ;
  144  01:AB11  AD FC 26          lda   s_idx
  145  01:4B14                    add   #$FE
  146  01:AB17  60                rts
  147                     
  148                         ; ----
  149                         ; scan display list
  150                         ;
  151  01:AB18            .check_list:
  152                     
  153  01:AB18  DA                phx
  154  01:AB19  CA        .x1:    dex
  155  01:AB1A  30 08             bmi   .x2
  156  01:AB1C  DD 25 27          cmp   s_top,X
  157  01:AB1F  D0 F8             bne   .x1
  158  01:AB21  FA                plx
  159  01:AB22  38                sec
  160  01:AB23  60                rts
  161                             ; --
  162  01:AB24  FA        .x2:    plx
  163  01:AB25  18                clc
  164  01:AB26  60                rts
  165                     
  166           0000                      .bank   LIB1_BANK       ; restore context
  167                     
#[4]   sup_hes.asm
#[5]   math.asm
 1297                             .include "math.asm"
    1                     ;
    2                     ; MATH.ASM  -  MagicKit Standard Math Routines
    3                     ;
    4                     ;
    5                     
    6                     
    7                     ; ----
    8                     ; divu8
    9                     ; ----
   10                     ; 8-bit unsigned division
   11                     ; ----
   12                     ; OUT : _CL = _AL / _BL
   13                     ;       _DL = _AL % _BL
   14                     ; ----
   15                     
   16  00:E74A            divu8:
   17  00:E74A  A5 F8             lda   <_al
   18  00:E74C  0A                asl   A
   19  00:E74D  85 FC             sta   <_cl
   20  00:E74F  62                cla
   21  00:E750  A0 08             ldy   #8
   22  00:E752            .l1:
   23  00:E752  2A                rol   A
   24  00:E753  C5 FA             cmp   <_bl
   25  00:E755  90 02             bcc   .l2
   26  00:E757  E5 FA             sbc   <_bl
   27  00:E759            .l2:
   28  00:E759  26 FC             rol   <_cl
   29  00:E75B  88                dey
   30  00:E75C  D0 F4             bne   .l1
   31                     
   32  00:E75E  85 FE             sta   <_dl
   33  00:E760  60                rts
   34                     
   35                     
   36                     ; ----
   37                     ; divu10
   38                     ; ----
   39                     ; 16-bit unsigned division by 10
   40                     ; ----
   41                     ; OUT : _DX = _DX / 10
   42                     ;         A = _DX % 10
   43                     ; ----
   44                     
   45  00:E761            divu10:
   46  00:E761  A0 10               ldy   #16
   47  00:E763  62                  cla
   48  00:E764  06 FE               asl   <_dl
   49  00:E766  26 FF               rol   <_dh
   50  00:E768  2A        .l1:      rol   a
   51  00:E769  C9 0A               cmp   #10
   52  00:C76B                      blo   .l2
   53  00:E76D  E9 0A               sbc   #10
   54  00:E76F  26 FE     .l2:      rol   <_dl
   55  00:E771  26 FF               rol   <_dh
   56  00:E773  88                  dey
   57  00:E774  D0 F2               bne   .l1
   58  00:E776  60                  rts
   59                     
   60           0001              .if (!CDROM)
   61                     ; ----
   62                     ; mulu8
   63                     ; ----
   64                     ; 8-bit unsigned multiplication
   65                     ; ----
   66                     ; OUT : _CX = _AL * _BL
   67                     ; ----
   68                     
   69  00:E777            mulu8:
   70  00:E777  A5 FA             lda   <_bl
   71  00:E779  85 FD             sta   <_ch
   72                     
   73  00:E77B  62                cla
   74  00:E77C  A0 08             ldy   #8
   75  00:E77E            .l1:
   76  00:E77E  0A                asl   A
   77  00:E77F  26 FD             rol   <_ch
   78  00:E781  90 07             bcc   .next
   79  00:C783                    add   <_al
   80  00:E786  90 02             bcc   .next
   81  00:E788  E6 FD             inc   <_ch
   82  00:E78A            .next:
   83  00:E78A  88                dey
   84  00:E78B  D0 F1             bne   .l1
   85                     
   86  00:E78D  85 FC             sta   <_cl
   87  00:E78F  60                rts
   88                     
   89                     
   90                     ; ----
   91                     ; mulu16
   92                     ; ----
   93                     ; 16-bit unsigned multiplication
   94                     ; ----
   95                     ; OUT : _DX/CX = _AX * _BX
   96                     ; ----
   97                     
   98  00:E790            mulu16:
   99  00:E790  A5 F9             lda   <_ah
  100  00:E792  05 FB             ora   <_bh
  101  00:E794  D0 07             bne   .l1
  102                     
  103  00:C796                    stwz  <_dx              ;  8-bit multiplication
  104  00:E79A  4C 77 E7          jmp   mulu8
  105                     
  106  00:C79D            .l1:    stw   <_bx,<_dx         ; 16-bit multiplication
  107  00:C7A5                    stwz  <_cx
  108  00:E7A9  A0 10             ldy   #16
  109                     
  110  00:C7AB            .l2:    aslw  <_cx
  111  00:C7AF                    rolw  <_dx
  112  00:E7B3  90 15             bcc   .l3
  113                     
  114  00:C7B5                    addw  <_ax,<_cx
  115  00:E7C2  90 06             bcc   .l3
  116  00:C7C4                    incw  <_dx
  117                     
  118  00:E7CA  88        .l3:    dey
  119  00:E7CB  D0 DE             bne   .l2
  120  00:E7CD  60                rts
  121                             .endif
  122                     
  123                     ; ----
  124                     ; mulu32
  125                     ; ----
  126                     ; 32-bit unsigned multiplication
  127                     ; ----
  128                     ; OUT : _DX/CX = _BX/AX * _DX/CX
  129                     ; ----
  130                     
  131  00:E7CE            mulu32:
  132  00:C7CE                    stw   <_cx,<_si
  133  00:C7D6                    stw   <_dx,<_di
  134  00:C7DE                    stwz  <_cx
  135  00:C7E2                    stwz  <_dx
  136  00:E7E6  A0 20             ldy   #32
  137  00:E7E8            .loop:
  138  00:C7E8                    aslw  <_cx
  139  00:C7EC                    rolw  <_dx
  140  00:C7F0                    rolw  <_si
  141  00:C7F4                    rolw  <_di
  142  00:E7F8  90 19             bcc   .next
  143                     
  144  00:C7FA                    addw  <_ax,<_cx
  145  00:C807                    adcw  <_bx,<_dx
  146  00:E813            .next:
  147  00:E813  88                dey
  148  00:E814  D0 D2             bne   .loop
  149  00:E816  60                rts
  150                     
  151                     
  152                     ; ----
  153                     ; srand
  154                     ; ----
  155                     ; set random seed
  156                     ; ----
  157                     ; IN : _DX/CX = 32-bit seed
  158                     ; ----
  159                     
  160           2741              .bss
  161  --:2741            _rndptr         .ds 2
  162  --:2743            _rndseed        .ds 2
  163  --:2745            _rndn1          .ds 1
  164  --:2746            _rndn2          .ds 1
  165                     
  166           E817              .code
  167  00:E817            srand:
  168  00:C817                    stw     <_cx,_rndptr
  169  00:C821                    stw     <_dx,_rndn1
  170  00:E82B  AD 42 27          lda     _rndptr+1
  171  00:E82E  09 E0             ora     #$e0
  172  00:E830  8D 42 27          sta     _rndptr+1
  173  00:E833  C9 F4             cmp     #$f4
  174  00:C835                    blo     .exit
  175  00:E837  A9 E0             lda     #$e0
  176  00:E839  8D 42 27          sta     _rndptr+1
  177  00:E83C            .exit:
  178  00:E83C  60                rts
  179                     
  180                     ; ----
  181                     ; rand
  182                     ; ----
  183                     ; return 16-bit random number
  184                     ; ----
  185                     ; OUT: _DX
  186                     ; ----
  187                     
  188           2014              .zp
  189  --:2014            _rndzp  .ds     2
  190                     
  191           E83D              .code
  192  00:E83D  20 4B E8  rand:   jsr     randomize
  193  00:C840                    stw     _rndn1,<_dx
  194  00:E84A  60                rts
  195                     
  196  00:E84B            randomize:
  197  00:C84B                    stw     _rndptr,<_rndzp
  198                     
  199  00:E855  AD 45 27          lda     _rndn1  ; rotate 3 bits right
  200  00:E858  AE 46 27          ldx     _rndn2
  201  00:E85B  6A                ror     A
  202  00:E85C  22                sax
  203  00:E85D  6A                ror     A
  204  00:E85E  22                sax
  205  00:E85F  6A                ror     A
  206  00:E860  22                sax
  207  00:E861  6A                ror     A
  208  00:E862  22                sax
  209  00:E863  6A                ror     A
  210  00:E864  22                sax
  211  00:E865  6A                ror     A
  212  00:E866  8E 45 27          stx     _rndn1
  213  00:E869  8D 46 27          sta     _rndn2
  214                     
  215  00:C86C                    addw    #$05A2,_rndn1 ; add #$05A2 to number
  216                     
  217  00:C87D                    incw    <_rndzp ; eor with next 2 bytes of ROM
  218  00:E883  AD 46 27          lda     _rndn2
  219  00:E886  52 14             eor     [_rndzp]
  220  00:E888  8D 46 27          sta     _rndn2
  221                     
  222  00:C88B                    incw    <_rndzp
  223  00:E891  AD 45 27          lda     _rndn1
  224  00:E894  52 14             eor     [_rndzp]
  225  00:E896  8D 45 27          sta     _rndn1
  226                     
  227  00:C899                    incw    <_rndzp ; don't use every consecutive byte
  228                     
  229  00:E89F  A5 15             lda     <_rndzp+1       ; reset pointer to $e000 if > $f400
  230  00:E8A1  C9 F4             cmp     #$f4
  231  00:C8A3                    blo     .l1
  232  00:E8A5  A9 E0             lda     #$e0
  233  00:E8A7  85 15             sta     <_rndzp+1
  234  00:E8A9            .l1:
  235  00:C8A9                    stw     <_rndzp,_rndptr
  236  00:E8B3  60                rts
  237                     
  238                     
  239                     ; ----
  240                     ; random
  241                     ; ----
  242                     ; return a random number in the interval 0 <= x < A
  243                     ; ----
  244                     ; IN  : A = range (1 - 128)
  245                     ; ----
  246                     ; OUT : A = random number
  247                     ; ----
  248                     ;
  249  00:E8B4            random:
  250  00:E8B4  48                pha
  251  00:E8B5  20 3D E8          jsr     rand
  252  00:E8B8  68                pla
  253                             ; ----
  254  00:E8B9  C9 80             cmp     #128
  255  00:C8BB                    blo     .l1
  256                     
  257  00:E8BD  A5 FF             lda     <_dh
  258  00:E8BF  29 7F             and     #$7f
  259  00:E8C1  60                rts
  260                     
  261  00:E8C2            .l1:    ; asl   A
  262  00:E8C2  85 F8             sta     <_al
  263  00:E8C4  A5 FE             lda     <_dl
  264  00:E8C6  85 FA             sta     <_bl
  265  00:E8C8  20 77 E7          jsr     mulu8
  266                     
  267  00:E8CB  A5 FD             lda     <_ch
  268  00:E8CD  60                rts
  269                     
#[4]   sup_hes.asm
 1298                     
 1299           0001             .ifdef HUC
#[5]   huc.asm
 1300                             .include "huc.asm"
    1                     ;
    2                     ; HUC.ASM  -  HuC Internal Library
    3                     ;
    4                     
    5                     ; ----
    6                     ; local variables
    7                     
    8           2747                .bss
    9  --:2747            _vdc      .ds 20*2
   10                     
   11           2016                .zp
   12  --:2016            __sign
   13  --:2016            __remain  .ds 2
   14                     
   15           E8CE                .code
   17                     
   18                     ; ----
   19                     ; eq
   20                     ; ----
   21                     ; test egality of two words
   22                     ; ----
   23                     ; IN :  First word on the C stack
   24                     ;       Another word in A:X
   25                     ; ----
   26                     ; OUT : word A:X equals 0 is the two args are egals
   27                     ;       else non nul
   28                     ; ----
   29                     ; REMARK : signed compatible
   30                     ; ----
   31                     
   32                                     ; old version is 75 bytes long
   33                                     ; new version is 31 bytes long (58% shorter :)
   34                                     ; DAVE: newer version 45 bytes but much faster
   35                                     ; best case was: 56 cycles (worst = 70)
   36                                     ; best case now: 45 cycles (worst = 59)
   37                     
   38  00:E8CE            eq:
   39  00:E8CE  22           sax
   40  00:E8CF  D2 00        cmp [__stack]
   41  00:E8D1  D0 18        bne .eq_endno
   42                     
   43  00:E8D3  A0 01        ldy #1
   44  00:E8D5  22           sax
   45  00:E8D6  D1 00        cmp [__stack],Y
   46  00:E8D8  D0 11        bne .eq_endno
   47                     
   48  00:E8DA            .eq_endyes:
   49                        addw #2,<__stack   ; don't push A/X; they are thrown away
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:E8DA  18                 clc
       00:E8DB  A5 00              lda    LOW_BYTE <__stack
       00:E8DD  69 02              adc    LOW_BYTE #2
       00:E8DF  85 00              sta    LOW_BYTE <__stack
       00:E8E1  A5 01              lda    HIGH_BYTE <__stack
       00:E8E3  69 00              adc    HIGH_BYTE #2
       00:E8E5  85 01              sta    HIGH_BYTE <__stack
                                  .endif
   50  00:E8E7  A9 FF        lda  #$FF        ; A=255 -> true
   51  00:E8E9  82           clx
   52  00:E8EA  60           rts
   53                     
   54  00:E8EB            .eq_endno:
   55                        addw #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:E8EB  18                 clc
       00:E8EC  A5 00              lda    LOW_BYTE <__stack
       00:E8EE  69 02              adc    LOW_BYTE #2
       00:E8F0  85 00              sta    LOW_BYTE <__stack
       00:E8F2  A5 01              lda    HIGH_BYTE <__stack
       00:E8F4  69 00              adc    HIGH_BYTE #2
       00:E8F6  85 01              sta    HIGH_BYTE <__stack
                                  .endif
   56  00:E8F8  A9 00        lda  #0
   57  00:E8FA  82           clx
   58  00:E8FB  60           rts
   59                     
   60                     ; streamlined version MACRO - uses zp ( <__temp ) instead of stack
   61                     ; returns A:X = 0 if false, FF00 if true
   62                     ; 15 bytes, best = 12 cycles; worst = 23
   63                             
   64  00:E8FC            eqzp:
   65  00:E8FC  C5 04             cmp   <__temp+1
   66  00:E8FE  D0 09             bne   .x_ne
   67  00:E900  22                sax
   68  00:E901  C5 03             cmp   <__temp
   69  00:E903  D0 04             bne   .x_ne
   70  00:E905  A9 FF             lda   #$FF      ; ensure Z flag not set
   71  00:E907  80 02             bra   .x1_eq
   72  00:E909            .x_ne:
   73  00:E909  A9 00             lda   #0        ; ensure Z flag set
   74  00:E90B            .x1_eq:
   75  00:E90B  82                clx
   76  00:E90C  60                rts
   77                     
   78                     
   79                     ; ----
   80                     ; lt
   81                     ; ----
   82                     ; compare two words
   83                     ; ----
   84                     ; IN :  First word on the C stack
   85                     ;       Another word in A:X
   86                     ; ----
   87                     ; OUT : word A:X is non nul if pushed word is strictly lower than
   88                     ;       the word in A:X else nul
   89                     ; ----
   90                     
   91  00:E90D            lt:     ; signed version
   92  00:E90D  A0 01        ldy #1
   93  00:E90F  C9 80        cmp #$80
   94  00:E911  B0 0A        bcs lt_primary_minus
   95                     
   96                             ; if here, the A:X value is positive
   97                     
   98  00:E913  85 03        sta <__temp
   99  00:E915  B1 00        lda [__stack], Y
  100  00:E917  30 55        bmi cmp_ok   ; stack value is negative, so reply OK
  101                     
  102  00:E919  A5 03        lda <__temp   ; stack value is also positive, so just go for the unsigned version
  103  00:E91B  80 1B        bra ult_y1
  104                     
  105                        
  106  00:E91D            lt_primary_minus:
  107                     
  108                             ; if here, the A:X value is negative
  109                     
  110  00:E91D  85 03        sta <__temp
  111  00:E91F  B1 00        lda [__stack], Y
  112  00:E921  30 11        bmi getA_ult ; stack value is also negative, so restore A val from
  113                                             ; __temp and call ult
  114                     
  115  00:E923            cmp_false:
  116                        addw #2,<__stack     ; OK to kill A/X
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:E923  18                 clc
       00:E924  A5 00              lda    LOW_BYTE <__stack
       00:E926  69 02              adc    LOW_BYTE #2
       00:E928  85 00              sta    LOW_BYTE <__stack
       00:E92A  A5 01              lda    HIGH_BYTE <__stack
       00:E92C  69 00              adc    HIGH_BYTE #2
       00:E92E  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  117  00:E930  A9 00        lda  #0
  118  00:E932  82           clx
  119  00:E933  60           rts
  120                     
  121  00:E934            getA_ult:
  122  00:E934  A5 03        lda <__temp
  123                     
  124  00:E936            ult:    ; unsigned version
  125  00:E936  A0 01        ldy #1       ; false by default
  126                     
  127  00:E938            ult_y1: ; same thing but Y is assumed to be egal to 1
  128                     
  129  00:E938  D1 00        cmp [__stack],Y
  130  00:E93A  F0 04        beq .lt_must_test_lobyte
  131  00:E93C  B0 30        bcs cmp_ok
  132  00:E93E  80 07        bra .lt_end ; hibyte of the reg var < hibyte of the pushed var
  133                     
  134  00:E940            .lt_must_test_lobyte:
  135  00:E940  22           sax
  136  00:E941  D2 00        cmp [__stack]
  137  00:E943  F0 02        beq .lt_end
  138  00:E945  B0 27        bcs cmp_ok        ; set result to true
  139                                          ; lobyte of the reg var < lobyte of the pushed var
  140                     
  141  00:E947            .lt_end:
  142                        addw      #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:E947  18                 clc
       00:E948  A5 00              lda    LOW_BYTE <__stack
       00:E94A  69 02              adc    LOW_BYTE #2
       00:E94C  85 00              sta    LOW_BYTE <__stack
       00:E94E  A5 01              lda    HIGH_BYTE <__stack
       00:E950  69 00              adc    HIGH_BYTE #2
       00:E952  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  143                     
  144  00:E954  98           tya          ; if Y was 1, return A=X=0 -> false
  145  00:E955  3A           dec A        ; if Y was 0, return A=255 -> true
  146                     
  147  00:E956  82           clx
  148  00:E957  60           rts
  149                     
  150                     
  151                     
  152                     ; ----
  153                     ; gt
  154                     ; ----
  155                     ; compare two words
  156                     ; ----
  157                     ; IN :  First word on the C stack
  158                     ;       Another word in A:X
  159                     ; ----
  160                     ; OUT : word A:X is non nul if pushed word is strictly greater than
  161                     ;       the word in A:X else nul
  162                     ; ----
  163                     
  164  00:E958            gt:     ; signed version of >
  165  00:E958  A0 01        ldy #1
  166  00:E95A  C9 80        cmp #$80
  167  00:E95C  B0 0A        bcs .gt_primary_minus
  168                     
  169                             ; if here, the A:X value is positive
  170                     
  171  00:E95E  85 03        sta <__temp
  172  00:E960  B1 00        lda [__stack], Y
  173  00:E962  30 BF        bmi cmp_false ; stack value is negative, so reply False
  174                     
  175  00:E964  A5 03        lda <__temp   ; stack value is also positive, so just go for the unsigned version
  176  00:E966  80 1B        bra ugt_y1   ; we spare one instruction, since we already have Y=1
  177                     
  178  00:E968            .gt_primary_minus:
  179                     
  180                             ; if here, the A:X value is negative
  181                     
  182  00:E968  85 03        sta <__temp
  183  00:E96A  B1 00        lda [__stack], Y
  184  00:E96C  30 11        bmi getA_ugt ; stack value is also negative, so restore A val from
  185                                             ; __temp and call ugt
  186                     
  187  00:E96E            cmp_ok:
  188                        addw #2,<__stack     ; OK to kill A/X
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:E96E  18                 clc
       00:E96F  A5 00              lda    LOW_BYTE <__stack
       00:E971  69 02              adc    LOW_BYTE #2
       00:E973  85 00              sta    LOW_BYTE <__stack
       00:E975  A5 01              lda    HIGH_BYTE <__stack
       00:E977  69 00              adc    HIGH_BYTE #2
       00:E979  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  189  00:E97B  A9 FF        lda #$FF
  190  00:E97D  82           clx
  191  00:E97E  60           rts
  192                     
  193  00:E97F            getA_ugt:       ; we grab back the value of A before entering the unsigned
  194                                     ; version of >
  195  00:E97F  A5 03        lda <__temp
  196                     
  197  00:E981            ugt:    ; unsigned version of >
  198                     
  199  00:E981  A0 01        ldy #1
  200                     
  201  00:E983            ugt_y1: ; unsigned version of >, assuming Y = 1
  202                     
  203  00:E983  D1 00        cmp [__stack],Y
  204  00:E985  F0 05        beq .gt_must_test_lobyte
  205  00:E987  B0 09        bcs .gt_end ; hibyte of the reg var >= hibyte of the pushed var
  206  00:E989  C2           cly
  207  00:E98A  80 06        bra .gt_end
  208                     
  209  00:E98C            .gt_must_test_lobyte
  210  00:E98C  22           sax
  211  00:E98D  D2 00        cmp [__stack]
  212  00:E98F  B0 01        bcs .gt_end       ; lobyte of the reg var >= lobyte of the pushed var
  213  00:E991  C2           cly
  214                     
  215  00:E992            .gt_end:
  216                        addw      #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:E992  18                 clc
       00:E993  A5 00              lda    LOW_BYTE <__stack
       00:E995  69 02              adc    LOW_BYTE #2
       00:E997  85 00              sta    LOW_BYTE <__stack
       00:E999  A5 01              lda    HIGH_BYTE <__stack
       00:E99B  69 00              adc    HIGH_BYTE #2
       00:E99D  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  217  00:E99F  98           tya
  218  00:E9A0  3A           dec A
  219  00:E9A1  82           clx
  220  00:E9A2  60           rts
  221                     
  222                     
  223                     ; ----
  224                     ; zero page versions of lt/gt/ult/ugt:
  225                     ; ----
  226                     
  227  00:E9A3            ltzp:   ; signed, zero page
  228  00:E9A3  85 05             sta     <__temp+2
  229  00:E9A5  45 04             eor     <__temp+1
  230  00:E9A7  10 0C             bpl     .geta_ult
  231  00:E9A9  A5 05             lda     <__temp+2
  232  00:E9AB  10 04             bpl     .true
  233  00:E9AD  A9 00     .false: lda     #0
  234  00:E9AF  82                clx
  235  00:E9B0  60                rts
  236  00:E9B1  A9 FF     .true:  lda     #$ff
  237  00:E9B3  82                clx
  238  00:E9B4  60                rts
  239  00:E9B5            .geta_ult:
  240  00:E9B5  A5 05             lda     <__temp+2       ; and fall through to unsigned test
  241                     
  242  00:E9B7  C5 04     ultzp:  cmp     <__temp+1
  243  00:E9B9  F0 06             beq     .test_lo
  244  00:E9BB  90 0B             bcc     .false
  245  00:E9BD  A9 FF     .true:  lda     #$ff
  246  00:E9BF  82                clx
  247  00:E9C0  60                rts
  248  00:E9C1            .test_lo:
  249  00:E9C1  22                sax
  250  00:E9C2  C5 03             cmp     <__temp
  251  00:E9C4  F0 02             beq     .false
  252  00:E9C6  B0 F5             bcs     .true
  253  00:E9C8  A9 00     .false: lda     #0
  254  00:E9CA  82                clx
  255  00:E9CB  60                rts
  256                     ; ----
  257  00:E9CC            gtzp:   ; signed, zero page
  258  00:E9CC  85 05             sta     <__temp+2
  259  00:E9CE  45 04             eor     <__temp+1
  260  00:E9D0  10 0C             bpl     .geta_ugt
  261  00:E9D2  A5 05             lda     <__temp+2
  262  00:E9D4  10 04             bpl     .false
  263  00:E9D6  A9 FF     .true:  lda     #$ff
  264  00:E9D8  82                clx
  265  00:E9D9  60                rts
  266  00:E9DA  A9 00     .false: lda     #0
  267  00:E9DC  82                clx
  268  00:E9DD  60                rts
  269  00:E9DE            .geta_ugt:
  270  00:E9DE  A5 05             lda     <__temp+2       ; and fall through to unsigned test
  271                     
  272  00:E9E0            ugtzp:
  273  00:E9E0  C5 04             cmp     <__temp+1
  274  00:E9E2  F0 06             beq     .test_lo
  275  00:E9E4  B0 0B             bcs     .false
  276  00:E9E6  A9 FF     .true:  lda     #$ff
  277  00:E9E8  82                clx
  278  00:E9E9  60                rts
  279  00:E9EA            .test_lo:
  280  00:E9EA  22                sax
  281  00:E9EB  C5 03             cmp     <__temp
  282  00:E9ED  F0 02             beq     .false
  283  00:E9EF  90 F5             bcc     .true
  284  00:E9F1  A9 00     .false: lda     #0
  285  00:E9F3  82                clx
  286  00:E9F4  60                rts
  287                     
  288                     
  289                     ; ----
  290                     ; ge
  291                     ; ----
  292                     ; compare two signed words
  293                     ; ----
  294                     ; IN :  First word on the C stack
  295                     ;       Another word in A:X
  296                     ; ----
  297                     ; OUT : word A:X is non nul if pushed word is greater or egal to
  298                     ;       the word in A:X else nul
  299                     ; ----
  300                     
  301  00:E9F5            ge:     ; signed version of >
  302  00:E9F5  20 0D E9      jsr lt
  303  00:E9F8  1A            inc A   ; assuming that true is represented by A = 255
  304  00:E9F9  60            rts
  305                     
  306  00:E9FA  20 A3 E9  gezp:   jsr     ltzp
  307  00:E9FD  49 FF             eor     #$ff
  308  00:E9FF  60                rts
  309                     
  310                     ; ----
  311                     ; uge
  312                     ; ----
  313                     ; compare two unsigned signed words
  314                     ; ----
  315                     ; IN :  First word on the C stack
  316                     ;       Another word in A:X
  317                     ; ----
  318                     ; OUT : word A:X is non nul if pushed word is greater or egal to
  319                     ;       the word in A:X else nul
  320                     ; ----
  321                     
  322  00:EA00            uge:    ; unsigned version of >
  323  00:EA00  20 36 E9      jsr ult
  324  00:EA03  1A            inc A   ; assuming that true is represented by A = 255
  325  00:EA04  60            rts
  326                     
  327  00:EA05  20 B7 E9  ugezp:  jsr     ultzp
  328  00:EA08  49 FF             eor     #$ff
  329  00:EA0A  60                rts
  330                     
  331                     ; ----
  332                     ; ne
  333                     ; ----
  334                     ; compare two words
  335                     ; ----
  336                     ; IN :  First word on the C stack
  337                     ;       Another word in A:X
  338                     ; ----
  339                     ; OUT : word A:X is non null if pushed word is different from
  340                     ;       the word in A:X else null
  341                     ; ----
  342                     ; REMARK : signed compatible
  343                     ; ----
  344                     
  345                             ; previous version called 'eq' as subroutine and returned
  346                             ; opposite value; should be fully implemented for speed
  347                             ; since '!=' is such a common operand
  348                     
  349  00:EA0B            ne:
  350  00:EA0B  22           sax
  351  00:EA0C  D2 00        cmp [__stack]
  352  00:EA0E  D0 18        bne .ne_endne
  353                     
  354  00:EA10  A0 01        ldy #1
  355  00:EA12  22           sax
  356  00:EA13  D1 00        cmp [__stack],Y
  357  00:EA15  D0 11        bne .ne_endne
  358                     
  359  00:EA17            .ne_endeq:
  360                        addw #2,<__stack   ; don't push A/X; they are thrown away
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EA17  18                 clc
       00:EA18  A5 00              lda    LOW_BYTE <__stack
       00:EA1A  69 02              adc    LOW_BYTE #2
       00:EA1C  85 00              sta    LOW_BYTE <__stack
       00:EA1E  A5 01              lda    HIGH_BYTE <__stack
       00:EA20  69 00              adc    HIGH_BYTE #2
       00:EA22  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  361  00:EA24  A9 00        lda  #0
  362  00:EA26  82           clx
  363  00:EA27  60           rts
  364                     
  365  00:EA28            .ne_endne:
  366                        addw #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EA28  18                 clc
       00:EA29  A5 00              lda    LOW_BYTE <__stack
       00:EA2B  69 02              adc    LOW_BYTE #2
       00:EA2D  85 00              sta    LOW_BYTE <__stack
       00:EA2F  A5 01              lda    HIGH_BYTE <__stack
       00:EA31  69 00              adc    HIGH_BYTE #2
       00:EA33  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  367  00:EA35  A9 FF        lda  #$ff
  368  00:EA37  82           clx
  369  00:EA38  60           rts
  370                     
  371                     ; streamlined version MACRO - uses zp ( <__temp ) instead of stack
  372                     ; returns A:X = 0 if false, FF00 if true
  373                     ; 15 bytes, best = 12 cycles; worst = 23
  374                     
  375  00:EA39            nezp:
  376  00:EA39  C5 04             cmp   <__temp+1
  377  00:EA3B  D0 09             bne   .x_ne
  378  00:EA3D  22                sax
  379  00:EA3E  C5 03             cmp   <__temp
  380  00:EA40  D0 04             bne   .x_ne
  381  00:EA42  A9 00             lda   #0        ; ensure Z flag set
  382  00:EA44  80 02             bra   .x1_eq
  383  00:EA46            .x_ne:
  384  00:EA46  A9 FF             lda   #$ff      ; ensure Z flag not set
  385  00:EA48            .x1_eq:
  386  00:EA48  82                clx
  387  00:EA49  60                rts
  388                     
  389                     ; ----
  390                     ; le
  391                     ; ----
  392                     ; compare two signed words
  393                     ; ----
  394                     ; IN :  First word on the C stack
  395                     ;       Another word in A:X
  396                     ; ----
  397                     ; OUT : word A:X is non nul if pushed word is lower or egal to
  398                     ;       the word in A:X else nul
  399                     ; ----
  400                     
  401  00:EA4A            le:     ; signed version
  402  00:EA4A  20 58 E9      jsr gt
  403  00:EA4D  1A            inc A       ; assuming that A=255 if true
  404  00:EA4E  60            rts
  405                     
  406  00:EA4F  20 CC E9  lezp:   jsr     gtzp
  407  00:EA52  49 FF             eor     #$ff
  408  00:EA54  60                rts
  409                     
  410                     ; ----
  411                     ; ule
  412                     ; ----
  413                     ; compare two unsigned words
  414                     ; ----
  415                     ; IN :  First word on the C stack
  416                     ;       Another word in A:X
  417                     ; ----
  418                     ; OUT : word A:X is non nul if pushed word is lower or egal to
  419                     ;       the word in A:X else nul
  420                     ; ----
  421                     
  422  00:EA55            ule:    ; unsigned version
  423  00:EA55  20 81 E9      jsr ugt
  424  00:EA58  1A            inc A       ; assuming that A=255 if true
  425  00:EA59  60            rts
  426                     
  427  00:EA5A  20 E0 E9  ulezp:  jsr     ugtzp
  428  00:EA5D  49 FF             eor     #$ff
  429  00:EA5F  60                rts
  430                     
  431                     
  432                     ; ----
  433                     ; asl
  434                     ; ----
  435                     ; shift the pushed word left by the register word
  436                     ; ----
  437                     ; IN :  First word on the C stack
  438                     ;       Another word in A:X
  439                     ; ----
  440                     ; OUT : Register word egals the previous pushed value
  441                     ;       shifted left by A:X
  442                     ; ----
  443                     ; REMARK : only the lower byte of the right operand is taken in account
  444                     ;          signed compatible
  445                     ; ----
  446  00:EA60            asl:
  447  00:EA60  86 03        stx <__temp
  448                        __ldwp __stack
       00:EA62  B2 00              lda    [__stack]
       00:EA64  AA                 tax
       00:EA65  A0 01              ldy    #1
       00:EA67  B1 00              lda    [__stack],Y
  449  00:EA69  A4 03        ldy <__temp
  450  00:EA6B  F0 0C        beq .asl_end
  451  00:EA6D  85 03        sta <__temp
  452  00:EA6F  22           sax
  453                     
  454  00:EA70            .asl_begin
  455  00:EA70  0A           asl a
  456  00:EA71  26 03        rol <__temp
  457  00:EA73  88           dey
  458  00:EA74  D0 FA        bne .asl_begin
  459                     
  460  00:EA76  22           sax
  461  00:EA77  A5 03        lda <__temp
  462  00:EA79            .asl_end
  463  00:EA79  A8           tay
  464                        addw #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EA7A  18                 clc
       00:EA7B  A5 00              lda    LOW_BYTE <__stack
       00:EA7D  69 02              adc    LOW_BYTE #2
       00:EA7F  85 00              sta    LOW_BYTE <__stack
       00:EA81  A5 01              lda    HIGH_BYTE <__stack
       00:EA83  69 00              adc    HIGH_BYTE #2
       00:EA85  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  465  00:EA87  98           tya
  466  00:EA88  60           rts
  467                     
  468                     
  469                     ; ----
  470                     ; asr
  471                     ; ----
  472                     ; shift the pushed word right by the register word
  473                     ; ----
  474                     ; IN :  First word on the C stack
  475                     ;       Another word in A:X
  476                     ; ----
  477                     ; OUT : Register word egals the previous pushed value
  478                     ;       shifted right by A:X
  479                     ; ----
  480                     ; REMARK : only the lower byte of the right operand is taken in account
  481                     ;          signed compatible
  482                     ; ----
  483  00:EA89            asr:
  484  00:EA89  86 03        stx <__temp
  485                        __ldwp __stack
       00:EA8B  B2 00              lda    [__stack]
       00:EA8D  AA                 tax
       00:EA8E  A0 01              ldy    #1
       00:EA90  B1 00              lda    [__stack],Y
  486  00:EA92  A4 03        ldy <__temp
  487  00:EA94  F0 0E        beq .asr_end
  488  00:EA96  85 03        sta <__temp
  489  00:EA98  22           sax
  490                     
  491  00:EA99            .asr_begin
  492  00:EA99  E0 80        cpx #$80
  493  00:EA9B  66 03        ror <__temp
  494  00:EA9D  6A           ror a
  495                     
  496  00:EA9E  88           dey
  497  00:EA9F  D0 F8        bne .asr_begin
  498                     
  499  00:EAA1  22           sax
  500  00:EAA2  A5 03        lda <__temp
  501  00:EAA4            .asr_end
  502  00:EAA4  A8           tay
  503                        addw #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EAA5  18                 clc
       00:EAA6  A5 00              lda    LOW_BYTE <__stack
       00:EAA8  69 02              adc    LOW_BYTE #2
       00:EAAA  85 00              sta    LOW_BYTE <__stack
       00:EAAC  A5 01              lda    HIGH_BYTE <__stack
       00:EAAE  69 00              adc    HIGH_BYTE #2
       00:EAB0  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  504  00:EAB2  98           tya
  505  00:EAB3  60           rts
  506                     
  507                     
  508                     ; ----
  509                     ; smul
  510                     ; ----
  511                     ; multiply two SIGNED words
  512                     ; ----
  513                     ; IN :  First word on the C stack
  514                     ;       Another word in A:X
  515                     ; ----
  516                     ; OUT : Register word egals the previous pushed value
  517                     ;       multiplied by A:X
  518                     ; ----
  519                     
  520  00:EAB4            smul:
  521  00:EAB4  64 16             stz <__sign      ; until we call umul, __sign keeps the sign parity
  522                                             ; of operand
  523  00:EAB6  C9 80             cmp #$80
  524  00:EAB8  90 0D             bcc smul_no_invert_primary
  525                     
  526                             __negw
       00:EABA  22                 sax
       00:EABB  49 FF              eor    #$FF
       00:EABD  18                 clc
       00:EABE  69 01              adc    #1
       00:EAC0  22                 sax
       00:EAC1  49 FF              eor    #$FF
       00:EAC3  69 00              adc    #0
  527                     
  528  00:EAC5  E6 16             inc <__sign      ; __sign ++
  529                     
  530  00:EAC7            smul_no_invert_primary:
  531                     
  532  00:EAC7  85 03             sta <__temp
  533  00:EAC9  A0 01             ldy #1
  534  00:EACB  B1 00             lda [__stack],Y
  535  00:EACD  C9 80             cmp #$80
  536  00:EACF  90 1B             bcc smul_no_invert_secondary
  537                     
  538  00:EAD1  E6 16             inc <__sign      ; this time, no optimisation possible, IMHO :)
  539                                             ; are you sure? :))
  540  00:EAD3  86 04             stx <__temp+1
  541                     
  542  00:EAD5  B2 00             lda [__stack]
  543  00:EAD7  AA                tax
  544  00:EAD8  B1 00             lda [__stack],Y ; we assumed Y = 1 since we set it at the beginning of
  545                                             ; smul_no_invert_primary
  546                             __negw
       00:EADA  22                 sax
       00:EADB  49 FF              eor    #$FF
       00:EADD  18                 clc
       00:EADE  69 01              adc    #1
       00:EAE0  22                 sax
       00:EAE1  49 FF              eor    #$FF
       00:EAE3  69 00              adc    #0
  547  00:EAE5  91 00             sta [__stack],Y
  548  00:EAE7  22                sax
  549  00:EAE8  92 00             sta [__stack]
  550                     
  551  00:EAEA  A6 04             ldx <__temp+1
  552                     
  553  00:EAEC            smul_no_invert_secondary:
  554                     
  555  00:EAEC  A5 16             lda <__sign
  556  00:EAEE  48                pha
  557  00:EAEF  A5 03             lda <__temp      ; saved at the beginning of smul_no_invert_primary
  558                                             ; where we're sure we passed
  559                     
  560  00:EAF1  20 09 EB          jsr umul
  561                     
  562  00:EAF4  42                say
  563  00:EAF5  68                pla
  564  00:EAF6  29 01             and #$01
  565  00:EAF8  F0 0D             beq smul_end
  566                     
  567  00:EAFA  42                say
  568                             __negw
       00:EAFB  22                 sax
       00:EAFC  49 FF              eor    #$FF
       00:EAFE  18                 clc
       00:EAFF  69 01              adc    #1
       00:EB01  22                 sax
       00:EB02  49 FF              eor    #$FF
       00:EB04  69 00              adc    #0
  569  00:EB06  60                rts
  570                     
  571  00:EB07            smul_end:
  572  00:EB07  42                say
  573  00:EB08  60                rts
  574                     
  575                     
  576                     ; ----
  577                     ; umul
  578                     ; ----
  579                     ; multiply two UNSIGNED words
  580                     ; ----
  581                     ; IN :  First word on the C stack
  582                     ;       Another word in A:X
  583                     ; ----
  584                     ; OUT : Register word egals the previous pushed value
  585                     ;       multiplied by A:X
  586                     ; ----
  587                     
  588  00:EB09            umul:
  589                             __stw   <__temp+2 ; bx
       00:EB09  86 05              stx    <__temp+2
       00:EB0B  85 06              sta    <__temp+2+1
  590                             __ldwp  __stack
       00:EB0D  B2 00              lda    [__stack]
       00:EB0F  AA                 tax
       00:EB10  A0 01              ldy    #1
       00:EB12  B1 00              lda    [__stack],Y
  591                             __stw   <__temp   ; ax
       00:EB14  86 03              stx    <__temp
       00:EB16  85 04              sta    <__temp+1
  592  00:EB18  20 2D EB            jsr   umul16
  593                               addw  #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EB1B  18                 clc
       00:EB1C  A5 00              lda    LOW_BYTE <__stack
       00:EB1E  69 02              adc    LOW_BYTE #2
       00:EB20  85 00              sta    LOW_BYTE <__stack
       00:EB22  A5 01              lda    HIGH_BYTE <__stack
       00:EB24  69 00              adc    HIGH_BYTE #2
       00:EB26  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  594                             __ldw   <__ptr
                0000              .if (1 = 2)
                                  .else
       00:EB28  A6 0B              ldx    <__ptr
       00:EB2A  A5 0C              lda    <__ptr+1
                                  .endif
  595  00:EB2C  60                  rts
  596  00:EB2D            umul16:
  597  00:EB2D  A5 06               lda   <__temp+3
  598  00:EB2F  05 04               ora   <__temp+1
  599  00:EB31  F0 21               beq   umul8
  600                               stwz  <__ptr
       00:EB33  64 0B              stz    LOW_BYTE <__ptr
       00:EB35  64 0C              stz    HIGH_BYTE <__ptr
  601  00:EB37  A0 10               ldy   #16
  602                     
  603                     .l1:      aslw  <__ptr
       00:EB39  06 0B              asl    <__ptr              ; word-sized value (at stated
       00:EB3B  26 0C              rol    <__ptr+1            ; memory location)
  604                               aslw  <__temp+2
       00:EB3D  06 05              asl    <__temp+2              ; word-sized value (at stated
       00:EB3F  26 06              rol    <__temp+2+1            ; memory location)
  605  00:EB41  90 0D               bcc   .l2
  606                               addw  <__temp,<__ptr
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EB43  18                 clc
       00:EB44  A5 0B              lda    LOW_BYTE <__ptr
       00:EB46  65 03              adc    LOW_BYTE <__temp
       00:EB48  85 0B              sta    LOW_BYTE <__ptr
       00:EB4A  A5 0C              lda    HIGH_BYTE <__ptr
       00:EB4C  65 04              adc    HIGH_BYTE <__temp
       00:EB4E  85 0C              sta    HIGH_BYTE <__ptr
                                  .endif
  607  00:EB50  88        .l2:      dey
  608  00:EB51  D0 E6               bne   .l1
  609  00:EB53  60                  rts
  610  00:EB54            umul8:
  611  00:EB54  A5 05               lda   <__temp+2
  612  00:EB56  85 0C               sta   <__ptr+1
  613  00:EB58  62                  cla
  614  00:EB59  A0 08               ldy   #8
  615                     
  616  00:EB5B  0A        .l1:      asl   A
  617  00:EB5C  26 0C               rol   <__ptr+1
  618  00:EB5E  90 07               bcc   .l2
  619                               add   <__temp
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:EB60  18                 clc
       00:EB61  65 03              adc    <__temp
                                  .endif
  620  00:EB63  90 02               bcc   .l2
  621  00:EB65  E6 0C               inc   <__ptr+1
  622  00:EB67  88        .l2:      dey
  623  00:EB68  D0 F1               bne   .l1
  624                     
  625  00:EB6A  85 0B               sta   <__ptr
  626  00:EB6C  60                  rts
  627                     
  628                     
  629                     ; ----
  630                     ; sdiv
  631                     ; ----
  632                     ; divide two SIGNED words
  633                     ; ----
  634                     ; IN :  First word on the C stack
  635                     ;       Another word in A:X
  636                     ; ----
  637                     ; OUT : Register word egals the previous pushed value
  638                     ;       divided by A:X
  639                     ; ----
  640                     
  641  00:EB6D            sdiv:
  642  00:EB6D  64 16             stz <__sign      ; until we call udiv, __sign keeps the sign parity
  643                                             ; of operand
  644  00:EB6F  C9 80             cmp #$80
  645  00:EB71  90 0D             bcc sdiv_no_invert_primary
  646                     
  647                             __negw
       00:EB73  22                 sax
       00:EB74  49 FF              eor    #$FF
       00:EB76  18                 clc
       00:EB77  69 01              adc    #1
       00:EB79  22                 sax
       00:EB7A  49 FF              eor    #$FF
       00:EB7C  69 00              adc    #0
  648                     
  649  00:EB7E  E6 16             inc <__sign      ; __sign ++
  650                     
  651  00:EB80            sdiv_no_invert_primary:
  652                     
  653  00:EB80  85 03             sta <__temp
  654  00:EB82  A0 01             ldy #1
  655  00:EB84  B1 00             lda [__stack],Y
  656  00:EB86  C9 80             cmp #$80
  657  00:EB88  90 1B             bcc sdiv_no_invert_secondary
  658                     
  659  00:EB8A  E6 16             inc <__sign
  660                     
  661  00:EB8C  86 04             stx <__temp+1
  662                     
  663  00:EB8E  B2 00             lda [__stack]
  664  00:EB90  AA                tax
  665  00:EB91  B1 00             lda [__stack],Y ; we assumed Y = 1 since we set it at the beginning of
  666                                             ; sdiv_no_invert_primary
  667                             __negw
       00:EB93  22                 sax
       00:EB94  49 FF              eor    #$FF
       00:EB96  18                 clc
       00:EB97  69 01              adc    #1
       00:EB99  22                 sax
       00:EB9A  49 FF              eor    #$FF
       00:EB9C  69 00              adc    #0
  668  00:EB9E  91 00             sta [__stack],Y
  669  00:EBA0  22                sax
  670  00:EBA1  92 00             sta [__stack]
  671                     
  672  00:EBA3  A6 04             ldx <__temp+1
  673                     
  674  00:EBA5            sdiv_no_invert_secondary:
  675                     
  676  00:EBA5  A5 16             lda <__sign
  677  00:EBA7  48                pha
  678  00:EBA8  A5 03             lda <__temp      ; saved at the beginning of sdiv_no_invert_primary
  679                                             ; where we're sure we passed
  680  00:EBAA  20 C2 EB          jsr udiv
  681                     
  682  00:EBAD  42                say
  683  00:EBAE  68                pla
  684  00:EBAF  29 01             and #$01
  685  00:EBB1  F0 0D             beq sdiv_end
  686                     
  687  00:EBB3  42                say
  688                             __negw
       00:EBB4  22                 sax
       00:EBB5  49 FF              eor    #$FF
       00:EBB7  18                 clc
       00:EBB8  69 01              adc    #1
       00:EBBA  22                 sax
       00:EBBB  49 FF              eor    #$FF
       00:EBBD  69 00              adc    #0
  689  00:EBBF  60                rts
  690                     
  691  00:EBC0            sdiv_end:
  692  00:EBC0  42                say
  693  00:EBC1  60                rts
  694                     
  695                     
  696                     ; ----
  697                     ; udiv
  698                     ; ----
  699                     ; divide two UNSIGNED words
  700                     ; ----
  701                     ; IN :  First word on the C stack
  702                     ;       Another word in A:X
  703                     ; ----
  704                     ; OUT : Register word egals the previous pushed value
  705                     ;       divided by A:X
  706                     ; ----
  707                     
  708  00:EBC2            udiv:
  709                             __stw   <__ptr
       00:EBC2  86 0B              stx    <__ptr
       00:EBC4  85 0C              sta    <__ptr+1
  710                             __ldwp  __stack
       00:EBC6  B2 00              lda    [__stack]
       00:EBC8  AA                 tax
       00:EBC9  A0 01              ldy    #1
       00:EBCB  B1 00              lda    [__stack],Y
  711                             __stw   <__temp
       00:EBCD  86 03              stx    <__temp
       00:EBCF  85 04              sta    <__temp+1
  712                     
  713  00:EBD1  A9 00             lda     #0
  714  00:EBD3  85 17             sta     <__remain+1
  715  00:EBD5  A0 10             ldy     #16
  716  00:EBD7  06 03     .sdiv_begin:    asl     <__temp
  717  00:EBD9  26 04             rol     <__temp+1
  718  00:EBDB  2A                rol     a
  719  00:EBDC  26 17             rol     <__remain+1
  720  00:EBDE  48                pha
  721  00:EBDF  C5 0B             cmp     <__ptr
  722  00:EBE1  A5 17             lda     <__remain+1
  723  00:EBE3  E5 0C             sbc     <__ptr+1
  724  00:EBE5  90 08             bcc     .sdiv_end
  725  00:EBE7  85 17             sta     <__remain+1
  726  00:EBE9  68                pla
  727  00:EBEA  E5 0B             sbc     <__ptr
  728  00:EBEC  48                pha
  729  00:EBED  E6 03             inc     <__temp
  730  00:EBEF  68        .sdiv_end:      pla
  731  00:EBF0  88                dey
  732  00:EBF1  D0 E4             bne     .sdiv_begin
  733  00:EBF3  85 16             sta     <__remain
  734                     
  735                             addw  #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EBF5  18                 clc
       00:EBF6  A5 00              lda    LOW_BYTE <__stack
       00:EBF8  69 02              adc    LOW_BYTE #2
       00:EBFA  85 00              sta    LOW_BYTE <__stack
       00:EBFC  A5 01              lda    HIGH_BYTE <__stack
       00:EBFE  69 00              adc    HIGH_BYTE #2
       00:EC00  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  736                             __ldw <__temp
                0000              .if (1 = 2)
                                  .else
       00:EC02  A6 03              ldx    <__temp
       00:EC04  A5 04              lda    <__temp+1
                                  .endif
  737                     
  738  00:EC06  60                rts
  739                     
  740                     
  741                     ; ----
  742                     ; smod
  743                     ; ----
  744                     ; give the integer remainder of the two words
  745                     ; ----
  746                     ; IN :  First word on the C stack
  747                     ;       Another word in A:X
  748                     ; ----
  749                     ; OUT : Register word egals the remainder of the division of the
  750                     ;       pushed value by A:X
  751                     ; ----
  752                     ; REMARK : signed NON compatible
  753                     ; ----
  754                     
  755  00:EC07            smod:
  756  00:EC07            umod:
  757                             __stw   <__ptr
       00:EC07  86 0B              stx    <__ptr
       00:EC09  85 0C              sta    <__ptr+1
  758                             __ldwp  __stack
       00:EC0B  B2 00              lda    [__stack]
       00:EC0D  AA                 tax
       00:EC0E  A0 01              ldy    #1
       00:EC10  B1 00              lda    [__stack],Y
  759                             __stw   <__temp
       00:EC12  86 03              stx    <__temp
       00:EC14  85 04              sta    <__temp+1
  760                     
  761  00:EC16  A9 00             lda     #0
  762  00:EC18  85 17             sta     <__remain+1
  763  00:EC1A  A0 10             ldy     #16
  764  00:EC1C  06 03     .smod_begin:    asl     <__temp
  765  00:EC1E  26 04             rol     <__temp+1
  766  00:EC20  2A                rol     a
  767  00:EC21  26 17             rol     <__remain+1
  768  00:EC23  48                pha
  769  00:EC24  C5 0B             cmp     <__ptr
  770  00:EC26  A5 17             lda     <__remain+1
  771  00:EC28  E5 0C             sbc     <__ptr+1
  772  00:EC2A  90 08             bcc     .smod_end
  773  00:EC2C  85 17             sta     <__remain+1
  774  00:EC2E  68                pla
  775  00:EC2F  E5 0B             sbc     <__ptr
  776  00:EC31  48                pha
  777  00:EC32  E6 03             inc     <__temp
  778  00:EC34  68        .smod_end:      pla
  779  00:EC35  88                dey
  780  00:EC36  D0 E4             bne     .smod_begin
  781  00:EC38  85 16             sta     <__remain
  782                     
  783                             addw  #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EC3A  18                 clc
       00:EC3B  A5 00              lda    LOW_BYTE <__stack
       00:EC3D  69 02              adc    LOW_BYTE #2
       00:EC3F  85 00              sta    LOW_BYTE <__stack
       00:EC41  A5 01              lda    HIGH_BYTE <__stack
       00:EC43  69 00              adc    HIGH_BYTE #2
       00:EC45  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  784                             __ldw <__remain
                0000              .if (1 = 2)
                                  .else
       00:EC47  A6 16              ldx    <__remain
       00:EC49  A5 17              lda    <__remain+1
                                  .endif
  785                     
  786  00:EC4B  60                rts
  787                     
  788                     ; ----
  789                     ; ___case
  790                     ; ----
  791                     ; implement a switch instruction in C
  792                     ; ----
  793                     ; IN :  primary register (A:X) contain the discriminant value
  794                     ;       i.e. the one that will be checked against those indicated in the
  795                     ;       various case instructions
  796                     ;       On the stack, a pointer is passed
  797                     ;       This is a pointer toward an array
  798                     ;       Each item of this array is a 4 bytes long structure
  799                     ;       The structure is the following :
  800                     ;         WORD value_to_check
  801                     ;         WORD label_to_jump_to
  802                     ;       We have to parse the whole array in order to compare the primary
  803                     ;       register with all the 'value_to_check' field. If we ever find that
  804                     ;       the primary register is egal to such a value, we must jump to the
  805                     ;       corresponding 'label_to_jump_to'.
  806                     ;       The default value (which also means that we reached the end of the
  807                     ;       array) can be recognized with its 'label_to_jump_to' field set to 0.
  808                     ;       Then the 'value_to_check' field become the default label we have to
  809                     ;       use for the rest of the execution.
  810                     ; ----
  811                     ; OUT : The execution goes to another place
  812                     ; ----
  813                     ; REMARK : Also use __remain variable as a temporary value
  814                     ; ----
  815  00:EC4C            ___case:
  816                       __stw <__remain ; store the value to check to
       00:EC4C  86 16              stx    <__remain
       00:EC4E  85 17              sta    <__remain+1
  817                       __ldwp __stack
       00:EC50  B2 00              lda    [__stack]
       00:EC52  AA                 tax
       00:EC53  A0 01              ldy    #1
       00:EC55  B1 00              lda    [__stack],Y
  818                       __stw <__ptr ; __ptr contain the address of the array
       00:EC57  86 0B              stx    <__ptr
       00:EC59  85 0C              sta    <__ptr+1
  819                     
  820                       addw #2,<__stack
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EC5B  18                 clc
       00:EC5C  A5 00              lda    LOW_BYTE <__stack
       00:EC5E  69 02              adc    LOW_BYTE #2
       00:EC60  85 00              sta    LOW_BYTE <__stack
       00:EC62  A5 01              lda    HIGH_BYTE <__stack
       00:EC64  69 00              adc    HIGH_BYTE #2
       00:EC66  85 01              sta    HIGH_BYTE <__stack
                                  .endif
  821                     
  822  00:EC68            .begin_case:
  823                       addw #2,<__ptr
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EC68  18                 clc
       00:EC69  A5 0B              lda    LOW_BYTE <__ptr
       00:EC6B  69 02              adc    LOW_BYTE #2
       00:EC6D  85 0B              sta    LOW_BYTE <__ptr
       00:EC6F  A5 0C              lda    HIGH_BYTE <__ptr
       00:EC71  69 00              adc    HIGH_BYTE #2
       00:EC73  85 0C              sta    HIGH_BYTE <__ptr
                                  .endif
  824                       __ldwp __ptr
       00:EC75  B2 0B              lda    [__ptr]
       00:EC77  AA                 tax
       00:EC78  A0 01              ldy    #1
       00:EC7A  B1 0B              lda    [__ptr],Y
  825                       __tstw
                                   ; pha
       00:EC7C  86 03              stx    <__temp
       00:EC7E  05 03              ora    <__temp
                                   ; pla
  826                       __lbeq .end_case_default
       00:EC80  D0 03              bne    .x00221
       00:EC82  4C E8 EC           jmp    .end_case_default
       00:EC85            .x00221
  827                     
  828                       addw  #-2,<__ptr
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:EC85  18                 clc
       00:EC86  A5 0B              lda    LOW_BYTE <__ptr
       00:EC88  69 FE              adc    LOW_BYTE #-2
       00:EC8A  85 0B              sta    LOW_BYTE <__ptr
       00:EC8C  A5 0C              lda    HIGH_BYTE <__ptr
       00:EC8E  69 FF              adc    HIGH_BYTE #-2
       00:EC90  85 0C              sta    HIGH_BYTE <__ptr
                                  .endif
  829                     
  830                       __ldwp __ptr
       00:EC92  B2 0B              lda    [__ptr]
       00:EC94  AA                 tax
       00:EC95  A0 01              ldy    #1
       00:EC97  B1 0B              lda    [__ptr],Y
  831                     
  832                       __addmi -2,__stack
       00:EC99  48                 pha
       00:EC9A  18                 clc
       00:EC9B  A5 00              lda    <__stack
       00:EC9D  69 FE              adc    #low(-2)
       00:EC9F  85 00              sta    <__stack
       00:ECA1  A5 01              lda    <__stack+1
       00:ECA3  69 FF              adc    #high(-2)
       00:ECA5  85 01              sta    <__stack+1
       00:ECA7  68                 pla
  833                       __stwp __stack
       00:ECA8  22                 sax
       00:ECA9  92 00              sta    [__stack]
       00:ECAB  22                 sax
       00:ECAC  A0 01              ldy    #1
       00:ECAE  91 00              sta    [__stack],Y
  834                     
  835                       addw  #4,<__ptr
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:ECB0  18                 clc
       00:ECB1  A5 0B              lda    LOW_BYTE <__ptr
       00:ECB3  69 04              adc    LOW_BYTE #4
       00:ECB5  85 0B              sta    LOW_BYTE <__ptr
       00:ECB7  A5 0C              lda    HIGH_BYTE <__ptr
       00:ECB9  69 00              adc    HIGH_BYTE #4
       00:ECBB  85 0C              sta    HIGH_BYTE <__ptr
                                  .endif
  836                     
  837                       __ldw <__remain
                0000              .if (1 = 2)
                                  .else
       00:ECBD  A6 16              ldx    <__remain
       00:ECBF  A5 17              lda    <__remain+1
                                  .endif
  838                     
  839  00:ECC1  20 CE E8    jsr eq
  840                       __tstw
                                   ; pha
       00:ECC4  86 03              stx    <__temp
       00:ECC6  05 03              ora    <__temp
                                   ; pla
  841                       __lbeq .begin_case
       00:ECC8  D0 03              bne    .x00229
       00:ECCA  4C 68 EC           jmp    .begin_case
       00:ECCD            .x00229
  842                     
  843                       addw  #-2,<__ptr
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:ECCD  18                 clc
       00:ECCE  A5 0B              lda    LOW_BYTE <__ptr
       00:ECD0  69 FE              adc    LOW_BYTE #-2
       00:ECD2  85 0B              sta    LOW_BYTE <__ptr
       00:ECD4  A5 0C              lda    HIGH_BYTE <__ptr
       00:ECD6  69 FF              adc    HIGH_BYTE #-2
       00:ECD8  85 0C              sta    HIGH_BYTE <__ptr
                                  .endif
  844                       __ldwp __ptr
       00:ECDA  B2 0B              lda    [__ptr]
       00:ECDC  AA                 tax
       00:ECDD  A0 01              ldy    #1
       00:ECDF  B1 0B              lda    [__ptr],Y
  845                       __stw <__temp
       00:ECE1  86 03              stx    <__temp
       00:ECE3  85 04              sta    <__temp+1
  846                     
  847  00:ECE5  6C 03 20    jmp [__temp]
  848                     
  849  00:ECE8            .end_case_default:      ; if we haven't found any corresponding value
  850                                             ; then we jump to the default supplied label
  851                     
  852                       addw   #-2,<__ptr
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:ECE8  18                 clc
       00:ECE9  A5 0B              lda    LOW_BYTE <__ptr
       00:ECEB  69 FE              adc    LOW_BYTE #-2
       00:ECED  85 0B              sta    LOW_BYTE <__ptr
       00:ECEF  A5 0C              lda    HIGH_BYTE <__ptr
       00:ECF1  69 FF              adc    HIGH_BYTE #-2
       00:ECF3  85 0C              sta    HIGH_BYTE <__ptr
                                  .endif
  853                       __ldwp __ptr
       00:ECF5  B2 0B              lda    [__ptr]
       00:ECF7  AA                 tax
       00:ECF8  A0 01              ldy    #1
       00:ECFA  B1 0B              lda    [__ptr],Y
  854                       __stw <__temp
       00:ECFC  86 03              stx    <__temp
       00:ECFE  85 04              sta    <__temp+1
  855                     
  856  00:ED00  6C 03 20    jmp [__temp]
  857                     
  858                     
  859                     ; ----
  860                     ; hook
  861                     ; ----
  862                     ; indirect call to sub-routine
  863                     ; ----
  864                     ; IN :  sub-routine addr in __ptr
  865                     ; ----
  866                     
  867  00:ED03            hook:
  868  00:ED03  6C 0B 20          jmp     [__ptr]
  869                     
  870                     ; ----
  871                     ; setvdc
  872                     ; ----
  873                     ; set a vdc register
  874                     ; ----
  875                     ; IN : - reg index on the C stack
  876                     ;      - value in A:X
  877                     ; ----
  878                     
  879  00:ED06            setvdc:
  880  00:ED06  A8                tay
  881  00:ED07  B2 00             lda     [__sp]
  882  00:ED09  4A                lsr     A
  883                             ; --
  884  00:ED0A  C9 09             cmp     #$09
  885  00:ED0C  F0 2E             beq     .l3
  886  00:ED0E  C9 0A             cmp     #$0A
  887                             blo     .l1
       00:ED10  90 04              bcc    .l1
  888  00:ED12  C9 0F             cmp     #$0F
  889                             blo     .l2
       00:ED14  90 18              bcc    .l2
  890                             ; --
  891  00:ED16  85 F7     .l1:    sta     <vdc_reg
  892  00:ED18  8D 00 00          sta     video_reg
  893  00:ED1B  8E 02 00          stx     video_data_l
  894  00:ED1E  8C 03 00          sty     video_data_h
  895                             ; --
  896  00:ED21  C9 02             cmp     #$02
  897  00:ED23  F0 09             beq     .l2
  898                             ; --
  899  00:ED25  0A                asl     A
  900  00:ED26  22                sax
  901  00:ED27  9D 47 27          sta     _vdc,X
  902  00:ED2A  98                tya
  903  00:ED2B  9D 48 27          sta     _vdc+1,X
  904                     .l2:    addw    #2,<__sp
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:ED2E  18                 clc
       00:ED2F  A5 00              lda    LOW_BYTE <__sp
       00:ED31  69 02              adc    LOW_BYTE #2
       00:ED33  85 00              sta    LOW_BYTE <__sp
       00:ED35  A5 01              lda    HIGH_BYTE <__sp
       00:ED37  69 00              adc    HIGH_BYTE #2
       00:ED39  85 01              sta    HIGH_BYTE <__sp
                                  .endif
  905  00:ED3B  60                rts     
  906                             ; -- reg $09
  907  00:ED3C  8A        .l3:    txa
  908  00:ED3D  29 70             and     #$70
  909  00:ED3F  4A                lsr     A
  910  00:ED40  4A                lsr     A
  911  00:ED41  4A                lsr     A
  912  00:ED42  4A                lsr     A
  913  00:ED43  20 95 E5          jsr     set_bat_size
  914  00:ED46  80 E6             bra     .l2
  915                     
  916                     ; ----
  917                     ; getvdc
  918                     ; ----
  919                     ; get vdc register content
  920                     ; ----
  921                     ; IN : reg index in A:X
  922                     ; ----
  923                     ; OUT: vdc register in A:X
  924                     ; ----
  925                     
  926  00:ED48            getvdc:
  927  00:ED48  E0 04             cpx     #4
  928  00:ED4A  F0 08             beq     .l1
  929                             ; --
  930  00:ED4C  02                sxy
  931  00:ED4D  BE 47 27          ldx     _vdc,Y
  932  00:ED50  B9 48 27          lda     _vdc+1,Y
  933  00:ED53  60                rts     
  934                             ; --
  935  00:ED54  A9 02     .l1:    lda     #2
  936  00:ED56  85 F7             sta     <vdc_reg
  937  00:ED58  8D 00 00          sta     video_reg
  938  00:ED5B  AE 02 00          ldx     video_data_l
  939  00:ED5E  AD 03 00          lda     video_data_h
  940  00:ED61  60                rts
  941                     
#[4]   sup_hes.asm
#[5]   huc_gfx.asm
 1301                             .include "huc_gfx.asm"
    1                     ;
    2                     ; HUC_GFX.ASM  -  HuC Graphic Library
    3                     ;
    4                     
    5                     ; ----
    6                     ; local variables
    7                     
    8           2018                  .zp
    9  --:2018            __spr_ptr   .ds 2
   10  --:201A            __spr_max   .ds 1
   11  --:201B            __spr_flag  .ds 1
   12                     
   13           276F                  .bss
   14  --:276F            _font_base  .ds 2
   15  --:2771            _font_color .ds 2
   16  --:2773            _satb       .ds 512     ; the local SATB
   17                     
   18  --:2973            _gfx_pal    .ds 1
   19                     
   20  --:2974            _line_currx     .ds     2
   21  --:2976            _line_curry     .ds     2
   22  --:2978            _line_deltax    .ds     2
   23  --:297A            _line_deltay    .ds     2
   24  --:297C            _line_error     .ds     2
   25  --:297E            _line_adjust    .ds     2
   26  --:2980            _line_xdir      .ds     1
   27  --:2981            _line_color     .ds     1
   28                     
   29                     
   30                     ; ----
   31                     ; library code
   32                     
   33           ED62               .code
   34                     
   35                     ; cls(int val [dx])
   36                     ; ----
   37                     
   38  00:ED62            _cls:
   39                               stw   _font_base,<_dx
       00:ED62  AD 6F 27           lda    LOW_BYTE _font_base
       00:ED65  85 FE              sta    LOW_BYTE <_dx
       00:ED67  AD 70 27           lda    HIGH_BYTE _font_base
       00:ED6A  85 FF              sta    HIGH_BYTE <_dx
   40  00:ED6C            _cls.1:
   41                               setvwaddr $0
                                   stw  #$0,<_di
       00:ED6C  A9 00              lda    LOW_BYTE #$0
       00:ED6E  85 F0              sta    LOW_BYTE <_di
       00:ED70  A9 00              lda    HIGH_BYTE #$0
       00:ED72  85 F1              sta    HIGH_BYTE <_di
       00:ED74  20 A5 E4           jsr  set_write
   42                               ; --
   43  00:ED77  AC D6 26            ldy   bat_height
   44  00:ED7A  AE D4 26  .l2:      ldx   bat_width
   45                               ; --
   46                     .l3:      stw   <_dx,video_data
       00:ED7D  A5 FE              lda    LOW_BYTE <_dx
       00:ED7F  8D 02 00           sta    LOW_BYTE video_data
       00:ED82  A5 FF              lda    HIGH_BYTE <_dx
       00:ED84  8D 03 00           sta    HIGH_BYTE video_data
   47  00:ED87  CA                  dex
   48  00:ED88  D0 F3               bne   .l3
   49  00:ED8A  88                  dey
   50  00:ED8B  D0 ED               bne   .l2
   51  00:ED8D  60                  rts
   52                     
   53                     ; set_font_pal(int pal)
   54                     ; ----
   55                     
   56  00:ED8E            _set_font_pal:
   57  00:ED8E  8A                  txa
   58  00:ED8F  0A                  asl   A
   59  00:ED90  0A                  asl   A
   60  00:ED91  0A                  asl   A
   61  00:ED92  0A                  asl   A
   62  00:ED93  85 03               sta   <__temp
   63  00:ED95  AD 70 27            lda   _font_base+1
   64  00:ED98  29 0F               and   #$0F
   65  00:ED9A  05 03               ora   <__temp
   66  00:ED9C  8D 70 27            sta   _font_base+1
   67  00:ED9F  60                  rts
   68                     
   69                     ; set_font_color(char color, char bg)
   70                     ; ----
   71                     
   72  00:EDA0            _set_font_color.2:
   73  00:EDA0  8A                  txa
   74  00:EDA1  29 0F               and   #$F
   75  00:EDA3  8D 72 27            sta   _font_color+1
   76  00:EDA6  A5 F8               lda   <_al
   77  00:EDA8  29 0F               and   #$F
   78  00:EDAA  8D 71 27            sta   _font_color
   79  00:EDAD  60                  rts
   80                     
   81                     ; set_font_addr(int addr)
   82                     ; ----
   83                     
   84  00:EDAE            _set_font_addr:
   85                               ; --
   86  00:EDAE  8E 6F 27            stx   _font_base
   87  00:EDB1  4A                  lsr   A
   88  00:EDB2  6E 6F 27            ror   _font_base
   89  00:EDB5  4A                  lsr   A
   90  00:EDB6  6E 6F 27            ror   _font_base
   91  00:EDB9  4A                  lsr   A
   92  00:EDBA  6E 6F 27            ror   _font_base
   93  00:EDBD  4A                  lsr   A
   94  00:EDBE  6E 6F 27            ror   _font_base
   95  00:EDC1  85 F8               sta   <_al
   96                               ; --
   97  00:EDC3  AD 70 27            lda   _font_base+1
   98  00:EDC6  29 F0               and   #$F0
   99  00:EDC8  05 F8               ora   <_al
  100  00:EDCA  8D 70 27            sta   _font_base+1
  101  00:EDCD  60                  rts
  102                     
  103                     ; get_font_pal()
  104                     ; ----
  105                     
  106  00:EDCE            _get_font_pal:
  107  00:EDCE  AD 70 27            lda   _font_base+1
  108  00:EDD1  4A                  lsr   A
  109  00:EDD2  4A                  lsr   A
  110  00:EDD3  4A                  lsr   A
  111  00:EDD4  4A                  lsr   A
  112  00:EDD5  82                  clx
  113  00:EDD6  22                  sax
  114  00:EDD7  60                  rts
  115                     
  116                     ; get_font_addr()
  117                     ; ----
  118                     
  119  00:EDD8            _get_font_addr:
  120                               ; --
  121  00:EDD8  AD 70 27            lda   _font_base+1
  122  00:EDDB  85 F8               sta   <_al
  123  00:EDDD  AD 6F 27            lda   _font_base
  124  00:EDE0  0A                  asl   A
  125  00:EDE1  26 F8               rol   <_al
  126  00:EDE3  0A                  asl   A
  127  00:EDE4  26 F8               rol   <_al
  128  00:EDE6  0A                  asl   A
  129  00:EDE7  26 F8               rol   <_al
  130  00:EDE9  0A                  asl   A
  131  00:EDEA  26 F8               rol   <_al
  132  00:EDEC  A6 F8               ldx   <_al
  133  00:EDEE  22                  sax
  134  00:EDEF  60                  rts
  135                     
  136                     ; load_default_font(char num [dl], int addr [di])
  137                     ; ----
  138                     
  139  00:EDF0            _load_default_font:
  140                               ; --
  141  00:EDF0  64 FE               stz   <_dl
  142                     
  143  00:EDF2            _load_default_font.1:
  144                               ; --
  145  00:EDF2  A2 FF               ldx   #$FF
  146  00:EDF4  A9 FF               lda   #$FF
  147  00:EDF6  20 C2 E4            jsr   calc_vram_addr
  148                               incw  <_di
       00:EDF9  E6 F0              inc    <_di              ; value at stated memory
       00:EDFB  D0 02              bne    .x_00243           ; location
       00:EDFD  E6 F1              inc    <_di+1
       00:EDFF            .x_00243:
  149                     
  150  00:EDFF            _load_default_font.2:
  151                               ; --
  152  00:EDFF  A5 F0               lda   <_di
  153  00:EE01  05 F1               ora   <_di+1
  154  00:EE03  D0 09               bne   .l1
  155  00:EE05  20 D8 ED            jsr   _get_font_addr
  156                             __stw   <_di
       00:EE08  86 F0              stx    <_di
       00:EE0A  85 F1              sta    <_di+1
  157  00:EE0C  80 07               bra   .l2
  158                               ; --
  159                     .l1:    __ldw   <_di
                0000              .if (1 = 2)
                                  .else
       00:EE0E  A6 F0              ldx    <_di
       00:EE10  A5 F1              lda    <_di+1
                                  .endif
  160  00:EE12  20 AE ED            jsr   _set_font_addr
  161                               ; --
  162                     .l2:      stb   #FONT_BANK+_bank_base,<_bl
       00:EE15  A9 01              lda    #FONT_BANK+_bank_base
       00:EE17  85 FA              sta    <_bl
  163                               stb   #96,<_cl
       00:EE19  A9 60              lda    #96
       00:EE1B  85 FC              sta    <_cl
  164                               stb   _font_color+1,<_ah
       00:EE1D  AD 72 27           lda    _font_color+1
       00:EE20  85 F9              sta    <_ah
  165  00:EE22  AD 71 27            lda   _font_color
  166  00:EE25  D0 01               bne   .l3
  167  00:EE27  1A                  inc   A
  168  00:EE28  85 F8     .l3:      sta   <_al
  169  00:EE2A  A5 FE               lda   <_dl
  170  00:EE2C  29 03               and   #$03
  171  00:EE2E  0A                  asl   A
  172  00:EE2F  AA                  tax
  173  00:EE30  BD B7 E3            lda   font_table,X
  174  00:EE33  85 EE               sta   <_si
  175  00:EE35  E8                  inx
  176  00:EE36  BD B7 E3            lda   font_table,X
  177  00:EE39  85 EF               sta   <_si+1
  178  00:EE3B  4C 4E E4            jmp   load_font
  179                     
  180                     ; load_font(farptr font [bl:si], char nb [cl], int addr [di])
  181                     ; ----
  182                     
  183  00:EE3E            _load_font.2:
  184                               ; --
  185  00:EE3E  A2 FF               ldx   #$FF
  186  00:EE40  A9 FF               lda   #$FF
  187  00:EE42  20 C2 E4            jsr   calc_vram_addr
  188                               incw  <_di
       00:EE45  E6 F0              inc    <_di              ; value at stated memory
       00:EE47  D0 02              bne    .x_00249           ; location
       00:EE49  E6 F1              inc    <_di+1
       00:EE4B            .x_00249:
  189                     
  190  00:EE4B            _load_font.3:
  191                               ; --
  192  00:EE4B  A5 F0               lda   <_di
  193  00:EE4D  05 F1               ora   <_di+1
  194  00:EE4F  D0 09               bne   .l1
  195  00:EE51  20 D8 ED            jsr   _get_font_addr
  196                             __stw   <_di
       00:EE54  86 F0              stx    <_di
       00:EE56  85 F1              sta    <_di+1
  197  00:EE58  80 07               bra   .l2
  198                               ; --
  199                     .l1:    __ldw   <_di
                0000              .if (1 = 2)
                                  .else
       00:EE5A  A6 F0              ldx    <_di
       00:EE5C  A5 F1              lda    <_di+1
                                  .endif
  200  00:EE5E  20 AE ED            jsr   _set_font_addr
  201                               ; --
  202  00:EE61  A5 FC     .l2:      lda   <_cl
  203  00:EE63  64 FD               stz   <_ch
  204  00:EE65  0A                  asl   A
  205  00:EE66  26 FD               rol   <_ch
  206  00:EE68  0A                  asl   A
  207  00:EE69  26 FD               rol   <_ch
  208  00:EE6B  0A                  asl   A
  209  00:EE6C  26 FD               rol   <_ch
  210  00:EE6E  0A                  asl   A
  211  00:EE6F  26 FD               rol   <_ch
  212  00:EE71  85 FC               sta   <_cl
  213  00:EE73  4C 60 E4            jmp   load_vram
  214                     
  215                     ; put_digit(char digit, int offset)
  216                     ; put_digit(char digit, char x, char y)
  217                     ; ----
  218                     
  219  00:EE76            _put_digit.3:
  220  00:EE76  A4 02               ldy   <__arg_idx
  221                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EE78  88                 dey
       00:EE79  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  222  00:EE7C  20 A3 EE            jsr   _put.xy
  223  00:EE7F  80 05               bra   _put_digit.main
  224  00:EE81            _put_digit.2:
  225  00:EE81  A4 02               ldy   <__arg_idx
  226  00:EE83  20 AA EE            jsr   _put.vram
  227  00:EE86            _put_digit.main:
  228                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EE86  88                 dey
       00:EE87  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  229  00:EE8A  84 02               sty   <__arg_idx
  230  00:EE8C            _put_digit.sub:
  231  00:EE8C  C9 0A               cmp   #10
  232                               blo   .l1
       00:EE8E  90 03              bcc    .l1
  233                               add   #$07
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:EE90  18                 clc
       00:EE91  69 07              adc    #$07
                                  .endif
  234  00:EE93  69 10     .l1:      adc   #$10
  235  00:EE95  6D 6F 27            adc   _font_base
  236  00:EE98  8D 02 00            sta   video_data_l
  237  00:EE9B  62                  cla
  238  00:EE9C  6D 70 27            adc   _font_base+1
  239  00:EE9F  8D 03 00            sta   video_data_h
  240  00:EEA2  60                  rts
  241  00:EEA3            _put.xy:
  242  00:EEA3  22                  sax
  243  00:EEA4  20 C2 E4            jsr   calc_vram_addr
  244  00:EEA7  4C A5 E4            jmp   set_write
  245  00:EEAA            _put.vram:
  246  00:EEAA  64 F7               stz   <vdc_reg
  247  00:EEAC  9C 00 00            stz   video_reg
  248  00:EEAF  8E 02 00            stx   video_data_l
  249  00:EEB2  8D 03 00            sta   video_data_h
  250                               vreg  #$02
       00:EEB5  A9 02              lda    #$02
       00:EEB7  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       00:EEB9  03 02               st0   #$02
                                   .else
                                   .endif
  251  00:EEBB  60                  rts
  252                     
  253                     ; put_char(char character, int offset)
  254                     ; put_char(char character, char x, char y)
  255                     ; ----
  256                     
  257  00:EEBC            _put_char.3:
  258  00:EEBC  A4 02               ldy   <__arg_idx
  259                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EEBE  88                 dey
       00:EEBF  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  260  00:EEC2  20 A3 EE            jsr   _put.xy
  261  00:EEC5  80 05               bra   _put_char.main
  262  00:EEC7            _put_char.2:
  263  00:EEC7  A4 02               ldy   <__arg_idx
  264  00:EEC9  20 AA EE            jsr   _put.vram
  265  00:EECC            _put_char.main:
  266                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EECC  88                 dey
       00:EECD  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  267  00:EED0  84 02               sty   <__arg_idx
  268                               ; --
  269  00:EED2  C9 20               cmp   #32
  270                               bhs   .l1
       00:EED4  B0 03              bcs    .l1
  271  00:EED6  A9 20               lda   #32
  272  00:EED8  38                  sec
  273  00:EED9  E9 20     .l1:      sbc   #32
  274                               add   _font_base
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:EEDB  18                 clc
       00:EEDC  6D 6F 27           adc    _font_base
                                  .endif
  275  00:EEDF  8D 02 00            sta   video_data_l
  276  00:EEE2  62                  cla
  277  00:EEE3  6D 70 27            adc   _font_base+1
  278  00:EEE6  8D 03 00            sta   video_data_h
  279  00:EEE9  60                  rts
  280                     
  281                     ; put_raw(int character, int offset)
  282                     ; put_raw(int character, char x, char y)
  283                     ; ----
  284                     
  285  00:EEEA            _put_raw.3:
  286  00:EEEA  A4 02               ldy   <__arg_idx
  287                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EEEC  88                 dey
       00:EEED  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  288  00:EEF0  20 A3 EE            jsr   _put.xy
  289  00:EEF3  80 05               bra   _put_raw.main
  290  00:EEF5            _put_raw.2:
  291  00:EEF5  A4 02               ldy   <__arg_idx
  292  00:EEF7  20 AA EE            jsr   _put.vram
  293  00:EEFA            _put_raw.main:
  294                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EEFA  88                 dey
       00:EEFB  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  295  00:EEFE  8D 02 00            sta   video_data_l
  296                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EF01  88                 dey
       00:EF02  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  297  00:EF05  8D 03 00            sta   video_data_h
  298  00:EF08  84 02               sty   <__arg_idx
  299  00:EF0A  60                  rts
  300                     
  301                     ; put_number(int number, char n, int offset)
  302                     ; put_number(int number, char n, char x, char y)
  303                     ; ----
  304                     
  305                     
  306                     _put_number.3:  maplibfunc      lib2_put_number.3
       00:EF0B  A8                 tay
       00:EF0C  43 20              tma  #page(lib2_put_number.3)
       00:EF0E  48                 pha
       00:EF0F  A9 01              lda  #bank(lib2_put_number.3)
       00:EF11  53 20              tam  #page(lib2_put_number.3)
       00:EF13  98                 tya
       00:EF14  20 32 AB           jsr  lib2_put_number.3
       00:EF17  A8                 tay
       00:EF18  68                 pla
       00:EF19  53 20              tam  #page(lib2_put_number.3)
       00:EF1B  98                 tya
  307  00:EF1C  60                        rts
  308                     
  309                     _put_number.4:  maplibfunc      lib2_put_number.4
       00:EF1D  A8                 tay
       00:EF1E  43 20              tma  #page(lib2_put_number.4)
       00:EF20  48                 pha
       00:EF21  A9 01              lda  #bank(lib2_put_number.4)
       00:EF23  53 20              tam  #page(lib2_put_number.4)
       00:EF25  98                 tya
       00:EF26  20 27 AB           jsr  lib2_put_number.4
       00:EF29  A8                 tay
       00:EF2A  68                 pla
       00:EF2B  53 20              tam  #page(lib2_put_number.4)
       00:EF2D  98                 tya
  310  00:EF2E  60                        rts
  311                     
  312                     
  313                     ; put_hex(int number, char n, int offset)
  314                     ; put_hex(int number, char n, char x, char y)
  315                     ; ----
  316                     
  317  00:EF2F            _put_hex.4:
  318  00:EF2F  A4 02               ldy   <__arg_idx
  319                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EF31  88                 dey
       00:EF32  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  320  00:EF35  20 A3 EE            jsr   _put.xy
  321  00:EF38  80 05               bra   _put_hex.main
  322  00:EF3A            _put_hex.3:
  323  00:EF3A  A4 02               ldy   <__arg_idx
  324  00:EF3C  20 AA EE            jsr   _put.vram
  325  00:EF3F            _put_hex.main:
  326                             __plb   <_cl,1
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0001              .if (2 = 2)
       00:EF3F  88                 dey
       00:EF40  BE 64 2A           ldx    __arg,Y
       00:EF43  86 FC              stx    <_cl
                                  .else
                                  .endif
  327                             __plw   <_dx
                                   ; (bytes : 9/12, cycles : 16/22)
                          
       00:EF45  88                 dey
       00:EF46  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:EF49  85 FE              sta    <_dx
                                  .else
                                  .endif
       00:EF4B  88                 dey
       00:EF4C  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:EF4F  85 FF              sta    <_dx+1
                                  .endif
  328  00:EF51  84 02               sty   <__arg_idx
  329                               ; --
  330  00:EF53  8A                  txa
  331  00:EF54  F0 12               beq   .l3
  332  00:EF56  E0 05     .l1:      cpx   #5
  333                               blo   .l2
       00:EF58  90 07              bcc    .l2
  334  00:EF5A  62                  cla
  335  00:EF5B  20 8C EE            jsr   _put_digit.sub
  336  00:EF5E  CA                  dex
  337  00:EF5F  80 F5               bra   .l1
  338                               ; --
  339  00:EF61  8A        .l2:      txa
  340  00:EF62  3A                  dec   A
  341  00:EF63  0A                  asl   A
  342  00:EF64  AA                  tax
  343  00:EF65  7C 69 EF            jmp   [.tbl,X]
  344  00:EF68  60        .l3:      rts
  345                               ; --
  346  00:EF69  8A EF     .tbl:    .dw    .h1,.h2,.h3,.h4
       00:EF6B  81 EF     
       00:EF6D  7A EF     
       00:EF6F  71 EF     
  347                               ; --
  348  00:EF71  A5 FF     .h4:      lda   <_dh
  349  00:EF73  4A                  lsr   A
  350  00:EF74  4A                  lsr   A
  351  00:EF75  4A                  lsr   A
  352  00:EF76  4A                  lsr   A
  353  00:EF77  20 8C EE            jsr   _put_digit.sub
  354                               ; --
  355  00:EF7A  A5 FF     .h3:      lda   <_dh
  356  00:EF7C  29 0F               and   #$0F
  357  00:EF7E  20 8C EE            jsr   _put_digit.sub
  358                               ; --
  359  00:EF81  A5 FE     .h2:      lda   <_dl
  360  00:EF83  4A                  lsr   A
  361  00:EF84  4A                  lsr   A
  362  00:EF85  4A                  lsr   A
  363  00:EF86  4A                  lsr   A
  364  00:EF87  20 8C EE            jsr   _put_digit.sub
  365                               ; --
  366  00:EF8A  A5 FE     .h1:      lda   <_dl
  367  00:EF8C  29 0F               and   #$0F
  368  00:EF8E  4C 8C EE            jmp   _put_digit.sub
  369                     
  370                     ; put_string(char *string, int offset)
  371                     ; put_string(char *string, char x, char y)
  372                     ; ----
  373                     
  374  00:EF91            _put_string.3:
  375  00:EF91  A4 02               ldy   <__arg_idx
  376                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       00:EF93  88                 dey
       00:EF94  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
  377  00:EF97  20 A3 EE            jsr   _put.xy
  378  00:EF9A  80 05               bra   _put_string.main
  379  00:EF9C            _put_string.2:
  380  00:EF9C  A4 02               ldy   <__arg_idx
  381  00:EF9E  20 AA EE            jsr   _put.vram
  382  00:EFA1            _put_string.main:
  383                             __plw   <_si
                                   ; (bytes : 9/12, cycles : 16/22)
                          
       00:EFA1  88                 dey
       00:EFA2  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:EFA5  85 EE              sta    <_si
                                  .else
                                  .endif
       00:EFA7  88                 dey
       00:EFA8  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:EFAB  85 EF              sta    <_si+1
                                  .endif
  384  00:EFAD  84 02               sty   <__arg_idx
  385  00:EFAF  80 1D               bra   .l3
  386                               ; --
  387  00:EFB1  C9 20     .l1:      cmp   #32
  388                               bhs   .l2
       00:EFB3  B0 03              bcs    .l2
  389  00:EFB5  A9 20               lda   #32
  390  00:EFB7  38                  sec
  391  00:EFB8  E9 20     .l2:      sbc   #32
  392                               add   _font_base
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:EFBA  18                 clc
       00:EFBB  6D 6F 27           adc    _font_base
                                  .endif
  393  00:EFBE  8D 02 00            sta   video_data_l
  394  00:EFC1  62                  cla
  395  00:EFC2  6D 70 27            adc   _font_base+1
  396  00:EFC5  8D 03 00            sta   video_data_h
  397                               incw  <_si
       00:EFC8  E6 EE              inc    <_si              ; value at stated memory
       00:EFCA  D0 02              bne    .x_00274           ; location
       00:EFCC  E6 EF              inc    <_si+1
       00:EFCE            .x_00274:
  398  00:EFCE  B2 EE     .l3:      lda   [_si]
  399  00:EFD0  D0 DF               bne   .l1
  400  00:EFD2  60                  rts
  401                     
  402                     ; vsync(char nb_frame)
  403                     ; ----
  404                     
  405  00:EFD3            _vsync:
  406  00:EFD3  8A                  txa
  407  00:EFD4  C0 00               cpy   #0
  408  00:EFD6  D0 01               bne   .l1
  409  00:EFD8  62                  cla
  410  00:EFD9  4C C8 FC  .l1:      jmp   wait_vsync
  411                     
  412                     ; vreg(char reg)
  413                     ; ----
  414                     
  415  00:EFDC            _vreg:
  416  00:EFDC  C0 02               cpy   #2
  417  00:EFDE  D0 03               bne   .l1
  418  00:EFE0  4C 06 ED            jmp   setvdc
  419  00:EFE3            .l1:
  420  00:EFE3  86 F7               stx   <vdc_reg
  421  00:EFE5  8E 00 00            stx   video_reg
  422  00:EFE8  60                  rts
  423                     
  424                     ; vram_addr(char x [al], char y)
  425                     ; ----
  426                     
  427  00:EFE9            _vram_addr.2:
  428  00:EFE9  A5 F8               lda   <_al
  429  00:EFEB  22                  sax
  430  00:EFEC  20 C2 E4            jsr   calc_vram_addr
  431                             __ldw   <_di
                0000              .if (1 = 2)
                                  .else
       00:EFEF  A6 F0              ldx    <_di
       00:EFF1  A5 F1              lda    <_di+1
                                  .endif
  432  00:EFF3  60                  rts
  433                     
  434                     ; scan_map_table(int *tbl [si], int *x [ax], int *y [cx])
  435                     ; ----
  436                     ; tbl,
  437                     ; x,
  438                     ; y,
  439                     ; ----
  440                     
  441  00:EFF4            _scan_map_table.3:
  442                     
  443  00:EFF4  A0 01               ldy   #1
  444  00:EFF6  B2 F8               lda   [_ax]
  445  00:EFF8  85 FA               sta   <_bl
  446  00:EFFA  B1 F8               lda   [_ax],Y
  447  00:EFFC  85 FB               sta   <_bh
  448  00:EFFE  B2 FC               lda   [_cx]
  449  00:F000  85 FE               sta   <_dl
  450  00:F002  B1 FC               lda   [_cx],Y
  451  00:F004  85 FF               sta   <_dh
  452                               ; --
  453                               addw  #4,<_si
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F006  18                 clc
       00:F007  A5 EE              lda    LOW_BYTE <_si
       00:F009  69 04              adc    LOW_BYTE #4
       00:F00B  85 EE              sta    LOW_BYTE <_si
       00:F00D  A5 EF              lda    HIGH_BYTE <_si
       00:F00F  69 00              adc    HIGH_BYTE #4
       00:F011  85 EF              sta    HIGH_BYTE <_si
                                  .endif
  454                     
  455                         ; ----
  456                         ; check bounds
  457                         ;
  458                               ; -- bottom
  459  00:F013  A0 07     .l1:      ldy   #7
  460  00:F015  B1 EE               lda   [_si],Y
  461  00:F017  C5 FF               cmp   <_dh
  462                               blo   .x1
       00:F019  90 3B              bcc    .x1
  463  00:F01B  D0 07               bne   .l2
  464  00:F01D  88                  dey
  465  00:F01E  B1 EE               lda   [_si],Y
  466  00:F020  C5 FE               cmp   <_dl
  467                               blo   .x1
       00:F022  90 32              bcc    .x1
  468                               ; -- top
  469  00:F024  A0 03     .l2:      ldy   #3
  470  00:F026  A5 FF               lda   <_dh
  471  00:F028  D1 EE               cmp   [_si],Y
  472                               blo   .x1
       00:F02A  90 2A              bcc    .x1
  473  00:F02C  D0 07               bne   .l3
  474  00:F02E  88                  dey
  475  00:F02F  A5 FE               lda   <_dl
  476  00:F031  D1 EE               cmp   [_si],Y
  477                               blo   .x1
       00:F033  90 21              bcc    .x1
  478                               ; -- right
  479  00:F035  A0 05     .l3:      ldy   #5
  480  00:F037  B1 EE               lda   [_si],Y
  481  00:F039  C5 FB               cmp   <_bh
  482                               blo   .x1
       00:F03B  90 19              bcc    .x1
  483  00:F03D  D0 07               bne   .l4
  484  00:F03F  88                  dey
  485  00:F040  B1 EE               lda   [_si],Y
  486  00:F042  C5 FA               cmp   <_bl
  487                               blo   .x1
       00:F044  90 10              bcc    .x1
  488                               ; -- left
  489  00:F046  A0 01     .l4:      ldy   #1
  490  00:F048  A5 FB               lda   <_bh
  491  00:F04A  D1 EE               cmp   [_si],Y
  492                               blo   .x1
       00:F04C  90 08              bcc    .x1
  493  00:F04E  D0 20               bne   .x2
  494  00:F050  A5 FA               lda   <_bl
  495  00:F052  D2 EE               cmp   [_si]
  496                               bhs   .x2
       00:F054  B0 1A              bcs    .x2
  497                     
  498                         ; ----
  499                         ; next
  500                         ;
  501                     .x1:      addw  #12,<_si
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F056  18                 clc
       00:F057  A5 EE              lda    LOW_BYTE <_si
       00:F059  69 0C              adc    LOW_BYTE #12
       00:F05B  85 EE              sta    LOW_BYTE <_si
       00:F05D  A5 EF              lda    HIGH_BYTE <_si
       00:F05F  69 00              adc    HIGH_BYTE #12
       00:F061  85 EF              sta    HIGH_BYTE <_si
                                  .endif
  502  00:F063  A0 01               ldy   #1
  503  00:F065  B2 EE               lda   [_si]
  504  00:F067  31 EE               and   [_si],Y
  505  00:F069  C9 FF               cmp   #$FF
  506  00:F06B  D0 A6               bne   .l1
  507                     
  508                         ; ----
  509                         ; didn't find map...
  510                         ;
  511  00:F06D  82                  clx
  512  00:F06E  62                  cla
  513  00:F06F  60                  rts
  514                     
  515                         ; ----
  516                         ; found map!
  517                         ;
  518  00:F070  A0 01     .x2:      ldy   #1
  519  00:F072  A5 FA               lda   <_bl
  520                               sub   [_si]
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F074  38                 sec
       00:F075  F2 EE              sbc    [_si]
                                  .endif
  521  00:F077  92 F8               sta   [_ax]
  522  00:F079  A5 FB               lda   <_bh
  523  00:F07B  F1 EE               sbc   [_si],Y
  524  00:F07D  91 F8               sta   [_ax],Y
  525                               ; --
  526  00:F07F  C8                  iny
  527  00:F080  A5 FE               lda   <_dl
  528                               sub   [_si],Y
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F082  38                 sec
       00:F083  F1 EE              sbc    [_si],Y
                                  .endif
  529  00:F085  92 FC               sta   [_cx]
  530  00:F087  C8                  iny
  531  00:F088  A5 FF               lda   <_dh
  532  00:F08A  F1 EE               sbc   [_si],Y
  533  00:F08C  A0 01               ldy   #1
  534  00:F08E  91 FC               sta   [_cx],Y
  535                               ; --
  536                             __ldw   <_si
                0000              .if (1 = 2)
                                  .else
       00:F090  A6 EE              ldx    <_si
       00:F092  A5 EF              lda    <_si+1
                                  .endif
  537  00:F094  60                  rts
  538                     
  539                     ; set_map_data(int *ptr)
  540                     ; set_map_data(char *map [bl:si], int w [ax], int h)
  541                     ; set_map_data(char *map [bl:si], int w [ax], int h [dx], char wrap)
  542                     ; ----
  543                     ; map,  map base address
  544                     ; w,    map width
  545                     ; h,    map height
  546                     ; wrap, wrap flag (1 = wrap, 0 = do not wrap)
  547                     ; ----
  548                     
  549  00:F095            _set_map_data.1:
  550                             __stw   <_si
       00:F095  86 EE              stx    <_si
       00:F097  85 EF              sta    <_si+1
  551  00:F099  05 EE               ora   <_si
  552  00:F09B  F0 54               beq   .l1
  553                               ; -- calculate width
  554  00:F09D  A0 04 B1            lda   [_si].4
       00:F0A0  EE        
  555                               sub   [_si]
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F0A1  38                 sec
       00:F0A2  F2 EE              sbc    [_si]
                                  .endif
  556  00:F0A4  8D B4 26            sta   mapwidth
  557  00:F0A7  A0 05 B1            lda   [_si].5
       00:F0AA  EE        
  558  00:F0AB  A0 01 F1            sbc   [_si].1
       00:F0AE  EE        
  559  00:F0AF  8D B5 26            sta   mapwidth+1
  560                               incw  mapwidth
       00:F0B2  EE B4 26           inc    mapwidth              ; value at stated memory
       00:F0B5  D0 03              bne    .x_00291           ; location
       00:F0B7  EE B5 26           inc    mapwidth+1
       00:F0BA            .x_00291:
  561                               ; -- calculate height
  562  00:F0BA  A0 06 B1            lda   [_si].6
       00:F0BD  EE        
  563                               sub   [_si].2
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F0BE  38                 sec
       00:F0BF  A0 02 F1           sbc    [_si].2
       00:F0C2  EE        
                                  .endif
  564  00:F0C3  8D B6 26            sta   mapheight
  565  00:F0C6  A0 07 B1            lda   [_si].7
       00:F0C9  EE        
  566  00:F0CA  A0 03 F1            sbc   [_si].3
       00:F0CD  EE        
  567  00:F0CE  8D B7 26            sta   mapheight+1
  568                               incw  mapheight
       00:F0D1  EE B6 26           inc    mapheight              ; value at stated memory
       00:F0D4  D0 03              bne    .x_00293           ; location
       00:F0D6  EE B7 26           inc    mapheight+1
       00:F0D9            .x_00293:
  569                               ; -- get map bank
  570  00:F0D9  A0 08 B1            lda   [_si].8
       00:F0DC  EE        
  571  00:F0DD  8D B1 26            sta   mapbank
  572                               ; -- get map addr
  573  00:F0E0  A0 0A B1            lda   [_si].10
       00:F0E3  EE        
  574  00:F0E4  8D B2 26            sta   mapaddr
  575  00:F0E7  C8                  iny
  576  00:F0E8  B2 EE               lda   [_si]
  577  00:F0EA  8D B3 26            sta   mapaddr+1
  578                               ; -- no wrap
  579  00:F0ED  9C C3 26            stz   mapwrap
  580  00:F0F0  60                  rts
  581                               ; -- null pointer
  582                     .l1:      stwz  mapwidth
       00:F0F1  9C B4 26           stz    LOW_BYTE mapwidth
       00:F0F4  9C B5 26           stz    HIGH_BYTE mapwidth
  583                               stwz  mapheight
       00:F0F7  9C B6 26           stz    LOW_BYTE mapheight
       00:F0FA  9C B7 26           stz    HIGH_BYTE mapheight
  584  00:F0FD  9C B1 26            stz   mapbank
  585                               stwz  mapaddr
       00:F100  9C B2 26           stz    LOW_BYTE mapaddr
       00:F103  9C B3 26           stz    HIGH_BYTE mapaddr
  586  00:F106  9C C3 26            stz   mapwrap
  587  00:F109  60                  rts
  588  00:F10A            _set_map_data.4:
  589  00:F10A  8E C3 26            stx   mapwrap
  590                             __ldw   <_dx
                0000              .if (1 = 2)
                                  .else
       00:F10D  A6 FE              ldx    <_dx
       00:F10F  A5 FF              lda    <_dx+1
                                  .endif
  591  00:F111  80 06               bra   _set_map_data.main
  592  00:F113            _set_map_data.3:
  593  00:F113  9C C3 26            stz   mapwrap
  594  00:F116  EE C3 26            inc   mapwrap
  595  00:F119            _set_map_data.main:
  596                             __stw   mapheight
       00:F119  8E B6 26           stx    mapheight
       00:F11C  8D B7 26           sta    mapheight+1
  597                               stw   <_ax,mapwidth
       00:F11F  A5 F8              lda    LOW_BYTE <_ax
       00:F121  8D B4 26           sta    LOW_BYTE mapwidth
       00:F124  A5 F9              lda    HIGH_BYTE <_ax
       00:F126  8D B5 26           sta    HIGH_BYTE mapwidth
  598                               stb   <_bl,mapbank
       00:F129  A5 FA              lda    <_bl
       00:F12B  8D B1 26           sta    mapbank
  599                               stw   <_si,mapaddr
       00:F12E  A5 EE              lda    LOW_BYTE <_si
       00:F130  8D B2 26           sta    LOW_BYTE mapaddr
       00:F133  A5 EF              lda    HIGH_BYTE <_si
       00:F135  8D B3 26           sta    HIGH_BYTE mapaddr
  600  00:F138  60                  rts
  601                     
  602                     ; get_map_width()
  603                     ; ----
  604                     
  605  00:F139            _get_map_width:
  606                             __ldw   mapwidth
                0000              .if (1 = 2)
                                  .else
       00:F139  AE B4 26           ldx    mapwidth
       00:F13C  AD B5 26           lda    mapwidth+1
                                  .endif
  607  00:F13F  60                  rts
  608                     
  609                     ; get_map_height()
  610                     ; ----
  611                     
  612  00:F140            _get_map_height:
  613                             __ldw   mapheight
                0000              .if (1 = 2)
                                  .else
       00:F140  AE B6 26           ldx    mapheight
       00:F143  AD B7 26           lda    mapheight+1
                                  .endif
  614  00:F146  60                  rts
  615                     
  616                     ; set_tile_data(char *tile_ex [di])
  617                     ; set_tile_data(char *tile [bl:si], int nb_tile [cx], char *ptable [al:dx])
  618                     ; ----
  619                     ; tile,    tile base index
  620                     ; nb_tile, number of tile
  621                     ; ptable,  tile palette table address
  622                     ; ----
  623                     
  624  00:F147            _set_tile_data.1:
  625  00:F147  C2                  cly
  626  00:F148  B1 F0 C8            lda   [_di],Y++
  627  00:F14B  8D BE 26            sta   mapnbtile
  628  00:F14E  B1 F0 C8            lda   [_di],Y++
  629  00:F151  8D BF 26            sta   mapnbtile+1
  630  00:F154  B1 F0 C8            lda   [_di],Y++
  631  00:F157  8D B8 26            sta   maptiletype
  632  00:F15A  C8                  iny
  633  00:F15B  B1 F0 C8            lda   [_di],Y++
  634  00:F15E  8D B9 26            sta   maptilebank
  635  00:F161  C8                  iny
  636  00:F162  B1 F0 C8            lda   [_di],Y++
  637  00:F165  8D BA 26            sta   maptileaddr
  638  00:F168  B1 F0 C8            lda   [_di],Y++
  639  00:F16B  8D BB 26            sta   maptileaddr+1
  640  00:F16E  A9 03               lda   #(CONST_BANK+_bank_base)
  641  00:F170  8D C0 26            sta   mapctablebank
  642  00:F173  B1 F0 C8            lda   [_di],Y++
  643  00:F176  8D C1 26            sta   mapctable
  644  00:F179  B1 F0               lda   [_di],Y
  645  00:F17B  8D C2 26            sta   mapctable+1
  646  00:F17E  60                  rts
  647  00:F17F            _set_tile_data.3:
  648                               stb   <_bl,maptilebank
       00:F17F  A5 FA              lda    <_bl
       00:F181  8D B9 26           sta    maptilebank
  649                               stw   <_si,maptileaddr
       00:F184  A5 EE              lda    LOW_BYTE <_si
       00:F186  8D BA 26           sta    LOW_BYTE maptileaddr
       00:F189  A5 EF              lda    HIGH_BYTE <_si
       00:F18B  8D BB 26           sta    HIGH_BYTE maptileaddr
  650                               stw   <_cx,mapnbtile
       00:F18E  A5 FC              lda    LOW_BYTE <_cx
       00:F190  8D BE 26           sta    LOW_BYTE mapnbtile
       00:F193  A5 FD              lda    HIGH_BYTE <_cx
       00:F195  8D BF 26           sta    HIGH_BYTE mapnbtile
  651                               stb   <_al,mapctablebank
       00:F198  A5 F8              lda    <_al
       00:F19A  8D C0 26           sta    mapctablebank
  652                               stw   <_dx,mapctable
       00:F19D  A5 FE              lda    LOW_BYTE <_dx
       00:F19F  8D C1 26           sta    LOW_BYTE mapctable
       00:F1A2  A5 FF              lda    HIGH_BYTE <_dx
       00:F1A4  8D C2 26           sta    HIGH_BYTE mapctable
  653                               ; --
  654  00:F1A7  A4 FA               ldy   <_bl            ; get tile format (8x8 or 16x16)
  655  00:F1A9  A5 EF               lda   <_si+1
  656  00:F1AB  29 1F               and   #$1F
  657  00:F1AD  AA                  tax
  658  00:F1AE  A5 EE               lda   <_si
  659  00:F1B0  D0 08               bne   .l2
  660  00:F1B2  E0 00               cpx   #$0
  661  00:F1B4  D0 03               bne   .l1
  662  00:F1B6  88                  dey
  663  00:F1B7  A2 20               ldx   #$20
  664  00:F1B9  CA        .l1:      dex
  665  00:F1BA  3A        .l2:      dec   A
  666  00:F1BB  8A                  txa
  667  00:F1BC  09 60               ora   #$60
  668  00:F1BE  85 EF               sta   <_si+1
  669  00:F1C0  98                  tya
  670  00:F1C1  53 08               tam   #3
  671  00:F1C3  B2 EE               lda   [_si]
  672  00:F1C5  8D B8 26            sta   maptiletype
  673  00:F1C8  60                  rts
  674                     
  675                     ; load_tile(int addr)
  676                     ; ----
  677                     
  678  00:F1C9            _load_tile:
  679                             __stw   <_di
       00:F1C9  86 F0              stx    <_di
       00:F1CB  85 F1              sta    <_di+1
  680  00:F1CD  86 F8               stx   <_al
  681  00:F1CF  4A                  lsr   A
  682  00:F1D0  66 F8               ror   <_al
  683  00:F1D2  4A                  lsr   A
  684  00:F1D3  66 F8               ror   <_al
  685  00:F1D5  4A                  lsr   A
  686  00:F1D6  66 F8               ror   <_al
  687  00:F1D8  4A                  lsr   A
  688  00:F1D9  66 F8               ror   <_al
  689  00:F1DB  8D BD 26            sta        maptilebase+1
  690                               stb   <_al,maptilebase
       00:F1DE  A5 F8              lda    <_al
       00:F1E0  8D BC 26           sta    maptilebase
  691                               ; --
  692                               stw   mapnbtile,<_cx
       00:F1E3  AD BE 26           lda    LOW_BYTE mapnbtile
       00:F1E6  85 FC              sta    LOW_BYTE <_cx
       00:F1E8  AD BF 26           lda    HIGH_BYTE mapnbtile
       00:F1EB  85 FD              sta    HIGH_BYTE <_cx
  693  00:F1ED  A2 04               ldx   #4
  694  00:F1EF  AD B8 26            lda   maptiletype
  695  00:F1F2  C9 08               cmp   #8
  696  00:F1F4  F0 02               beq   .l1
  697  00:F1F6  A2 06               ldx   #6
  698  00:F1F8  06 FC     .l1:      asl   <_cl
  699  00:F1FA  26 FD               rol   <_ch
  700  00:F1FC  CA                  dex
  701  00:F1FD  D0 F9               bne   .l1
  702                               ; --
  703                               stb   maptilebank,<_bl
       00:F1FF  AD B9 26           lda    maptilebank
       00:F202  85 FA              sta    <_bl
  704                               stw   maptileaddr,<_si
       00:F204  AD BA 26           lda    LOW_BYTE maptileaddr
       00:F207  85 EE              sta    LOW_BYTE <_si
       00:F209  AD BB 26           lda    HIGH_BYTE maptileaddr
       00:F20C  85 EF              sta    HIGH_BYTE <_si
  705  00:F20E  4C 60 E4            jmp   load_vram
  706                     
  707                     ; load_map(char x [al], char y [ah], int mx, int my, char w [dl], char h [dh])
  708                     ; ----
  709                     
  710  00:F211            _load_map.6:
  711                     
  712                               tstw  mapwidth
       00:F211  AD B4 26           lda   mapwidth               ; value at stated memory
       00:F214  0D B5 26           ora   mapwidth+1             ; location is zero
  713                               lbeq  .l6
       00:F217  D0 03              bne    .x_00315
       00:F219  4C B3 F2           jmp    .l6
       00:F21C            .x_00315
  714                               tstw  mapheight
       00:F21C  AD B6 26           lda   mapheight               ; value at stated memory
       00:F21F  0D B7 26           ora   mapheight+1             ; location is zero
  715                               lbeq  .l6
       00:F222  D0 03              bne    .x_00317
       00:F224  4C B3 F2           jmp    .l6
       00:F227            .x_00317
  716                     
  717                         ; ----
  718                         ; adjust map y coordinate
  719                         ;
  720  00:F227  A4 02               ldy   <__arg_idx
  721                             __plw   <_bx
                                   ; (bytes : 9/12, cycles : 16/22)
                          
       00:F229  88                 dey
       00:F22A  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:F22D  85 FA              sta    <_bx
                                  .else
                                  .endif
       00:F22F  88                 dey
       00:F230  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:F233  85 FB              sta    <_bx+1
                                  .endif
  722  00:F235  30 1F               bmi   .l2
  723                     .l1:      cmpw  mapheight,<_bx
       00:F237  A5 FB              lda    HIGH_BYTE <_bx
       00:F239  CD B7 26           cmp    HIGH_BYTE mapheight
       00:F23C  D0 05              bne    .x_00319
       00:F23E  A5 FA              lda    LOW_BYTE <_bx
       00:F240  CD B6 26           cmp    LOW_BYTE mapheight
       00:F243            .x_00319:
  724                               blo   .l3
       00:F243  90 26              bcc    .l3
  725                               subw  mapheight,<_bx
       00:F245  38                 sec
       00:F246  A5 FA              lda    LOW_BYTE <_bx
       00:F248  ED B6 26           sbc    LOW_BYTE mapheight
       00:F24B  85 FA              sta    LOW_BYTE <_bx
       00:F24D  A5 FB              lda    HIGH_BYTE <_bx
       00:F24F  ED B7 26           sbc    HIGH_BYTE mapheight
       00:F252  85 FB              sta    HIGH_BYTE <_bx
  726  00:F254  80 E1               bra   .l1
  727                               ; --
  728  00:F256  A5 FB     .l2:      lda   <_bh
  729  00:F258  10 11               bpl   .l3
  730                               addw  mapheight,<_bx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F25A  18                 clc
       00:F25B  A5 FA              lda    LOW_BYTE <_bx
       00:F25D  6D B6 26           adc    LOW_BYTE mapheight
       00:F260  85 FA              sta    LOW_BYTE <_bx
       00:F262  A5 FB              lda    HIGH_BYTE <_bx
       00:F264  6D B7 26           adc    HIGH_BYTE mapheight
       00:F267  85 FB              sta    HIGH_BYTE <_bx
                                  .endif
  731  00:F269  80 EB               bra   .l2
  732                               
  733                         ; ----
  734                         ; adjust map x coordinate
  735                         ;
  736                     .l3:      stb   <_bl,<_ch
       00:F26B  A5 FA              lda    <_bl
       00:F26D  85 FD              sta    <_ch
  737                             __plw   <_bx
                                   ; (bytes : 9/12, cycles : 16/22)
                          
       00:F26F  88                 dey
       00:F270  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:F273  85 FA              sta    <_bx
                                  .else
                                  .endif
       00:F275  88                 dey
       00:F276  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       00:F279  85 FB              sta    <_bx+1
                                  .endif
  738  00:F27B  84 02               sty   <__arg_idx
  739  00:F27D  30 1F               bmi   .l5
  740                     .l4:      cmpw  mapwidth,<_bx
       00:F27F  A5 FB              lda    HIGH_BYTE <_bx
       00:F281  CD B5 26           cmp    HIGH_BYTE mapwidth
       00:F284  D0 05              bne    .x_00325
       00:F286  A5 FA              lda    LOW_BYTE <_bx
       00:F288  CD B4 26           cmp    LOW_BYTE mapwidth
       00:F28B            .x_00325:
  741                               blo   .l7
       00:F28B  90 2E              bcc    .l7
  742                               subw  mapwidth,<_bx
       00:F28D  38                 sec
       00:F28E  A5 FA              lda    LOW_BYTE <_bx
       00:F290  ED B4 26           sbc    LOW_BYTE mapwidth
       00:F293  85 FA              sta    LOW_BYTE <_bx
       00:F295  A5 FB              lda    HIGH_BYTE <_bx
       00:F297  ED B5 26           sbc    HIGH_BYTE mapwidth
       00:F29A  85 FB              sta    HIGH_BYTE <_bx
  743  00:F29C  80 E1               bra   .l4
  744                               ; --
  745  00:F29E  A5 FB     .l5:      lda   <_bh
  746  00:F2A0  10 19               bpl   .l7
  747                               addw  mapwidth,<_bx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F2A2  18                 clc
       00:F2A3  A5 FA              lda    LOW_BYTE <_bx
       00:F2A5  6D B4 26           adc    LOW_BYTE mapwidth
       00:F2A8  85 FA              sta    LOW_BYTE <_bx
       00:F2AA  A5 FB              lda    HIGH_BYTE <_bx
       00:F2AC  6D B5 26           adc    HIGH_BYTE mapwidth
       00:F2AF  85 FB              sta    HIGH_BYTE <_bx
                                  .endif
  748  00:F2B1  80 EB               bra   .l5
  749                     
  750                         ; ----
  751                         ; exit
  752                         ;
  753                     .l6:      sub   #4,<__arg_idx
                0001              .if (2 = 2)            ; from register A (handle
       00:F2B3  A5 02              lda    <__arg_idx              ; carry flag)
       00:F2B5  38                 sec
       00:F2B6  E9 04              sbc    #4
       00:F2B8  85 02              sta    <__arg_idx
                                  .else
                                  .endif
  754  00:F2BA  60                  rts
  755                     
  756                         ; ----
  757                         ; ok
  758                         ;
  759                     .l7:      stb   <_bl,<_cl
       00:F2BB  A5 FA              lda    <_bl
       00:F2BD  85 FC              sta    <_cl
  760  00:F2BF  4C 23 E4            jmp   load_map
  761                     
  762                     ; spr_set(char num)
  763                     ; ----
  764                     ; load SI with the offset of the sprite to change
  765                     ; SI = satb + 8 * sprite_number
  766                     ; ----
  767                     
  768  00:F2C2            _spr_set:
  769  00:F2C2  E0 40               cpx   #64
  770                               bhs   .l2
       00:F2C4  B0 19              bcs    .l2
  771  00:F2C6  8A                  txa
  772  00:F2C7  E8                  inx
  773  00:F2C8  E4 1A               cpx   <__spr_max
  774                               blo   .l1
       00:F2CA  90 02              bcc    .l1
  775  00:F2CC  86 1A               stx   <__spr_max
  776                               ; --
  777  00:F2CE  64 19     .l1:      stz   <__spr_ptr+1
  778  00:F2D0  0A                  asl   A
  779  00:F2D1  0A                  asl   A
  780  00:F2D2  0A                  asl   A
  781  00:F2D3  26 19               rol   <__spr_ptr+1
  782  00:F2D5  69 73               adc   #low(_satb)
  783  00:F2D7  85 18               sta   <__spr_ptr
  784  00:F2D9  A5 19               lda   <__spr_ptr+1
  785  00:F2DB  69 27               adc   #high(_satb)
  786  00:F2DD  85 19               sta   <__spr_ptr+1
  787  00:F2DF  60        .l2:      rts
  788                     
  789                     ; spr_hide(char num)
  790                     ; ----
  791                     
  792  00:F2E0            _spr_hide:
  793  00:F2E0  C0 00               cpy   #0
  794  00:F2E2  F0 0E               beq   .l2
  795                               ; -- hide sprite number #
  796  00:F2E4  E0 40               cpx   #64
  797                               bhs   .l1
       00:F2E6  B0 09              bcs    .l1
  798  00:F2E8  20 FB F2            jsr   _spr_hide.sub
  799  00:F2EB  B1 0B               lda   [__ptr],Y
  800  00:F2ED  09 02               ora   #$02
  801  00:F2EF  91 0B               sta   [__ptr],Y
  802  00:F2F1  60        .l1:      rts
  803                               ; -- hide current sprite
  804  00:F2F2  A0 01     .l2:      ldy   #1
  805  00:F2F4  B1 18               lda   [__spr_ptr],Y
  806  00:F2F6  09 02               ora   #$02
  807  00:F2F8  91 18               sta   [__spr_ptr],Y
  808  00:F2FA  60                  rts
  809                               ; -- calc satb ptr
  810  00:F2FB            _spr_hide.sub:
  811  00:F2FB  8A                  txa
  812  00:F2FC  64 0C               stz   <__ptr+1
  813  00:F2FE  0A                  asl   A
  814  00:F2FF  0A                  asl   A
  815  00:F300  0A                  asl   A
  816  00:F301  26 0C               rol   <__ptr+1
  817  00:F303  69 73               adc   #low(_satb)
  818  00:F305  85 0B               sta   <__ptr
  819  00:F307  A5 0C               lda   <__ptr+1
  820  00:F309  69 27               adc   #high(_satb)
  821  00:F30B  85 0C               sta   <__ptr+1
  822  00:F30D  A0 01               ldy   #1
  823  00:F30F  60                  rts
  824                     
  825                     ; spr_show(char num)
  826                     ; ----
  827                     
  828  00:F310            _spr_show:
  829  00:F310  C0 00               cpy   #0
  830  00:F312  F0 0E               beq   .l2
  831                               ; -- hide sprite number #
  832  00:F314  E0 40               cpx   #64
  833                               bhs   .l1
       00:F316  B0 09              bcs    .l1
  834  00:F318  20 FB F2            jsr   _spr_hide.sub
  835  00:F31B  B1 0B               lda   [__ptr],Y
  836  00:F31D  29 01               and   #$01
  837  00:F31F  91 0B               sta   [__ptr],Y
  838  00:F321  60        .l1:      rts
  839                               ; -- hide current sprite
  840  00:F322  A0 01     .l2:      ldy   #1
  841  00:F324  B1 18               lda   [__spr_ptr],Y
  842  00:F326  29 01               and   #$01
  843  00:F328  91 18               sta   [__spr_ptr],Y
  844  00:F32A  60                  rts
  845                     
  846                     ; spr_x(int value)
  847                     ; ----
  848                     
  849  00:F32B            _spr_x:
  850  00:F32B  A0 02               ldy   #2
  851  00:F32D  22                  sax
  852                               add   #32
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F32E  18                 clc
       00:F32F  69 20              adc    #32
                                  .endif
  853  00:F331  91 18               sta   [__spr_ptr],Y
  854  00:F333  22                  sax
  855  00:F334  69 00               adc   #0
  856  00:F336  C8                  iny
  857  00:F337  91 18               sta   [__spr_ptr],Y
  858  00:F339  60                  rts
  859                     
  860  00:F33A            _spr_get_x:
  861  00:F33A  A0 02               ldy   #2
  862  00:F33C  B1 18               lda   [__spr_ptr],Y
  863                               sub   #32
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F33E  38                 sec
       00:F33F  E9 20              sbc    #32
                                  .endif
  864  00:F341  AA                  tax
  865  00:F342  C8                  iny
  866  00:F343  B1 18               lda   [__spr_ptr],Y
  867  00:F345  E9 00               sbc   #0
  868  00:F347  60                  rts
  869                     
  870                     ; spr_y(int value)
  871                     ; ----
  872                     
  873  00:F348            _spr_y:
  874  00:F348  22                  sax
  875                               add   #64
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F349  18                 clc
       00:F34A  69 40              adc    #64
                                  .endif
  876  00:F34C  92 18               sta   [__spr_ptr]
  877  00:F34E  22                  sax
  878  00:F34F  69 00               adc   #0
  879  00:F351  29 01               and   #$01
  880  00:F353  A0 01               ldy   #1
  881  00:F355  91 18               sta   [__spr_ptr],Y
  882  00:F357  60                  rts
  883                     
  884  00:F358            _spr_get_y:
  885  00:F358  B2 18               lda   [__spr_ptr]
  886                               sub   #64
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F35A  38                 sec
       00:F35B  E9 40              sbc    #64
                                  .endif
  887  00:F35D  AA                  tax
  888  00:F35E  A0 01               ldy   #1
  889  00:F360  B1 18               lda   [__spr_ptr],Y
  890  00:F362  E9 00               sbc   #0
  891  00:F364  60                  rts
  892                     
  893                     ; spr_pattern(int vaddr)
  894                     ; ----
  895                     
  896  00:F365            _spr_pattern:
  897  00:F365  85 03               sta   <__temp
  898  00:F367  8A                  txa
  899  00:F368  0A                  asl   A
  900  00:F369  26 03               rol   <__temp
  901  00:F36B  2A                  rol   A
  902  00:F36C  26 03               rol   <__temp
  903  00:F36E  2A                  rol   A
  904  00:F36F  26 03               rol   <__temp
  905  00:F371  2A                  rol   A
  906  00:F372  29 07               and   #$7
  907  00:F374  A0 05               ldy   #5
  908  00:F376  91 18               sta   [__spr_ptr],Y
  909  00:F378  A5 03               lda   <__temp
  910  00:F37A  88                  dey
  911  00:F37B  91 18               sta   [__spr_ptr],Y
  912  00:F37D  60                  rts
  913                     
  914  00:F37E            _spr_get_pattern:
  915  00:F37E  A0 04               ldy   #4
  916  00:F380  B1 18               lda   [__spr_ptr],Y
  917  00:F382  85 03               sta   <__temp
  918  00:F384  C8                  iny
  919  00:F385  B1 18               lda   [__spr_ptr],Y
  920  00:F387  4A                  lsr   A
  921  00:F388  66 03               ror   <__temp
  922  00:F38A  6A                  ror   A
  923  00:F38B  66 03               ror   <__temp
  924  00:F38D  6A                  ror   A
  925  00:F38E  66 03               ror   <__temp
  926  00:F390  6A                  ror   A
  927  00:F391  29 E0               and   #$E0
  928  00:F393  AA                  tax
  929  00:F394  A5 03               lda   <__temp
  930  00:F396  60                  rts
  931                     
  932                     ; spr_ctrl(char mask [al], char value)
  933                     ; ----
  934                     
  935  00:F397            _spr_ctrl.2:
  936  00:F397  8A                  txa
  937  00:F398  25 F8               and   <_al
  938  00:F39A  85 03               sta   <__temp
  939  00:F39C  A5 F8               lda   <_al
  940  00:F39E  49 FF               eor   #$FF
  941  00:F3A0  A0 07               ldy   #7
  942  00:F3A2  31 18               and   [__spr_ptr],Y
  943  00:F3A4  05 03               ora   <__temp
  944  00:F3A6  91 18               sta   [__spr_ptr],Y
  945  00:F3A8  60                  rts
  946                     
  947                     ; spr_pal(char pal)
  948                     ; ----
  949                     
  950  00:F3A9            _spr_pal:
  951  00:F3A9  8A                  txa
  952  00:F3AA  29 0F               and   #$0F
  953  00:F3AC  85 03               sta   <__temp
  954  00:F3AE  A0 06               ldy   #6
  955  00:F3B0  B1 18               lda   [__spr_ptr],Y
  956  00:F3B2  29 F0               and   #$F0
  957  00:F3B4  05 03               ora   <__temp
  958  00:F3B6  91 18               sta   [__spr_ptr],Y
  959  00:F3B8  60                  rts
  960                     
  961  00:F3B9            _spr_get_pal:
  962  00:F3B9  A0 06               ldy   #6
  963  00:F3BB  B1 18               lda   [__spr_ptr],Y
  964  00:F3BD  29 0F               and   #$0F
  965  00:F3BF  AA                  tax
  966  00:F3C0  62                  cla
  967  00:F3C1  60                  rts
  968                     
  969                     ; spr_pri(char pri)
  970                     ; ----
  971                     
  972  00:F3C2            _spr_pri:
  973  00:F3C2  A0 06               ldy   #6
  974  00:F3C4  B1 18               lda   [__spr_ptr],Y
  975  00:F3C6  29 7F               and   #$7F
  976  00:F3C8  E0 00               cpx   #$00
  977  00:F3CA  F0 02               beq   .l1
  978  00:F3CC  09 80               ora   #$80
  979  00:F3CE            .l1:
  980  00:F3CE  91 18               sta   [__spr_ptr],Y
  981  00:F3D0  60                  rts
  982                     
  983                     ; satb_update()
  984                     ; ----
  985                     
  986  00:F3D1            _satb_update:
  987  00:F3D1  A5 1B               lda   <__spr_flag
  988  00:F3D3  F0 06               beq   .l1
  989  00:F3D5  64 1B               stz   <__spr_flag
  990  00:F3D7  A2 40               ldx   #64
  991  00:F3D9  80 0A               bra   .l3
  992                               ; --
  993  00:F3DB  C0 01     .l1:      cpy   #1
  994  00:F3DD  F0 02               beq   .l2
  995  00:F3DF  A6 1A               ldx   <__spr_max
  996  00:F3E1  E0 00     .l2:      cpx   #0
  997  00:F3E3  F0 50               beq   .l4
  998                               ; --
  999  00:F3E5  86 F8     .l3:      stx   <_al    ; number of sprites
 1000  00:F3E7  8A                  txa
 1001  00:F3E8  3A                  dec   A       ; round up to the next group of 4 sprites
 1002  00:F3E9  4A                  lsr   A
 1003  00:F3EA  4A                  lsr   A
 1004  00:F3EB  1A                  inc   A
 1005  00:F3EC  85 FC               sta   <_cl
 1006                     
 1007                     ; Use TIA, but BLiT 16 words at a time (32 bytes)
 1008                     ; Because interrupt must not deferred too much
 1009                     ;
 1010                               stw   #32, _ram_hdwr_tia_size
       00:F3EE  A9 20              lda    LOW_BYTE #32
       00:F3F0  8D D1 26           sta    LOW_BYTE _ram_hdwr_tia_size
       00:F3F3  A9 00              lda    HIGH_BYTE #32
       00:F3F5  8D D2 26           sta    HIGH_BYTE _ram_hdwr_tia_size
 1011                               stw   #video_data, _ram_hdwr_tia_dest
       00:F3F8  A9 02              lda    LOW_BYTE #video_data
       00:F3FA  8D CF 26           sta    LOW_BYTE _ram_hdwr_tia_dest
       00:F3FD  A9 00              lda    HIGH_BYTE #video_data
       00:F3FF  8D D0 26           sta    HIGH_BYTE _ram_hdwr_tia_dest
 1012                               stw   #_satb, <_si
       00:F402  A9 73              lda    LOW_BYTE #_satb
       00:F404  85 EE              sta    LOW_BYTE <_si
       00:F406  A9 27              lda    HIGH_BYTE #_satb
       00:F408  85 EF              sta    HIGH_BYTE <_si
 1013                     
 1014                               stw   #$7F00, <_di
       00:F40A  A9 00              lda    LOW_BYTE #$7F00
       00:F40C  85 F0              sta    LOW_BYTE <_di
       00:F40E  A9 7F              lda    HIGH_BYTE #$7F00
       00:F410  85 F1              sta    HIGH_BYTE <_di
 1015  00:F412  20 A5 E4            jsr   set_write
 1016                     
 1017                     .l3a:     stw   <_si, _ram_hdwr_tia_src
       00:F415  A5 EE              lda    LOW_BYTE <_si
       00:F417  8D CD 26           sta    LOW_BYTE _ram_hdwr_tia_src
       00:F41A  A5 EF              lda    HIGH_BYTE <_si
       00:F41C  8D CE 26           sta    HIGH_BYTE _ram_hdwr_tia_src
 1018  00:F41F  20 CC 26            jsr   _ram_hdwr_tia
 1019                               addw  #32,<_si
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F422  18                 clc
       00:F423  A5 EE              lda    LOW_BYTE <_si
       00:F425  69 20              adc    LOW_BYTE #32
       00:F427  85 EE              sta    LOW_BYTE <_si
       00:F429  A5 EF              lda    HIGH_BYTE <_si
       00:F42B  69 00              adc    HIGH_BYTE #32
       00:F42D  85 EF              sta    HIGH_BYTE <_si
                                  .endif
 1020  00:F42F  C6 FC               dec   <_cl
 1021  00:F431  D0 E2               bne   .l3a
 1022                               
 1023                     ;.l3:     stx   <_al
 1024                     ;         stw   #_satb,<_si
 1025                     ;         stb   #BANK(_satb),<_bl
 1026                     ;         stw   #$7F00,<_di
 1027                     ;         txa
 1028                     ;         stz   <_ch
 1029                     ;         asl   A
 1030                     ;         asl   A
 1031                     ;         rol   <_ch
 1032                     ;         sta   <_cl
 1033                     ;         jsr   load_vram
 1034                     
 1035                               ; --
 1036  00:F433  A6 F8               ldx   <_al
 1037  00:F435  62        .l4:      cla
 1038  00:F436  60                  rts
 1039                     
 1040                     
 1041                     ; init_satb()
 1042                     ; reset_satb()
 1043                     ; ----
 1044                     
 1045  00:F437            _reset_satb:
 1046  00:F437            _init_satb:
 1047  00:F437  82                  clx
 1048  00:F438  62                  cla
 1049  00:F439  9E 73 27  .l1:      stz   _satb,X
 1050  00:F43C  9E 73 28            stz   _satb+256,X
 1051  00:F43F  E8                  inx
 1052  00:F440  D0 F7               bne   .l1
 1053                               ; --
 1054  00:F442  A0 01               ldy   #1
 1055  00:F444  84 1B               sty   <__spr_flag
 1056  00:F446  64 1A               stz   <__spr_max
 1057  00:F448  60                  rts
 1058                     
 1059                     ; get_color(int index [color_reg])
 1060                     ; ----
 1061                     ; index: index in the palette (0-511)
 1062                     ; ----
 1063                     
 1064  00:F449            _get_color.1:
 1065  00:F449  AE 04 04            ldx   color_data_l
 1066  00:F44C  AD 05 04            lda   color_data_h
 1067  00:F44F  29 01               and   #$01
 1068  00:F451  60                  rts
 1069                     
 1070                     ; set_color(int index [color_reg], int color [color_data])
 1071                     ; ----
 1072                     ; set one palette entry to the specified color
 1073                     ; ----
 1074                     ; index: index in the palette (0-511)
 1075                     ; color: color value,  GREEN: bit 6-8
 1076                     ;                      RED:   bit 3-5
 1077                     ;                      BLUE:  bit 0-2
 1078                     ; ----
 1079                     ; NOTE : inlined
 1080                     ; ----
 1081                     
 1082                     ; fade_color(int color [ax], char level)
 1083                     ; fade_color(int index [color_reg], int color [ax], char level)
 1084                     ; ----
 1085                     ; set one palette entry to the specified color
 1086                     ; ----
 1087                     ; index: index in the palette (0-511)
 1088                     ; color: color value,  GREEN: bit 6-8
 1089                     ;                      RED:   bit 3-5
 1090                     ;                      BLUE:  bit 0-2
 1091                     ; level: level of fading (0 = black, 8 = full)
 1092                     ; ----
 1093                     
 1094  00:F452            _fade_color.2:
 1095  00:F452            _fade_color.3:
 1096  00:F452  E0 00               cpx   #0
 1097  00:F454  F0 38               beq   .l4
 1098  00:F456  E0 08               cpx   #8
 1099                               bhs   .l5
       00:F458  B0 37              bcs    .l5
 1100                               ; -- fading
 1101  00:F45A  A0 03               ldy   #3
 1102  00:F45C  86 FA               stx   <_bl
 1103                               stwz  <_dx
       00:F45E  64 FE              stz    LOW_BYTE <_dx
       00:F460  64 FF              stz    HIGH_BYTE <_dx
 1104  00:F462  46 FA     .l1:      lsr   <_bl
 1105  00:F464  90 0D               bcc   .l2
 1106                               addw  <_ax,<_dx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F466  18                 clc
       00:F467  A5 FE              lda    LOW_BYTE <_dx
       00:F469  65 F8              adc    LOW_BYTE <_ax
       00:F46B  85 FE              sta    LOW_BYTE <_dx
       00:F46D  A5 FF              lda    HIGH_BYTE <_dx
       00:F46F  65 F9              adc    HIGH_BYTE <_ax
       00:F471  85 FF              sta    HIGH_BYTE <_dx
                                  .endif
 1107                     .l2:      aslw  <_ax
       00:F473  06 F8              asl    <_ax              ; word-sized value (at stated
       00:F475  26 F9              rol    <_ax+1            ; memory location)
 1108  00:F477  88                  dey
 1109  00:F478  D0 E8               bne   .l1
 1110  00:F47A  A5 FF               lda   <_dh
 1111  00:F47C  4A                  lsr   A
 1112  00:F47D  66 FE               ror   <_dl
 1113  00:F47F  4A                  lsr   A
 1114  00:F480  66 FE               ror   <_dl
 1115  00:F482  4A                  lsr   A
 1116  00:F483  66 FE               ror   <_dl
 1117                               ; -- set color
 1118  00:F485  A6 FE               ldx   <_dl
 1119  00:F487  8E 04 04  .l3:      stx   color_data_l
 1120  00:F48A  8D 05 04            sta   color_data_h
 1121  00:F48D  60                  rts
 1122                               ; -- black
 1123  00:F48E  62        .l4:      cla
 1124  00:F48F  80 F6               bra   .l3
 1125                               ; -- full
 1126  00:F491  A6 F8     .l5:      ldx   <_al
 1127  00:F493  A5 F9               lda   <_ah
 1128  00:F495  80 F0               bra   .l3
 1129                     
 1130                     ; set_color_rgb(int index [color_reg], char r [al], char g [ah], char b)
 1131                     ; ----
 1132                     ; set one palette entry to the specified color
 1133                     ; ----
 1134                     ; index: index in the palette (0-511)
 1135                     ; r:     red              RED:   bit 3-5
 1136                     ; g:     green            GREEN: bit 6-8
 1137                     ; b:     blue             BLUE:  bit 0-2
 1138                     ; ----
 1139                     
 1140  00:F497            _set_color_rgb.4:
 1141  00:F497  8A                  txa
 1142  00:F498  29 07               and   #$7
 1143  00:F49A  85 03               sta   <__temp
 1144  00:F49C  A5 F8               lda   <_al
 1145  00:F49E  0A                  asl   A
 1146  00:F49F  0A                  asl   A
 1147  00:F4A0  0A                  asl   A
 1148  00:F4A1  05 03               ora   <__temp
 1149  00:F4A3  0A                  asl   A
 1150  00:F4A4  0A                  asl   A
 1151  00:F4A5  85 03               sta   <__temp
 1152  00:F4A7  A5 F9               lda   <_ah
 1153  00:F4A9  4A                  lsr   A
 1154  00:F4AA  66 03               ror   <__temp
 1155  00:F4AC  4A                  lsr   A
 1156  00:F4AD  66 03               ror   <__temp
 1157  00:F4AF  A6 03               ldx   <__temp
 1158  00:F4B1  8E 04 04            stx   color_data_l
 1159  00:F4B4  8D 05 04            sta   color_data_h
 1160  00:F4B7  60                  rts
 1161                     
 1162                     ; put_tile(int tile_num [dx], int position)
 1163                     ; put_tile(int tile_num [dx], char x [al], char y)
 1164                     ; ----
 1165                     ; draw a single 8x8 or 16x16 tile at a given position
 1166                     ; ----
 1167                     ; pattern:  vram address of the tile pattern
 1168                     ; position: position on screen where to put the tile
 1169                     ; ----
 1170                     
 1171  00:F4B8            _put_tile.3:
 1172  00:F4B8  A5 F8               lda   <_al
 1173  00:F4BA  AC B8 26            ldy   maptiletype
 1174  00:F4BD  C0 08               cpy   #8
 1175  00:F4BF  F0 08               beq   .l1
 1176                               ; --
 1177  00:F4C1  0A                  asl   A
 1178  00:F4C2  22                  sax
 1179  00:F4C3  0A                  asl   A
 1180  00:F4C4  20 C2 E4            jsr   calc_vram_addr
 1181  00:F4C7  80 33               bra   _put_tile_16
 1182                               ; --
 1183  00:F4C9  22        .l1:      sax
 1184  00:F4CA  20 C2 E4            jsr   calc_vram_addr
 1185  00:F4CD  80 0B               bra   _put_tile_8
 1186  00:F4CF            _put_tile.2:
 1187                             __stw   <_di
       00:F4CF  86 F0              stx    <_di
       00:F4D1  85 F1              sta    <_di+1
 1188  00:F4D3  AC B8 26            ldy   maptiletype
 1189  00:F4D6  C0 08               cpy   #8
 1190  00:F4D8  D0 22               bne   _put_tile_16
 1191  00:F4DA            _put_tile_8:
 1192  00:F4DA  20 A5 E4            jsr   set_write
 1193                               ; -- calculate tile vram address
 1194                               stw   mapctable,<_bx
       00:F4DD  AD C1 26           lda    LOW_BYTE mapctable
       00:F4E0  85 FA              sta    LOW_BYTE <_bx
       00:F4E2  AD C2 26           lda    HIGH_BYTE mapctable
       00:F4E5  85 FB              sta    HIGH_BYTE <_bx
 1195  00:F4E7  A5 FE               lda   <_dl
 1196  00:F4E9  A8                  tay
 1197                               add   maptilebase
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F4EA  18                 clc
       00:F4EB  6D BC 26           adc    maptilebase
                                  .endif
 1198  00:F4EE  AA                  tax
 1199  00:F4EF  62                  cla
 1200  00:F4F0  6D BD 26            adc   maptilebase+1
 1201  00:F4F3  71 FA               adc   [_bx],Y
 1202                               ; -- copy tile
 1203  00:F4F5  8E 02 00            stx   video_data_l
 1204  00:F4F8  8D 03 00            sta   video_data_h
 1205  00:F4FB  60                  rts
 1206  00:F4FC            _put_tile_16:
 1207  00:F4FC  20 A5 E4            jsr   set_write
 1208                               ; -- calculate tile vram address
 1209                               stw   mapctable,<_bx
       00:F4FF  AD C1 26           lda    LOW_BYTE mapctable
       00:F502  85 FA              sta    LOW_BYTE <_bx
       00:F504  AD C2 26           lda    HIGH_BYTE mapctable
       00:F507  85 FB              sta    HIGH_BYTE <_bx
 1210  00:F509  64 FF               stz   <_dh
 1211  00:F50B  A5 FE               lda   <_dl
 1212  00:F50D  A8                  tay
 1213  00:F50E  0A                  asl   A
 1214  00:F50F  26 FF               rol   <_dh
 1215  00:F511  0A                  asl   A
 1216  00:F512  26 FF               rol   <_dh
 1217                               add   maptilebase
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F514  18                 clc
       00:F515  6D BC 26           adc    maptilebase
                                  .endif
 1218  00:F518  85 FE               sta   <_dl
 1219  00:F51A  A5 FF               lda   <_dh
 1220  00:F51C  6D BD 26            adc   maptilebase+1
 1221  00:F51F  71 FA               adc   [_bx],Y
 1222  00:F521  85 FF               sta   <_dh
 1223                               ; -- copy tile
 1224                               stw   <_dx,video_data
       00:F523  A5 FE              lda    LOW_BYTE <_dx
       00:F525  8D 02 00           sta    LOW_BYTE video_data
       00:F528  A5 FF              lda    HIGH_BYTE <_dx
       00:F52A  8D 03 00           sta    HIGH_BYTE video_data
 1225                               incw  <_dx
       00:F52D  E6 FE              inc    <_dx              ; value at stated memory
       00:F52F  D0 02              bne    .x_00355           ; location
       00:F531  E6 FF              inc    <_dx+1
       00:F533            .x_00355:
 1226                               stw   <_dx,video_data
       00:F533  A5 FE              lda    LOW_BYTE <_dx
       00:F535  8D 02 00           sta    LOW_BYTE video_data
       00:F538  A5 FF              lda    HIGH_BYTE <_dx
       00:F53A  8D 03 00           sta    HIGH_BYTE video_data
 1227                               incw  <_dx
       00:F53D  E6 FE              inc    <_dx              ; value at stated memory
       00:F53F  D0 02              bne    .x_00357           ; location
       00:F541  E6 FF              inc    <_dx+1
       00:F543            .x_00357:
 1228                               vreg  #0
       00:F543  A9 00              lda    #0
       00:F545  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       00:F547  03 00               st0   #0
                                   .else
                                   .endif
 1229                               addw  bat_width,<_di,video_data
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       00:F549  18                 clc
       00:F54A  A5 F0              lda    LOW_BYTE <_di
       00:F54C  6D D4 26           adc    LOW_BYTE bat_width
       00:F54F  8D 02 00           sta    LOW_BYTE video_data
       00:F552  A5 F1              lda    HIGH_BYTE <_di
       00:F554  6D D5 26           adc    HIGH_BYTE bat_width
       00:F557  8D 03 00           sta    HIGH_BYTE video_data
                                  .else
                                  .endif
 1230                               vreg  #2
       00:F55A  A9 02              lda    #2
       00:F55C  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       00:F55E  03 02               st0   #2
                                   .else
                                   .endif
 1231                               stw   <_dx,video_data
       00:F560  A5 FE              lda    LOW_BYTE <_dx
       00:F562  8D 02 00           sta    LOW_BYTE video_data
       00:F565  A5 FF              lda    HIGH_BYTE <_dx
       00:F567  8D 03 00           sta    HIGH_BYTE video_data
 1232                               incw  <_dx
       00:F56A  E6 FE              inc    <_dx              ; value at stated memory
       00:F56C  D0 02              bne    .x_00362           ; location
       00:F56E  E6 FF              inc    <_dx+1
       00:F570            .x_00362:
 1233                               stw   <_dx,video_data
       00:F570  A5 FE              lda    LOW_BYTE <_dx
       00:F572  8D 02 00           sta    LOW_BYTE video_data
       00:F575  A5 FF              lda    HIGH_BYTE <_dx
       00:F577  8D 03 00           sta    HIGH_BYTE video_data
 1234  00:F57A  60                  rts
 1235                     
 1236                     ; map_get_tile(char x [dl], char y)
 1237                     ; map_put_tile(char x [dl], char y [dh], char tile)
 1238                     ; ----
 1239                     
 1240  00:F57B            _map_get_tile.2:
 1241  00:F57B  86 FF               stx   <_dh
 1242  00:F57D  20 8D F5            jsr   _map_calc_tile_addr
 1243                               ; --
 1244  00:F580  B2 FC               lda   [_cx]
 1245  00:F582  AA                  tax
 1246  00:F583  62                  cla
 1247  00:F584  60                  rts
 1248                     
 1249  00:F585            _map_put_tile.3:
 1250  00:F585  DA                  phx
 1251  00:F586  20 8D F5            jsr   _map_calc_tile_addr
 1252  00:F589  68                  pla
 1253  00:F58A  92 FC               sta   [_cx]
 1254  00:F58C  60                  rts
 1255                     
 1256                     ; map_calc_tile_addr(char x [dl], char y [dh])
 1257                     ; ----
 1258  00:F58D            _map_calc_tile_addr:
 1259  00:F58D  A6 FF               ldx   <_dh
 1260  00:F58F  AD B5 26            lda   mapwidth+1
 1261  00:F592  F0 08               beq   .l1
 1262  00:F594  86 FD               stx   <_ch
 1263  00:F596  A5 FE               lda   <_dl
 1264  00:F598  85 FC               sta   <_cl
 1265  00:F59A  80 13               bra   .l2
 1266                               ; --
 1267  00:F59C  86 F8     .l1:      stx   <_al
 1268  00:F59E  AD B4 26            lda   mapwidth
 1269  00:F5A1  85 FA               sta   <_bl
 1270  00:F5A3  20 77 E7            jsr   mulu8
 1271                               ; --
 1272  00:F5A6  A5 FC               lda   <_cl
 1273                               add   <_dl
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F5A8  18                 clc
       00:F5A9  65 FE              adc    <_dl
                                  .endif
 1274  00:F5AB  90 02               bcc   .l2
 1275  00:F5AD  E6 FD               inc   <_ch
 1276                               ; --
 1277                     .l2:      add   mapaddr
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F5AF  18                 clc
       00:F5B0  6D B2 26           adc    mapaddr
                                  .endif
 1278  00:F5B3  85 FC               sta   <_cl
 1279  00:F5B5  AD B3 26            lda   mapaddr+1
 1280  00:F5B8  29 1F               and   #$1F
 1281  00:F5BA  65 FD               adc   <_ch
 1282  00:F5BC  AA                  tax
 1283                               ; --
 1284                     ;         rol   A
 1285                     ;         rol   A
 1286                     ;         rol   A
 1287                     ;         rol   A
 1288  00:F5BD  4A                  lsr   A
 1289  00:F5BE  4A                  lsr   A
 1290  00:F5BF  4A                  lsr   A
 1291  00:F5C0  4A                  lsr   A
 1292  00:F5C1  4A                  lsr   A
 1293  00:F5C2  29 0F               and   #$0F
 1294                               add   mapbank
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F5C4  18                 clc
       00:F5C5  6D B1 26           adc    mapbank
                                  .endif
 1295  00:F5C8  53 08               tam   #3
 1296                               ; --
 1297  00:F5CA  8A                  txa
 1298  00:F5CB  29 1F               and   #$1F
 1299  00:F5CD  09 60               ora   #$60
 1300  00:F5CF  85 FD               sta   <_ch
 1301  00:F5D1  A6 FC               ldx   <_cl
 1302  00:F5D3  60                  rts
 1303                     
 1304                     ; scroll(char num, int x, int y, char top, char bottom, char disp)
 1305                     ; ----
 1306                     ; set screen scrolling
 1307                     ; ----
 1308                     
 1309  00:F5D4            _scroll:
 1310  00:F5D4  A0 08               ldy   #8
 1311  00:F5D6  B1 00               lda   [__sp],Y
 1312  00:F5D8  29 03               and   #$03
 1313                               ; --
 1314  00:F5DA  22                  sax
 1315  00:F5DB  29 C0               and   #$C0
 1316  00:F5DD  09 01               ora   #$01
 1317  00:F5DF  9D F8 26            sta   scroll_cr,X
 1318  00:F5E2  B2 00               lda   [__sp]
 1319  00:F5E4  1A                  inc   A
 1320  00:F5E5  9D F4 26            sta   scroll_bottom,X
 1321  00:F5E8  A0 02               ldy   #2
 1322  00:F5EA  B1 00               lda   [__sp],Y
 1323  00:F5EC  9D F0 26            sta   scroll_top,X
 1324  00:F5EF  A0 04               ldy   #4
 1325  00:F5F1  B1 00               lda   [__sp],Y
 1326  00:F5F3  9D E8 26            sta   scroll_yl,X
 1327  00:F5F6  C8                  iny
 1328  00:F5F7  B1 00               lda   [__sp],Y
 1329  00:F5F9  9D EC 26            sta   scroll_yh,X
 1330  00:F5FC  C8                  iny
 1331  00:F5FD  B1 00               lda   [__sp],Y
 1332  00:F5FF  9D E0 26            sta   scroll_xl,X
 1333  00:F602  C8                  iny
 1334  00:F603  B1 00               lda   [__sp],Y
 1335  00:F605  9D E4 26            sta   scroll_xh,X
 1336                               addw  #10,<__sp
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       00:F608  18                 clc
       00:F609  A5 00              lda    LOW_BYTE <__sp
       00:F60B  69 0A              adc    LOW_BYTE #10
       00:F60D  85 00              sta    LOW_BYTE <__sp
       00:F60F  A5 01              lda    HIGH_BYTE <__sp
       00:F611  69 00              adc    HIGH_BYTE #10
       00:F613  85 01              sta    HIGH_BYTE <__sp
                                  .endif
 1337  00:F615  60                  rts
 1338                     
 1339                     ; scroll_disable(char num)
 1340                     ; ----
 1341                     ; disable screen scrolling for a scroll region
 1342                     ; ----
 1343                     
 1344  00:F616            _scroll_disable:
 1345  00:F616  BD F8 26            lda   scroll_cr,X
 1346  00:F619  29 FE               and   #$fe
 1347  00:F61B  9D F8 26            sta   scroll_cr,X
 1348  00:F61E  60                  rts
 1349                     
 1350                     ; set_screen_size(char size)
 1351                     ; ----
 1352                     ; set screen virtual size
 1353                     ; ----
 1354                     
 1355  00:F61F            _set_screen_size:
 1356  00:F61F  8A                  txa
 1357  00:F620  4C 95 E5            jmp   set_bat_size
 1358                     
 1359                     ; set_xres(int xres)
 1360                     ; ----
 1361                     ; set horizontal display resolution
 1362                     ; ----
 1363                     
 1364  00:F623            _set_xres.1:
 1365  00:F623  A9 04               lda   #XRES_SOFT
 1366  00:F625  85 FC               sta   <_cl
 1367  00:F627            _set_xres.2:
 1368  00:F627  20 83 E5            jsr   set_xres
 1369  00:F62A  A6 F8               ldx   <_al
 1370  00:F62C  A5 F9               lda   <_ah
 1371  00:F62E  60                  rts
 1372                     
 1373                     
 1374                     ; ------------------------
 1375                     ; Graphics functions
 1376                     ; ------------------------
 1377                     
 1378                     ; readvram
 1379                     ; ----
 1380                     ; leftover from asm library
 1381                     ; needed for 'a = vram[n]'
 1382                     ; semantic
 1383                     ; ----
 1384  00:F62F            readvram:
 1385  00:F62F  A0 01               ldy   #1
 1386  00:F631  84 F7               sty   <vdc_reg
 1387  00:F633  8C 00 00            sty   video_reg
 1388  00:F636  8E 02 00            stx   video_data_l
 1389  00:F639  8D 03 00            sta   video_data_h
 1390                               vreg  #$02
       00:F63C  A9 02              lda    #$02
       00:F63E  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       00:F640  03 02               st0   #$02
                                   .else
                                   .endif
 1391  00:F642  AE 02 00            ldx   video_data_l
 1392  00:F645  AD 03 00            lda   video_data_h
 1393  00:F648  60                  rts
 1394                     
 1395                     
 1396                     ; writevram
 1397                     ; ----
 1398                     ; leftover from asm library
 1399                     ; needed for 'vram[n] = a'
 1400                     ; semantic
 1401                     ; ----
 1402  00:F649            writevram:
 1403  00:F649  A8                  tay
 1404  00:F64A  64 F7               stz   <vdc_reg
 1405  00:F64C  9C 00 00            stz   video_reg
 1406  00:F64F  B2 00               lda   [__sp]
 1407  00:F651  8D 02 00            sta   video_data_l
 1408                               incw  <__sp
       00:F654  E6 00              inc    <__sp              ; value at stated memory
       00:F656  D0 02              bne    .x_00369           ; location
       00:F658  E6 01              inc    <__sp+1
       00:F65A            .x_00369:
 1409  00:F65A  B2 00               lda   [__sp]
 1410  00:F65C  8D 03 00            sta   video_data_h
 1411                               incw  <__sp
       00:F65F  E6 00              inc    <__sp              ; value at stated memory
       00:F661  D0 02              bne    .x_00370           ; location
       00:F663  E6 01              inc    <__sp+1
       00:F665            .x_00370:
 1412                               vreg  #2
       00:F665  A9 02              lda    #2
       00:F667  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       00:F669  03 02               st0   #2
                                   .else
                                   .endif
 1413  00:F66B  8E 02 00            stx   video_data_l
 1414  00:F66E  8C 03 00            sty   video_data_h
 1415  00:F671  60                  rts
 1416                     
 1417                     
 1418                     ; gfx_setbgpal(char pal)
 1419                     ; ----
 1420                     ; set default major palette for gfx_* func's
 1421                     ; ----
 1422                     
 1423  00:F672            _gfx_setbgpal:
 1424  00:F672  8A                  txa
 1425  00:F673  0A                  asl   A
 1426  00:F674  0A                  asl   A
 1427  00:F675  0A                  asl   A
 1428  00:F676  0A                  asl   A
 1429  00:F677  8D 73 29            sta   _gfx_pal
 1430  00:F67A  60                  rts
 1431                     
 1432                     
 1433                     ; gfx_init(int start_vram_addr)
 1434                     ; ----
 1435                     ; initialize graphics mode
 1436                     ;  - points graphics map to tiles at start_vram_addr
 1437                     ; ----
 1438                     
 1439  00:F67B            _gfx_init:
 1440                             __stw   <_dx    ; vram addr
       00:F67B  86 FE              stx    <_dx
       00:F67D  85 FF              sta    <_dx+1
 1441                     
 1442                               lsrw  <_dx    ; shift address to make char pattern
       00:F67F  46 FF              lsr    <_dx+1            ; value (at stated memory
       00:F681  66 FE              ror    <_dx              ; location)
 1443                               lsrw  <_dx
       00:F683  46 FF              lsr    <_dx+1            ; value (at stated memory
       00:F685  66 FE              ror    <_dx              ; location)
 1444                               lsrw  <_dx
       00:F687  46 FF              lsr    <_dx+1            ; value (at stated memory
       00:F689  66 FE              ror    <_dx              ; location)
 1445                               lsrw  <_dx
       00:F68B  46 FF              lsr    <_dx+1            ; value (at stated memory
       00:F68D  66 FE              ror    <_dx              ; location)
 1446  00:F68F  A5 FF               lda   <_dx+1
 1447  00:F691  29 0F               and   #$0f
 1448  00:F693  0D 73 29            ora   _gfx_pal        ; and add major palette info
 1449  00:F696  85 FF               sta   <_dx+1
 1450                     
 1451                               setvwaddr $0
                                   stw  #$0,<_di
       00:F698  A9 00              lda    LOW_BYTE #$0
       00:F69A  85 F0              sta    LOW_BYTE <_di
       00:F69C  A9 00              lda    HIGH_BYTE #$0
       00:F69E  85 F1              sta    HIGH_BYTE <_di
       00:F6A0  20 A5 E4           jsr  set_write
 1452                               ; --
 1453  00:F6A3  AC D6 26            ldy   bat_height
 1454  00:F6A6  AE D4 26  .l2:      ldx   bat_width
 1455                               ; --
 1456                     .l3:      stw   <_dx,video_data
       00:F6A9  A5 FE              lda    LOW_BYTE <_dx
       00:F6AB  8D 02 00           sta    LOW_BYTE video_data
       00:F6AE  A5 FF              lda    HIGH_BYTE <_dx
       00:F6B0  8D 03 00           sta    HIGH_BYTE video_data
 1457                               incw  <_dx
       00:F6B3  E6 FE              inc    <_dx              ; value at stated memory
       00:F6B5  D0 02              bne    .x_00380           ; location
       00:F6B7  E6 FF              inc    <_dx+1
       00:F6B9            .x_00380:
 1458  00:F6B9  CA                  dex
 1459  00:F6BA  D0 ED               bne   .l3
 1460  00:F6BC  88                  dey
 1461  00:F6BD  D0 E7               bne   .l2
 1462  00:F6BF  60                  rts
 1463                     
 1464                     
 1465                     ; gfx_clear(int start_vram_addr)
 1466                     ; ----
 1467                     ; Clear the values in the graphics tiles
 1468                     ; - places zeroes in graphics tiles at start_vram_addr
 1469                     ; ----
 1470                     
 1471  00:F6C0            _gfx_clear:
 1472                             __stw   <_di            ; start_vram_addr
       00:F6C0  86 F0              stx    <_di
       00:F6C2  85 F1              sta    <_di+1
 1473  00:F6C4  20 A5 E4            jsr   set_write       ; setup VRAM addr for writing
 1474                     
 1475  00:F6C7  AD D6 26            lda   bat_height
 1476  00:F6CA  85 FA               sta   <_bl            ; loop for all lines
 1477  00:F6CC  AE D4 26  .l2:      ldx   bat_width       ; loop for all characters
 1478  00:F6CF  A0 08     .l3:      ldy   #8              ; loop for 16 words
 1479                     .l4:      stw   #0,video_data   ; unrolled a bit (8 iterations
       00:F6D1  A9 00              lda    LOW_BYTE #0
       00:F6D3  8D 02 00           sta    LOW_BYTE video_data
       00:F6D6  A9 00              lda    HIGH_BYTE #0
       00:F6D8  8D 03 00           sta    HIGH_BYTE video_data
 1480                               stw   #0,video_data   ; @ 2 words each iteration)
       00:F6DB  A9 00              lda    LOW_BYTE #0
       00:F6DD  8D 02 00           sta    LOW_BYTE video_data
       00:F6E0  A9 00              lda    HIGH_BYTE #0
       00:F6E2  8D 03 00           sta    HIGH_BYTE video_data
 1481  00:F6E5  88                  dey
 1482  00:F6E6  D0 E9               bne   .l4 
 1483  00:F6E8  CA                  dex
 1484  00:F6E9  D0 E4               bne   .l3
 1485  00:F6EB  C6 FA               dec   <_bl
 1486  00:F6ED  D0 DD               bne   .l2
 1487  00:F6EF  60                  rts
 1488                     
 1489                     
 1490                     ; gfx_plot(int x [bx] int y [cx] char color [reg acc])
 1491                     ; ----
 1492                     ; Plot a point at location (x,y) in color
 1493                     ; ----
 1494                     
 1495  00:F6F0            _gfx_plot.3:
 1496                               maplibfunc    lib2_gfx_plot.3
       00:F6F0  A8                 tay
       00:F6F1  43 20              tma  #page(lib2_gfx_plot.3)
       00:F6F3  48                 pha
       00:F6F4  A9 01              lda  #bank(lib2_gfx_plot.3)
       00:F6F6  53 20              tam  #page(lib2_gfx_plot.3)
       00:F6F8  98                 tya
       00:F6F9  20 22 AE           jsr  lib2_gfx_plot.3
       00:F6FC  A8                 tay
       00:F6FD  68                 pla
       00:F6FE  53 20              tam  #page(lib2_gfx_plot.3)
       00:F700  98                 tya
 1497  00:F701  60                  rts
 1498                     
 1499                     
 1500                     ; gfx_point(int x [bx], int y [cx])
 1501                     ; ----
 1502                     ; Returns color of point at location (x,y)
 1503                     ; ----
 1504                     
 1505  00:F702            _gfx_point.2:
 1506                               maplibfunc    lib2_gfx_point.2
       00:F702  A8                 tay
       00:F703  43 20              tma  #page(lib2_gfx_point.2)
       00:F705  48                 pha
       00:F706  A9 01              lda  #bank(lib2_gfx_point.2)
       00:F708  53 20              tam  #page(lib2_gfx_point.2)
       00:F70A  98                 tya
       00:F70B  20 DD AE           jsr  lib2_gfx_point.2
       00:F70E  A8                 tay
       00:F70F  68                 pla
       00:F710  53 20              tam  #page(lib2_gfx_point.2)
       00:F712  98                 tya
 1507  00:F713  60                  rts
 1508                     
 1509                     
 1510                     ; gfx_line(int x1 [bx], int y1 [cx], int x2 [si], int y2 [bp], char color [reg acc])
 1511                     ; ----
 1512                     ; Plot a line from location (x1,y1) to location (x2,y2) in color
 1513                     ; ----
 1514                     
 1515  00:F714            _gfx_line.5:
 1516                               maplibfunc    lib2_gfx_line.5
       00:F714  A8                 tay
       00:F715  43 20              tma  #page(lib2_gfx_line.5)
       00:F717  48                 pha
       00:F718  A9 01              lda  #bank(lib2_gfx_line.5)
       00:F71A  53 20              tam  #page(lib2_gfx_line.5)
       00:F71C  98                 tya
       00:F71D  20 98 AB           jsr  lib2_gfx_line.5
       00:F720  A8                 tay
       00:F721  68                 pla
       00:F722  53 20              tam  #page(lib2_gfx_line.5)
       00:F724  98                 tya
 1517  00:F725  60                  rts
 1518                     
 1519                     ;---------------------------------
 1520                     
 1521                     ;
 1522                     ; Change to context LIB2_BANK for these functions
 1523                     ; because they are larger than LIB1_BANK functions
 1524                     ; should be
 1525                     ;
 1526                     
 1527           0001               .bank  LIB2_BANK
 1528                     
 1529                     ; put_number(int number, char n, int offset)
 1530                     ; put_number(int number, char n, char x, char y)
 1531                     ; ----
 1532                     
 1533  01:AB27            lib2_put_number.4:
 1534  01:AB27  A4 02               ldy   <__arg_idx
 1535                             __plb
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0000              .if (0 = 2)
                                  .else
       01:AB29  88                 dey
       01:AB2A  B9 64 2A           lda    __arg,Y
                0000              .if (0)
                                  .endif
                                  .endif
 1536  01:AB2D  20 A3 EE            jsr   _put.xy
 1537  01:AB30  80 05               bra   putnum.main
 1538  01:AB32            lib2_put_number.3:
 1539  01:AB32  A4 02               ldy   <__arg_idx
 1540  01:AB34  20 AA EE            jsr   _put.vram
 1541  01:AB37            putnum.main:
 1542                             __plb   <_cl,1
                                   ; (bytes : 6/7, cycles : 11/12)
                          
                0001              .if (2 = 2)
       01:AB37  88                 dey
       01:AB38  BE 64 2A           ldx    __arg,Y
       01:AB3B  86 FC              stx    <_cl
                                  .else
                                  .endif
 1543                             __plw   <_dx
                                   ; (bytes : 9/12, cycles : 16/22)
                          
       01:AB3D  88                 dey
       01:AB3E  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       01:AB41  85 FE              sta    <_dx
                                  .else
                                  .endif
       01:AB43  88                 dey
       01:AB44  B9 64 2A           lda    __arg,Y
                0001              .if (1)
       01:AB47  85 FF              sta    <_dx+1
                                  .endif
 1544  01:AB49  84 02               sty   <__arg_idx
 1545                               ; --
 1546  01:AB4B  64 F8               stz   <_al ; sign flag
 1547  01:AB4D  CA                  dex
 1548  01:AB4E  E0 10               cpx   #16
 1549                               bhs   .l5
       01:AB50  B0 45              bcs    .l5
 1550                               ; --
 1551  01:AB52  A5 FF               lda   <_dh ; check sign
 1552  01:AB54  10 0F               bpl   .l1
 1553                               negw  <_dx ; negate
       01:AB56  62                 cla                    ; (at stated memory location)
                                   sub    <_dx              ; 2's complement
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:AB57  38                 sec
       01:AB58  E5 FE              sbc    <_dx
                                  .endif
       01:AB5A  85 FE              sta    <_dx
       01:AB5C  62                 cla
       01:AB5D  E5 FF              sbc    <_dx+1
       01:AB5F  85 FF              sta    <_dx+1
 1554  01:AB61  A9 01               lda   #1
 1555  01:AB63  85 F8               sta   <_al
 1556                               ; --
 1557  01:AB65  20 61 E7  .l1:      jsr   divu10
 1558  01:AB68  09 10               ora   #$10
 1559  01:AB6A  48                  pha
 1560  01:AB6B  CA                  dex
 1561  01:AB6C  30 15               bmi   .l3
 1562                               tstw  <_dx
       01:AB6E  A5 FE              lda   <_dx               ; value at stated memory
       01:AB70  05 FF              ora   <_dx+1             ; location is zero
 1563  01:AB72  D0 F1               bne   .l1
 1564                               ; --
 1565  01:AB74  A5 F8               lda   <_al
 1566  01:AB76  F0 07               beq   .l2
 1567  01:AB78  A9 0D               lda   #$0D
 1568  01:AB7A  48                  pha
 1569  01:AB7B  CA                  dex
 1570  01:AB7C  30 05               bmi   .l3
 1571                               ; --
 1572  01:AB7E  62                  cla
 1573  01:AB7F  48        .l2:      pha
 1574  01:AB80  CA                  dex
 1575  01:AB81  10 FC               bpl   .l2
 1576                               ; --
 1577  01:AB83  A6 FC     .l3:      ldx   <_cl
 1578  01:AB85  68        .l4:      pla
 1579                               add   _font_base
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:AB86  18                 clc
       01:AB87  6D 6F 27           adc    _font_base
                                  .endif
 1580  01:AB8A  8D 02 00            sta   video_data_l
 1581  01:AB8D  62                  cla
 1582  01:AB8E  6D 70 27            adc   _font_base+1
 1583  01:AB91  8D 03 00            sta   video_data_h
 1584  01:AB94  CA                  dex
 1585  01:AB95  D0 EE               bne   .l4
 1586  01:AB97  60        .l5:      rts
 1587                     
 1588                     
 1589                     ; gfx_line(int x1 [bx], int y1 [cx], int x2 [si], int y2 [bp], char color [reg acc])
 1590                     ; ----
 1591                     ; Plot a line from location (x1,y1) to locations (x2,y2) in color
 1592                     ; ----
 1593  01:AB98            lib2_gfx_line.5:                ; Bresenham line drawing algorithm
 1594  01:AB98  8E 81 29            stx   _line_color
 1595                     
 1596                               cmpw  <_cx,<_bp       ; make y always ascending by swapping
       01:AB9B  A5 ED              lda    HIGH_BYTE <_bp
       01:AB9D  C5 FD              cmp    HIGH_BYTE <_cx
       01:AB9F  D0 04              bne    .x_00395
       01:ABA1  A5 EC              lda    LOW_BYTE <_bp
       01:ABA3  C5 FC              cmp    LOW_BYTE <_cx
       01:ABA5            .x_00395:
 1597                               bhs   .l1             ; co-ordinates
       01:ABA5  B0 26              bcs    .l1
 1598                                                     ; jump over swap if _bp > _cx
 1599                     
 1600                               stw   <_bp,_line_curry        ; swap coordinates
       01:ABA7  A5 EC              lda    LOW_BYTE <_bp
       01:ABA9  8D 76 29           sta    LOW_BYTE _line_curry
       01:ABAC  A5 ED              lda    HIGH_BYTE <_bp
       01:ABAE  8D 77 29           sta    HIGH_BYTE _line_curry
 1601                               stw   <_cx,<_bp
       01:ABB1  A5 FC              lda    LOW_BYTE <_cx
       01:ABB3  85 EC              sta    LOW_BYTE <_bp
       01:ABB5  A5 FD              lda    HIGH_BYTE <_cx
       01:ABB7  85 ED              sta    HIGH_BYTE <_bp
 1602                               stw   <_si,_line_currx
       01:ABB9  A5 EE              lda    LOW_BYTE <_si
       01:ABBB  8D 74 29           sta    LOW_BYTE _line_currx
       01:ABBE  A5 EF              lda    HIGH_BYTE <_si
       01:ABC0  8D 75 29           sta    HIGH_BYTE _line_currx
 1603                               stw   <_bx,<_si
       01:ABC3  A5 FA              lda    LOW_BYTE <_bx
       01:ABC5  85 EE              sta    LOW_BYTE <_si
       01:ABC7  A5 FB              lda    HIGH_BYTE <_bx
       01:ABC9  85 EF              sta    HIGH_BYTE <_si
 1604                     
 1605  01:ABCB  80 14               bra   .l2
 1606                     
 1607                     .l1:      stw   <_bx,_line_currx
       01:ABCD  A5 FA              lda    LOW_BYTE <_bx
       01:ABCF  8D 74 29           sta    LOW_BYTE _line_currx
       01:ABD2  A5 FB              lda    HIGH_BYTE <_bx
       01:ABD4  8D 75 29           sta    HIGH_BYTE _line_currx
 1608                               stw   <_cx,_line_curry
       01:ABD7  A5 FC              lda    LOW_BYTE <_cx
       01:ABD9  8D 76 29           sta    LOW_BYTE _line_curry
       01:ABDC  A5 FD              lda    HIGH_BYTE <_cx
       01:ABDE  8D 77 29           sta    HIGH_BYTE _line_curry
 1609                     
 1610                     ; now:
 1611                     ;  line_currx and line_curry are start point
 1612                     ;  <_si and <_bp are end point
 1613                     ;  <_bx and <_cx are 'dont care'
 1614                     
 1615  01:ABE1            .l2:
 1616  01:ABE1  A5 EC               lda   LOW_BYTE  <_bp
 1617                               sub   LOW_BYTE  _line_curry
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:ABE3  38                 sec
       01:ABE4  ED 76 29           sbc    LOW_BYTE  _line_curry
                                  .endif
 1618  01:ABE7  8D 7A 29            sta   LOW_BYTE  _line_deltay
 1619  01:ABEA  A5 ED               lda   HIGH_BYTE <_bp
 1620  01:ABEC  ED 77 29            sbc   HIGH_BYTE _line_curry
 1621  01:ABEF  8D 7B 29            sta   HIGH_BYTE _line_deltay
 1622                     
 1623  01:ABF2  A5 EE               lda   LOW_BYTE  <_si
 1624                               sub   LOW_BYTE  _line_currx
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:ABF4  38                 sec
       01:ABF5  ED 74 29           sbc    LOW_BYTE  _line_currx
                                  .endif
 1625  01:ABF8  8D 78 29            sta   LOW_BYTE  _line_deltax
 1626  01:ABFB  A5 EF               lda   HIGH_BYTE <_si
 1627  01:ABFD  ED 75 29            sbc   HIGH_BYTE _line_currx
 1628  01:AC00  8D 79 29            sta   HIGH_BYTE _line_deltax
 1629                     
 1630  01:AC03  9C 80 29            stz   _line_xdir      ; 0 = positive
 1631                     
 1632  01:AC06  AD 79 29            lda   HIGH_BYTE _line_deltax
 1633  01:AC09  10 14               bpl   .l3
 1634                     
 1635  01:AC0B  A9 01               lda   #1
 1636  01:AC0D  8D 80 29            sta   _line_xdir      ; 1 = negative
 1637                               negw  _line_deltax
       01:AC10  62                 cla                    ; (at stated memory location)
                                   sub    _line_deltax              ; 2's complement
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:AC11  38                 sec
       01:AC12  ED 78 29           sbc    _line_deltax
                                  .endif
       01:AC15  8D 78 29           sta    _line_deltax
       01:AC18  62                 cla
       01:AC19  ED 79 29           sbc    _line_deltax+1
       01:AC1C  8D 79 29           sta    _line_deltax+1
 1638                     
 1639                     ; now:
 1640                     ;  line_deltay is difference from end to start (positive)
 1641                     ;  line_deltax is difference from end to start (positive)
 1642                     ;  line_xdir shows whether to apply deltax positive or negative
 1643                     
 1644                     
 1645  01:AC1F            .l3:
 1646                               cmpw  _line_deltax,_line_deltay
       01:AC1F  AD 7B 29           lda    HIGH_BYTE _line_deltay
       01:AC22  CD 79 29           cmp    HIGH_BYTE _line_deltax
       01:AC25  D0 06              bne    .x_00407
       01:AC27  AD 7A 29           lda    LOW_BYTE _line_deltay
       01:AC2A  CD 78 29           cmp    LOW_BYTE _line_deltax
       01:AC2D            .x_00407:
 1647                               lbhs  .ybiglp         ; jump if deltay > |deltax|
       01:AC2D  90 03              bcc    .x_00408
       01:AC2F  4C 2B AD           jmp    .ybiglp
       01:AC32            .x_00408
 1648                     
 1649  01:AC32            .xbiglp:
 1650                             __ldw   _line_deltay
                0000              .if (1 = 2)
                                  .else
       01:AC32  AE 7A 29           ldx    _line_deltay
       01:AC35  AD 7B 29           lda    _line_deltay+1
                                  .endif
 1651                             __aslw
       01:AC38  22                 sax
       01:AC39  0A                 asl    A
       01:AC3A  22                 sax
       01:AC3B  2A                 rol    A
 1652                             __stw   _line_adjust
       01:AC3C  8E 7E 29           stx    _line_adjust
       01:AC3F  8D 7F 29           sta    _line_adjust+1
 1653                             __stw   _line_error
       01:AC42  8E 7C 29           stx    _line_error
       01:AC45  8D 7D 29           sta    _line_error+1
 1654                     
 1655                               subw  _line_deltax,_line_adjust
       01:AC48  38                 sec
       01:AC49  AD 7E 29           lda    LOW_BYTE _line_adjust
       01:AC4C  ED 78 29           sbc    LOW_BYTE _line_deltax
       01:AC4F  8D 7E 29           sta    LOW_BYTE _line_adjust
       01:AC52  AD 7F 29           lda    HIGH_BYTE _line_adjust
       01:AC55  ED 79 29           sbc    HIGH_BYTE _line_deltax
       01:AC58  8D 7F 29           sta    HIGH_BYTE _line_adjust
 1656                               subw  _line_deltax,_line_adjust
       01:AC5B  38                 sec
       01:AC5C  AD 7E 29           lda    LOW_BYTE _line_adjust
       01:AC5F  ED 78 29           sbc    LOW_BYTE _line_deltax
       01:AC62  8D 7E 29           sta    LOW_BYTE _line_adjust
       01:AC65  AD 7F 29           lda    HIGH_BYTE _line_adjust
       01:AC68  ED 79 29           sbc    HIGH_BYTE _line_deltax
       01:AC6B  8D 7F 29           sta    HIGH_BYTE _line_adjust
 1657                     
 1658                               subw  _line_deltax,_line_error
       01:AC6E  38                 sec
       01:AC6F  AD 7C 29           lda    LOW_BYTE _line_error
       01:AC72  ED 78 29           sbc    LOW_BYTE _line_deltax
       01:AC75  8D 7C 29           sta    LOW_BYTE _line_error
       01:AC78  AD 7D 29           lda    HIGH_BYTE _line_error
       01:AC7B  ED 79 29           sbc    HIGH_BYTE _line_deltax
       01:AC7E  8D 7D 29           sta    HIGH_BYTE _line_error
 1659                     
 1660                               incw  _line_deltax            ; used as counter - get both endpoints
       01:AC81  EE 78 29           inc    _line_deltax              ; value at stated memory
       01:AC84  D0 03              bne    .x_00416           ; location
       01:AC86  EE 79 29           inc    _line_deltax+1
       01:AC89            .x_00416:
 1661                     
 1662  01:AC89            .xlp1:
 1663                               stw   _line_currx,<_bx        ; draw pixel
       01:AC89  AD 74 29           lda    LOW_BYTE _line_currx
       01:AC8C  85 FA              sta    LOW_BYTE <_bx
       01:AC8E  AD 75 29           lda    HIGH_BYTE _line_currx
       01:AC91  85 FB              sta    HIGH_BYTE <_bx
 1664                               stw   _line_curry,<_cx
       01:AC93  AD 76 29           lda    LOW_BYTE _line_curry
       01:AC96  85 FC              sta    LOW_BYTE <_cx
       01:AC98  AD 77 29           lda    HIGH_BYTE _line_curry
       01:AC9B  85 FD              sta    HIGH_BYTE <_cx
 1665  01:AC9D  AE 81 29            ldx   _line_color
 1666  01:ACA0  62                  cla
 1667  01:ACA1  20 22 AE            jsr   lib2_gfx_plot.3
 1668                     
 1669                               decw  _line_deltax            ; dec counter
       01:ACA4  38                 sec                    ; value at stated memory
       01:ACA5  AD 78 29           lda    _line_deltax              ; location
       01:ACA8  E9 01              sbc    #1
       01:ACAA  8D 78 29           sta    _line_deltax
       01:ACAD  AD 79 29           lda    _line_deltax+1
       01:ACB0  E9 00              sbc    #0
       01:ACB2  8D 79 29           sta    _line_deltax+1
 1670                               tstw  _line_deltax
       01:ACB5  AD 78 29           lda   _line_deltax               ; value at stated memory
       01:ACB8  0D 79 29           ora   _line_deltax+1             ; location is zero
 1671                               lbeq  .out
       01:ACBB  D0 03              bne    .x_00421
       01:ACBD  4C 21 AE           jmp    .out
       01:ACC0            .x_00421
 1672                     
 1673  01:ACC0  AD 80 29            lda   _line_xdir              ; adjust currx
 1674  01:ACC3  F0 13               beq   .xlppos
 1675                     
 1676                               decw  _line_currx
       01:ACC5  38                 sec                    ; value at stated memory
       01:ACC6  AD 74 29           lda    _line_currx              ; location
       01:ACC9  E9 01              sbc    #1
       01:ACCB  8D 74 29           sta    _line_currx
       01:ACCE  AD 75 29           lda    _line_currx+1
       01:ACD1  E9 00              sbc    #0
       01:ACD3  8D 75 29           sta    _line_currx+1
 1677  01:ACD6  80 08               bra   .xlp2
 1678                     
 1679                     .xlppos:  incw  _line_currx
       01:ACD8  EE 74 29           inc    _line_currx              ; value at stated memory
       01:ACDB  D0 03              bne    .x_00423           ; location
       01:ACDD  EE 75 29           inc    _line_currx+1
       01:ACE0            .x_00423:
 1680                     
 1681  01:ACE0            .xlp2:
 1682  01:ACE0  AD 7D 29            lda   HIGH_BYTE _line_error
 1683  01:ACE3  30 1D               bmi   .xlp3
 1684                     
 1685                               addw  _line_adjust,_line_error
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:ACE5  18                 clc
       01:ACE6  AD 7C 29           lda    LOW_BYTE _line_error
       01:ACE9  6D 7E 29           adc    LOW_BYTE _line_adjust
       01:ACEC  8D 7C 29           sta    LOW_BYTE _line_error
       01:ACEF  AD 7D 29           lda    HIGH_BYTE _line_error
       01:ACF2  6D 7F 29           adc    HIGH_BYTE _line_adjust
       01:ACF5  8D 7D 29           sta    HIGH_BYTE _line_error
                                  .endif
 1686                               incw  _line_curry
       01:ACF8  EE 76 29           inc    _line_curry              ; value at stated memory
       01:ACFB  D0 03              bne    .x_00425           ; location
       01:ACFD  EE 77 29           inc    _line_curry+1
       01:AD00            .x_00425:
 1687  01:AD00  80 87               bra   .xlp1
 1688  01:AD02            .xlp3:
 1689                               addw  _line_deltay,_line_error
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:AD02  18                 clc
       01:AD03  AD 7C 29           lda    LOW_BYTE _line_error
       01:AD06  6D 7A 29           adc    LOW_BYTE _line_deltay
       01:AD09  8D 7C 29           sta    LOW_BYTE _line_error
       01:AD0C  AD 7D 29           lda    HIGH_BYTE _line_error
       01:AD0F  6D 7B 29           adc    HIGH_BYTE _line_deltay
       01:AD12  8D 7D 29           sta    HIGH_BYTE _line_error
                                  .endif
 1690                               addw  _line_deltay,_line_error
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:AD15  18                 clc
       01:AD16  AD 7C 29           lda    LOW_BYTE _line_error
       01:AD19  6D 7A 29           adc    LOW_BYTE _line_deltay
       01:AD1C  8D 7C 29           sta    LOW_BYTE _line_error
       01:AD1F  AD 7D 29           lda    HIGH_BYTE _line_error
       01:AD22  6D 7B 29           adc    HIGH_BYTE _line_deltay
       01:AD25  8D 7D 29           sta    HIGH_BYTE _line_error
                                  .endif
 1691  01:AD28  4C 89 AC            jmp   .xlp1
 1692                     
 1693  01:AD2B            .ybiglp:
 1694                             __ldw   _line_deltax
                0000              .if (1 = 2)
                                  .else
       01:AD2B  AE 78 29           ldx    _line_deltax
       01:AD2E  AD 79 29           lda    _line_deltax+1
                                  .endif
 1695                             __aslw
       01:AD31  22                 sax
       01:AD32  0A                 asl    A
       01:AD33  22                 sax
       01:AD34  2A                 rol    A
 1696                             __stw   _line_adjust
       01:AD35  8E 7E 29           stx    _line_adjust
       01:AD38  8D 7F 29           sta    _line_adjust+1
 1697                             __stw   _line_error
       01:AD3B  8E 7C 29           stx    _line_error
       01:AD3E  8D 7D 29           sta    _line_error+1
 1698                     
 1699                               subw  _line_deltay,_line_adjust
       01:AD41  38                 sec
       01:AD42  AD 7E 29           lda    LOW_BYTE _line_adjust
       01:AD45  ED 7A 29           sbc    LOW_BYTE _line_deltay
       01:AD48  8D 7E 29           sta    LOW_BYTE _line_adjust
       01:AD4B  AD 7F 29           lda    HIGH_BYTE _line_adjust
       01:AD4E  ED 7B 29           sbc    HIGH_BYTE _line_deltay
       01:AD51  8D 7F 29           sta    HIGH_BYTE _line_adjust
 1700                               subw  _line_deltay,_line_adjust
       01:AD54  38                 sec
       01:AD55  AD 7E 29           lda    LOW_BYTE _line_adjust
       01:AD58  ED 7A 29           sbc    LOW_BYTE _line_deltay
       01:AD5B  8D 7E 29           sta    LOW_BYTE _line_adjust
       01:AD5E  AD 7F 29           lda    HIGH_BYTE _line_adjust
       01:AD61  ED 7B 29           sbc    HIGH_BYTE _line_deltay
       01:AD64  8D 7F 29           sta    HIGH_BYTE _line_adjust
 1701                             
 1702                               subw  _line_deltay,_line_error
       01:AD67  38                 sec
       01:AD68  AD 7C 29           lda    LOW_BYTE _line_error
       01:AD6B  ED 7A 29           sbc    LOW_BYTE _line_deltay
       01:AD6E  8D 7C 29           sta    LOW_BYTE _line_error
       01:AD71  AD 7D 29           lda    HIGH_BYTE _line_error
       01:AD74  ED 7B 29           sbc    HIGH_BYTE _line_deltay
       01:AD77  8D 7D 29           sta    HIGH_BYTE _line_error
 1703                     
 1704                               incw  _line_deltay            ; used as counter - get both endpoints
       01:AD7A  EE 7A 29           inc    _line_deltay              ; value at stated memory
       01:AD7D  D0 03              bne    .x_00435           ; location
       01:AD7F  EE 7B 29           inc    _line_deltay+1
       01:AD82            .x_00435:
 1705                     
 1706  01:AD82            .ylp1:
 1707                               stw   _line_currx,<_bx        ; draw pixel
       01:AD82  AD 74 29           lda    LOW_BYTE _line_currx
       01:AD85  85 FA              sta    LOW_BYTE <_bx
       01:AD87  AD 75 29           lda    HIGH_BYTE _line_currx
       01:AD8A  85 FB              sta    HIGH_BYTE <_bx
 1708                               stw   _line_curry,<_cx
       01:AD8C  AD 76 29           lda    LOW_BYTE _line_curry
       01:AD8F  85 FC              sta    LOW_BYTE <_cx
       01:AD91  AD 77 29           lda    HIGH_BYTE _line_curry
       01:AD94  85 FD              sta    HIGH_BYTE <_cx
 1709  01:AD96  AE 81 29            ldx   _line_color
 1710  01:AD99  62                  cla
 1711  01:AD9A  20 22 AE            jsr   lib2_gfx_plot.3
 1712                     
 1713                               decw  _line_deltay            ; dec counter
       01:AD9D  38                 sec                    ; value at stated memory
       01:AD9E  AD 7A 29           lda    _line_deltay              ; location
       01:ADA1  E9 01              sbc    #1
       01:ADA3  8D 7A 29           sta    _line_deltay
       01:ADA6  AD 7B 29           lda    _line_deltay+1
       01:ADA9  E9 00              sbc    #0
       01:ADAB  8D 7B 29           sta    _line_deltay+1
 1714                               tstw  _line_deltay
       01:ADAE  AD 7A 29           lda   _line_deltay               ; value at stated memory
       01:ADB1  0D 7B 29           ora   _line_deltay+1             ; location is zero
 1715  01:ADB4  F0 6B               beq   .out
 1716                     
 1717                               incw  _line_curry
       01:ADB6  EE 76 29           inc    _line_curry              ; value at stated memory
       01:ADB9  D0 03              bne    .x_00440           ; location
       01:ADBB  EE 77 29           inc    _line_curry+1
       01:ADBE            .x_00440:
 1718                     
 1719  01:ADBE  AD 7D 29            lda   HIGH_BYTE _line_error
 1720  01:ADC1  30 35               bmi   .ylp2
 1721                     
 1722                               addw  _line_adjust,_line_error
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:ADC3  18                 clc
       01:ADC4  AD 7C 29           lda    LOW_BYTE _line_error
       01:ADC7  6D 7E 29           adc    LOW_BYTE _line_adjust
       01:ADCA  8D 7C 29           sta    LOW_BYTE _line_error
       01:ADCD  AD 7D 29           lda    HIGH_BYTE _line_error
       01:ADD0  6D 7F 29           adc    HIGH_BYTE _line_adjust
       01:ADD3  8D 7D 29           sta    HIGH_BYTE _line_error
                                  .endif
 1723  01:ADD6  AD 80 29            lda   _line_xdir
 1724  01:ADD9  F0 13               beq   .ylppos
 1725                     
 1726                               decw  _line_currx
       01:ADDB  38                 sec                    ; value at stated memory
       01:ADDC  AD 74 29           lda    _line_currx              ; location
       01:ADDF  E9 01              sbc    #1
       01:ADE1  8D 74 29           sta    _line_currx
       01:ADE4  AD 75 29           lda    _line_currx+1
       01:ADE7  E9 00              sbc    #0
       01:ADE9  8D 75 29           sta    _line_currx+1
 1727  01:ADEC  80 94               bra   .ylp1
 1728                     
 1729                     .ylppos:  incw  _line_currx
       01:ADEE  EE 74 29           inc    _line_currx              ; value at stated memory
       01:ADF1  D0 03              bne    .x_00443           ; location
       01:ADF3  EE 75 29           inc    _line_currx+1
       01:ADF6            .x_00443:
 1730  01:ADF6  80 8A               bra   .ylp1
 1731                     
 1732  01:ADF8            .ylp2:
 1733                               addw  _line_deltax,_line_error
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:ADF8  18                 clc
       01:ADF9  AD 7C 29           lda    LOW_BYTE _line_error
       01:ADFC  6D 78 29           adc    LOW_BYTE _line_deltax
       01:ADFF  8D 7C 29           sta    LOW_BYTE _line_error
       01:AE02  AD 7D 29           lda    HIGH_BYTE _line_error
       01:AE05  6D 79 29           adc    HIGH_BYTE _line_deltax
       01:AE08  8D 7D 29           sta    HIGH_BYTE _line_error
                                  .endif
 1734                               addw  _line_deltax,_line_error
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:AE0B  18                 clc
       01:AE0C  AD 7C 29           lda    LOW_BYTE _line_error
       01:AE0F  6D 78 29           adc    LOW_BYTE _line_deltax
       01:AE12  8D 7C 29           sta    LOW_BYTE _line_error
       01:AE15  AD 7D 29           lda    HIGH_BYTE _line_error
       01:AE18  6D 79 29           adc    HIGH_BYTE _line_deltax
       01:AE1B  8D 7D 29           sta    HIGH_BYTE _line_error
                                  .endif
 1735  01:AE1E  4C 82 AD            jmp   .ylp1
 1736                     
 1737  01:AE21            .out:
 1738  01:AE21  60                  rts
 1739                     
 1740                     
 1741                     ; gfx_plot(int x [bx], int y [cx], char color [reg acc])
 1742                     ; ----
 1743                     ; Plot a point at location (x,y) in color
 1744                     ; ----
 1745                     
 1746  01:AE22            lib2_gfx_plot.3:
 1747  01:AE22  86 FE               stx   <_dl            ; color
 1748  01:AE24  20 33 AF            jsr   gfx_getaddr
 1749                     
 1750                             ; same as vm_rawread - save 21 cycles by inlining
 1751                             ;
 1752                               vreg  #1              ; video read register
       01:AE27  A9 01              lda    #1
       01:AE29  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AE2B  03 01               st0   #1
                                   .else
                                   .endif
 1753                               stw   <_cx,video_data ; VRAM address
       01:AE2D  A5 FC              lda    LOW_BYTE <_cx
       01:AE2F  8D 02 00           sta    LOW_BYTE video_data
       01:AE32  A5 FD              lda    HIGH_BYTE <_cx
       01:AE34  8D 03 00           sta    HIGH_BYTE video_data
 1754                               vreg  #2              ; set R/W memory mode
       01:AE37  A9 02              lda    #2
       01:AE39  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AE3B  03 02               st0   #2
                                   .else
                                   .endif
 1755                             __ldw   video_data
                0000              .if (1 = 2)
                                  .else
       01:AE3D  AE 02 00           ldx    video_data
       01:AE40  AD 03 00           lda    video_data+1
                                  .endif
 1756                             ;
 1757                             ; end inline
 1758                     
 1759  01:AE43  A4 F8               ldy   <_al            ; bit offset
 1760  01:AE45  1F FE 05            bbr1  <_dl,.l1
 1761  01:AE48  19 23 AF            ora   gfx_bittbl,Y    ; set bit
 1762  01:AE4B  80 03               bra   .l1a
 1763  01:AE4D  39 2B AF  .l1:      and   gfx_bittbl2,Y   ; else mask bit
 1764  01:AE50            .l1a:
 1765  01:AE50  22                  sax
 1766  01:AE51  0F FE 05            bbr0  <_dl,.l2
 1767  01:AE54  19 23 AF            ora   gfx_bittbl,Y    ; set bit
 1768  01:AE57  80 03               bra   .l2a
 1769  01:AE59  39 2B AF  .l2:      and   gfx_bittbl2,Y   ; else mask bit
 1770  01:AE5C            .l2a:
 1771                             ; same as vm_rawwrite - save >14 cycles by inlining
 1772                             ;
 1773  01:AE5C  DA                  phx
 1774  01:AE5D  AA                  tax
 1775                               vreg  #0              ; video write register
       01:AE5E  A9 00              lda    #0
       01:AE60  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AE62  03 00               st0   #0
                                   .else
                                   .endif
 1776                               stw   <_cx,video_data ; VRAM address
       01:AE64  A5 FC              lda    LOW_BYTE <_cx
       01:AE66  8D 02 00           sta    LOW_BYTE video_data
       01:AE69  A5 FD              lda    HIGH_BYTE <_cx
       01:AE6B  8D 03 00           sta    HIGH_BYTE video_data
 1777                               vreg  #2              ; set R/W memory mode
       01:AE6E  A9 02              lda    #2
       01:AE70  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AE72  03 02               st0   #2
                                   .else
                                   .endif
 1778  01:AE74  68                  pla
 1779                             __stw   video_data      ; write
       01:AE75  8E 02 00           stx    video_data
       01:AE78  8D 03 00           sta    video_data+1
 1780                             ;
 1781                             ; end inline
 1782                     
 1783                               addw  #8,<_cx         ; other half of pixel
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:AE7B  18                 clc
       01:AE7C  A5 FC              lda    LOW_BYTE <_cx
       01:AE7E  69 08              adc    LOW_BYTE #8
       01:AE80  85 FC              sta    LOW_BYTE <_cx
       01:AE82  A5 FD              lda    HIGH_BYTE <_cx
       01:AE84  69 00              adc    HIGH_BYTE #8
       01:AE86  85 FD              sta    HIGH_BYTE <_cx
                                  .endif
 1784                     
 1785                             ; same as vm_rawread - save 21 cycles by inlining
 1786                             ;
 1787                               vreg  #1              ; video read register
       01:AE88  A9 01              lda    #1
       01:AE8A  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AE8C  03 01               st0   #1
                                   .else
                                   .endif
 1788                               stw   <_cx,video_data ; VRAM address
       01:AE8E  A5 FC              lda    LOW_BYTE <_cx
       01:AE90  8D 02 00           sta    LOW_BYTE video_data
       01:AE93  A5 FD              lda    HIGH_BYTE <_cx
       01:AE95  8D 03 00           sta    HIGH_BYTE video_data
 1789                               vreg  #2              ; set R/W memory mode
       01:AE98  A9 02              lda    #2
       01:AE9A  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AE9C  03 02               st0   #2
                                   .else
                                   .endif
 1790                             __ldw   video_data
                0000              .if (1 = 2)
                                  .else
       01:AE9E  AE 02 00           ldx    video_data
       01:AEA1  AD 03 00           lda    video_data+1
                                  .endif
 1791                             ;
 1792                             ; end inline
 1793                     
 1794  01:AEA4  A4 F8               ldy   <_al            ; bit offset
 1795  01:AEA6  3F FE 05            bbr3  <_dl,.l3
 1796  01:AEA9  19 23 AF            ora   gfx_bittbl,Y    ; set bit
 1797  01:AEAC  80 03               bra   .l3a
 1798  01:AEAE  39 2B AF  .l3:      and   gfx_bittbl2,Y   ; else mask bit
 1799  01:AEB1            .l3a:
 1800  01:AEB1  22                  sax
 1801  01:AEB2  2F FE 05            bbr2  <_dl,.l4
 1802  01:AEB5  19 23 AF            ora   gfx_bittbl,Y    ; set bit
 1803  01:AEB8  80 03               bra   .l4a
 1804  01:AEBA  39 2B AF  .l4:      and   gfx_bittbl2,Y   ; mask bit
 1805  01:AEBD            .l4a:
 1806                             ; same as vm_rawwrite - save >14 cycles by inlining
 1807                             ;
 1808  01:AEBD  DA                  phx
 1809  01:AEBE  AA                  tax
 1810                               vreg  #0              ; video write register
       01:AEBF  A9 00              lda    #0
       01:AEC1  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AEC3  03 00               st0   #0
                                   .else
                                   .endif
 1811                               stw   <_cx,video_data ; VRAM address
       01:AEC5  A5 FC              lda    LOW_BYTE <_cx
       01:AEC7  8D 02 00           sta    LOW_BYTE video_data
       01:AECA  A5 FD              lda    HIGH_BYTE <_cx
       01:AECC  8D 03 00           sta    HIGH_BYTE video_data
 1812                               vreg  #2              ; set R/W memory mode
       01:AECF  A9 02              lda    #2
       01:AED1  85 F7              sta    <vdc_reg
                0001               .if (2 = ARG_IMMED)
       01:AED3  03 02               st0   #2
                                   .else
                                   .endif
 1813  01:AED5  68                  pla
 1814                             __stw   video_data      ; write
       01:AED6  8E 02 00           stx    video_data
       01:AED9  8D 03 00           sta    video_data+1
 1815                             ;
 1816                             ; end inline
 1817                     
 1818  01:AEDC  60                  rts
 1819                     
 1820                     
 1821                     ; gfx_point(int x [bx], int y [cx])
 1822                     ; ----
 1823                     ; Returns color of point at location (x,y)
 1824                     ; ----
 1825                     
 1826  01:AEDD            lib2_gfx_point.2:
 1827  01:AEDD  20 33 AF            jsr   gfx_getaddr
 1828  01:AEE0  64 F9               stz   <_ah            ; will be color
 1829                             __ldw   <_cx            ; VRAM address
                0000              .if (1 = 2)
                                  .else
       01:AEE2  A6 FC              ldx    <_cx
       01:AEE4  A5 FD              lda    <_cx+1
                                  .endif
 1830  01:AEE6  20 2F F6            jsr   readvram
 1831                     
 1832  01:AEE9  A4 F8               ldy   <_al            ; bit offset
 1833  01:AEEB  39 23 AF            and   gfx_bittbl,Y
 1834  01:AEEE  F0 02               beq   .l1
 1835  01:AEF0  97 F9               smb1  <_ah
 1836  01:AEF2  8A        .l1:      txa
 1837  01:AEF3  39 23 AF            and   gfx_bittbl,Y
 1838  01:AEF6  F0 02               beq   .l2
 1839  01:AEF8  87 F9               smb0  <_ah
 1840  01:AEFA            .l2:
 1841                               addw  #8,<_cx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:AEFA  18                 clc
       01:AEFB  A5 FC              lda    LOW_BYTE <_cx
       01:AEFD  69 08              adc    LOW_BYTE #8
       01:AEFF  85 FC              sta    LOW_BYTE <_cx
       01:AF01  A5 FD              lda    HIGH_BYTE <_cx
       01:AF03  69 00              adc    HIGH_BYTE #8
       01:AF05  85 FD              sta    HIGH_BYTE <_cx
                                  .endif
 1842                             __ldw   <_cx            ; VRAM address part 2
                0000              .if (1 = 2)
                                  .else
       01:AF07  A6 FC              ldx    <_cx
       01:AF09  A5 FD              lda    <_cx+1
                                  .endif
 1843  01:AF0B  20 2F F6            jsr   readvram
 1844                     
 1845  01:AF0E  A4 F8               ldy   <_al
 1846  01:AF10  39 23 AF            and   gfx_bittbl,Y
 1847  01:AF13  F0 02               beq   .l3
 1848  01:AF15  B7 F9               smb3  <_ah
 1849  01:AF17  8A        .l3:      txa
 1850  01:AF18  39 23 AF            and   gfx_bittbl,Y
 1851  01:AF1B  F0 02               beq   .l4
 1852  01:AF1D  A7 F9               smb2  <_ah
 1853  01:AF1F            .l4:
 1854  01:AF1F  A6 F9               ldx   <_ah
 1855  01:AF21  62                  cla
 1856  01:AF22  60                  rts
 1857                     
 1858                     
 1859  01:AF23            gfx_bittbl:
 1860  01:AF23  80 40 20            .db   $80,$40,$20,$10,$08,$04,$02,$01
       01:AF26  10 08 04  
       01:AF29  02 01     
 1861  01:AF2B            gfx_bittbl2:
 1862  01:AF2B  7F BF DF            .db   $7f,$bf,$df,$ef,$f7,$fb,$fd,$fe
       01:AF2E  EF F7 FB  
       01:AF31  FD FE     
 1863                     
 1864                     
 1865                     ; gfx_getaddr
 1866                     ; ----
 1867                     ; Utility routine to switch x/y pixel
 1868                     ; co-ordinates into VRAM addr and bit #
 1869                     ; ----
 1870                     
 1871  01:AF33            gfx_getaddr:
 1872  01:AF33  A5 FC               lda   <_cl
 1873  01:AF35  29 07               and   #7
 1874  01:AF37  85 F8               sta   <_al    ; al = lines from tile base
 1875                     
 1876  01:AF39  A5 FA               lda   <_bl
 1877  01:AF3B  29 07               and   #7
 1878  01:AF3D  48                  pha           ; = bit offset
 1879                     
 1880                             __ldw   <_bx
                0000              .if (1 = 2)
                                  .else
       01:AF3E  A6 FA              ldx    <_bx
       01:AF40  A5 FB              lda    <_bx+1
                                  .endif
 1881                             __lsrw          ; should be only 2 bits in MSB are possible
       01:AF42  4A                lsr     A
       01:AF43  22                sax
       01:AF44  6A                ror     A
       01:AF45  22                sax
 1882                             __lsrw          ; but we'll shift 3 times anyway
       01:AF46  4A                lsr     A
       01:AF47  22                sax
       01:AF48  6A                ror     A
       01:AF49  22                sax
 1883                             __lsrw
       01:AF4A  4A                lsr     A
       01:AF4B  22                sax
       01:AF4C  6A                ror     A
       01:AF4D  22                sax
 1884  01:AF4E  DA                  phx           ; X = character column
 1885                     
 1886                             __ldw   <_cx
                0000              .if (1 = 2)
                                  .else
       01:AF4F  A6 FC              ldx    <_cx
       01:AF51  A5 FD              lda    <_cx+1
                                  .endif
 1887                             __lsrw          ; should be only 2 bits in MSB are possible
       01:AF53  4A                lsr     A
       01:AF54  22                sax
       01:AF55  6A                ror     A
       01:AF56  22                sax
 1888                             __lsrw          ; but we'll shift 3 times anyway
       01:AF57  4A                lsr     A
       01:AF58  22                sax
       01:AF59  6A                ror     A
       01:AF5A  22                sax
 1889                             __lsrw
       01:AF5B  4A                lsr     A
       01:AF5C  22                sax
       01:AF5D  6A                ror     A
       01:AF5E  22                sax
 1890  01:AF5F  8A                  txa           ; A = character row
 1891                     
 1892  01:AF60  FA                  plx
 1893  01:AF61  20 C2 E4            jsr   calc_vram_addr
 1894                     
 1895                             __ldw   <_di            ; to get BAT addr
                0000              .if (1 = 2)
                                  .else
       01:AF64  A6 F0              ldx    <_di
       01:AF66  A5 F1              lda    <_di+1
                                  .endif
 1896  01:AF68  20 2F F6            jsr   readvram        ; read BAT value
 1897                             __aslw                  ; change into VRAM tile addr
       01:AF6B  22                 sax
       01:AF6C  0A                 asl    A
       01:AF6D  22                 sax
       01:AF6E  2A                 rol    A
 1898                             __aslw
       01:AF6F  22                 sax
       01:AF70  0A                 asl    A
       01:AF71  22                 sax
       01:AF72  2A                 rol    A
 1899                             __aslw
       01:AF73  22                 sax
       01:AF74  0A                 asl    A
       01:AF75  22                 sax
       01:AF76  2A                 rol    A
 1900                             __aslw                  ; cx = VRAM addr start of tile
       01:AF77  22                 sax
       01:AF78  0A                 asl    A
       01:AF79  22                 sax
       01:AF7A  2A                 rol    A
 1901                     
 1902  01:AF7B  22                  sax
 1903  01:AF7C  18                  clc                   ; add row within tile
 1904  01:AF7D  65 F8               adc   <_al
 1905  01:AF7F  22                  sax
 1906  01:AF80  69 00               adc   #0
 1907                             __stw   <_cx
       01:AF82  86 FC              stx    <_cx
       01:AF84  85 FD              sta    <_cx+1
 1908                     
 1909  01:AF86  68                  pla
 1910  01:AF87  85 F8               sta   <_al            ; al = bit offset
 1911                     
 1912  01:AF89  60                  rts
 1913                     
 1914                     ; Change back to original LIB1_BANK context
 1915                     
 1916           0000               .bank  LIB1_BANK
 1917                     
 1918                     
 1919                     
#[4]   sup_hes.asm
#[5]   huc_math.asm
 1302                             .include "huc_math.asm"
    1                     ;
    2                     ; HUC_MATH.ASM  -  HuC Math Library
    3                     ;
    4                     
    5                     ; abs(int val)
    6                     ; ---
    7                     
    8  00:F726            _abs:
    9  00:F726  A8                tay
   10  00:F727  10 0B             bpl     .l1
   11  00:F729  22                sax
   12  00:F72A  49 FF             eor     #$FF
   13                             add     #1
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       00:F72C  18                 clc
       00:F72D  69 01              adc    #1
                                  .endif
   14  00:F72F  22                sax
   15  00:F730  49 FF             eor     #$FF
   16  00:F732  69 00             adc     #0
   17  00:F734            .l1:
   18  00:F734  60                rts
   19                     
   20                     ; mov32(void *dst [di], void *src)
   21                     ; ----
   22                     
   23  00:F735            _mov32.2:
   24                             __stw   <_si
       00:F735  86 EE              stx    <_si
       00:F737  85 EF              sta    <_si+1
   25  00:F739            _mov32.sub:
   26  00:F739  A0 03               ldy   #3
   27  00:F73B  B1 EE     .l1:      lda   [_si],Y
   28  00:F73D  91 F0               sta   [_di],Y
   29  00:F73F  88                  dey
   30  00:F740  10 F9               bpl   .l1
   31  00:F742  60                  rts
   32                     
   33                     ; add32(void *dst [di], void *src) /* ax|bx */
   34                     ; ----
   35                     
   36  00:F743            _add32.2:
   37                             __stw   <_si
       00:F743  86 EE              stx    <_si
       00:F745  85 EF              sta    <_si+1
   38  00:F747  18                  clc
   39  00:F748  C2                  cly
   40  00:F749  A2 04               ldx   #4
   41  00:F74B  B1 F0     .l1:      lda   [_di],Y
   42  00:F74D  71 EE               adc   [_si],Y
   43  00:F74F  91 F0               sta   [_di],Y
   44  00:F751  C8                  iny
   45  00:F752  CA                  dex
   46  00:F753  D0 F6               bne   .l1
   47  00:F755  60                  rts
   48                     
   49                     ; sub32(void *dst [di], void *src)
   50                     ; ----
   51                     
   52  00:F756            _sub32.2:
   53                             __stw   <_si
       00:F756  86 EE              stx    <_si
       00:F758  85 EF              sta    <_si+1
   54  00:F75A  38                  sec
   55  00:F75B  C2                  cly
   56  00:F75C  A2 04               ldx   #4
   57  00:F75E  B1 F0     .l1:      lda   [_di],Y
   58  00:F760  F1 EE               sbc   [_si],Y
   59  00:F762  91 F0               sta   [_di],Y
   60  00:F764  C8                  iny
   61  00:F765  CA                  dex
   62  00:F766  D0 F6               bne   .l1
   63  00:F768  60                  rts
   64                     
   65                     ; mul32(void *dst [bp], void *src)
   66                     ; ----
   67                     
   68  00:F769            _mul32.2:
   69                             __stw   <_si
       00:F769  86 EE              stx    <_si
       00:F76B  85 EF              sta    <_si+1
   70                               stw   #_ax,<_di
       00:F76D  A9 F8              lda    LOW_BYTE #_ax
       00:F76F  85 F0              sta    LOW_BYTE <_di
       00:F771  A9 20              lda    HIGH_BYTE #_ax
       00:F773  85 F1              sta    HIGH_BYTE <_di
   71  00:F775  20 39 F7            jsr   _mov32.sub
   72                               stw   <_bp,<_si
       00:F778  A5 EC              lda    LOW_BYTE <_bp
       00:F77A  85 EE              sta    LOW_BYTE <_si
       00:F77C  A5 ED              lda    HIGH_BYTE <_bp
       00:F77E  85 EF              sta    HIGH_BYTE <_si
   73                               stw   #_cx,<_di
       00:F780  A9 FC              lda    LOW_BYTE #_cx
       00:F782  85 F0              sta    LOW_BYTE <_di
       00:F784  A9 20              lda    HIGH_BYTE #_cx
       00:F786  85 F1              sta    HIGH_BYTE <_di
   74  00:F788  20 39 F7            jsr   _mov32.sub
   75  00:F78B  20 CE E7            jsr    mulu32
   76                               stw   <_bp,<_di
       00:F78E  A5 EC              lda    LOW_BYTE <_bp
       00:F790  85 F0              sta    LOW_BYTE <_di
       00:F792  A5 ED              lda    HIGH_BYTE <_bp
       00:F794  85 F1              sta    HIGH_BYTE <_di
   77                               stw   #_cx,<_si
       00:F796  A9 FC              lda    LOW_BYTE #_cx
       00:F798  85 EE              sta    LOW_BYTE <_si
       00:F79A  A9 20              lda    HIGH_BYTE #_cx
       00:F79C  85 EF              sta    HIGH_BYTE <_si
   78  00:F79E  4C 39 F7            jmp   _mov32.sub
   79                     
   80                     ; div32(void *dst [di], void *src)
   81                     ; ----
   82                     
   83  00:F7A1            _div32.2:
   84  00:F7A1  60                  rts
   85                     
   86                     ; com32(void *dst)
   87                     ; ----
   88                     
   89  00:F7A2            _com32.1:
   90                             __stw   <_di
       00:F7A2  86 F0              stx    <_di
       00:F7A4  85 F1              sta    <_di+1
   91  00:F7A6  A0 03               ldy   #3
   92  00:F7A8  B1 F0     .l1:      lda   [_di],Y
   93  00:F7AA  49 FF               eor   #$FF
   94  00:F7AC  91 F0               sta   [_di],Y
   95  00:F7AE  88                  dey
   96  00:F7AF  10 F7               bpl   .l1
   97  00:F7B1  60                  rts
   98                             
   99                     ; cmp32(void *dst [di], void *src)
  100                     ; ----
  101                     
  102  00:F7B2            _cmp32.2:
  103                             __stw   <_si
       00:F7B2  86 EE              stx    <_si
       00:F7B4  85 EF              sta    <_si+1
  104  00:F7B6  A0 03               ldy   #3
  105  00:F7B8  B1 F0     .l1:      lda   [_di],Y
  106  00:F7BA  D1 EE               cmp   [_si],Y
  107  00:F7BC  D0 06               bne   .l2
  108  00:F7BE  88                  dey
  109  00:F7BF  10 F7               bpl   .l1
  110                               ; --
  111  00:F7C1  82                  clx
  112  00:F7C2  62                  cla
  113  00:F7C3  60                  rts
  114                               ; --
  115                     .l2:      blo   .l3
       00:F7C4  90 04              bcc    .l3
  116  00:F7C6  A2 01               ldx   #$01
  117  00:F7C8  62                  cla
  118  00:F7C9  60                  rts
  119                               ; --
  120  00:F7CA  A2 FF     .l3:      ldx   #$FF
  121  00:F7CC  8A                  txa
  122  00:F7CD  60                  rts
  123                     
  124                     ; bcd_init(char *dst [bx], char digits)
  125                     ; ----
  126                     
  127  00:F7CE            _bcd_init.2:
  128                               ; -- check digit number (max. 16)
  129  00:F7CE  8A                  txa
  130  00:F7CF  C9 10               cmp   #16
  131                               blo   .l1
       00:F7D1  90 02              bcc    .l1
  132  00:F7D3  A9 10               lda   #16
  133  00:F7D5  1A        .l1:      inc   A
  134  00:F7D6  4A                  lsr   A
  135  00:F7D7  09 80               ora   #$80
  136  00:F7D9  92 FA               sta   [_bx]
  137  00:F7DB            _bcd_init.clear:
  138                               ; -- clear bcd number
  139  00:F7DB  B2 FA               lda   [_bx]
  140  00:F7DD  29 1F               and   #$1F
  141  00:F7DF  A8                  tay
  142  00:F7E0  62                  cla
  143  00:F7E1  91 FA     .l2:      sta   [_bx],Y
  144  00:F7E3  88                  dey
  145  00:F7E4  D0 FB               bne   .l2
  146  00:F7E6  60                  rts
  147                     
  148                     ; bcd_set(char *dst [bx], char *src)
  149                     ; bcd_mov(char *dst [bx], char *src)
  150                     ; ----
  151                     
  152  00:F7E7            _bcd_set.2:
  153  00:F7E7            _bcd_mov.2:
  154                             __stw   <_si
       00:F7E7  86 EE              stx    <_si
       00:F7E9  85 EF              sta    <_si+1
  155  00:F7EB  05 EE               ora   <_si
  156  00:F7ED  F0 EC               beq   _bcd_init.clear
  157                               ; -- check dst
  158  00:F7EF  B2 FA               lda   [_bx]
  159  00:F7F1  10 0B               bpl   .x1
  160  00:F7F3  29 1F               and   #$1F
  161  00:F7F5  F0 07               beq   .x1
  162  00:F7F7  AA                  tax
  163                               ; -- check src type
  164  00:F7F8  B2 EE               lda   [_si]
  165  00:F7FA  10 03               bpl   _bcd_set.ascii
  166  00:F7FC  80 33               bra   _bcd_set.bcd
  167  00:F7FE  60        .x1:      rts
  168                         ; ----
  169                         ; ... from an ascii string (ie. "100")
  170                         ;
  171  00:F7FF            _bcd_set.ascii:
  172                               ; -- get string length
  173  00:F7FF  C2                  cly
  174  00:F800  B1 EE     .l1:      lda   [_si],Y
  175  00:F802  C9 30               cmp   #48
  176                               blo   .l2
       00:F804  90 07              bcc    .l2
  177  00:F806  C9 3A               cmp   #58
  178                               bhs   .l2
       00:F808  B0 03              bcs    .l2
  179  00:F80A  C8                  iny
  180  00:F80B  80 F3               bra   .l1
  181                               ; -- check if the string is empty 
  182  00:F80D  98        .l2:      tya
  183  00:F80E  F0 CB               beq   _bcd_init.clear
  184                               ; -- copy number
  185  00:F810  62        .l3:      cla
  186  00:F811  88                  dey
  187  00:F812  30 15               bmi   .l4
  188  00:F814  B1 EE               lda   [_si],Y
  189                               sub   #48
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F816  38                 sec
       00:F817  E9 30              sbc    #48
                                  .endif
  190  00:F819  85 FE               sta   <_dl
  191  00:F81B  88                  dey
  192  00:F81C  30 0B               bmi   .l4
  193  00:F81E  B1 EE               lda   [_si],Y
  194                               sub   #48
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:F820  38                 sec
       00:F821  E9 30              sbc    #48
                                  .endif
  195  00:F823  0A                  asl   A
  196  00:F824  0A                  asl   A
  197  00:F825  0A                  asl   A
  198  00:F826  0A                  asl   A
  199  00:F827  05 FE               ora   <_dl
  200  00:F829  02        .l4:      sxy
  201  00:F82A  91 FA               sta   [_bx],Y
  202  00:F82C  02                  sxy
  203  00:F82D  CA                  dex
  204  00:F82E  D0 E0               bne   .l3
  205  00:F830  60                  rts
  206                     
  207                         ; ----
  208                         ; ... from another bcd number
  209                         ;
  210  00:F831            _bcd_set.bcd:
  211                               ; -- get src size
  212  00:F831  B2 EE               lda   [_si]
  213  00:F833  10 18               bpl   .x1
  214  00:F835  29 1F               and   #$1F
  215  00:F837  F0 14               beq   .x1
  216  00:F839  A8                  tay
  217                               ; -- copy number
  218  00:F83A  B1 EE     .l1:      lda   [_si],Y
  219  00:F83C  02                  sxy
  220  00:F83D  91 FA               sta   [_bx],Y
  221  00:F83F  88                  dey
  222  00:F840  F0 0B               beq   .x1
  223  00:F842  02                  sxy
  224  00:F843  88                  dey
  225  00:F844  D0 F4               bne   .l1
  226                               ; -- adjust number
  227  00:F846  02                  sxy
  228  00:F847  62                  cla
  229  00:F848  91 FA     .l2:      sta   [_bx],Y
  230  00:F84A  88                  dey
  231  00:F84B  D0 FB               bne   .l2
  232  00:F84D  60        .x1:      rts
  233                     
  234                     ; bcd_add(char *dst [di], char *src)
  235                     ; ----
  236                     
  237  00:F84E            _bcd_add.2:
  238                             __stw   <_si
       00:F84E  86 EE              stx    <_si
       00:F850  85 EF              sta    <_si+1
  239  00:F852  05 EE               ora   <_si
  240  00:F854  F0 3D               beq   .x1
  241                               ; -- check dst
  242  00:F856  B2 F0               lda   [_di]
  243  00:F858  10 39               bpl   .x1
  244  00:F85A  29 1F               and   #$1F
  245  00:F85C  F0 35               beq   .x1
  246  00:F85E  AA                  tax
  247  00:F85F  86 FC               stx   <_cl
  248                               ; -- check src
  249  00:F861  B2 EE               lda   [_si]
  250  00:F863  30 19               bmi   .l1
  251                               ; -- convert ascii string
  252                               stw   #__temp,<_bx
       00:F865  A9 03              lda    LOW_BYTE #__temp
       00:F867  85 FA              sta    LOW_BYTE <_bx
       00:F869  A9 20              lda    HIGH_BYTE #__temp
       00:F86B  85 FB              sta    HIGH_BYTE <_bx
  253  00:F86D  20 FF F7            jsr   _bcd_set.ascii
  254                               stw   #__temp,<_si
       00:F870  A9 03              lda    LOW_BYTE #__temp
       00:F872  85 EE              sta    LOW_BYTE <_si
       00:F874  A9 20              lda    HIGH_BYTE #__temp
       00:F876  85 EF              sta    HIGH_BYTE <_si
  255  00:F878  A6 FC               ldx   <_cl
  256  00:F87A  A4 FC               ldy   <_cl
  257  00:F87C  80 07               bra   .l2
  258                               ; -- get src size
  259  00:F87E  29 1F     .l1:      and   #$1F
  260  00:F880  F0 11               beq   .x1
  261  00:F882  A8                  tay
  262                               ; -- add numbers
  263  00:F883  18                  clc
  264  00:F884  F8                  sed
  265  00:F885  B1 F0     .l2:      lda   [_di],Y
  266  00:F887  02                  sxy
  267  00:F888  71 F0               adc   [_di],Y
  268  00:F88A  91 F0               sta   [_di],Y
  269  00:F88C  CA                  dex
  270  00:F88D  F0 0C               beq   .l4
  271  00:F88F  02                  sxy
  272  00:F890  CA                  dex
  273  00:F891  D0 F2               bne   .l2
  274                               ; --
  275  00:F893  D8        .x1:      cld
  276  00:F894  60                  rts
  277                               ; -- carry
  278  00:F895  B1 F0     .l3:      lda   [_di],Y
  279  00:F897  69 00               adc   #0
  280  00:F899  91 F0               sta   [_di],Y
  281  00:F89B  90 F6     .l4:      bcc   .x1
  282  00:F89D  88                  dey
  283  00:F89E  D0 F5               bne   .l3
  284  00:F8A0  D8                  cld
  285  00:F8A1  60                  rts
  286                     
#[4]   sup_hes.asm
#[5]   huc_bram.asm
 1303                             .include "huc_bram.asm"
    1                     ;
    2                     ; HUC_BRAM.ASM  -  HuC Backup RAM Library
    3                     ;
    4                     
    5           2982                      .bss
    6  --:2982            _bm_mpr4:       .ds 1
    7  --:2983            _bm_error:      .ds 1
    8           F8A2                      .code
    9                     
   10                     ; NOTE: the BRAM format is as follows:
   11                     ;
   12                     ; BRAM bank header (0x10 bytes):
   13                     ; ------------------------------
   14                     ; - Header tag (4 bytes) = 'HUBM'
   15                     ;
   16                     ; - Pointer to 1st byte after BRAM (2 byte int)
   17                     ;   Note: relative to 0x8000 segment, hex example: 00 88 ($8800)
   18                     ;
   19                     ; - Pointer to next available BRAM slot (2 byte int)
   20                     ;   Note: relative to 0x8000 segment, hex example: 22 80 ($8022)
   21                     ;
   22                     ; - Zeroes (8 bytes)
   23                     ;
   24                     ; BRAM Entry Header (0x10 bytes):
   25                     ; -------------------------------
   26                     ; - Size of entry (2 bytes), hex example: 12 00 ($0012)
   27                     ;   This size includes the 0x10 bytes used by this header information
   28                     ;
   29                     ; - Checksum (2 bytes)
   30                     ;   This number added to the data should total to 0
   31                     ;
   32                     ; - Name (12 bytes)
   33                     ;   This subdivides into:
   34                     ;   - Unique ID (2 bytes); I have only ever seen 00 00 in this entry
   35                     ;     However, it appears to be an integral part of the name
   36                     ;   - ASCII Name (10 bytes)
   37                     ;     This should be padded with spaces
   38                     ;
   39                     ; BRAM Entry:
   40                     ; -----------
   41                     ; - Miscellaneous data, size described by header parameters
   42                     ;
   43                     ; BRAM Entry Trailer (0x02 bytes):
   44                     ; --------------------------------
   45                     ; - Zeores (2 bytes)
   46                     ;   Technically, this trailer is "not used", but rather a terminator
   47                     ;   to the linked list.  The BRAM bank header points at it by the
   48                     ;   'next available slot' pointer
   49                     ;
   50                     
   51                     
   52                     ; bm_check()
   53                     ; ---
   54                     ; Determine whether BRAM exists on this system
   55                     ; without damaging contents on BRAM
   56                     ;
   57                     
   58  00:F8A2            _bm_check:
   59  00:F8A2  20 D3 FA            jsr   _bm_unlock
   60                     
   61                               stw   #$8000,<_di     ; test area at $8000
       00:F8A5  A9 00              lda    LOW_BYTE #$8000
       00:F8A7  85 F0              sta    LOW_BYTE <_di
       00:F8A9  A9 80              lda    HIGH_BYTE #$8000
       00:F8AB  85 F1              sta    HIGH_BYTE <_di
   62  00:F8AD  20 C3 F8            jsr   _bm_testram
   63                     
   64                               ; -- result
   65  00:F8B0  20 C1 FA            jsr   _bm_disable
   66  00:F8B3  E0 00               cpx   #0
   67  00:F8B5  D0 08               bne   .err
   68                               ; -- ok
   69  00:F8B7  9C 83 29            stz   _bm_error
   70  00:F8BA  A2 01               ldx   #1
   71  00:F8BC  62                  cla
   72  00:F8BD  18                  clc
   73  00:F8BE  60                  rts
   74                               ; -- no bram
   75  00:F8BF  82        .err:     clx
   76  00:F8C0  62                  cla
   77  00:F8C1  38                  sec
   78  00:F8C2  60                  rts
   79                     
   80                     
   81                     ; bm_testram
   82                     ; ---
   83                     ; internal function to test whether BRAM exists at a location
   84                     ; input  = _di (pointer to memory area to test)
   85                     ; output = register x (# errors)
   86                     ;
   87                     
   88  00:F8C3            _bm_testram:
   89                               ; -- swap bits
   90  00:F8C3  A0 07               ldy   #7
   91  00:F8C5  B1 F0     .l1:      lda   [_di],Y
   92  00:F8C7  49 FF               eor   #$FF
   93  00:F8C9  99 F8 20            sta   _ax,Y
   94  00:F8CC  91 F0               sta   [_di],Y
   95  00:F8CE  88                  dey
   96  00:F8CF  10 F4               bpl   .l1
   97                               ; -- cmp
   98  00:F8D1  82                  clx
   99  00:F8D2  A0 07               ldy   #7
  100  00:F8D4  B9 F8 20  .l2:      lda   _ax,Y
  101  00:F8D7  D1 F0               cmp   [_di],Y
  102  00:F8D9  F0 01               beq   .l3
  103  00:F8DB  E8                  inx
  104  00:F8DC  49 FF     .l3:      eor   #$FF
  105  00:F8DE  91 F0               sta   [_di],Y
  106  00:F8E0  88                  dey
  107  00:F8E1  10 F1               bpl   .l2
  108                     
  109  00:F8E3  60                  rts
  110                     
  111                     
  112                     ; bm_format()
  113                     ; ---
  114                     ; If BRAM is already formatted (*_PROPERLY_*), return OK
  115                     ; Otherwise, set header info, and set limit of BRAM to
  116                     ; maximum amount of memory available on this hardware
  117                     ;
  118                     
  119  00:F8E4            _bm_format:
  120  00:F8E4  20 AF FA            jsr   _bm_enable
  121  00:F8E7  90 30               bcc   .ok
  122                               ; -- format
  123  00:F8E9  A2 07               ldx   #7
  124  00:F8EB  BD 3B FA  .l1:      lda   _bm_id,X
  125  00:F8EE  9D 00 80            sta   $8000,X
  126  00:F8F1  CA                  dex
  127  00:F8F2  10 F7               bpl   .l1
  128  00:F8F4  9C 10 80            stz   $8010
  129  00:F8F7  9C 11 80            stz   $8011
  130                     
  131                               stw   #$8000,<_di     ; test area at $8000
       00:F8FA  A9 00              lda    LOW_BYTE #$8000
       00:F8FC  85 F0              sta    LOW_BYTE <_di
       00:F8FE  A9 80              lda    HIGH_BYTE #$8000
       00:F900  85 F1              sta    HIGH_BYTE <_di
  132  00:F902  20 C3 F8  .l2:      jsr   _bm_testram
  133  00:F905  E0 00               cpx   #0
  134  00:F907  D0 0B               bne   .setsz
  135  00:F909  A5 F1               lda   <_di+1
  136  00:F90B  C9 A0               cmp   #$A0            ; and keep going until either
  137  00:F90D  F0 05               beq   .setsz          ; (a) bad memory, or
  138  00:F90F  1A                  inc   A               ; (b) next bank
  139  00:F910  85 F1               sta   <_di+1
  140  00:F912  80 EE               bra   .l2
  141                     
  142  00:F914  A5 F1     .setsz:   lda   <_di+1
  143  00:F916  8D 05 80            sta   $8005
  144                     
  145                               ; -- ok
  146  00:F919  20 C1 FA  .ok:      jsr   _bm_disable
  147  00:F91C  9C 83 29            stz   _bm_error
  148  00:F91F  82                  clx
  149  00:F920  62                  cla
  150  00:F921  18                  clc
  151  00:F922  60                  rts
  152                     
  153                     
  154                     ; bm_free()
  155                     ; ---
  156                     ; Returns (int) number of user bytes available in BRAM
  157                     ; BRAM header entry and trailer overhead is already deducted
  158                     ;
  159                     
  160  00:F923            _bm_free:
  161  00:F923  20 AF FA            jsr   _bm_enable
  162  00:F926  B0 3A               bcs   .err
  163                               ; -- calculate free space
  164                               stw   $8004,<_cx
       00:F928  AD 04 80           lda    LOW_BYTE $8004
       00:F92B  85 FC              sta    LOW_BYTE <_cx
       00:F92D  AD 05 80           lda    HIGH_BYTE $8004
       00:F930  85 FD              sta    HIGH_BYTE <_cx
  165                               subw  $8006,<_cx
       00:F932  38                 sec
       00:F933  A5 FC              lda    LOW_BYTE <_cx
       00:F935  ED 06 80           sbc    LOW_BYTE $8006
       00:F938  85 FC              sta    LOW_BYTE <_cx
       00:F93A  A5 FD              lda    HIGH_BYTE <_cx
       00:F93C  ED 07 80           sbc    HIGH_BYTE $8006
       00:F93F  85 FD              sta    HIGH_BYTE <_cx
  166                               subw  #$12,<_cx
       00:F941  38                 sec
       00:F942  A5 FC              lda    LOW_BYTE <_cx
       00:F944  E9 12              sbc    LOW_BYTE #$12
       00:F946  85 FC              sta    LOW_BYTE <_cx
       00:F948  A5 FD              lda    HIGH_BYTE <_cx
       00:F94A  E9 00              sbc    HIGH_BYTE #$12
       00:F94C  85 FD              sta    HIGH_BYTE <_cx
  167  00:F94E  A5 FD               lda   <_ch
  168  00:F950  10 04               bpl   .ok
  169                               stwz  <_cx
       00:F952  64 FC              stz    LOW_BYTE <_cx
       00:F954  64 FD              stz    HIGH_BYTE <_cx
  170                               ; -- ok
  171  00:F956  20 C1 FA  .ok:      jsr   _bm_disable
  172  00:F959  9C 83 29            stz   _bm_error
  173                             __ldw   <_cx
                0000              .if (1 = 2)
                                  .else
       00:F95C  A6 FC              ldx    <_cx
       00:F95E  A5 FD              lda    <_cx+1
                                  .endif
  174  00:F960  18                  clc
  175  00:F961  60                  rts
  176                               ; -- error, bram not formated
  177  00:F962  8D 83 29  .err:     sta   _bm_error
  178  00:F965  20 C1 FA            jsr   _bm_disable
  179  00:F968  A9 FF               lda   #$FF
  180  00:F96A  AA                  tax
  181  00:F96B  38                  sec
  182  00:F96C  60                  rts
  183                     
  184                     
  185                     ; bm_size()
  186                     ; ---
  187                     ; Returns (int) number of bytes in BRAM - should normally
  188                     ; be 2K, but can be as large as 8KB
  189                     
  190  00:F96D            _bm_size:
  191  00:F96D  20 AF FA            jsr   _bm_enable
  192  00:F970  B0 33               bcs   .err
  193                               ; -- calculate free space
  194                               stw   $8004,<_cx
       00:F972  AD 04 80           lda    LOW_BYTE $8004
       00:F975  85 FC              sta    LOW_BYTE <_cx
       00:F977  AD 05 80           lda    HIGH_BYTE $8004
       00:F97A  85 FD              sta    HIGH_BYTE <_cx
  195                               subw  #$8000,<_cx
       00:F97C  38                 sec
       00:F97D  A5 FC              lda    LOW_BYTE <_cx
       00:F97F  E9 00              sbc    LOW_BYTE #$8000
       00:F981  85 FC              sta    LOW_BYTE <_cx
       00:F983  A5 FD              lda    HIGH_BYTE <_cx
       00:F985  E9 80              sbc    HIGH_BYTE #$8000
       00:F987  85 FD              sta    HIGH_BYTE <_cx
  196  00:F989  A5 FD               lda   <_ch
  197  00:F98B  C9 21               cmp   #$21
  198  00:F98D  B0 14               bcs   .err1
  199  00:F98F  A5 FD               lda   <_ch
  200  00:F991  10 04               bpl   .ok
  201                               stwz  <_cx
       00:F993  64 FC              stz    LOW_BYTE <_cx
       00:F995  64 FD              stz    HIGH_BYTE <_cx
  202                               ; -- ok
  203  00:F997  20 C1 FA  .ok:      jsr   _bm_disable
  204  00:F99A  9C 83 29            stz   _bm_error
  205                             __ldw   <_cx
                0000              .if (1 = 2)
                                  .else
       00:F99D  A6 FC              ldx    <_cx
       00:F99F  A5 FD              lda    <_cx+1
                                  .endif
  206  00:F9A1  18                  clc
  207  00:F9A2  60                  rts
  208                               ; -- error, bram not formated
  209  00:F9A3  A9 FF     .err1:    lda   #$ff
  210  00:F9A5  8D 83 29  .err:     sta   _bm_error
  211  00:F9A8  20 C1 FA            jsr   _bm_disable
  212  00:F9AB  A9 FF               lda   #$FF
  213  00:F9AD  AA                  tax
  214  00:F9AE  38                  sec
  215  00:F9AF  60                  rts
  216                     
  217                     
  218                     ; bm_rawread(int location)
  219                     ; ---
  220                     ; Similar to peek(), but for BRAM
  221                     ; Automatically handles mapping of memory ; and address range
  222                     ;
  223  00:F9B0            _bm_rawread:
  224                             __stw   <_bx
       00:F9B0  86 FA              stx    <_bx
       00:F9B2  85 FB              sta    <_bx+1
  225  00:F9B4  A5 FB               lda   <_bh
  226  00:F9B6  29 1F               and   #$1F
  227  00:F9B8  09 80               ora   #$80
  228  00:F9BA  85 FB               sta   <_bh
  229  00:F9BC  20 AF FA            jsr   _bm_enable
  230  00:F9BF  B0 0C               bcs   .err
  231  00:F9C1  B2 FA               lda   [_bx]
  232  00:F9C3  22                  sax
  233  00:F9C4  9C 83 29            stz   _bm_error
  234  00:F9C7  20 C1 FA            jsr   _bm_disable
  235  00:F9CA  62                  cla
  236  00:F9CB  18                  clc
  237  00:F9CC  60                  rts
  238  00:F9CD  8D 83 29  .err:     sta   _bm_error
  239  00:F9D0  20 C1 FA            jsr   _bm_disable
  240  00:F9D3  38                  sec
  241  00:F9D4  60                  rts
  242                     
  243                     
  244                     ; bm_rawwrite(int location [bx], char val [reg acc])
  245                     ; ---
  246                     ; Similar to peek(), but for BRAM
  247                     ; Automatically handles mapping of memory ; and address range
  248                     ;
  249  00:F9D5            _bm_rawwrite.2:
  250                             __stw   <_ax
       00:F9D5  86 F8              stx    <_ax
       00:F9D7  85 F9              sta    <_ax+1
  251  00:F9D9  A5 FB               lda   <_bh
  252  00:F9DB  29 1F               and   #$1F
  253  00:F9DD  09 80               ora   #$80
  254  00:F9DF  85 FB               sta   <_bh
  255  00:F9E1  20 AF FA            jsr   _bm_enable
  256  00:F9E4  B0 0E               bcs   .err
  257  00:F9E6  A5 F8               lda   <_al
  258  00:F9E8  92 FA               sta   [_bx]
  259  00:F9EA  9C 83 29            stz   _bm_error
  260  00:F9ED  20 C1 FA            jsr   _bm_disable
  261  00:F9F0  62                  cla
  262  00:F9F1  82                  clx
  263  00:F9F2  18                  clc
  264  00:F9F3  60                  rts
  265  00:F9F4  8D 83 29  .err:     sta   _bm_error
  266  00:F9F7  20 C1 FA            jsr   _bm_disable
  267  00:F9FA  38                  sec
  268  00:F9FB  60                  rts
  269                     
  270                     
  271                     ; bm_exist(char *name)
  272                     ; ---
  273                     ; Check for existence of BRAM file with a matching name
  274                     ; Note: name is 12 bytes; first 2 bytes are a uniqueness value
  275                     ;       (should be zeroes), and the next10 bytes are ASCII name
  276                     ;       with trailing spaces as padding
  277                     ;
  278                     
  279  00:F9FC            _bm_exist:
  280                             __stw   <_bx
       00:F9FC  86 FA              stx    <_bx
       00:F9FE  85 FB              sta    <_bx+1
  281  00:FA00  20 9D FA            jsr   _bm_open
  282  00:FA03  B0 0A               bcs   .l1
  283  00:FA05  20 C1 FA            jsr   _bm_disable
  284  00:FA08  A2 01               ldx   #1
  285  00:FA0A  AD 83 29            lda   _bm_error
  286  00:FA0D  F0 02               beq   .noerr
  287  00:FA0F  82        .l1:      clx
  288  00:FA10  62                  cla
  289  00:FA11  60        .noerr:   rts
  290                     
  291                     
  292                     ; bm_sizeof(char *name)
  293                     ; ---
  294                     ; Return the size of the user data in a RAM file with the given name
  295                     ; Note: name is 12 bytes; first 2 bytes are a uniqueness value
  296                     ;       (should be zeroes), and the next10 bytes are ASCII name
  297                     ;       with trailing spaces as padding
  298                     ;
  299                     
  300  00:FA12            _bm_sizeof:
  301                             __stw   <_bx
       00:FA12  86 FA              stx    <_bx
       00:FA14  85 FB              sta    <_bx+1
  302  00:FA16  20 9D FA            jsr   _bm_open
  303  00:FA19  B0 18               bcs   .l1
  304                               subw  #$10,<_cx
       00:FA1B  38                 sec
       00:FA1C  A5 FC              lda    LOW_BYTE <_cx
       00:FA1E  E9 10              sbc    LOW_BYTE #$10
       00:FA20  85 FC              sta    LOW_BYTE <_cx
       00:FA22  A5 FD              lda    HIGH_BYTE <_cx
       00:FA24  E9 00              sbc    HIGH_BYTE #$10
       00:FA26  85 FD              sta    HIGH_BYTE <_cx
  305  00:FA28  20 C1 FA            jsr   _bm_disable
  306  00:FA2B  9C 83 29            stz   _bm_error
  307  00:FA2E  A6 FC               ldx   <_cl
  308  00:FA30  A5 FD               lda   <_ch
  309  00:FA32  60                  rts
  310  00:FA33  82        .l1:      clx
  311  00:FA34  62                  cla
  312  00:FA35  60                  rts
  313                     
  314                     
  315                     ; bm_errno()
  316                     ; ---
  317                     ; Return error type
  318                     ;
  319                     
  320  00:FA36            _bm_errno:
  321  00:FA36  AE 83 29            ldx   _bm_error
  322  00:FA39  62                  cla
  323  00:FA3A  60                  rts
  324                     
  325                     
  326  00:FA3B            _bm_id:
  327  00:FA3B  48 55 42            .db   $48,$55,$42,$4D
       00:FA3E  4D        
  328  00:FA3F  00 88 10            .db   $00,$88,$10,$80
       00:FA42  80        
  329                     
  330                     
  331                     ; ------------------------
  332                     
  333                     ; bm_getptr(int ptr [bp], char *namebuf [reg acc])
  334                     ; ---
  335                     ; Given a pointer with the BRAM, obtain the name of the entry
  336                     ; and the pointer to the next entry
  337                     ; Use BRAM_START for first entry
  338                     ;
  339                     
  340  00:FA43            _bm_getptr.2:
  341                               maplibfunc    lib2_bm_getptr.2
       00:FA43  A8                 tay
       00:FA44  43 20              tma  #page(lib2_bm_getptr.2)
       00:FA46  48                 pha
       00:FA47  A9 01              lda  #bank(lib2_bm_getptr.2)
       00:FA49  53 20              tam  #page(lib2_bm_getptr.2)
       00:FA4B  98                 tya
       00:FA4C  20 8A AF           jsr  lib2_bm_getptr.2
       00:FA4F  A8                 tay
       00:FA50  68                 pla
       00:FA51  53 20              tam  #page(lib2_bm_getptr.2)
       00:FA53  98                 tya
  342  00:FA54  60                  rts
  343                     
  344                     
  345                     ; bm_delete(char *namebuf)
  346                     ; ---
  347                     ; Delete the entry specified by the name provided
  348                     ;
  349                     
  350  00:FA55            _bm_delete:
  351                               maplibfunc    lib2_bm_delete
       00:FA55  A8                 tay
       00:FA56  43 20              tma  #page(lib2_bm_delete)
       00:FA58  48                 pha
       00:FA59  A9 01              lda  #bank(lib2_bm_delete)
       00:FA5B  53 20              tam  #page(lib2_bm_delete)
       00:FA5D  98                 tya
       00:FA5E  20 E0 AF           jsr  lib2_bm_delete
       00:FA61  A8                 tay
       00:FA62  68                 pla
       00:FA63  53 20              tam  #page(lib2_bm_delete)
       00:FA65  98                 tya
  352  00:FA66  60                  rts
  353                     
  354                     
  355                     ; bm_read(char *buf [di], char *name [bx], int offset [bp], int nb)
  356                     ; ---
  357                     ; Given a name of a file, grab some info from the file
  358                     ;
  359                     
  360  00:FA67            _bm_read.4:
  361                               maplibfunc    lib2_bm_read.4
       00:FA67  A8                 tay
       00:FA68  43 20              tma  #page(lib2_bm_read.4)
       00:FA6A  48                 pha
       00:FA6B  A9 01              lda  #bank(lib2_bm_read.4)
       00:FA6D  53 20              tam  #page(lib2_bm_read.4)
       00:FA6F  98                 tya
       00:FA70  20 3F B0           jsr  lib2_bm_read.4
       00:FA73  A8                 tay
       00:FA74  68                 pla
       00:FA75  53 20              tam  #page(lib2_bm_read.4)
       00:FA77  98                 tya
  362  00:FA78  60                  rts
  363                     
  364                     
  365                     ; bm_write(char *buf [di], char *name [bx], int offset [bp], int nb)
  366                     ; ---
  367                     ; Given the name of a BRAM file, update some info inside of it
  368                     ;
  369                     
  370  00:FA79            _bm_write.4:
  371                               maplibfunc    lib2_bm_write.4
       00:FA79  A8                 tay
       00:FA7A  43 20              tma  #page(lib2_bm_write.4)
       00:FA7C  48                 pha
       00:FA7D  A9 01              lda  #bank(lib2_bm_write.4)
       00:FA7F  53 20              tam  #page(lib2_bm_write.4)
       00:FA81  98                 tya
       00:FA82  20 8E B0           jsr  lib2_bm_write.4
       00:FA85  A8                 tay
       00:FA86  68                 pla
       00:FA87  53 20              tam  #page(lib2_bm_write.4)
       00:FA89  98                 tya
  372  00:FA8A  60                  rts
  373                     
  374                     
  375                     ; bm_create(char *name [bx], int size)
  376                     ; ---
  377                     ; Create a new BRAM file, given the name and size
  378                     
  379  00:FA8B            _bm_create.2:
  380                               maplibfunc    lib2_bm_create.2
       00:FA8B  A8                 tay
       00:FA8C  43 20              tma  #page(lib2_bm_create.2)
       00:FA8E  48                 pha
       00:FA8F  A9 01              lda  #bank(lib2_bm_create.2)
       00:FA91  53 20              tam  #page(lib2_bm_create.2)
       00:FA93  98                 tya
       00:FA94  20 CD B0           jsr  lib2_bm_create.2
       00:FA97  A8                 tay
       00:FA98  68                 pla
       00:FA99  53 20              tam  #page(lib2_bm_create.2)
       00:FA9B  98                 tya
  381  00:FA9C  60                  rts
  382                     
  383                     
  384                     ; bm_open(char *name [bx])
  385                     ; ---
  386                     ; Internal function to obtain access to a named file
  387                     
  388  00:FA9D            _bm_open:
  389                               maplibfunc    lib2_bm_open
       00:FA9D  A8                 tay
       00:FA9E  43 20              tma  #page(lib2_bm_open)
       00:FAA0  48                 pha
       00:FAA1  A9 01              lda  #bank(lib2_bm_open)
       00:FAA3  53 20              tam  #page(lib2_bm_open)
       00:FAA5  98                 tya
       00:FAA6  20 8D B1           jsr  lib2_bm_open
       00:FAA9  A8                 tay
       00:FAAA  68                 pla
       00:FAAB  53 20              tam  #page(lib2_bm_open)
       00:FAAD  98                 tya
  390  00:FAAE  60                  rts
  391                     
  392                     
  393                     ; bm_enable()
  394                     ; ---
  395                     ; Internal function to enable the BRAM area and do a quick check
  396                     
  397  00:FAAF            _bm_enable:
  398                               maplibfunc    lib2_bm_enable
       00:FAAF  A8                 tay
       00:FAB0  43 20              tma  #page(lib2_bm_enable)
       00:FAB2  48                 pha
       00:FAB3  A9 01              lda  #bank(lib2_bm_enable)
       00:FAB5  53 20              tam  #page(lib2_bm_enable)
       00:FAB7  98                 tya
       00:FAB8  20 10 B2           jsr  lib2_bm_enable
       00:FABB  A8                 tay
       00:FABC  68                 pla
       00:FABD  53 20              tam  #page(lib2_bm_enable)
       00:FABF  98                 tya
  399  00:FAC0  60                  rts
  400                     
  401                     
  402                     ; bm_disable()
  403                     ; ---
  404                     ; This internal function handles the fixup of BRAM segment/locking
  405                     
  406  00:FAC1            _bm_disable:
  407                               maplibfunc    lib2_bm_disable
       00:FAC1  A8                 tay
       00:FAC2  43 20              tma  #page(lib2_bm_disable)
       00:FAC4  48                 pha
       00:FAC5  A9 01              lda  #bank(lib2_bm_disable)
       00:FAC7  53 20              tam  #page(lib2_bm_disable)
       00:FAC9  98                 tya
       00:FACA  20 38 B2           jsr  lib2_bm_disable
       00:FACD  A8                 tay
       00:FACE  68                 pla
       00:FACF  53 20              tam  #page(lib2_bm_disable)
       00:FAD1  98                 tya
  408  00:FAD2  60                  rts
  409                     
  410                     
  411                     ; bm_unlock()
  412                     ; ---
  413                     ; This internal function handles only the map/unlock of the BRAM area
  414                     
  415  00:FAD3            _bm_unlock:
  416                               maplibfunc    lib2_bm_unlock
       00:FAD3  A8                 tay
       00:FAD4  43 20              tma  #page(lib2_bm_unlock)
       00:FAD6  48                 pha
       00:FAD7  A9 01              lda  #bank(lib2_bm_unlock)
       00:FAD9  53 20              tam  #page(lib2_bm_unlock)
       00:FADB  98                 tya
       00:FADC  20 27 B2           jsr  lib2_bm_unlock
       00:FADF  A8                 tay
       00:FAE0  68                 pla
       00:FAE1  53 20              tam  #page(lib2_bm_unlock)
       00:FAE3  98                 tya
  417  00:FAE4  60                  rts
  418                     
  419                     
  420                     ; ---------------
  421                     
  422                     ;
  423                     ; From here, we have the implementation of various
  424                     ; BRAM routines in LIB2_BANK rather than LIB1_BANK
  425                     ; for reasons of speed and size
  426                     ;
  427                     ; Their external linkages will have specified above
  428                     ; and be begin with an underscore.  The private
  429                     ; definitions will not have an underscore
  430                     ;
  431                     
  432           0001              .bank   LIB2_BANK
  433                     
  434                     ; bm_getptr(int ptr [bp], char *namebuf [reg acc])
  435                     ; ---
  436                     ; Given a pointer with the BRAM, obtain the name of the entry
  437                     ; and the pointer to the next entry
  438                     ; Use BRAM_START for first entry
  439                     ;
  440                     
  441  01:AF8A            lib2_bm_getptr.2:
  442                             __stw   <_di            ; namebuf is destination of a copy
       01:AF8A  86 F0              stx    <_di
       01:AF8C  85 F1              sta    <_di+1
  443  01:AF8E  20 10 B2            jsr   lib2_bm_enable
  444  01:AF91  B0 43               bcs   .x2
  445                     
  446                               tstw  <_bp            ; error - 0 input
       01:AF93  A5 EC              lda   <_bp               ; value at stated memory
       01:AF95  05 ED              ora   <_bp+1             ; location is zero
  447  01:AF97  F0 3D               beq   .x2
  448  01:AF99  B2 EC               lda   [_bp]
  449  01:AF9B  85 FC               sta   <_cl
  450  01:AF9D  A0 01               ldy   #1
  451  01:AF9F  B1 EC               lda   [_bp],Y
  452  01:AFA1  85 FD               sta   <_ch            ; <_cx is length of entry
  453                               tstw  <_cx
       01:AFA3  A5 FC              lda   <_cx               ; value at stated memory
       01:AFA5  05 FD              ora   <_cx+1             ; location is zero
  454  01:AFA7  F0 2C               beq   .empty
  455                     
  456                               addw  #4,<_bp,<_si    ; <_si is now ptr to name of current entry
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       01:AFA9  18                 clc
       01:AFAA  A5 EC              lda    LOW_BYTE <_bp
       01:AFAC  69 04              adc    LOW_BYTE #4
       01:AFAE  85 EE              sta    LOW_BYTE <_si
       01:AFB0  A5 ED              lda    HIGH_BYTE <_bp
       01:AFB2  69 00              adc    HIGH_BYTE #4
       01:AFB4  85 EF              sta    HIGH_BYTE <_si
                                  .else
                                  .endif
  457  01:AFB6  62                  cla
  458  01:AFB7  A2 0C               ldx   #12
  459  01:AFB9  20 8F E6            jsr   _memcpy.3       ; copy 12 bytes of name to namebuf
  460                               addw  <_cx,<_bp,<_ax  ; next pointer
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       01:AFBC  18                 clc
       01:AFBD  A5 EC              lda    LOW_BYTE <_bp
       01:AFBF  65 FC              adc    LOW_BYTE <_cx
       01:AFC1  85 F8              sta    LOW_BYTE <_ax
       01:AFC3  A5 ED              lda    HIGH_BYTE <_bp
       01:AFC5  65 FD              adc    HIGH_BYTE <_cx
       01:AFC7  85 F9              sta    HIGH_BYTE <_ax
                                  .else
                                  .endif
  461  01:AFC9  20 38 B2            jsr   lib2_bm_disable
  462  01:AFCC  9C 83 29            stz   _bm_error
  463  01:AFCF  A5 F9               lda   <_ah
  464  01:AFD1  A6 F8               ldx   <_al
  465  01:AFD3  18                  clc
  466  01:AFD4  60                  rts
  467                     
  468  01:AFD5  62        .empty:   cla
  469                               
  470                               ; -- error, bram not formatted
  471  01:AFD6  8D 83 29  .x2:      sta   _bm_error
  472  01:AFD9  20 38 B2            jsr   lib2_bm_disable
  473  01:AFDC  62                  cla
  474  01:AFDD  82                  clx
  475  01:AFDE  38                  sec
  476  01:AFDF  60                  rts
  477                     
  478                     
  479                     ; bm_delete(char *namebuf)
  480                     ; ---
  481                     ; Delete the entry specified by the name provided
  482                     ;
  483                     
  484  01:AFE0            lib2_bm_delete:
  485                             __stw   <_ax
       01:AFE0  86 F8              stx    <_ax
       01:AFE2  85 F9              sta    <_ax+1
  486  01:AFE4  20 8D B1            jsr   lib2_bm_open
  487  01:AFE7  B0 55               bcs   .out
  488                               stw   $8006,<_bx      ; ptr to end
       01:AFE9  AD 06 80           lda    LOW_BYTE $8006
       01:AFEC  85 FA              sta    LOW_BYTE <_bx
       01:AFEE  AD 07 80           lda    HIGH_BYTE $8006
       01:AFF1  85 FB              sta    HIGH_BYTE <_bx
  489                               stw   <_si,<_di       ; setup currptr as dest
       01:AFF3  A5 EE              lda    LOW_BYTE <_si
       01:AFF5  85 F0              sta    LOW_BYTE <_di
       01:AFF7  A5 EF              lda    HIGH_BYTE <_si
       01:AFF9  85 F1              sta    HIGH_BYTE <_di
  490                               stw   <_dx,<_si       ; setup nextptr as src
       01:AFFB  A5 FE              lda    LOW_BYTE <_dx
       01:AFFD  85 EE              sta    LOW_BYTE <_si
       01:AFFF  A5 FF              lda    HIGH_BYTE <_dx
       01:B001  85 EF              sta    HIGH_BYTE <_si
  491                               subw  <_dx,<_bx       ; #bytes = end-next + 2
       01:B003  38                 sec
       01:B004  A5 FA              lda    LOW_BYTE <_bx
       01:B006  E5 FE              sbc    LOW_BYTE <_dx
       01:B008  85 FA              sta    LOW_BYTE <_bx
       01:B00A  A5 FB              lda    HIGH_BYTE <_bx
       01:B00C  E5 FF              sbc    HIGH_BYTE <_dx
       01:B00E  85 FB              sta    HIGH_BYTE <_bx
  492                               addw  #2,<_bx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:B010  18                 clc
       01:B011  A5 FA              lda    LOW_BYTE <_bx
       01:B013  69 02              adc    LOW_BYTE #2
       01:B015  85 FA              sta    LOW_BYTE <_bx
       01:B017  A5 FB              lda    HIGH_BYTE <_bx
       01:B019  69 00              adc    HIGH_BYTE #2
       01:B01B  85 FB              sta    HIGH_BYTE <_bx
                                  .endif
  493                               subw  <_cx,$8006      ; adjust ptr to end
       01:B01D  38                 sec
       01:B01E  AD 06 80           lda    LOW_BYTE $8006
       01:B021  E5 FC              sbc    LOW_BYTE <_cx
       01:B023  8D 06 80           sta    LOW_BYTE $8006
       01:B026  AD 07 80           lda    HIGH_BYTE $8006
       01:B029  E5 FD              sbc    HIGH_BYTE <_cx
       01:B02B  8D 07 80           sta    HIGH_BYTE $8006
  494  01:B02E  A5 FB               lda   <_bh
  495  01:B030  A6 FA               ldx   <_bl
  496  01:B032  20 8F E6            jsr   _memcpy.3
  497  01:B035  20 38 B2            jsr   lib2_bm_disable
  498  01:B038  9C 83 29            stz   _bm_error
  499  01:B03B  82                  clx
  500  01:B03C  62                  cla
  501  01:B03D  18                  clc
  502  01:B03E  60        .out:     rts
  503                     
  504                     
  505                     ; bm_read(char *buf [di], char *name [bx], int offset [bp], int nb)
  506                     ; ---
  507                     ; Given a name of a file, grab some info from the file
  508                     ;
  509                     
  510  01:B03F            lib2_bm_read.4:
  511                             __stw   <_ax
       01:B03F  86 F8              stx    <_ax
       01:B041  85 F9              sta    <_ax+1
  512                               ; -- open file
  513  01:B043  20 8D B1            jsr   lib2_bm_open
  514  01:B046  B0 45               bcs   .x2
  515                               ; -- checksum test
  516  01:B048  20 43 B2            jsr   lib2_bm_checksum
  517  01:B04B  A0 02               ldy   #2
  518  01:B04D  B1 EE               lda   [_si],Y
  519                               add   <_dl
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:B04F  18                 clc
       01:B050  65 FE              adc    <_dl
                                  .endif
  520  01:B052  85 FE               sta   <_dl
  521  01:B054  C8                  iny
  522  01:B055  B1 EE               lda   [_si],Y
  523  01:B057  65 FF               adc   <_dh
  524  01:B059  05 FE               ora   <_dl
  525  01:B05B  D0 25               bne   .x1
  526                               ; -- setup ptr
  527  01:B05D  20 79 B2            jsr   lib2_bm_setup_ptr
  528  01:B060  B0 14               bcs   .ok
  529                               ; -- read
  530  01:B062  C2                  cly
  531  01:B063  B1 FE     .l1:      lda   [_dx],Y
  532  01:B065  91 F0               sta   [_di],Y
  533  01:B067  C8                  iny
  534  01:B068  D0 04               bne   .l2
  535  01:B06A  E6 FF               inc   <_dx+1
  536  01:B06C  E6 F1               inc   <_di+1
  537  01:B06E  C6 FC     .l2:      dec   <_cl
  538  01:B070  D0 F1               bne   .l1
  539  01:B072  C6 FD               dec   <_ch
  540  01:B074  10 ED               bpl   .l1
  541                               ; -- ok
  542  01:B076  20 38 B2  .ok:      jsr   lib2_bm_disable
  543  01:B079  9C 83 29            stz   _bm_error
  544                             __ldw   <_ax
                0000              .if (1 = 2)
                                  .else
       01:B07C  A6 F8              ldx    <_ax
       01:B07E  A5 F9              lda    <_ax+1
                                  .endif
  545  01:B080  18                  clc
  546  01:B081  60                  rts
  547                               ; -- error, bad file checksum
  548  01:B082  A9 02     .x1:      lda   #2
  549  01:B084  8D 83 29            sta   _bm_error
  550  01:B087  20 38 B2            jsr   lib2_bm_disable
  551  01:B08A  82                  clx
  552  01:B08B  62                  cla
  553  01:B08C  38                  sec
  554  01:B08D  60        .x2:      rts
  555                     
  556                     
  557                     ; bm_write(char *buf [di], char *name [bx], int offset [bp], int nb)
  558                     ; ---
  559                     ; Given the name of a BRAM file, update some info inside of it
  560                     ;
  561                     
  562  01:B08E            lib2_bm_write.4:
  563                             __stw   <_ax
       01:B08E  86 F8              stx    <_ax
       01:B090  85 F9              sta    <_ax+1
  564                               ; -- open file
  565  01:B092  20 8D B1            jsr   lib2_bm_open
  566  01:B095  B0 35               bcs   .x1
  567                               ; -- setup ptr
  568  01:B097  20 79 B2            jsr   lib2_bm_setup_ptr
  569  01:B09A  B0 25               bcs   .ok
  570                               ; -- write data
  571  01:B09C  C2                  cly
  572  01:B09D  B1 F0     .l1:      lda   [_di],Y
  573  01:B09F  91 FE               sta   [_dx],Y
  574  01:B0A1  C8                  iny
  575  01:B0A2  D0 04               bne   .l2
  576  01:B0A4  E6 FF               inc   <_dx+1
  577  01:B0A6  E6 F1               inc   <_di+1
  578  01:B0A8  C6 FC     .l2:      dec   <_cl
  579  01:B0AA  D0 F1               bne   .l1
  580  01:B0AC  C6 FD               dec   <_ch
  581  01:B0AE  10 ED               bpl   .l1
  582                               ; -- update checksum
  583  01:B0B0  20 43 B2            jsr   lib2_bm_checksum
  584  01:B0B3  A0 02               ldy   #2
  585  01:B0B5  62                  cla
  586                               sub   <_dl
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:B0B6  38                 sec
       01:B0B7  E5 FE              sbc    <_dl
                                  .endif
  587  01:B0B9  91 EE               sta   [_si],Y
  588  01:B0BB  C8                  iny
  589  01:B0BC  62                  cla
  590  01:B0BD  E5 FF               sbc   <_dh
  591  01:B0BF  91 EE               sta   [_si],Y
  592                               ; -- ok
  593  01:B0C1  20 38 B2  .ok:      jsr   lib2_bm_disable
  594  01:B0C4  9C 83 29            stz   _bm_error
  595                             __ldw   <_ax
                0000              .if (1 = 2)
                                  .else
       01:B0C7  A6 F8              ldx    <_ax
       01:B0C9  A5 F9              lda    <_ax+1
                                  .endif
  596  01:B0CB  18                  clc
  597  01:B0CC  60        .x1:      rts
  598                     
  599                     
  600                     ; bm_create(char *name [bx], int size)
  601                     ; ---
  602                     ; Create a new BRAM file, given the name and size
  603                     
  604  01:B0CD            lib2_bm_create.2:
  605                             __stw   <_ax
       01:B0CD  86 F8              stx    <_ax
       01:B0CF  85 F9              sta    <_ax+1
  606  01:B0D1  20 10 B2            jsr   lib2_bm_enable
  607  01:B0D4  90 10               bcc   .go
  608  01:B0D6  80 02               bra   .x2
  609                               ; -- error, not enough ram
  610  01:B0D8  A9 05     .x1:      lda   #5
  611                               ; -- error, bram not formated
  612  01:B0DA  8D 83 29  .x2:      sta   _bm_error
  613  01:B0DD  20 38 B2            jsr   lib2_bm_disable
  614  01:B0E0  AE 83 29            ldx   _bm_error
  615  01:B0E3  62                  cla
  616  01:B0E4  38                  sec
  617  01:B0E5  60                  rts
  618                               ; -- check free space
  619                     .go:      addw  #$12,$8006,<_dx
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       01:B0E6  18                 clc
       01:B0E7  AD 06 80           lda    LOW_BYTE $8006
       01:B0EA  69 12              adc    LOW_BYTE #$12
       01:B0EC  85 FE              sta    LOW_BYTE <_dx
       01:B0EE  AD 07 80           lda    HIGH_BYTE $8006
       01:B0F1  69 00              adc    HIGH_BYTE #$12
       01:B0F3  85 FF              sta    HIGH_BYTE <_dx
                                  .else
                                  .endif
  620                               addw  <_ax,<_dx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:B0F5  18                 clc
       01:B0F6  A5 FE              lda    LOW_BYTE <_dx
       01:B0F8  65 F8              adc    LOW_BYTE <_ax
       01:B0FA  85 FE              sta    LOW_BYTE <_dx
       01:B0FC  A5 FF              lda    HIGH_BYTE <_dx
       01:B0FE  65 F9              adc    HIGH_BYTE <_ax
       01:B100  85 FF              sta    HIGH_BYTE <_dx
                                  .endif
  621                               cmpw  <_dx,$8004
       01:B102  AD 05 80           lda    HIGH_BYTE $8004
       01:B105  C5 FF              cmp    HIGH_BYTE <_dx
       01:B107  D0 05              bne    .x_00548
       01:B109  AD 04 80           lda    LOW_BYTE $8004
       01:B10C  C5 FE              cmp    LOW_BYTE <_dx
       01:B10E            .x_00548:
  622                               blo   .x1
       01:B10E  90 C8              bcc    .x1
  623                               ; -- create file
  624                               stw   $8006,<_si
       01:B110  AD 06 80           lda    LOW_BYTE $8006
       01:B113  85 EE              sta    LOW_BYTE <_si
       01:B115  AD 07 80           lda    HIGH_BYTE $8006
       01:B118  85 EF              sta    HIGH_BYTE <_si
  625  01:B11A  A0 01               ldy   #1
  626  01:B11C  A5 F8               lda   <_al
  627                               add   #$10
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:B11E  18                 clc
       01:B11F  69 10              adc    #$10
                                  .endif
  628  01:B121  92 EE               sta   [_si]
  629  01:B123  A5 F9               lda   <_ah
  630  01:B125  69 00               adc   #$00
  631  01:B127  91 EE               sta   [_si],Y
  632                               ; --
  633  01:B129  AD 06 80            lda   $8006
  634                               add   [_si]
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:B12C  18                 clc
       01:B12D  72 EE              adc    [_si]
                                  .endif
  635  01:B12F  85 FE               sta   <_dl
  636  01:B131  8D 06 80            sta   $8006
  637  01:B134  AD 07 80            lda   $8007
  638  01:B137  71 EE               adc   [_si],Y
  639  01:B139  85 FF               sta   <_dh
  640  01:B13B  8D 07 80            sta   $8007
  641  01:B13E  62                  cla
  642  01:B13F  92 FE               sta   [_dx]
  643  01:B141  91 FE               sta   [_dx],Y
  644                               ; -- copy name
  645  01:B143  82                  clx
  646  01:B144  A0 04               ldy   #4
  647  01:B146  02        .l1:      sxy
  648  01:B147  B1 FA               lda   [_bx],Y
  649  01:B149  02                  sxy
  650  01:B14A  91 EE               sta   [_si],Y
  651  01:B14C  C8                  iny
  652  01:B14D  E8                  inx
  653  01:B14E  E0 0C               cpx   #12
  654  01:B150  D0 F4               bne   .l1
  655                               ; -- clear file
  656  01:B152  A5 F8               lda   <_al
  657  01:B154  05 F9               ora   <_ah
  658  01:B156  F0 1A               beq   .sum
  659                               stw   <_si,<_bx
       01:B158  A5 EE              lda    LOW_BYTE <_si
       01:B15A  85 FA              sta    LOW_BYTE <_bx
       01:B15C  A5 EF              lda    HIGH_BYTE <_si
       01:B15E  85 FB              sta    HIGH_BYTE <_bx
  660  01:B160  A0 10               ldy   #16
  661  01:B162  62                  cla
  662  01:B163  91 FA     .l2:      sta   [_bx],Y
  663  01:B165  C8                  iny
  664  01:B166  D0 02               bne   .l3
  665  01:B168  E6 FB               inc   <_bh
  666  01:B16A  C6 F8     .l3:      dec   <_al
  667  01:B16C  D0 F5               bne   .l2
  668  01:B16E  C6 F9               dec   <_ah
  669  01:B170  10 F1               bpl   .l2
  670                               ; -- update checksum
  671  01:B172  20 43 B2  .sum:     jsr   lib2_bm_checksum
  672  01:B175  A0 02               ldy   #2
  673  01:B177  62                  cla
  674                               sub   <_dl
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:B178  38                 sec
       01:B179  E5 FE              sbc    <_dl
                                  .endif
  675  01:B17B  91 EE               sta   [_si],Y
  676  01:B17D  C8                  iny
  677  01:B17E  62                  cla
  678  01:B17F  E5 FF               sbc   <_dh
  679  01:B181  91 EE               sta   [_si],Y
  680                               ; -- ok
  681  01:B183  20 38 B2  .ok:      jsr   lib2_bm_disable
  682  01:B186  9C 83 29            stz   _bm_error
  683  01:B189  82                  clx
  684  01:B18A  62                  cla
  685  01:B18B  18                  clc
  686  01:B18C  60                  rts
  687                     
  688                     
  689                     ; bm_open(char *name [bx])
  690                     ; ---
  691                     ; Internal function to obtain access to a named file
  692                     
  693  01:B18D            lib2_bm_open:
  694  01:B18D  20 10 B2            jsr   lib2_bm_enable
  695  01:B190  B0 6E               bcs   .x2
  696                               ; -- get dir entry
  697                               stw   #$8010,<_si
       01:B192  A9 10              lda    LOW_BYTE #$8010
       01:B194  85 EE              sta    LOW_BYTE <_si
       01:B196  A9 80              lda    HIGH_BYTE #$8010
       01:B198  85 EF              sta    HIGH_BYTE <_si
  698  01:B19A  B2 EE     .l1:      lda   [_si]
  699  01:B19C  85 FC               sta   <_cl
  700  01:B19E  A0 01               ldy   #1
  701  01:B1A0  B1 EE               lda   [_si],Y
  702  01:B1A2  85 FD               sta   <_ch
  703  01:B1A4  05 FC               ora   <_cl
  704  01:B1A6  F0 56               beq   .x1
  705                               addw  <_cx,<_si,<_dx
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       01:B1A8  18                 clc
       01:B1A9  A5 EE              lda    LOW_BYTE <_si
       01:B1AB  65 FC              adc    LOW_BYTE <_cx
       01:B1AD  85 FE              sta    LOW_BYTE <_dx
       01:B1AF  A5 EF              lda    HIGH_BYTE <_si
       01:B1B1  65 FD              adc    HIGH_BYTE <_cx
       01:B1B3  85 FF              sta    HIGH_BYTE <_dx
                                  .else
                                  .endif
  706                               cmpw  <_dx,$8004
       01:B1B5  AD 05 80           lda    HIGH_BYTE $8004
       01:B1B8  C5 FF              cmp    HIGH_BYTE <_dx
       01:B1BA  D0 05              bne    .x_00557
       01:B1BC  AD 04 80           lda    LOW_BYTE $8004
       01:B1BF  C5 FE              cmp    LOW_BYTE <_dx
       01:B1C1            .x_00557:
  707                               blo   .x3
       01:B1C1  90 45              bcc    .x3
  708                               cmpw  #16,<_cx
       01:B1C3  A5 FD              lda    HIGH_BYTE <_cx
       01:B1C5  C9 00              cmp    HIGH_BYTE #16
       01:B1C7  D0 04              bne    .x_00559
       01:B1C9  A5 FC              lda    LOW_BYTE <_cx
       01:B1CB  C9 10              cmp    LOW_BYTE #16
       01:B1CD            .x_00559:
  709                               blo   .x3
       01:B1CD  90 39              bcc    .x3
  710                               ; -- compare names
  711  01:B1CF  C2                  cly
  712  01:B1D0  A2 04               ldx   #4
  713  01:B1D2  B1 FA     .l2:      lda   [_bx],Y
  714  01:B1D4  02                  sxy
  715  01:B1D5  D1 EE               cmp   [_si],Y
  716  01:B1D7  D0 16               bne   .next
  717  01:B1D9  02                  sxy
  718  01:B1DA  E8                  inx
  719  01:B1DB  C8                  iny
  720  01:B1DC  C0 0C               cpy   #12
  721                               blo   .l2
       01:B1DE  90 F2              bcc    .l2
  722                               ; -- check file size
  723  01:B1E0  A5 FD               lda   <_ch
  724  01:B1E2  D0 06               bne   .ok
  725  01:B1E4  A5 FC               lda   <_cl
  726  01:B1E6  C9 10               cmp   #16
  727  01:B1E8  F0 22               beq   .x4
  728                               ; -- ok
  729  01:B1EA  9C 83 29  .ok:      stz   _bm_error
  730  01:B1ED  18                  clc
  731  01:B1EE  60                  rts
  732                               ; -- next entry
  733                     .next:    addw  <_cx,<_si
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:B1EF  18                 clc
       01:B1F0  A5 EE              lda    LOW_BYTE <_si
       01:B1F2  65 FC              adc    LOW_BYTE <_cx
       01:B1F4  85 EE              sta    LOW_BYTE <_si
       01:B1F6  A5 EF              lda    HIGH_BYTE <_si
       01:B1F8  65 FD              adc    HIGH_BYTE <_cx
       01:B1FA  85 EF              sta    HIGH_BYTE <_si
                                  .endif
  734  01:B1FC  80 9C               bra   .l1
  735                               ; -- error, file not found
  736  01:B1FE  A9 01     .x1:      lda   #1
  737                               ; -- error, bram not formated
  738  01:B200  8D 83 29  .x2:      sta   _bm_error
  739  01:B203  20 38 B2            jsr   lib2_bm_disable
  740  01:B206  38                  sec
  741  01:B207  60                  rts
  742                               ; -- error, directory corrupted
  743  01:B208  A9 03     .x3:      lda   #3
  744  01:B20A  80 F4               bra   .x2
  745                               ; -- error, empty file
  746  01:B20C  A9 04     .x4:      lda   #4
  747  01:B20E  80 F0               bra   .x2
  748                     
  749                     
  750                     ; bm_enable()
  751                     ; ---
  752                     ; Internal function to enable the BRAM area and do a quick check
  753                     
  754  01:B210            lib2_bm_enable:
  755  01:B210  20 27 B2            jsr   lib2_bm_unlock
  756                               ; -- check if formated
  757  01:B213  A2 03               ldx   #3
  758  01:B215  BD 00 80  .l1:      lda   $8000,X
  759  01:B218  DD 3B FA            cmp   _bm_id,X
  760  01:B21B  D0 06               bne   .x1
  761  01:B21D  CA                  dex
  762  01:B21E  10 F5               bpl   .l1
  763                               ; -- ok
  764  01:B220  62                  cla
  765  01:B221  18                  clc
  766  01:B222  60                  rts
  767                               ; -- error, not formated!
  768  01:B223  A9 FF     .x1:      lda   #$FF
  769  01:B225  38                  sec
  770  01:B226  60                  rts
  771                     
  772                     
  773                     ; bm_unlock()
  774                     ; ---
  775                     ; This internal function handles only the map/unlock of the BRAM area
  776                     
  777  01:B227            lib2_bm_unlock:
  778  01:B227  78                  sei
  779  01:B228  43 10               tma   #4
  780  01:B22A  8D 82 29            sta   _bm_mpr4
  781  01:B22D  A9 F7               lda   #$F7
  782  01:B22F  53 10               tam   #4
  783  01:B231  54                  csl
  784  01:B232  A9 80               lda   #$80
  785  01:B234  8D 07 18            sta   bram_unlock
  786  01:B237  60                  rts
  787                     
  788                             
  789                     ; bm_disable()
  790                     ; ---
  791                     ; This internal function handles the fixup of BRAM segment/locking
  792                     
  793  01:B238            lib2_bm_disable:
  794  01:B238  AD 82 29            lda   _bm_mpr4
  795  01:B23B  53 10               tam   #4
  796  01:B23D  AD 03 18            lda   bram_lock
  797  01:B240  D4                  csh
  798  01:B241  58                  cli
  799  01:B242  60                  rts
  800                     
  801                     
  802                     ; bm_checksum(char *fcb [si])
  803                     ; ---
  804                     ; Internal function to generate checksum
  805                     ;
  806                     
  807  01:B243            lib2_bm_checksum:
  808                               stwz  <_dx
       01:B243  64 FE              stz    LOW_BYTE <_dx
       01:B245  64 FF              stz    HIGH_BYTE <_dx
  809                               ; -- get file size
  810  01:B247  B2 EE               lda   [_si]
  811                               sub   #4
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:B249  38                 sec
       01:B24A  E9 04              sbc    #4
                                  .endif
  812  01:B24C  85 FC               sta   <_cl
  813  01:B24E  A0 01               ldy   #1
  814  01:B250  B1 EE               lda   [_si],Y
  815  01:B252  E9 00               sbc   #0
  816  01:B254  85 FD               sta   <_ch
  817                               stw   <_si,<_bx
       01:B256  A5 EE              lda    LOW_BYTE <_si
       01:B258  85 FA              sta    LOW_BYTE <_bx
       01:B25A  A5 EF              lda    HIGH_BYTE <_si
       01:B25C  85 FB              sta    HIGH_BYTE <_bx
  818                               ; -- calc checksum
  819  01:B25E  A0 04               ldy   #4
  820  01:B260  B1 FA     .l1:      lda   [_bx],Y
  821                               add   <_dl
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:B262  18                 clc
       01:B263  65 FE              adc    <_dl
                                  .endif
  822  01:B265  85 FE               sta   <_dl
  823  01:B267  90 02               bcc   .l2
  824  01:B269  E6 FF               inc   <_dh
  825  01:B26B  C8        .l2:      iny
  826  01:B26C  D0 02               bne   .l3
  827  01:B26E  E6 FB               inc   <_bh
  828  01:B270  C6 FC     .l3:      dec   <_cl
  829  01:B272  D0 EC               bne   .l1
  830  01:B274  C6 FD               dec   <_ch
  831  01:B276  10 E8               bpl   .l1
  832  01:B278  60                  rts
  833                     
  834                     
  835                     ; bm_setup_ptr(char *fcb [si], char *buf [di], int offset [bp], int nb [ax])
  836                     ; ---
  837                     
  838  01:B279            lib2_bm_setup_ptr:
  839                               ; -- check length
  840                               tstw  <_ax
       01:B279  A5 F8              lda   <_ax               ; value at stated memory
       01:B27B  05 F9              ora   <_ax+1             ; location is zero
  841  01:B27D  F0 21               beq   .x1
  842                               ; -- check ptr
  843                               tstw  <_di
       01:B27F  A5 F0              lda   <_di               ; value at stated memory
       01:B281  05 F1              ora   <_di+1             ; location is zero
  844  01:B283  F0 1B               beq   .x1
  845                               ; -- check offset
  846                               addw  #16,<_bp,<_bx
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       01:B285  18                 clc
       01:B286  A5 EC              lda    LOW_BYTE <_bp
       01:B288  69 10              adc    LOW_BYTE #16
       01:B28A  85 FA              sta    LOW_BYTE <_bx
       01:B28C  A5 ED              lda    HIGH_BYTE <_bp
       01:B28E  69 00              adc    HIGH_BYTE #16
       01:B290  85 FB              sta    HIGH_BYTE <_bx
                                  .else
                                  .endif
  847  01:B292  A0 01               ldy   #1
  848  01:B294  A5 FB               lda   <_bh
  849  01:B296  D1 EE               cmp   [_si],Y
  850  01:B298  D0 04               bne   .l1
  851  01:B29A  A5 FA               lda   <_bl
  852  01:B29C  D2 EE               cmp   [_si]
  853                     .l1:      blo   .l2
       01:B29E  90 06              bcc    .l2
  854                               ; -- eof
  855                     .x1:      stwz  <_ax
       01:B2A0  64 F8              stz    LOW_BYTE <_ax
       01:B2A2  64 F9              stz    HIGH_BYTE <_ax
  856  01:B2A4  38                  sec
  857  01:B2A5  60                  rts
  858                               ; -- set base ptr
  859                     .l2:      addw  <_bx,<_si,<_dx
                0001              .if     (3 = 3)
                                   ; 3-arg mode
                                   ;
       01:B2A6  18                 clc
       01:B2A7  A5 EE              lda    LOW_BYTE <_si
       01:B2A9  65 FA              adc    LOW_BYTE <_bx
       01:B2AB  85 FE              sta    LOW_BYTE <_dx
       01:B2AD  A5 EF              lda    HIGH_BYTE <_si
       01:B2AF  65 FB              adc    HIGH_BYTE <_bx
       01:B2B1  85 FF              sta    HIGH_BYTE <_dx
                                  .else
                                  .endif
  860                               ; -- check length
  861                               addw  <_ax,<_bx
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:B2B3  18                 clc
       01:B2B4  A5 FA              lda    LOW_BYTE <_bx
       01:B2B6  65 F8              adc    LOW_BYTE <_ax
       01:B2B8  85 FA              sta    LOW_BYTE <_bx
       01:B2BA  A5 FB              lda    HIGH_BYTE <_bx
       01:B2BC  65 F9              adc    HIGH_BYTE <_ax
       01:B2BE  85 FB              sta    HIGH_BYTE <_bx
                                  .endif
  862  01:B2C0  B2 EE               lda   [_si]
  863                               sub   <_bl
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       01:B2C2  38                 sec
       01:B2C3  E5 FA              sbc    <_bl
                                  .endif
  864  01:B2C5  85 FA               sta   <_bl
  865  01:B2C7  B1 EE               lda   [_si],Y
  866  01:B2C9  E5 FB               sbc   <_bh
  867  01:B2CB  85 FB               sta   <_bh
  868  01:B2CD  10 0D               bpl   .ok
  869                               ; -- adjust size
  870                               addw  <_bx,<_ax
                0000              .if     (2 = 3)
                                  .else
                                   ; 2-arg mode
                                   ;
       01:B2CF  18                 clc
       01:B2D0  A5 F8              lda    LOW_BYTE <_ax
       01:B2D2  65 FA              adc    LOW_BYTE <_bx
       01:B2D4  85 F8              sta    LOW_BYTE <_ax
       01:B2D6  A5 F9              lda    HIGH_BYTE <_ax
       01:B2D8  65 FB              adc    HIGH_BYTE <_bx
       01:B2DA  85 F9              sta    HIGH_BYTE <_ax
                                  .endif
  871                     .ok:      stw   <_ax,<_cx
       01:B2DC  A5 F8              lda    LOW_BYTE <_ax
       01:B2DE  85 FC              sta    LOW_BYTE <_cx
       01:B2E0  A5 F9              lda    HIGH_BYTE <_ax
       01:B2E2  85 FD              sta    HIGH_BYTE <_cx
  872  01:B2E4  18                  clc
  873  01:B2E5  60                  rts
  874                     
  875                     ;
  876                     ; restore the context of the library routines
  877                     ; in LIB1_BANK
  878                     ;
  879           0000              .bank   LIB1_BANK
  880                     
#[4]   sup_hes.asm
#[5]   huc_misc.asm
 1304                             .include "huc_misc.asm"
    1                     ;
    2                     ; HUC_MISC.ASM  -  HuC Misc Library
    3                     ;
    4                     
    5                     
    6                     ; joy(char number)
    7                     ; ----
    8                     
    9  00:FAE5            _joy:
   10  00:FAE5  02                  sxy
   11  00:FAE6  BE 28 22            ldx   joy,Y
   12  00:FAE9  B9 93 26            lda   joy6,Y
   13  00:FAEC  60                  rts
   14                     
   15                     ; joytrg(char number)
   16                     ; ----
   17                     
   18  00:FAED            _joytrg:
   19  00:FAED  02                  sxy
   20  00:FAEE  BE 2D 22            ldx   joytrg,Y
   21  00:FAF1  B9 98 26            lda   joytrg6,Y
   22  00:FAF4  60                  rts
   23                     
   24                     ; joyold(char number)
   25                     ; ----
   26                     
   27  00:FAF5            _joyold:
   28  00:FAF5  02                  sxy
   29  00:FAF6  BE 32 22            ldx   joyold,Y
   30  00:FAF9  B9 9D 26            lda   joyold6,Y
   31  00:FAFC  60                  rts
   32                     
   33                     ; joybuf(char number)
   34                     ; ----
   35                     
   36  00:FAFD            _joybuf:
   37  00:FAFD  02                  sxy
   38  00:FAFE  BE 81 26            ldx   joybuf,Y
   39  00:FB01  B9 A2 26            lda   joybuf6,Y
   40  00:FB04  60                  rts
   41                     
   42                     
   43                     ; mouse functions
   44                     ; only available if '#define SUPPORT_MOUSE 1' is used
   45                     ; ----
   46                     
   47           0001              .ifdef SUPPORT_MOUSE
   48                     
   49                     ; mouse_exists() - returns true/false (true = 1)
   50                     ; ----
   51                     
   52  00:FB05            _mouse_exists:
   53  00:FB05  AE 84 29            ldx   msflag
   54  00:FB08  62                  cla
   55  00:FB09  60                  rts
   56                     
   57                     ; mouse_disable() - turns off mouse support
   58                     ; ----
   59                     
   60  00:FB0A            _mouse_disable:
   61  00:FB0A  62                  cla
   62  00:FB0B  82                  clx
   63  00:FB0C  8D 84 29            sta   msflag
   64  00:FB0F  60                  rts
   65                     
   66                     ; mouse_enable() - turns on mouse support, if mouse detected
   67                     ;                - return true/false (true=1) if mouse exists
   68                     ; ----
   69                     
   70  00:FB10            _mouse_enable:
   71  00:FB10  20 2F FC            jsr   mousinit
   72  00:FB13  22                  sax
   73  00:FB14  62                  cla
   74  00:FB15  60                  rts
   75                     
   76                     ; mouse_x() - returns x/y delta (int)
   77                     ; ----
   78                     
   79  00:FB16            _mouse_x:
   80  00:FB16  AE 86 29            ldx   mshorz
   81  00:FB19  10 08               bpl   mouspos
   82  00:FB1B  A9 FF     mousneg:  lda   #$ff
   83  00:FB1D  60                  rts
   84                     
   85                     ; mouse_y() - returns y delta (int)
   86                     ; ----
   87                     
   88  00:FB1E            _mouse_y:
   89  00:FB1E  AE 85 29            ldx   msvert
   90  00:FB21  30 F8               bmi   mousneg
   91  00:FB23  62        mouspos:  cla
   92  00:FB24  60                  rts
   93                     
   94                             .endif          ; SUPPORT_MOUSE
   95                     
   96                     
   97                     ; set_joy_callback(char num [dl], char mask [al], char keys [ah], int proc [bl:si])
   98                     ; ----
   99                     
  100  00:FB25            _set_joy_callback.4:
  101  00:FB25  9C 88 26            stz   joycallback
  102  00:FB28  A5 FA               lda   <_bl
  103  00:FB2A  8D 8B 26            sta   joycallback+3
  104                             __ldw   <_si
                0000              .if (1 = 2)
                                  .else
       00:FB2D  A6 EE              ldx    <_si
       00:FB2F  A5 EF              lda    <_si+1
                                  .endif
  105                             __stw   joycallback+4
       00:FB31  8E 8C 26           stx    joycallback+4
       00:FB34  8D 8D 26           sta    joycallback+4+1
  106  00:FB37  05 EE               ora   <_si
  107  00:FB39  F0 0F               beq   .l1
  108  00:FB3B  A5 F9               lda   <_ah
  109  00:FB3D  8D 8A 26            sta   joycallback+2
  110  00:FB40  A5 F8               lda   <_al
  111  00:FB42  8D 89 26            sta   joycallback+1
  112  00:FB45  A9 80               lda   #$80
  113  00:FB47  8D 88 26            sta   joycallback
  114  00:FB4A  60        .l1:      rts
  115                     
  116                     ; get_joy_events(char num, int rst)
  117                     ; ----
  118                     ; return all the collected joypad events
  119                     ; ----
  120                     
  121  00:FB4B            _get_joy_events.2:
  122  00:FB4B  A4 F8               ldy   <_al
  123  00:FB4D  E0 00               cpx   #0
  124  00:FB4F  D0 06               bne   _get_joy_events.sub
  125  00:FB51  BE 81 26            ldx   joybuf,Y
  126  00:FB54  62                  cla
  127  00:FB55  60                  rts
  128  00:FB56            _get_joy_events.1:
  129  00:FB56  02                  sxy
  130  00:FB57            _get_joy_events.sub:
  131  00:FB57  BE 81 26            ldx   joybuf,Y
  132  00:FB5A  62                  cla
  133  00:FB5B  99 81 26            sta   joybuf,Y
  134  00:FB5E  60                  rts
  135                     
  136                     ; clear_joy_events(char mask)
  137                     ; ----
  138                     
  139  00:FB5F            _clear_joy_events:
  140  00:FB5F  86 F8               stx   <_al
  141  00:FB61  C2                  cly
  142  00:FB62  78                  sei
  143  00:FB63  46 F8     .l1:      lsr   <_al
  144  00:FB65  90 15               bcc   .l2
  145  00:FB67  62                  cla
  146  00:FB68  99 81 26            sta   joybuf,Y
  147  00:FB6B  99 A2 26            sta   joybuf6,Y
  148  00:FB6E  99 2D 22            sta   joytrg,Y
  149  00:FB71  99 98 26            sta   joytrg6,Y
  150  00:FB74  A9 FF               lda   #$FF
  151  00:FB76  99 32 22            sta   joyold,Y
  152  00:FB79  99 9D 26            sta   joyold6,Y
  153  00:FB7C  C8        .l2:      iny
  154  00:FB7D  C0 05               cpy   #5
  155                               blo   .l1
       00:FB7F  90 E2              bcc    .l1
  156  00:FB81  58                  cli
  157  00:FB82  60                  rts
  158                     
  159                     
  160                     ; clock_hh()
  161                     ; ----
  162  00:FB83            _clock_hh:
  163  00:FB83  62                  cla
  164  00:FB84  AE 8F 26            ldx   clock_hh
  165  00:FB87  60                  rts
  166                     
  167                     ; clock_mm()
  168                     ; ----
  169  00:FB88            _clock_mm:
  170  00:FB88  62                  cla
  171  00:FB89  AE 90 26            ldx   clock_mm
  172  00:FB8C  60                  rts
  173                     
  174                     ; clock_ss()
  175                     ; ----
  176  00:FB8D            _clock_ss:
  177  00:FB8D  62                  cla
  178  00:FB8E  AE 91 26            ldx   clock_ss
  179  00:FB91  60                  rts
  180                     
  181                     ; clock_tt()
  182                     ; ----
  183  00:FB92            _clock_tt:
  184  00:FB92  62                  cla
  185  00:FB93  AE 92 26            ldx   clock_tt
  186  00:FB96  60                  rts
  187                     
  188                     ; clock_reset()
  189                     ; ----
  190  00:FB97            _clock_reset:
  191  00:FB97  9C 8F 26            stz   clock_hh
  192  00:FB9A  9C 90 26            stz   clock_mm
  193  00:FB9D  9C 91 26            stz   clock_ss
  194  00:FBA0  9C 92 26            stz   clock_tt
  195  00:FBA3  60                  rts
  196                     
  197                     
  198                     ; poke(int offset bx, char val)
  199                     ; ----
  200                     
  201  00:FBA4            _poke.2:
  202  00:FBA4  8A                  txa
  203  00:FBA5  92 FA               sta   [_bx]
  204  00:FBA7  60                  rts
  205                     
  206                     ; poke/pokew(int offset bx, int val)
  207                     ; ----
  208                     
  209  00:FBA8            _pokew.2:
  210  00:FBA8  22                  sax
  211  00:FBA9  92 FA               sta   [_bx]
  212  00:FBAB  A0 01               ldy   #1
  213  00:FBAD  22                  sax
  214  00:FBAE  91 FA               sta   [_bx],Y
  215  00:FBB0  60                  rts
  216                     
  217                     ; peek(int offset)
  218                     ; ----
  219                     
  220  00:FBB1            _peek:
  221                             __stw   <__ptr
       00:FBB1  86 0B              stx    <__ptr
       00:FBB3  85 0C              sta    <__ptr+1
  222  00:FBB5  B2 0B               lda   [__ptr]
  223  00:FBB7  AA                  tax
  224  00:FBB8  62                  cla
  225  00:FBB9  60                  rts
  226                     
  227                     ; peekw(int offset)
  228                     ; ----
  229                     
  230  00:FBBA            _peekw:
  231                             __stw   <__ptr
       00:FBBA  86 0B              stx    <__ptr
       00:FBBC  85 0C              sta    <__ptr+1
  232  00:FBBE  B2 0B               lda   [__ptr]
  233  00:FBC0  AA                  tax
  234  00:FBC1  A0 01               ldy   #1
  235  00:FBC3  B1 0B               lda   [__ptr],Y
  236  00:FBC5  60                  rts
  237                     
  238                     ; farpeekb(far void *base)
  239                     ; ----
  240                     
  241  00:FBC6            _farpeekb.1:
  242  00:FBC6  A5 0D               lda   <__fbank
  243  00:FBC8  53 08               tam   #3
  244  00:FBCA  A5 0F               lda   <__fptr+1
  245  00:FBCC  29 1F               and   #$1F
  246  00:FBCE  09 60               ora   #$60
  247  00:FBD0  85 0F               sta   <__fptr+1
  248  00:FBD2  B2 0E               lda   [__fptr]
  249  00:FBD4  AA                  tax
  250  00:FBD5  62                  cla
  251  00:FBD6  60                  rts
  252                     
  253                     ; farpeekw(far void *base)
  254                     ; ----
  255                     
  256  00:FBD7            _farpeekw.1:
  257  00:FBD7  A5 0D               lda   <__fbank
  258  00:FBD9  53 08               tam   #3
  259  00:FBDB  A5 0F               lda   <__fptr+1
  260  00:FBDD  29 1F               and   #$1F
  261  00:FBDF  09 60               ora   #$60
  262  00:FBE1  85 0F               sta   <__fptr+1
  263  00:FBE3  80 09               bra   _farpeekw.sub
  264  00:FBE5            _farpeekw.fast:
  265  00:FBE5  53 08               tam   #3
  266  00:FBE7  8A                  txa
  267  00:FBE8  29 1F               and   #$1F
  268  00:FBEA  09 60               ora   #$60
  269  00:FBEC  85 0F               sta   <__fptr+1
  270  00:FBEE            _farpeekw.sub:
  271  00:FBEE  B2 0E               lda   [__fptr]
  272  00:FBF0  AA                  tax
  273  00:FBF1  E6 0E               inc   <__fptr
  274  00:FBF3  90 08               bcc   .l1
  275  00:FBF5  E6 0F               inc   <__fptr+1
  276  00:FBF7  10 04               bpl   .l1
  277  00:FBF9  A9 60               lda   #$60
  278  00:FBFB  85 0F               sta   <__fptr+1
  279  00:FBFD            .l1:
  280  00:FBFD  B2 0E               lda   [__fptr]
  281  00:FBFF  60                  rts
  282                     
  283                     ; farmemget(void *dst, far void *base, int len)
  284                     ; ----
  285                     
  286  00:FC00            _farmemget.3:
  287                               maplibfunc    lib2_farmemget.3
       00:FC00  A8                 tay
       00:FC01  43 20              tma  #page(lib2_farmemget.3)
       00:FC03  48                 pha
       00:FC04  A9 01              lda  #bank(lib2_farmemget.3)
       00:FC06  53 20              tam  #page(lib2_farmemget.3)
       00:FC08  98                 tya
       00:FC09  20 E6 B2           jsr  lib2_farmemget.3
       00:FC0C  A8                 tay
       00:FC0D  68                 pla
       00:FC0E  53 20              tam  #page(lib2_farmemget.3)
       00:FC10  98                 tya
  288  00:FC11  60                  rts
  289                     
  290                     ; The following function was too large to stay
  291                     ; in LIB1_BANK, so it is placed in LIB2_BANK
  292                     ; and must be mapped in and out when used.
  293                     
  294                     ; Code after this routine should be back in LIB1_BANK
  295                     
  296           0001               .bank  LIB2_BANK
  297                     
  298  01:B2E6            lib2_farmemget.3:
  299                     
  300                             __stw   <_cx
       01:B2E6  86 FC              stx    <_cx
       01:B2E8  85 FD              sta    <_cx+1
  301  01:B2EA  A5 0D               lda   <__fbank
  302  01:B2EC  53 08               tam   #3
  303                     
  304                         ; ----
  305                         ; split transfer if needed
  306                         ;
  307                               ; -- clip length (max. 8KB)
  308                               cmpw  #$2000,<_cx
       01:B2EE  A5 FD              lda    HIGH_BYTE <_cx
       01:B2F0  C9 20              cmp    HIGH_BYTE #$2000
       01:B2F2  D0 04              bne    .x_00584
       01:B2F4  A5 FC              lda    LOW_BYTE <_cx
       01:B2F6  C9 00              cmp    LOW_BYTE #$2000
       01:B2F8            .x_00584:
  309                               blo   .t1
       01:B2F8  90 08              bcc    .t1
  310                               stw   #$2000,<_cx
       01:B2FA  A9 00              lda    LOW_BYTE #$2000
       01:B2FC  85 FC              sta    LOW_BYTE <_cx
       01:B2FE  A9 20              lda    HIGH_BYTE #$2000
       01:B300  85 FD              sta    HIGH_BYTE <_cx
  311                               ; -- check length
  312  01:B302  A5 0E     .t1:      lda   <__fptr
  313                               add   <_cl
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:B304  18                 clc
       01:B305  65 FC              adc    <_cl
                                  .endif
  314  01:B307  85 F8               sta   <_al
  315  01:B309  A5 0F               lda   <__fptr+1
  316  01:B30B  29 1F               and   #$1F
  317  01:B30D  65 FD               adc   <_ch
  318  01:B30F  85 F9               sta   <_ah
  319  01:B311  C9 20               cmp   #$20
  320                               blo   .t2
       01:B313  90 15              bcc    .t2
  321                               ; -- calculate second-half size
  322  01:B315  29 1F               and   #$1F
  323  01:B317  85 FF               sta   <_dh
  324  01:B319  A5 F8               lda   <_al
  325  01:B31B  85 FE               sta   <_dl
  326                               subw  <_dx,<_cx
       01:B31D  38                 sec
       01:B31E  A5 FC              lda    LOW_BYTE <_cx
       01:B320  E5 FE              sbc    LOW_BYTE <_dx
       01:B322  85 FC              sta    LOW_BYTE <_cx
       01:B324  A5 FD              lda    HIGH_BYTE <_cx
       01:B326  E5 FF              sbc    HIGH_BYTE <_dx
       01:B328  85 FD              sta    HIGH_BYTE <_cx
  327                               ; -- remap src ptr
  328  01:B32A  A5 0F     .t2:      lda   <__fptr+1
  329  01:B32C  29 1F               and   #$1F
  330  01:B32E  09 60               ora   #$60
  331  01:B330  85 0F               sta   <__fptr+1
  332                     
  333                         ; ----
  334                         ; copy a block
  335                         ;
  336  01:B332  82                  clx
  337  01:B333  C2                  cly
  338  01:B334  C6 FD               dec   <_ch
  339  01:B336  30 1C               bmi   .l4
  340                               ; -- main loop
  341  01:B338  B1 0E     .l1:      lda   [__fptr],Y
  342  01:B33A  91 FA               sta   [_bx],Y
  343  01:B33C  C8                  iny
  344  01:B33D  CA                  dex
  345  01:B33E  D0 F8               bne   .l1
  346                               ; -- inc dst ptr
  347  01:B340  C0 00               cpy   #0
  348  01:B342  F0 08               beq   .l2
  349  01:B344  98                  tya
  350                               add   <_bl
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       01:B345  18                 clc
       01:B346  65 FA              adc    <_bl
                                  .endif
  351  01:B348  85 FA               sta   <_bl
  352  01:B34A  90 02               bcc   .l3
  353  01:B34C  E6 FB     .l2:      inc   <_bh
  354                               ; -- inc src ptr
  355  01:B34E  E6 0F     .l3:      inc   <__fptr+1
  356                               ; -- next chunk
  357  01:B350  C6 FD               dec   <_ch
  358  01:B352  10 E4               bpl   .l1
  359  01:B354  A6 FC     .l4:      ldx   <_cl
  360  01:B356  64 FC               stz   <_cl
  361  01:B358  D0 DE               bne   .l1
  362                     
  363                         ; ----
  364                         ; second half
  365                         ;
  366                               tstw  <_dx
       01:B35A  A5 FE              lda   <_dx               ; value at stated memory
       01:B35C  05 FF              ora   <_dx+1             ; location is zero
  367  01:B35E  F0 17               beq   .l5
  368                               ; -- reload dst and cnt
  369                               stw   <_dx,<_cx
       01:B360  A5 FE              lda    LOW_BYTE <_dx
       01:B362  85 FC              sta    LOW_BYTE <_cx
       01:B364  A5 FF              lda    HIGH_BYTE <_dx
       01:B366  85 FD              sta    HIGH_BYTE <_cx
  370                               stw   #$6000,<__fptr
       01:B368  A9 00              lda    LOW_BYTE #$6000
       01:B36A  85 0E              sta    LOW_BYTE <__fptr
       01:B36C  A9 60              lda    HIGH_BYTE #$6000
       01:B36E  85 0F              sta    HIGH_BYTE <__fptr
  371                               ; -- inc bank
  372  01:B370  43 08               tma   #3
  373  01:B372  1A                  inc   A
  374  01:B373  53 08               tam   #3
  375  01:B375  80 C1               bra   .l1
  376                     
  377                         ; ----
  378                         ; exit
  379                         ;
  380  01:B377  60        .l5:      rts
  381                     
  382                     ; The preceding function was too large to stay
  383                     ; in LIB1_BANK, so it is placed in LIB2_BANK
  384                     ; and must be mapped in and out when used.
  385                     
  386                     ; Code after this routine should be back in LIB1_BANK
  387                     
  388           0000               .bank  LIB1_BANK
  389                     
  390                     
  391                     ; srand(int seed)
  392                     ; srand32.2(int seed1 [dx], int seed2 [cx])
  393                     ; ---------------
  394                     ; set the seed number for the psuedo-random number generator
  395                     
  396  00:FC12            _srand:
  397                             __stw   <_dx
       00:FC12  86 FE              stx    <_dx
       00:FC14  85 FF              sta    <_dx+1
  398                             __stw   <_cx
       00:FC16  86 FC              stx    <_cx
       00:FC18  85 FD              sta    <_cx+1
  399                     
  400  00:FC1A            _srand32.2:
  401  00:FC1A  20 17 E8            jsr   srand
  402  00:FC1D  60                  rts
  403                     
  404                     ; rand()
  405                     ; ----
  406                     ; get a 16-bit random number
  407                     
  408  00:FC1E            _rand:
  409  00:FC1E  20 3D E8            jsr   rand
  410                             __ldw   <_dx
                0000              .if (1 = 2)
                                  .else
       00:FC21  A6 FE              ldx    <_dx
       00:FC23  A5 FF              lda    <_dx+1
                                  .endif
  411  00:FC25  60                  rts
  412                     
  413                     
  414                     ; random(char limit)
  415                     ; --- 
  416                     ; get a random number where 0 <= n < limit
  417                     ; (and limit < 128)
  418                     
  419  00:FC26            _random:
  420  00:FC26  22                  sax
  421  00:FC27  29 7F               and   #$7f
  422  00:FC29  20 B4 E8            jsr   random
  423  00:FC2C  22                  sax
  424  00:FC2D  62                  cla
  425  00:FC2E  60                  rts
  426                     
#[4]   sup_hes.asm
 1305                            .endif   ; HUC
 1306                     
 1307           0001             .ifdef SUPPORT_MOUSE
#[5]   mouse.asm
 1308                             .include "mouse.asm"
    1                     ;- The mouse is read 4 successive times, in order to assemble the mouse data
    2                     ;(horiz most-significant-nybble/horiz LSN/vert MSN/vert LSN).
    3                     ;- values are deltas, and reading the mouse every VSYNC is normal
    4                     ;- For vertical movement, up is positive, down is negative
    5                     ;- For horizontal movement, left is positive, right is negative
    6                     ;- I was not able to yield a delta value greater than 0x25 (hexadecimal)
    7                     ;during a 1-VSYNC interval  (I didn't try all *that* hard though).  This
    8                     ;should give you an idea of the sensitivity.
    9                     
   10                     ;
   11                     ;  PCE mouse driver source
   12                     ;
   13                     
   14           2984              .bss
   15  --:2984            msflag: .ds 1
   16  --:2985            msvert: .ds 1
   17  --:2986            mshorz: .ds 1
   18                     
   19           FC2F              .code
   20                     
   21                     ;
   22                     ; These stub interfaces are available from LIB1_BANK
   23                     ; But the real guts are in LIB2_BANK
   24                     ;
   25  00:FC2F            mousinit:
   26                             maplibfunc      lib2_mousinit
       00:FC2F  A8                 tay
       00:FC30  43 20              tma  #page(lib2_mousinit)
       00:FC32  48                 pha
       00:FC33  A9 01              lda  #bank(lib2_mousinit)
       00:FC35  53 20              tam  #page(lib2_mousinit)
       00:FC37  98                 tya
       00:FC38  20 78 B3           jsr  lib2_mousinit
       00:FC3B  A8                 tay
       00:FC3C  68                 pla
       00:FC3D  53 20              tam  #page(lib2_mousinit)
       00:FC3F  98                 tya
   27  00:FC40  60                rts
   28                     
   29  00:FC41            mousread:
   30                             maplibfunc      lib2_mousread
       00:FC41  A8                 tay
       00:FC42  43 20              tma  #page(lib2_mousread)
       00:FC44  48                 pha
       00:FC45  A9 01              lda  #bank(lib2_mousread)
       00:FC47  53 20              tam  #page(lib2_mousread)
       00:FC49  98                 tya
       00:FC4A  20 07 B4           jsr  lib2_mousread
       00:FC4D  A8                 tay
       00:FC4E  68                 pla
       00:FC4F  53 20              tam  #page(lib2_mousread)
       00:FC51  98                 tya
   31  00:FC52  60                rts
   32                     
   33                     
   34                     ;
   35                     ; These functions are available in bank 2 of the
   36                     ; library:
   37                     ;
   38           0001              .bank   LIB2_BANK
   39                     
   40                     ;
   41                     ; detect and initialize the mouse
   42                     ;
   43  01:B378            lib2_mousinit:
   44  01:B378  A9 20             lda   #$20      ; reset resource-usage flag
   45  01:B37A  04 F5             tsb   <irq_m    ; to skip joystick read portion of vsync
   46                     
   47  01:B37C  9C 28 22          stz   joy       ; clear joypad memory area
   48  01:B37F  73 28 22          tii   joy, joy+1, $4
       01:B382  29 22 04  
       01:B385  00        
   49                     
   50  01:B386  9C 2D 22          stz   joytrg    ; clear joypad memory area
   51  01:B389  73 2D 22          tii   joytrg, joytrg+1, $4
       01:B38C  2E 22 04  
       01:B38F  00        
   52                     
   53  01:B390  9C 32 22          stz   joyold    ; clear joypad memory area
   54  01:B393  73 32 22          tii   joyold, joyold+1, $4
       01:B396  33 22 04  
       01:B399  00        
   55                     
   56  01:B39A  9C 81 26          stz   joybuf    ; clear joypad memory area
   57  01:B39D  73 81 26          tii   joybuf, joybuf+1, $4
       01:B3A0  82 26 04  
       01:B3A3  00        
   58                     
   59  01:B3A4  9C 93 26          stz   joy6      ; clear joypad memory area
   60  01:B3A7  73 93 26          tii   joy6, joy6+1, $4
       01:B3AA  94 26 04  
       01:B3AD  00        
   61                     
   62  01:B3AE  9C 98 26          stz   joytrg6   ; clear joypad memory area
   63  01:B3B1  73 98 26          tii   joytrg6, joytrg6+1, $4
       01:B3B4  99 26 04  
       01:B3B7  00        
   64                     
   65  01:B3B8  9C 9D 26          stz   joyold6   ; clear joypad memory area
   66  01:B3BB  73 9D 26          tii   joyold6, joyold6+1, $4
       01:B3BE  9E 26 04  
       01:B3C1  00        
   67                     
   68  01:B3C2  9C A2 26          stz   joybuf6   ; clear joypad memory area
   69  01:B3C5  73 A2 26          tii   joybuf6, joybuf6+1, $4
       01:B3C8  A3 26 04  
       01:B3CB  00        
   70                     
   71  01:B3CC  9C 85 29          stz   msvert
   72  01:B3CF  9C 86 29          stz   mshorz
   73  01:B3D2  9C 84 29          stz   msflag
   74                     
   75  01:B3D5  62                cla             ; counter of 'good' reads (where vertical == 0)
   76  01:B3D6  A2 0A             ldx   #$0A      ; try 10 iterations
   77  01:B3D8  48        .loop1: pha
   78  01:B3D9  DA                phx
   79  01:B3DA  A9 01             lda   #1
   80                     ;       jsr   wait_vsync        ; wait for 1 vsync frame
   81  01:B3DC  20 07 B4          jsr   lib2_mousread     ; read mouse
   82  01:B3DF  FA                plx
   83  01:B3E0  68                pla
   84  01:B3E1  AC 85 29          ldy   msvert    ; read mouse vertical axis movement
   85  01:B3E4  D0 01             bne   .l1       ; if (val == 0), inc counter
   86  01:B3E6  1A                inc   a
   87  01:B3E7  CA        .l1:    dex
   88  01:B3E8  D0 EE             bne   .loop1    ; next iteration
   89                     
   90  01:B3EA  C9 00             cmp   #$00      ; if #$00 value found even once (out of 10 times)
   91  01:B3EC  D0 0F             bne   .mous     ; then return(1)
   92                     
   93  01:B3EE  A9 20             lda   #$20      ; reset #$20 bit of $F5
   94  01:B3F0  14 F5             trb   <irq_m
   95  01:B3F2  62                cla             ; bad return code
   96  01:B3F3  8D 84 29          sta   msflag
   97  01:B3F6  9C 85 29          stz   msvert
   98  01:B3F9  9C 86 29          stz   mshorz
   99  01:B3FC  60                rts
  100                     
  101  01:B3FD            .mous:
  102  01:B3FD  A9 20             lda   #$20      ; reset #$20 bit of $F5
  103  01:B3FF  14 F5             trb   <irq_m
  104  01:B401  A9 01             lda   #$01      ; good return code
  105  01:B403  8D 84 29          sta   msflag
  106  01:B406  60                rts
  107                     
  108                     ;
  109                     ; actual mechanics of reading mouse
  110                     ;
  111  01:B407            lib2_mousread:
  112  01:B407  A2 04             ldx   #$04      ; # iterations (actually 5)
  113  01:B409  BD 28 22  .loop1: lda   joy,X     ; copy 'current' value to 'previous' value
  114  01:B40C  9D 32 22          sta   joyold,X
  115  01:B40F  CA                dex
  116  01:B410  10 F7             bpl  .loop1
  117                     
  118  01:B412  9C 28 22          stz   joy       ; initialize joypad #1's value
  119                     
  120  01:B415  A9 01             lda   #$01      ; reset joypad port# to joystick #1
  121  01:B417  8D 00 10          sta   joyport
  122  01:B41A  A9 03             lda   #$03
  123  01:B41C  8D 00 10          sta   joyport
  124  01:B41F  A9 01             lda   #$01
  125  01:B421  8D 00 10          sta   joyport
  126                     
  127  01:B424  20 9C B4          jsr   delay240  ; delay 240 CPU cycles
  128                     
  129  01:B427  AD 00 10          lda   joyport   ; read joystick port
  130  01:B42A  0A                asl   a ; upper nybble of 8-bit value - shift it
  131  01:B42B  0A                asl   a
  132  01:B42C  0A                asl   a
  133  01:B42D  0A                asl   a
  134  01:B42E  8D 86 29          sta   mshorz    ; store it
  135  01:B431  20 A9 B4          jsr   msbutt    ; read buttons (toggle port/read other nybble)
  136                     
  137  01:B434  A9 01             lda   #$01      ; reset joystick port again (to stick #1)
  138  01:B436  8D 00 10          sta   joyport
  139  01:B439  A9 03             lda   #$03
  140  01:B43B  8D 00 10          sta   joyport
  141  01:B43E  A9 01             lda   #$01
  142  01:B440  8D 00 10          sta   joyport
  143                     
  144  01:B443  20 A8 B4          jsr   delay14   ; wait 14 cycles to settle (reference code says 9)
  145                     
  146  01:B446  AD 00 10          lda   joyport   ; read port
  147  01:B449  29 0F             and   #$0F      ; lower nybble of 8-bit value
  148  01:B44B  0C 86 29          tsb   mshorz    ; 'or' it into memory
  149  01:B44E  44 59             bsr   msbutt    ; read buttons (toggle port/read other nybble)
  150                     
  151  01:B450  A9 01             lda   #$01      ; reset joystick port again
  152  01:B452  8D 00 10          sta   joyport
  153  01:B455  A9 03             lda   #$03
  154  01:B457  8D 00 10          sta   joyport
  155  01:B45A  A9 01             lda   #$01
  156  01:B45C  8D 00 10          sta   joyport
  157                     
  158  01:B45F  20 A8 B4          jsr   delay14   ; wait 14 cycles to settle (reference code says 9)
  159                     
  160  01:B462  AD 00 10          lda   joyport   ; read port
  161  01:B465  0A                asl   a ; upper nybble of 8-bit value - shift it
  162  01:B466  0A                asl   a
  163  01:B467  0A                asl   a
  164  01:B468  0A                asl   a
  165  01:B469  8D 85 29          sta   msvert
  166  01:B46C  44 3B             bsr   msbutt    ; read buttons (toggle port/read other nybble)
  167                     
  168  01:B46E  A9 01             lda   #$01      ; reset joystick port again
  169  01:B470  8D 00 10          sta   joyport
  170  01:B473  A9 03             lda   #$03
  171  01:B475  8D 00 10          sta   joyport
  172  01:B478  A9 01             lda   #$01
  173  01:B47A  8D 00 10          sta   joyport
  174                     
  175  01:B47D  20 A8 B4          jsr   delay14   ; wait 14 cycles to settle (reference code says 9)
  176                     
  177  01:B480  AD 00 10          lda   joyport   ; read port
  178  01:B483  29 0F             and   #$0F      ; lower nybble of 8-bit value
  179  01:B485  0C 85 29          tsb   msvert    ; 'or' it into value
  180  01:B488  44 1F             bsr   msbutt    ; read buttons (toggle port/read other nybble)
  181                     
  182  01:B48A  AD 2D 22          lda   joytrg    ; check joystick buttons
  183  01:B48D  C9 04             cmp   #$04      ; is 'select' newly-pressed ?
  184  01:B48F  D0 0A             bne  .exit
  185  01:B491  AD 28 22          lda   joy       ; if so, are both run & select pressed ?
  186  01:B494  C9 0C             cmp   #$0C
  187  01:B496  D0 03             bne  .exit
  188  01:B498  6C 84 22          jmp   [soft_reset]      ; if yes, reboot
  189  01:B49B  60        .exit:  rts             ; else return
  190                     
  191  01:B49C            delay240:
  192  01:B49C  48                pha             ; delay loop for 240 processor cycles
  193  01:B49D  DA                phx             ; (including call/return overhead)
  194  01:B49E  62                cla
  195  01:B49F  EA                nop
  196  01:B4A0  EA        .lp:    nop
  197  01:B4A1  1A                inc     a
  198  01:B4A2  C9 15             cmp     #21
  199  01:B4A4  90 FA             bcc     .lp
  200  01:B4A6  FA                plx
  201  01:B4A7  68                pla
  202  01:B4A8            delay14:
  203  01:B4A8  60                rts
  204                     
  205  01:B4A9            msbutt:
  206  01:B4A9  9C 00 10          stz   joyport   ; toggle joystick port to read buttons
  207                     
  208  01:B4AC  20 A8 B4          jsr   delay14   ; wait 14 cycles to settle (reference code says 9)
  209                     
  210  01:B4AF  AD 00 10          lda   joyport   ; read value
  211  01:B4B2  49 FF             eor   #$FF      ; change low-active to high-active
  212  01:B4B4  29 0F             and   #$0F      ; only 4 bits
  213  01:B4B6  0C 28 22          tsb   joy       ; 'or' it into value
  214                     
  215  01:B4B9  0D 32 22          ora   joyold    ; determine 'newly-pressed' buttons
  216  01:B4BC  4D 32 22          eor   joyold
  217  01:B4BF  8D 2D 22          sta   joytrg    ; put them into 'delta'
  218  01:B4C2  60                rts
  219                     
  220           0000              .bank   LIB1_BANK       ; restore bank-context
  221                     
  222                     
#[4]   sup_hes.asm
 1309                            .endif   ; SUPPORT_MOUSE
 1310                     
 1311           0000             .if (CDROM)
 1313                            .else
#[5]   sound.asm
 1314                             .include "sound.asm"
    1                     ; SOUND.ASM
    2                     ; ---------
    3                     ;
    4                     ; A PSG driver which is compatible with the "track data"
    5                     ; and other bytecodes as used by the CDROM System Card
    6                     ;
    7                     
    8                     
    9  00:FC53  DA        psg_bios:       phx
   10  00:FC54  5A                        phy
   11  00:FC55  43 40                     tma     #PAGE(psg_on)
   12  00:FC57  48                        pha
   13  00:FC58  A9 02                     lda     #BANK(psg_on)
   14  00:FC5A  53 40                     tam     #PAGE(psg_on)
   15  00:FC5C  A5 FF                     lda     <_dh
   16  00:FC5E  0A                        asl     A
   17  00:FC5F  AA                        tax
   18  00:FC60  20 6B FC                  jsr     .indir_jmp
   19  00:FC63  AA                        tax
   20  00:FC64  68                        pla
   21  00:FC65  53 40                     tam     #PAGE(psg_on)
   22  00:FC67  8A                        txa
   23  00:FC68  7A                        ply
   24  00:FC69  FA                        plx
   25  00:FC6A  60                        rts
   26  00:FC6B  7C 6E FC  .indir_jmp:     jmp     [.functbl,X]
   27                     
   28  00:FC6E  00 C0     .functbl:       .dw     psg_on          ; psg_on       (00)
   29  00:FC70  0D C0                     .dw     psg_off         ; psg_off      (01)
   30  00:FC72  17 C0                     .dw     psg_init        ; psg_init     (02)
   31  00:FC74  64 C0                     .dw     psg_bank        ; psg_bank     (03)
   32  00:FC76  6F C0                     .dw     psg_track       ; psg_track    (04)
   33  00:FC78  7A C0                     .dw     psg_wave        ; psg_wave     (05)
   34  00:FC7A  85 C0                     .dw     psg_env         ; psg_env      (06)
   35  00:FC7C  90 C0                     .dw     psg_fm          ; psg_fm       (07)
   36  00:FC7E  9B C0                     .dw     psg_pe          ; psg_pe       (08)
   37  00:FC80  A6 C0                     .dw     psg_pc          ; psg_pc       (09)
   38  00:FC82  B1 C0                     .dw     psg_settempo    ; psg_settempo (0a)
   39  00:FC84  C1 C0                     .dw     psg_play        ; psg_play     (0b)
   40  00:FC86  C9 C0                     .dw     psg_mstat       ; psg_mstat    (0c)
   41  00:FC88  DB C0                     .dw     psg_sstat       ; psg_sstat    (0d)
   42  00:FC8A  ED C0                     .dw     psg_mstop       ; psg_mstop    (0e)
   43  00:FC8C  2B C1                     .dw     psg_sstop       ; psg_sstop    (0f)
   44  00:FC8E  7B C1                     .dw     psg_astop       ; psg_astop    (10)
   45  00:FC90  94 C1                     .dw     psg_mvoff       ; psg_mvoff    (11)
   46  00:FC92  BC C1                     .dw     psg_cont        ; psg_cont     (12)
   47  00:FC94  F9 C1                     .dw     psg_fdout       ; psg_fdout    (13)
   48  00:FC96  0A C2                     .dw     psg_dcnt        ; psg_dcnt     (14)
   49                     
   50                     ;
   51                     ; Origin is at $C000.
   52                     ;
   53                     ; This is normally occupied by "START_BANK" when the program
   54                     ; is destined for CDROM, but should be OK for HuCard-only
   55                     ; development (note: PSG player exists in system card when
   56                     ; developing for CDROM)
   57                     ;
   58                     
   59           0002              .bank   PSG_BANK,"PSG Driver"
   60           C000              .org    $C000
   61                     
   62                     
   63                     ; ----
   64                     ; PSG_ON
   65                     ; ----
   66                     ; CDROM version takes a parameter in _al
   67                     ; 0=TIMER, 1=VSYNC
   68                     ;
   69                     ; This version will only support TIMER interrupt
   70                     ;
   71  02:C000            psg_on:
   72  02:C000  FF E7 04          bbs7    <psg_inhibit,.noturnoff
   73  02:C003  44 08             bsr     psg_off
   74  02:C005  F7 E7             smb7    <psg_inhibit
   75  02:C007            .noturnoff:
   76  02:C007  A9 01             lda     #1
   77  02:C009  8D 01 0C          sta     timer_ctrl
   78  02:C00C  60                rts
   79                     
   80                     
   81                     ; ----
   82                     ; PSG_OFF
   83                     ; ----
   84                     ;
   85                     ; turn off PSG
   86                     ; - all sound
   87                     ; - interrupt service (if TIMER)
   88                     ;
   89  02:C00D            psg_off:
   90  02:C00D  FF E7 03          bbs7    <psg_inhibit,.nostop
   91  02:C010  20 7B C1          jsr     psg_astop
   92  02:C013            .nostop:
   93  02:C013  9C 01 0C          stz     timer_ctrl
   94  02:C016  60                rts
   95                     
   96                     
   97                     ; ----
   98                     ; PSG_INIT
   99                     ; ----
  100                     ;
  101                     ; Initialize PSG.  CDROM version has a parameter:
  102                     ; 0=main track only; 60Hz
  103                     ; 1=sub track only; 60Hz
  104                     ; 2=both tracks; 60Hz
  105                     ; 3=both tracks; 120Hz
  106                     ; 4=both tracks; 240Hz
  107                     ; 5=both tracks; 300Hz
  108                     ;
  109                     ; This version only supports "both channels/60Hz" for now
  110                     ;
  111  02:C017            psg_init:
  112                     
  113                     ; initialize some IRQ stuff & zero values
  114                     
  115  02:C017  9C D0 22          stz     psg_tempo       ; clear header info
  116  02:C01A  73 D0 22          tii     psg_tempo, psg_tempo+1, 19
       02:C01D  D1 22 13  
       02:C020  00        
  117                     
  118                     ;       stz     psg_trkptr_l    ; clear per-track info
  119                     ;       tii     psg_trkptr_l,psg_trkptr_l+1,????
  120                     
  121  02:C021  64 E6             stz     <psg_irqflag
  122  02:C023  64 E8             stz     <psg_tmpptr
  123  02:C025  64 E9             stz     <psg_tmpptr+1
  124  02:C027  64 EA             stz     <psg_tmpptr1
  125  02:C029  64 EB             stz     <psg_tmpptr1+1
  126                     
  127  02:C02B  F7 E7             smb7    <psg_inhibit
  128                     
  129                     ;
  130                     ; reset hardware
  131                     ;
  132  02:C02D  A2 05             ldx     #5
  133  02:C02F  A9 40             lda     #PSG_DDA
  134  02:C031  8E DE 22  .loop1: stx     psg_ch_value    ; $0800 register value
  135  02:C034  8E 00 08          stx     psg_ch          ; set channel
  136  02:C037  8D 04 08          sta     psg_ctrl        ; reset channel
  137  02:C03A  9C 04 08          stz     psg_ctrl        ; reset wave buffer
  138  02:C03D  D3 C3 C4          tin     psg_waveforms,psg_wavebuf,$0020 ; simple squarewave
       02:C040  06 08 20  
       02:C043  00        
  139  02:C044  CA                dex
  140  02:C045  10 EA             bpl     .loop1
  141                     
  142  02:C047  A9 FF             lda     #$ff            ; set global hardware values
  143  02:C049  8D 01 08          sta     psg_mainvol
  144                     
  145  02:C04C  A9 01             lda     #$01
  146  02:C04E  8D 08 08          sta     psg_lfofreq
  147  02:C051  9C 09 08          stz     psg_lfoctrl
  148                     
  149                     ;
  150                     ; set some basic default values
  151                     ;
  152  02:C054  A9 80             lda     #$80
  153  02:C056  8D E0 22          sta     psg_song
  154                     
  155  02:C059  A9 C0             lda     #(PSG_MAINPAUSE | PSG_SUBPAUSE)
  156  02:C05B  8D DD 22          sta     psg_trkctrl
  157                     
  158  02:C05E  A9 26             lda     #$26            ; is this right ?
  159  02:C060  20 B1 C0          jsr     psg_settempo
  160                     
  161  02:C063  60                rts
  162                     
  163                     
  164                     ; ----
  165                     ; PSG_BANK
  166                     ; ----
  167                     
  168  02:C064            psg_bank:
  169                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C064  A6 F8              ldx    <_ax
       02:C066  A5 F9              lda    <_ax+1
                                  .endif
  170                           __stw     psg_bank1
       02:C068  8E E1 22           stx    psg_bank1
       02:C06B  8D E2 22           sta    psg_bank1+1
  171  02:C06E  60                rts
  172                     
  173                     
  174                     ; ----
  175                     ; PSG_TRACK
  176                     ; ----
  177                     
  178  02:C06F            psg_track:
  179                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C06F  A6 F8              ldx    <_ax
       02:C071  A5 F9              lda    <_ax+1
                                  .endif
  180                           __stw     psg_trkhdr
       02:C073  8E D1 22           stx    psg_trkhdr
       02:C076  8D D2 22           sta    psg_trkhdr+1
  181  02:C079  60                rts
  182                     
  183                     
  184                     ; ----
  185                     ; PSG_WAVE
  186                     ; ----
  187                     
  188  02:C07A            psg_wave:
  189                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C07A  A6 F8              ldx    <_ax
       02:C07C  A5 F9              lda    <_ax+1
                                  .endif
  190                           __stw     psg_wavehdr
       02:C07E  8E D3 22           stx    psg_wavehdr
       02:C081  8D D4 22           sta    psg_wavehdr+1
  191  02:C084  60                rts
  192                     
  193                     
  194                     ; ----
  195                     ; PSG_ENV
  196                     ; ----
  197                     
  198  02:C085            psg_env:
  199                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C085  A6 F8              ldx    <_ax
       02:C087  A5 F9              lda    <_ax+1
                                  .endif
  200                           __stw     psg_envhdr
       02:C089  8E D5 22           stx    psg_envhdr
       02:C08C  8D D6 22           sta    psg_envhdr+1
  201  02:C08F  60                rts
  202                     
  203                     
  204                     ; ----
  205                     ; PSG_FM
  206                     ; ----
  207                     
  208  02:C090            psg_fm:
  209                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C090  A6 F8              ldx    <_ax
       02:C092  A5 F9              lda    <_ax+1
                                  .endif
  210                           __stw     psg_fmhdr
       02:C094  8E D9 22           stx    psg_fmhdr
       02:C097  8D DA 22           sta    psg_fmhdr+1
  211  02:C09A  60                rts
  212                     
  213                     
  214                     ; ----
  215                     ; PSG_PE
  216                     ; ----
  217                     
  218  02:C09B            psg_pe:
  219                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C09B  A6 F8              ldx    <_ax
       02:C09D  A5 F9              lda    <_ax+1
                                  .endif
  220                           __stw     psg_pehdr
       02:C09F  8E DB 22           stx    psg_pehdr
       02:C0A2  8D DC 22           sta    psg_pehdr+1
  221  02:C0A5  60                rts
  222                     
  223                     
  224                     ; ----
  225                     ; PSG_PC
  226                     ; ----
  227                     
  228  02:C0A6            psg_pc:
  229                           __ldw     <_ax
                0000              .if (1 = 2)
                                  .else
       02:C0A6  A6 F8              ldx    <_ax
       02:C0A8  A5 F9              lda    <_ax+1
                                  .endif
  230                           __stw     psg_percusshdr
       02:C0AA  8E D7 22           stx    psg_percusshdr
       02:C0AD  8D D8 22           sta    psg_percusshdr+1
  231  02:C0B0  60                rts
  232                     
  233                     
  234                     ; ----
  235                     ; PSG_SETTEMPO
  236                     ; ----
  237                     
  238  02:C0B1            psg_settempo:
  239  02:C0B1  A5 F8             lda     <_al
  240                             sub     #$23
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       02:C0B3  38                 sec
       02:C0B4  E9 23              sbc    #$23
                                  .endif
  241  02:C0B6  10 01             bpl     .okvalue
  242  02:C0B8  62                cla
  243  02:C0B9            .okvalue:
  244  02:C0B9  AA                tax
  245  02:C0BA  BD 13 CB          lda     psg_tempotbl,X
  246  02:C0BD  8D D0 22          sta     psg_tempo
  247  02:C0C0  60                rts
  248                     
  249                     
  250                     ; ----
  251                     ; PSG_PLAY
  252                     ;
  253                     ; play song # in track list (_al = song #)
  254                     ; ----
  255                     
  256  02:C0C1            psg_play:
  257  02:C0C1  A5 F8             lda     <_al
  258  02:C0C3  8D E0 22          sta     psg_song
  259  02:C0C6  77 E7             rmb7    <psg_inhibit
  260  02:C0C8  60                rts
  261                     
  262                     
  263                     ; ----
  264                     ; PSG_MSTAT
  265                     ;
  266                     ; return bitmask of voices in use for main track
  267                     ; ----
  268                     
  269  02:C0C9            psg_mstat:
  270  02:C0C9  A0 05             ldy     #5
  271  02:C0CB  62                cla
  272                     
  273  02:C0CC  BE E3 22  .loop:  ldx     psg_voicectrl,Y
  274  02:C0CF  F0 04             beq     .empty
  275  02:C0D1  38                sec
  276  02:C0D2  2A                rol     A
  277  02:C0D3  80 02             bra     .next
  278  02:C0D5  18        .empty: clc
  279  02:C0D6  2A                rol     A
  280  02:C0D7  88        .next:  dey
  281  02:C0D8  10 F2             bpl     .loop
  282  02:C0DA  60                rts
  283                     
  284                     
  285                     ; ----
  286                     ; PSG_SSTAT
  287                     ;
  288                     ; return bitmask of voices in use for sub track
  289                     ; ----
  290                     
  291  02:C0DB            psg_sstat:
  292  02:C0DB  A0 05             ldy     #5
  293  02:C0DD  62                cla
  294                     
  295  02:C0DE  BE E9 22  .loop:  ldx     psg_voicectrl+6,Y
  296  02:C0E1  F0 04             beq     .empty
  297  02:C0E3  38                sec
  298  02:C0E4  2A                rol     A
  299  02:C0E5  80 02             bra     .next
  300  02:C0E7  18        .empty: clc
  301  02:C0E8  2A                rol     A
  302  02:C0E9  88        .next:  dey
  303  02:C0EA  10 F2             bpl     .loop
  304  02:C0EC  60                rts
  305                     
  306                     
  307                     ; ----
  308                     ; PSG_MSTOP
  309                     ;
  310                     ; Stop voices in main track, as described in bitmask (in _al)
  311                     ; ----
  312                     
  313  02:C0ED            psg_mstop:
  314  02:C0ED  A5 F8             lda     <_al
  315  02:C0EF  10 07             bpl     .nopause
  316                     
  317  02:C0F1  A9 80             lda     #PSG_MAINPAUSE  ; set pause on MAIN track
  318  02:C0F3  0C DD 22          tsb     psg_trkctrl
  319                     
  320  02:C0F6  A5 F8             lda     <_al
  321                     
  322  02:C0F8            .nopause:
  323  02:C0F8  A8                tay
  324  02:C0F9  82                clx
  325                     
  326  02:C0FA  BD E3 22  .loop:  lda     psg_voicectrl,X
  327  02:C0FD  F0 19             beq     .nextvoice
  328  02:C0FF  98                tya
  329  02:C100  30 06             bmi     .pause          ; is it a 'pause' for voice ?
  330                     
  331  02:C102  4A                lsr     A               ; no, it is a 'stop'
  332  02:C103  90 13             bcc     .nextvoice      ; this voice not in mask; skip it
  333                     
  334  02:C105  9E E3 22          stz     psg_voicectrl,X
  335                     
  336  02:C108  BD E9 22  .pause: lda     psg_voicectrl+6,X       ; check subtrack
  337  02:C10B  C9 01             cmp     #1
  338  02:C10D  F0 09             beq     .nextvoice
  339                     
  340  02:C10F  8E DE 22          stx     psg_ch_value
  341  02:C112  8E 00 08          stx     psg_ch
  342  02:C115  9C 04 08          stz     psg_ctrl
  343                     
  344  02:C118            .nextvoice:
  345  02:C118  E8                inx
  346  02:C119  E0 06             cpx     #6
  347  02:C11B  B0 0D             bcs     .out
  348  02:C11D  98                tya
  349  02:C11E  30 04             bmi     .pause2
  350                             
  351  02:C120  4A                lsr     A
  352  02:C121  A8                tay
  353  02:C122  80 D6             bra     .loop
  354                     
  355  02:C124            .pause2:
  356  02:C124  4A                lsr     A
  357  02:C125  09 80             ora     #$80            ; retain high-bit set
  358  02:C127  A8                tay
  359  02:C128  80 D0             bra     .loop
  360                     
  361  02:C12A  60        .out:   rts
  362                     
  363                     
  364                     ; ----
  365                     ; PSG_SSTOP
  366                     ;
  367                     ; Stop voices in sub track, as described in bitmask (in _al)
  368                     ; ----
  369                     
  370  02:C12B            psg_sstop:
  371  02:C12B  A5 F8             lda     <_al
  372  02:C12D  10 07             bpl     .nopause
  373                     
  374  02:C12F  A9 40             lda     #PSG_SUBPAUSE   ; set pause on SUB track
  375  02:C131  0C DD 22          tsb     psg_trkctrl
  376                     
  377  02:C134  A5 F8             lda     <_al
  378                     
  379  02:C136            .nopause:
  380  02:C136  A8                tay
  381  02:C137  82                clx
  382                     
  383  02:C138  BD E9 22  .loop:  lda     psg_voicectrl+6,X
  384  02:C13B  F0 2B             beq     .nextvoice
  385  02:C13D  98                tya
  386  02:C13E  30 08             bmi     .pause          ; is it a 'pause' ?
  387                     
  388  02:C140  4A                lsr     A               ; no, it is a 'stop'
  389  02:C141  90 25             bcc     .nextvoice      ; voice not in mask; skip it
  390                     
  391  02:C143  9E E9 22          stz     psg_voicectrl+6,X
  392  02:C146  80 05             bra     .pause1
  393  02:C148            .pause:
  394  02:C148  A9 FF             lda     #$ff            ; pause control
  395  02:C14A  9D E9 22          sta     psg_voicectrl+6,X
  396                     
  397  02:C14D            .pause1:
  398  02:C14D  BD E3 22          lda     psg_voicectrl,X
  399  02:C150  F0 08             beq     .skipwave
  400                     
  401  02:C152  BD DD 25          lda     psg_wavenum,X
  402  02:C155  29 80             and     #$80
  403  02:C157  9D DD 25          sta     psg_wavenum,X
  404                     
  405  02:C15A            .skipwave:
  406  02:C15A  AD DD 22          lda     psg_trkctrl     ; is anything playing on main track ?
  407  02:C15D  10 09             bpl     .nextvoice      ; yes... so don't stop it
  408                     
  409  02:C15F  8E DE 22          stx     psg_ch_value
  410  02:C162  8E 00 08          stx     psg_ch
  411  02:C165  9C 04 08          stz     psg_ctrl
  412                     
  413  02:C168            .nextvoice:
  414  02:C168  E8                inx
  415  02:C169  E0 06             cpx     #6
  416  02:C16B  B0 0D             bcs     .out
  417  02:C16D  98                tya
  418  02:C16E  30 04             bmi     .pause2
  419                             
  420  02:C170  4A                lsr     A
  421  02:C171  A8                tay
  422  02:C172  80 C4             bra     .loop
  423                     
  424  02:C174            .pause2:
  425  02:C174  4A                lsr     A
  426  02:C175  09 80             ora     #$80
  427  02:C177  A8                tay
  428  02:C178  80 BE             bra     .loop
  429                     
  430  02:C17A  60        .out:   rts
  431                     
  432                     
  433                     ; ----
  434                     ; PSG_ASTOP
  435                     ;
  436                     ; Stop all voices
  437                     ; ----
  438                     
  439  02:C17B            psg_astop:
  440  02:C17B  F7 E7             smb7    <psg_inhibit
  441                     
  442  02:C17D  A9 C0             lda     #(PSG_MAINPAUSE | PSG_SUBPAUSE)
  443  02:C17F  8D DD 22          sta     psg_trkctrl
  444                     
  445  02:C182  A2 05             ldx     #5
  446  02:C184  9E E3 22  .loop:  stz     psg_voicectrl,X         ; disable main track
  447  02:C187  9E E9 22          stz     psg_voicectrl+6,X       ; disable sub track
  448  02:C18A  8E 00 08          stx     psg_ch
  449  02:C18D  9C 04 08          stz     psg_ctrl                ; disable voice
  450  02:C190  CA                dex
  451  02:C191  10 F1             bpl     .loop
  452                     
  453  02:C193  60                rts
  454                     
  455                     ; ----
  456                     ; PSG_MVOFF
  457                     ;
  458                     ; Main volume off for voices specified in bitmask (in _al)
  459                     ; ----
  460                     
  461  02:C194            psg_mvoff:
  462  02:C194  A5 F8             lda     <_al
  463  02:C196  82                clx
  464                     
  465  02:C197  4A        .loop:  lsr     A
  466  02:C198  90 1C             bcc     .skip
  467                     
  468  02:C19A  BC E3 22          ldy     psg_voicectrl,X
  469  02:C19D  F0 17             beq     .skip
  470                     
  471  02:C19F  48                pha
  472  02:C1A0  A9 FF             lda     #$ff            ; turn off sound on voice
  473  02:C1A2  9D E3 22          sta     psg_voicectrl,X
  474  02:C1A5  68                pla
  475                     
  476  02:C1A6  BC E9 22          ldy     psg_voicectrl+6,X
  477  02:C1A9  C0 01             cpy     #1
  478  02:C1AB  F0 09             beq     .skip
  479                     
  480  02:C1AD  8E DE 22          stx     psg_ch_value    ; turn off voice
  481  02:C1B0  8E 00 08          stx     psg_ch
  482  02:C1B3  9C 04 08          stz     psg_ctrl
  483                     
  484  02:C1B6  E8        .skip:  inx
  485  02:C1B7  E0 06             cpx     #6
  486  02:C1B9  90 DC             bcc     .loop
  487                     
  488  02:C1BB  60                rts
  489                     
  490                     
  491                     ; ----
  492                     ; PSG_CONT
  493                     ;
  494                     ; "continue"
  495                     ; ----
  496                     ;
  497                     ; parameter:
  498                     ; 0 = main track
  499                     ; 1 = sub track
  500                     ; 2 = both
  501                     ;
  502  02:C1BC            psg_cont:
  503  02:C1BC  A5 F8             lda     <_al
  504  02:C1BE  C9 01             cmp     #1
  505  02:C1C0  F0 14             beq     .sub
  506                     
  507  02:C1C2  A2 05             ldx     #5
  508  02:C1C4  BD E3 22  .loop:  lda     psg_voicectrl,X
  509  02:C1C7  F0 05             beq     .next                   ; skip if disabled
  510                     
  511  02:C1C9  A9 01             lda     #1                      ; restart voice
  512  02:C1CB  9D E3 22          sta     psg_voicectrl,X
  513                     
  514  02:C1CE  CA        .next:  dex
  515  02:C1CF  10 F3             bpl     .loop
  516                     
  517  02:C1D1  A9 80             lda     #PSG_MAINPAUSE          ; release pause on main tracks
  518  02:C1D3  1C DD 22          trb     psg_trkctrl
  519                     
  520  02:C1D6  A5 F8     .sub:   lda     <_al
  521  02:C1D8  F0 1C             beq     .end
  522                     
  523  02:C1DA  A2 05             ldx     #5
  524  02:C1DC  BD E9 22  .loop1: lda     psg_voicectrl+6,X
  525  02:C1DF  F0 0D             beq     .next1                  ; skip if disabled
  526                     
  527  02:C1E1  A9 01             lda     #1                      ; restart voice
  528  02:C1E3  9D E9 22          sta     psg_voicectrl+6,X
  529                     
  530  02:C1E6  BD DD 25          lda     psg_wavenum,X
  531  02:C1E9  29 80             and     #$80                    ; force re-download of waveform
  532  02:C1EB  9D DD 25          sta     psg_wavenum,X
  533                     
  534  02:C1EE  CA        .next1: dex
  535  02:C1EF  10 EB             bpl     .loop1
  536                     
  537  02:C1F1  A9 40             lda     #PSG_SUBPAUSE           ; release pause on sub tracks
  538  02:C1F3  1C DD 22          trb     psg_trkctrl
  539                     
  540  02:C1F6  77 E7     .end:   rmb7    <psg_inhibit            ; remove pause on irq processing
  541  02:C1F8  60                rts
  542                     
  543                     
  544                     ; ----
  545                     ; PSG_FDOUT
  546                     ; ----
  547                     
  548  02:C1F9            psg_fdout:
  549  02:C1F9  A5 F8             lda     <_al
  550  02:C1FB  10 03             bpl     .positive
  551                     
  552  02:C1FD  49 FF             eor     #$ff            ; get absolute value from negative
  553  02:C1FF  1A                inc     A
  554                     
  555  02:C200            .positive:
  556  02:C200  8D 01 26          sta     psg_fadespeed   ; store it as fade speed
  557  02:C203  9C 03 26          stz     psg_fadecount   ; reset fade levels
  558  02:C206  9C 05 26          stz     psg_fadevolcut
  559                     
  560  02:C209  60                rts
  561                     
  562                     
  563                     ; ----
  564                     ; PSG_DCNT
  565                     ;
  566                     ;  set delay counter - sets an up-counter to use if interrupt
  567                     ;  frequency is >60Hz, and this will act as a frequency divider
  568                     ;  (by ignoring interrupts until up-counter value is hit)
  569                     ;
  570                     ;  Not used in this implementation of PSG driver
  571                     ; ----
  572                     
  573  02:C20A            psg_dcnt:
  574  02:C20A  60                rts
  575                     
  576                     
  577                     ; ----
  578                     ; psg_drive - driver for MAIN tracks
  579                     ; ----
  580                     
  581  02:C20B            psg_drive:
  582  02:C20B  AD E0 22          lda     psg_song
  583  02:C20E  30 03             bmi     .skipsong
  584                     
  585  02:C210  20 59 C2          jsr     psg_initsong
  586                     
  587  02:C213            .skipsong:
  588  02:C213  A9 0B             lda     #11
  589  02:C215  8D DF 22          sta     psg_currvoice
  590                     
  591  02:C218  AE DF 22  .loop:  ldx     psg_currvoice
  592  02:C21B  E0 06             cpx     #6
  593  02:C21D  90 09             bcc     .chkmain
  594                     
  595  02:C21F            .chksub:        
  596  02:C21F  AD DD 22          lda     psg_trkctrl
  597  02:C222  29 40             and     #PSG_SUBPAUSE
  598  02:C224  D0 0F             bne     .next
  599  02:C226  80 05             bra     .dovoice
  600                     
  601  02:C228            .chkmain:
  602  02:C228  AD DD 22          lda     psg_trkctrl
  603  02:C22B  30 08             bmi     .next
  604                     
  605  02:C22D            .dovoice:
  606  02:C22D  BD E3 22          lda     psg_voicectrl,X
  607  02:C230  F0 03             beq     .next
  608                     
  609  02:C232  20 20 C3          jsr     psg_drivevoice
  610                     
  611  02:C235  CE DF 22  .next:  dec     psg_currvoice
  612  02:C238  10 DE             bpl     .loop
  613                             
  614                     ; now loop is done...
  615                     ; so now we look at general items
  616                     
  617  02:C23A  20 1E C3          jsr     psg_dofade
  618  02:C23D  20 1F C3          jsr     psg_dodata2hdwr
  619                     
  620  02:C240  20 C9 C0          jsr     psg_mstat
  621  02:C243  C9 00             cmp     #$00
  622  02:C245  D0 05             bne     .mainok
  623                     
  624  02:C247  A9 80             lda     #PSG_MAINPAUSE
  625  02:C249  0C DD 22          tsb     psg_trkctrl
  626                     
  627  02:C24C            .mainok:
  628  02:C24C  20 DB C0          jsr     psg_sstat
  629  02:C24F  C9 00             cmp     #$00
  630  02:C251  D0 05             bne     .subok
  631                     
  632  02:C253  A9 40             lda     #PSG_SUBPAUSE
  633  02:C255  0C DD 22          tsb     psg_trkctrl
  634                     
  635  02:C258            .subok:
  636  02:C258  60                rts
  637                     
  638                     
  639                     ; ----
  640                     ; psg_initsong - initialize stuff for playing song
  641                     ; ----
  642                     
  643                     ; ???? MAY NOT BE COMPLETE
  644                     
  645  02:C259            psg_initsong:
  646  02:C259  AD E0 22          lda     psg_song
  647                     
  648  02:C25C  0A                asl     A               ; make index for 16-bit data
  649  02:C25D  A8                tay
  650                     
  651                           __ldw     psg_trkhdr
                0000              .if (1 = 2)
                                  .else
       02:C25E  AE D1 22           ldx    psg_trkhdr
       02:C261  AD D2 22           lda    psg_trkhdr+1
                                  .endif
  652                     
  653                           __stw     <psg_tmpptr1
       02:C264  86 EA              stx    <psg_tmpptr1
       02:C266  85 EB              sta    <psg_tmpptr1+1
  654  02:C268  B1 EA             lda     [psg_tmpptr1],Y
  655  02:C26A  85 E8             sta     <psg_tmpptr
  656  02:C26C  C8                iny
  657  02:C26D  B1 EA             lda     [psg_tmpptr1],Y
  658  02:C26F  85 E9             sta     <psg_tmpptr+1
  659                     
  660  02:C271  B2 E8             lda     [psg_tmpptr]
  661  02:C273  85 EA             sta     <psg_tmpptr1
  662  02:C275  85 EB             sta     <psg_tmpptr1+1
  663                     
  664  02:C277  30 03             bmi     .subtrack       ; starting voice = 0 (main), 6 (sub)
  665  02:C279  82                clx
  666  02:C27A  80 02             bra     .processmask
  667  02:C27C            .subtrack:
  668  02:C27C  A2 06             ldx     #6
  669                     
  670  02:C27E            .processmask:
  671  02:C27E  C2                cly
  672  02:C27F  4E EB 20          lsr     psg_tmpptr1+1
  673                             lbcc    .nextvoice
       02:C282  B0 03              bcs    .x_00616
       02:C284  4C F7 C2           jmp    .nextvoice
       02:C287            .x_00616
  674                     
  675  02:C287  A9 01             lda     #1
  676  02:C289  9D E3 22          sta     psg_voicectrl,X
  677  02:C28C  9D 1F 23          sta     psg_cntdown,X
  678  02:C28F  9E F5 25          stz     psg_strikephase,X
  679  02:C292  9E 73 23          stz     psg_transpose,X
  680  02:C295  9E 95 25          stz     psg_mode,X
  681  02:C298  9E A1 25          stz     psg_stkoff,X
  682  02:C29B  9E 87 24          stz     psg_detune,X
  683  02:C29E  9E 7F 23          stz     psg_duratnmult,X
  684  02:C2A1  9E 27 24          stz     psg_fmcorrect,X
  685  02:C2A4  9E 33 24          stz     psg_fmdelay,X
  686  02:C2A7  9E 3F 24          stz     psg_fmdelcntdn,X
  687  02:C2AA  9E 6F 24          stz     psg_pedelay,X
  688  02:C2AD  9E 7B 24          stz     psg_pedelcntdn,X
  689  02:C2B0  9E 93 24          stz     psg_volchg,X
  690  02:C2B3  9E 9F 24          stz     psg_volchgaccum,X
  691  02:C2B6  9E AB 24          stz     psg_panpotchg,X
  692  02:C2B9  9E B7 24          stz     psg_panpotaccum,X
  693                     
  694  02:C2BC  A9 04             lda     #4
  695  02:C2BE  9D 2B 23          sta     psg_octave,X
  696  02:C2C1  A9 08             lda     #8
  697  02:C2C3  9D 5B 23          sta     psg_keyonratio,X
  698  02:C2C6  9D 67 23          sta     psg_keycntdown,X
  699  02:C2C9  A9 1F             lda     #$1f
  700  02:C2CB  9D 4F 23          sta     psg_perchvol,X
  701                     
  702  02:C2CE  AD D5 CC          lda     psg_envtbl      ; set to basic envelope
  703  02:C2D1  9D 8B 23          sta     psg_envptr_l,X
  704  02:C2D4  AD D6 CC          lda     psg_envtbl+1
  705  02:C2D7  9D 97 23          sta     psg_envptr_h,X
  706  02:C2DA  9E A3 23          stz     psg_envptr_off,X
  707  02:C2DD  A9 84             lda     #$84            ; set default level to $8400
  708  02:C2DF  9E EB 23          stz     psg_envrels_l,X
  709  02:C2E2  9D F7 23          sta     psg_envrels_h,X
  710                     
  711  02:C2E5  C8                iny
  712  02:C2E6  B1 E8             lda     [psg_tmpptr],Y  ; put voice address into correct voice
  713  02:C2E8  9D EF 22          sta     psg_trkptr_l,X
  714  02:C2EB  9D 07 23          sta     psg_savepoint_l,X
  715  02:C2EE  C8                iny
  716  02:C2EF  B1 E8             lda     [psg_tmpptr],Y
  717  02:C2F1  9D FB 22          sta     psg_trkptr_h,X
  718  02:C2F4  9D 13 23          sta     psg_savepoint_h,X
  719                     
  720  02:C2F7            .nextvoice:
  721  02:C2F7  E8                inx
  722  02:C2F8  A5 EA             lda     <psg_tmpptr1
  723  02:C2FA  30 09             bmi     .nextsub
  724                     
  725  02:C2FC            .nextmain:
  726  02:C2FC  E0 06             cpx     #6
  727                             lbcc    .processmask
       02:C2FE  B0 03              bcs    .x_00617
       02:C300  4C 7E C2           jmp    .processmask
       02:C303            .x_00617
  728  02:C303  80 07             bra     .endloop
  729                             
  730  02:C305            .nextsub:
  731  02:C305  E0 0C             cpx     #12
  732                             lbcc    .processmask
       02:C307  B0 03              bcs    .x_00618
       02:C309  4C 7E C2           jmp    .processmask
       02:C30C            .x_00618
  733                     
  734  02:C30C            .endloop:
  735  02:C30C  9C 01 26          stz     psg_fadespeed
  736  02:C30F  9C 03 26          stz     psg_fadecount
  737  02:C312  9C 05 26          stz     psg_fadevolcut
  738                     
  739  02:C315  AD E0 22          lda     psg_song
  740  02:C318  09 80             ora     #$80
  741  02:C31A  8D E0 22          sta     psg_song
  742                     
  743  02:C31D  60                rts
  744                     
  745                     
  746                     ; ----
  747                     ; psg_dofade
  748                     ; ----
  749                     
  750                     ; ???? MAY NOT BE COMPLETE
  751                     
  752  02:C31E            psg_dofade:
  753  02:C31E  60                rts
  754                     
  755                     
  756                     ; ----
  757                     ; psg_dodata2hdwr
  758                     ; ----
  759                     
  760                     ; ???? MAY NOT BE COMPLETE
  761                     
  762  02:C31F            psg_dodata2hdwr:
  763  02:C31F  60                rts
  764                     
  765                     
  766                     ; ----
  767                     ; psg_drivevoice - driver for individual voice
  768                     ; ----
  769                     
  770  02:C320            psg_drivevoice:
  771  02:C320  20 30 C3          jsr     psg_dobytecodes ; process track bytecodes
  772  02:C323  20 BF C4          jsr     psg_doreladjust ; adjust relative volume/pan
  773  02:C326  20 C0 C4          jsr     psg_dopercuss
  774  02:C329  20 C1 C4          jsr     psg_doenvelope
  775  02:C32C  20 C2 C4          jsr     psg_dofreqstuff
  776  02:C32F  60                rts
  777                     
  778                     
  779                     ; ----
  780                     ; psg_dobytecodes
  781                     ; ----
  782                     
  783                     ; ???? MAY NOT BE COMPLETE
  784                     
  785  02:C330            psg_dobytecodes:
  786  02:C330  DE 1F 23          dec     psg_cntdown,X   ; is last note done yet ?
  787  02:C333  F0 01             beq     .next
  788  02:C335  60                rts
  789                     
  790  02:C336  BD EF 22  .next:  lda     psg_trkptr_l,X  ; get pointer
  791  02:C339  85 E8             sta     <psg_tmpptr
  792  02:C33B  BD FB 22          lda     psg_trkptr_h,X
  793  02:C33E  85 E8             sta     <psg_tmpptr
  794                     
  795  02:C340  B2 E8             lda     [psg_tmpptr]    ; read next bytecode
  796                             incw    <psg_tmpptr     ; increment
       02:C342  E6 E8              inc    <psg_tmpptr              ; value at stated memory
       02:C344  D0 02              bne    .x_00619           ; location
       02:C346  E6 E9              inc    <psg_tmpptr+1
       02:C348            .x_00619:
  797                     
  798  02:C348  C9 D0             cmp     #$D0            ; if <$d0, it's a tone
  799  02:C34A  90 0F             bcc     psg_dotone
  800                     
  801  02:C34C  02                sxy                     ; use Y as voice index now
  802  02:C34D  AA                tax                     ; save byte
  803                             
  804                             sub     #$D0    ; table starts with bytecode $D0
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       02:C34E  38                 sec
       02:C34F  E9 D0              sbc    #$D0
                                  .endif
  805  02:C351  0A                asl     A       ; 2 bytes per entry
  806  02:C352  22                sax             ; X = index; A = byte value
  807                     
  808  02:C353  44 03             bsr     .tablejump
  809  02:C355  44 07             bsr     psg_trkptr_replace
  810  02:C357  60                rts
  811                     
  812  02:C358            .tablejump:
  813  02:C358  7C 74 C3          jmp     [psg_bytefunctbl,X]
  814                     
  815                     
  816  02:C35B            psg_dotone:
  817                     
  818  02:C35B  44 01             bsr     psg_trkptr_replace
  819  02:C35D  60                rts
  820                     
  821  02:C35E            psg_trkptr_replace:
  822  02:C35E  AE DF 22          ldx     psg_currvoice
  823  02:C361  A5 E8             lda     <psg_tmpptr
  824  02:C363  9D EF 22          sta     psg_trkptr_l,X
  825  02:C366  A5 E9             lda     <psg_tmpptr+1
  826  02:C368  9D FB 22          sta     psg_trkptr_h,X
  827  02:C36B  60                rts
  828                     
  829  02:C36C            psg_octavetbl:
  830  02:C36C  00                .db     0
  831  02:C36D  18                .db     (12*2*1)
  832  02:C36E  30                .db     (12*2*2)
  833  02:C36F  48                .db     (12*2*3)
  834  02:C370  60                .db     (12*2*4)
  835  02:C371  78                .db     (12*2*5)
  836  02:C372  90                .db     (12*2*6)
  837  02:C373  A8                .db     (12*2*7)
  838                     
  839  02:C374            psg_bytefunctbl:
  840  02:C374  DB C3             .dw     psgf_timebase   ; d0
  841  02:C376  E5 C3             .dw     psgf_octave     ; d1
  842  02:C378  E5 C3             .dw     psgf_octave     ; d2
  843  02:C37A  E5 C3             .dw     psgf_octave     ; d3
  844  02:C37C  E5 C3             .dw     psgf_octave     ; d4
  845  02:C37E  E5 C3             .dw     psgf_octave     ; d5
  846  02:C380  E5 C3             .dw     psgf_octave     ; d6
  847  02:C382  E5 C3             .dw     psgf_octave     ; d7
  848  02:C384  EB C3             .dw     psgf_octup      ; d8
  849  02:C386  F2 C3             .dw     psgf_octdown    ; d9
  850  02:C388  F9 C3             .dw     psgf_tie        ; da
  851  02:C38A  FF C3             .dw     psgf_tempo      ; db
  852  02:C38C  11 C4             .dw     psgf_volume     ; dc
  853  02:C38E  20 C4             .dw     psgf_panpot     ; dd
  854  02:C390  2F C4             .dw     psgf_keyratio   ; de
  855  02:C392  3A C4             .dw     psgf_relvolume  ; df
  856  02:C394  DA C3             .dw     psgf_notused    ; e0
  857  02:C396  48 C4             .dw     psgf_contfromsave       ; e1
  858  02:C398  53 C4             .dw     psgf_savepoint  ; e2
  859  02:C39A  5E C4             .dw     psgf_rptbegin   ; e3
  860  02:C39C  5F C4             .dw     psgf_rptend     ; e4
  861  02:C39E  60 C4             .dw     psgf_wave       ; e5
  862  02:C3A0  68 C4             .dw     psgf_envelope   ; e6
  863  02:C3A2  69 C4             .dw     psgf_freqmod    ; e7
  864  02:C3A4  6A C4             .dw     psgf_fmdelay    ; e8
  865  02:C3A6  6B C4             .dw     psgf_fmcorrect  ; e9
  866  02:C3A8  6C C4             .dw     psgf_pitchenv   ; ea
  867  02:C3AA  6D C4             .dw     psgf_pedelay    ; eb
  868  02:C3AC  6E C4             .dw     psgf_detune     ; ec
  869  02:C3AE  76 C4             .dw     psgf_sweep      ; ed
  870  02:C3B0  77 C4             .dw     psgf_sweeptime  ; ee
  871  02:C3B2  78 C4             .dw     psgf_jump       ; ef
  872  02:C3B4  88 C4             .dw     psgf_call       ; f0
  873  02:C3B6  89 C4             .dw     psgf_return     ; f1
  874  02:C3B8  8A C4             .dw     psgf_transpose  ; f2
  875  02:C3BA  93 C4             .dw     psgf_reltransp  ; f3
  876  02:C3BC  A3 C4             .dw     psgf_fulltransp ; f4
  877  02:C3BE  A4 C4             .dw     psgf_voladjust  ; f5
  878  02:C3C0  A5 C4             .dw     psgf_panrtadjust        ; f6
  879  02:C3C2  A6 C4             .dw     psgf_panlftadjust       ; f7
  880  02:C3C4  A7 C4             .dw     psgf_setmode    ; f8
  881  02:C3C6  DA C3             .dw     psgf_notused    ; f9
  882  02:C3C8  DA C3             .dw     psgf_notused    ; fa
  883  02:C3CA  DA C3             .dw     psgf_notused    ; fb
  884  02:C3CC  DA C3             .dw     psgf_notused    ; fc
  885  02:C3CE  DA C3             .dw     psgf_notused    ; fd
  886  02:C3D0  A8 C4             .dw     psgf_fadeout    ; fe
  887  02:C3D2  B9 C4             .dw     psgf_dataend    ; ff
  888                             
  889                     
  890  02:C3D4            psgf_inctmpptr:
  891                             incw    <psg_tmpptr
       02:C3D4  E6 E8              inc    <psg_tmpptr              ; value at stated memory
       02:C3D6  D0 02              bne    .x_00621           ; location
       02:C3D8  E6 E9              inc    <psg_tmpptr+1
       02:C3DA            .x_00621:
  892  02:C3DA            psgf_notused:
  893  02:C3DA  60                rts
  894                     
  895                     ;
  896                     ; $d0
  897                     ;
  898  02:C3DB            psgf_timebase:
  899  02:C3DB  B2 E8             lda     [psg_tmpptr]
  900  02:C3DD  29 0F             and     #$0f
  901  02:C3DF  99 7F 23          sta     psg_duratnmult,Y
  902  02:C3E2  4C D4 C3          jmp     psgf_inctmpptr
  903                     
  904                     ;
  905                     ; $d1-7
  906                     ;
  907  02:C3E5            psgf_octave:
  908  02:C3E5  29 07             and     #$07
  909  02:C3E7  99 2B 23          sta     psg_octave,Y
  910  02:C3EA  60                rts
  911                     
  912                     ;
  913                     ; $d8
  914                     ;
  915  02:C3EB            psgf_octup:
  916  02:C3EB  AE DF 22          ldx     psg_currvoice
  917  02:C3EE  FE 2B 23          inc     psg_octave,X
  918  02:C3F1  60                rts
  919                     
  920                     ;
  921                     ; $d9
  922                     ;
  923  02:C3F2            psgf_octdown:
  924  02:C3F2  AE DF 22          ldx     psg_currvoice
  925  02:C3F5  DE 2B 23          dec     psg_octave,X
  926  02:C3F8  60                rts
  927                     
  928                     ;
  929                     ; $da
  930                     ;
  931  02:C3F9            psgf_tie:
  932  02:C3F9  A9 03             lda     #3
  933  02:C3FB  99 F5 25          sta     psg_strikephase,Y
  934  02:C3FE  60                rts
  935                     
  936                     ;
  937                     ; $db
  938                     ;
  939  02:C3FF            psgf_tempo:
  940  02:C3FF  B2 E8             lda     [psg_tmpptr]
  941                             sub     #$23
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       02:C401  38                 sec
       02:C402  E9 23              sbc    #$23
                                  .endif
  942  02:C404  10 01             bpl     .okval
  943  02:C406  62                cla
  944  02:C407  AA        .okval: tax
  945  02:C408  BD 13 CB          lda     psg_tempotbl,X
  946  02:C40B  8D D0 22          sta     psg_tempo
  947  02:C40E  4C D4 C3          jmp     psgf_inctmpptr
  948                     
  949                     ;
  950                     ; $dc
  951                     ;
  952  02:C411            psgf_volume:
  953  02:C411  B2 E8             lda     [psg_tmpptr]
  954  02:C413  99 4F 23          sta     psg_perchvol,Y
  955  02:C416  62                cla
  956  02:C417  99 93 24          sta     psg_volchg,Y
  957  02:C41A  99 9F 24          sta     psg_volchgaccum,Y
  958  02:C41D  4C D4 C3          jmp     psgf_inctmpptr
  959                     
  960                     ;
  961                     ; $dd
  962                     ;
  963  02:C420            psgf_panpot:
  964  02:C420  B2 E8             lda     [psg_tmpptr]
  965  02:C422  99 D1 25          sta     psg_panpot,Y
  966  02:C425  62                cla
  967  02:C426  99 AB 24          sta     psg_panpotchg,Y
  968  02:C429  99 B7 24          sta     psg_panpotaccum,Y
  969  02:C42C  4C D4 C3          jmp     psgf_inctmpptr
  970                     
  971                     ;
  972                     ; $de
  973                     ;
  974  02:C42F            psgf_keyratio:
  975  02:C42F  A9 08             lda     #8
  976                             sub     [psg_tmpptr]
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       02:C431  38                 sec
       02:C432  F2 E8              sbc    [psg_tmpptr]
                                  .endif
  977  02:C434  99 5B 23          sta     psg_keyonratio,Y
  978  02:C437  4C D4 C3          jmp     psgf_inctmpptr
  979                     
  980                     ;
  981                     ; $df
  982                     ;
  983  02:C43A            psgf_relvolume:
  984  02:C43A  B9 4F 23          lda     psg_perchvol,Y
  985                             add     [psg_tmpptr]
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       02:C43D  18                 clc
       02:C43E  72 E8              adc    [psg_tmpptr]
                                  .endif
  986  02:C440  29 1F             and     #$1f
  987  02:C442  99 4F 23          sta     psg_perchvol,Y
  988  02:C445  4C D4 C3          jmp     psgf_inctmpptr
  989                     
  990                     ;
  991                     ; $e1
  992                     ;
  993  02:C448            psgf_contfromsave:
  994  02:C448  B9 07 23          lda     psg_savepoint_l,Y
  995  02:C44B  85 E8             sta     <psg_tmpptr
  996  02:C44D  B9 13 23          lda     psg_savepoint_h,Y
  997  02:C450  85 E9             sta     <psg_tmpptr+1
  998  02:C452  60                rts
  999                     
 1000                     ;
 1001                     ; $e2
 1002                     ;
 1003  02:C453            psgf_savepoint:
 1004  02:C453  A5 E8             lda     <psg_tmpptr
 1005  02:C455  99 07 23          sta     psg_savepoint_l,Y
 1006  02:C458  A5 E9             lda     <psg_tmpptr+1
 1007  02:C45A  99 13 23          sta     psg_savepoint_h,Y
 1008  02:C45D  60                rts
 1009                     
 1010                     ;
 1011                     ; $e3
 1012                     ;
 1013  02:C45E            psgf_rptbegin:
 1014  02:C45E  60                rts
 1015                     
 1016                     ;
 1017                     ; $e4
 1018                     ;
 1019  02:C45F            psgf_rptend:
 1020  02:C45F  60                rts
 1021                     
 1022                     ;
 1023                     ; $e5
 1024                     ;
 1025  02:C460            psgf_wave:
 1026  02:C460  B2 E8             lda     [psg_tmpptr]
 1027  02:C462  99 DD 25          sta     psg_wavenum,Y
 1028  02:C465  4C D4 C3          jmp     psgf_inctmpptr
 1029                     
 1030                     ;
 1031                     ; $e6
 1032                     ;
 1033  02:C468            psgf_envelope:
 1034  02:C468  60                rts
 1035                     
 1036                     ;
 1037                     ; $e7
 1038                     ;
 1039  02:C469            psgf_freqmod:
 1040  02:C469  60                rts
 1041                     
 1042                     ;
 1043                     ; $e8
 1044                     ;
 1045  02:C46A            psgf_fmdelay:
 1046  02:C46A  60                rts
 1047                     
 1048                     ;
 1049                     ; $e9
 1050                     ;
 1051  02:C46B            psgf_fmcorrect:
 1052  02:C46B  60                rts
 1053                     
 1054                     ;
 1055                     ; $ea
 1056                     ;
 1057  02:C46C            psgf_pitchenv:
 1058  02:C46C  60                rts
 1059                     
 1060                     ;
 1061                     ; $eb
 1062                     ;
 1063  02:C46D            psgf_pedelay:
 1064  02:C46D  60                rts
 1065                     
 1066                     ;
 1067                     ; $ec
 1068                     ;
 1069  02:C46E            psgf_detune:
 1070  02:C46E  B2 E8             lda     [psg_tmpptr]
 1071  02:C470  99 87 24          sta     psg_detune,Y
 1072  02:C473  4C D4 C3          jmp     psgf_inctmpptr
 1073                     
 1074                     ;
 1075                     ; $ed
 1076                     ;
 1077  02:C476            psgf_sweep:
 1078  02:C476  60                rts
 1079                     
 1080                     ;
 1081                     ; $ee
 1082                     ;
 1083  02:C477            psgf_sweeptime:
 1084  02:C477  60                rts
 1085                     
 1086                     ;
 1087                     ; $ef
 1088                     ;
 1089  02:C478            psgf_jump:
 1090  02:C478  B2 E8             lda     [psg_tmpptr]
 1091  02:C47A  AA                tax
 1092                             incw    <psg_tmpptr
       02:C47B  E6 E8              inc    <psg_tmpptr              ; value at stated memory
       02:C47D  D0 02              bne    .x_00625           ; location
       02:C47F  E6 E9              inc    <psg_tmpptr+1
       02:C481            .x_00625:
 1093  02:C481  B2 E8             lda     [psg_tmpptr]
 1094                           __stw     <psg_tmpptr
       02:C483  86 E8              stx    <psg_tmpptr
       02:C485  85 E9              sta    <psg_tmpptr+1
 1095  02:C487  60                rts
 1096                     
 1097                     ;
 1098                     ; $f0
 1099                     ;
 1100  02:C488            psgf_call:
 1101  02:C488  60                rts
 1102                     
 1103                     ;
 1104                     ; $f1
 1105                     ;
 1106  02:C489            psgf_return:
 1107  02:C489  60                rts
 1108                     
 1109                     ;
 1110                     ; $f2
 1111                     ;
 1112  02:C48A            psgf_transpose:
 1113  02:C48A  B2 E8             lda     [psg_tmpptr]
 1114  02:C48C  0A                asl     A
 1115  02:C48D  99 73 23          sta     psg_transpose,Y
 1116  02:C490  4C D4 C3          jmp     psgf_inctmpptr
 1117                     
 1118                     ;
 1119                     ; $f3
 1120                     ;
 1121  02:C493            psgf_reltransp:
 1122  02:C493  B2 E8             lda     [psg_tmpptr]
 1123  02:C495  0A                asl     A
 1124  02:C496  AE DF 22          ldx     psg_currvoice
 1125                             add     psg_transpose,X
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       02:C499  18                 clc
       02:C49A  7D 73 23           adc    psg_transpose,X
                                  .endif
 1126  02:C49D  9D 73 23          sta     psg_transpose,X
 1127  02:C4A0  4C D4 C3          jmp     psgf_inctmpptr
 1128                     
 1129                     ;
 1130                     ; $f4
 1131                     ;
 1132  02:C4A3            psgf_fulltransp:
 1133  02:C4A3  60                rts
 1134                     
 1135                     ;
 1136                     ; $f5
 1137                     ;
 1138  02:C4A4            psgf_voladjust:
 1139  02:C4A4  60                rts
 1140                     
 1141                     ;
 1142                     ; $f6
 1143                     ;
 1144  02:C4A5            psgf_panrtadjust:
 1145  02:C4A5  60                rts
 1146                     
 1147                     ;
 1148                     ; $f7
 1149                     ;
 1150  02:C4A6            psgf_panlftadjust:
 1151  02:C4A6  60                rts
 1152                     
 1153                     ;
 1154                     ; $f8
 1155                     ;
 1156  02:C4A7            psgf_setmode:
 1157  02:C4A7  60                rts
 1158                     
 1159                     ;
 1160                     ; $fe
 1161                     ;
 1162  02:C4A8            psgf_fadeout:
 1163  02:C4A8  B2 E8             lda     [psg_tmpptr]
 1164  02:C4AA  10 03             bpl     .positive
 1165  02:C4AC  49 FF             eor     #$ff
 1166  02:C4AE  1A                inc     A
 1167  02:C4AF            .positive:
 1168  02:C4AF  8D 01 26          sta     psg_fadespeed
 1169  02:C4B2  9C 03 26          stz     psg_fadecount
 1170  02:C4B5  9C 05 26          stz     psg_fadevolcut
 1171  02:C4B8  60                rts
 1172                     
 1173                     ;
 1174                     ; $ff
 1175                     ;
 1176  02:C4B9            psgf_dataend:
 1177  02:C4B9  A9 02             lda     #2
 1178  02:C4BB  8D E3 22          sta     psg_voicectrl
 1179  02:C4BE  60                rts
 1180                     
 1181                     
 1182                     ; ----
 1183                     ; PSG_DORELADJUST
 1184                     ; ----
 1185                     
 1186                     ; NOT IMPLEMENTED YET
 1187                     
 1188  02:C4BF            psg_doreladjust:
 1189  02:C4BF  60                rts
 1190                     
 1191                     
 1192                     ; ----
 1193                     ; PSG_DOPERCUSS
 1194                     ; ----
 1195                     
 1196                     ; NOT IMPLEMENTED YET
 1197                     
 1198  02:C4C0            psg_dopercuss:
 1199  02:C4C0  60                rts
 1200                     
 1201                     
 1202                     ; ----
 1203                     ; PSG_DOENVELOPE
 1204                     ; ----
 1205                     
 1206                     ; NOT IMPLEMENTED YET
 1207                     
 1208  02:C4C1            psg_doenvelope:
 1209  02:C4C1  60                rts
 1210                     
 1211                     
 1212                     ; ----
 1213                     ; PSG_DOFREQSTUFF
 1214                     ; ----
 1215                     
 1216                     ; NOT IMPLEMENTED YET
 1217                     
 1218  02:C4C2            psg_dofreqstuff:
 1219  02:C4C2  60                rts
 1220                     
 1221                     
 1222                     ;
 1223                     ;;
 1224                     ;; load a waveform into a PSG channel
 1225                     ;; PSG channel must already be set
 1226                     ;;
 1227                     ;snd_loadwave:  lda     #0
 1228                     ;               sta     psg_ctrl
 1229                     ;
 1230                     ;               ldx     #$20
 1231                     ;.l1:           lda     [wavptr]
 1232                     ;               sta     psg_wave
 1233                     ;               incw    <wavptr
 1234                     ;               dex
 1235                     ;               bne     .l1
 1236                     ;
 1237                     ;               lda     #PSG_ENABLE
 1238                     ;               ora     #$1F            ; full volume
 1239                     ;               sta     psg_ctrl
 1240                     ;               lda     #$ff
 1241                     ;               sta     psg_pan
 1242                     ;               rts
 1243                     ;               
 1244                     
 1245                     
 1246                     ; careful with these wave data (etc.)
 1247                     
 1248                     ;
 1249                     ; wave #0
 1250                     ;
 1251  02:C4C3            psg_waveforms:
 1252  02:C4C3  00 00 00          .db $00,$00,$00,$00
       02:C4C6  00        
 1253  02:C4C7  00 00 00          .db $00,$00,$00,$00
       02:C4CA  00        
 1254  02:C4CB  00 00 00          .db $00,$00,$00,$00
       02:C4CE  00        
 1255  02:C4CF  00 00 00          .db $00,$00,$00,$00
       02:C4D2  00        
 1256  02:C4D3  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C4D6  1F        
 1257  02:C4D7  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C4DA  1F        
 1258  02:C4DB  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C4DE  1F        
 1259  02:C4DF  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C4E2  1F        
 1260                     
 1261                     ;
 1262                     ; wave #1
 1263                     ;
 1264  02:C4E3  10 0D 0A          .db $10,$0d,$0a,$07
       02:C4E6  07        
 1265  02:C4E7  05 03 02          .db $05,$03,$02,$01
       02:C4EA  01        
 1266  02:C4EB  00 01 02          .db $00,$01,$02,$03
       02:C4EE  03        
 1267  02:C4EF  05 07 09          .db $05,$07,$09,$0d
       02:C4F2  0D        
 1268  02:C4F3  0F 12 15          .db $0f,$12,$15,$17
       02:C4F6  17        
 1269  02:C4F7  19 1B 1D          .db $19,$1b,$1d,$1e
       02:C4FA  1E        
 1270  02:C4FB  1E 1E 1D          .db $1e,$1e,$1d,$1b
       02:C4FE  1B        
 1271  02:C4FF  19 17 15          .db $19,$17,$15,$13
       02:C502  13        
 1272                     
 1273                     ;
 1274                     ; wave #2
 1275                     ;
 1276  02:C503  10 11 12          .db $10,$11,$12,$13
       02:C506  13        
 1277  02:C507  14 15 16          .db $14,$15,$16,$17
       02:C50A  17        
 1278  02:C50B  18 19 1A          .db $18,$19,$1a,$1b
       02:C50E  1B        
 1279  02:C50F  1C 1D 1E          .db $1c,$1d,$1e,$1f
       02:C512  1F        
 1280  02:C513  00 01 02          .db $00,$01,$02,$03
       02:C516  03        
 1281  02:C517  04 05 06          .db $04,$05,$06,$07
       02:C51A  07        
 1282  02:C51B  08 09 0A          .db $08,$09,$0a,$0b
       02:C51E  0B        
 1283  02:C51F  0C 0D 0E          .db $0c,$0d,$0e,$0f
       02:C522  0F        
 1284                     
 1285                     ;
 1286                     ; wave #3
 1287                     ;
 1288  02:C523  05 05 09          .db $05,$05,$09,$09
       02:C526  09        
 1289  02:C527  02 16 16          .db $02,$16,$16,$10
       02:C52A  10        
 1290  02:C52B  10 1F 1F          .db $10,$1f,$1f,$0e
       02:C52E  0E        
 1291  02:C52F  0E 04 04          .db $0e,$04,$04,$12
       02:C532  12        
 1292  02:C533  19 19 09          .db $19,$19,$09,$09
       02:C536  09        
 1293  02:C537  02 02 13          .db $02,$02,$13,$13
       02:C53A  13        
 1294  02:C53B  07 07 1E          .db $07,$07,$1e,$1e
       02:C53E  1E        
 1295  02:C53F  0B 0B 15          .db $0b,$0b,$15,$15
       02:C542  15        
 1296                     
 1297                     ;
 1298                     ; wave #4
 1299                     ;
 1300  02:C543  0F 0B 0F          .db $0f,$0b,$0f,$11
       02:C546  11        
 1301  02:C547  0F 0D 0F          .db $0f,$0d,$0f,$10
       02:C54A  10        
 1302  02:C54B  10 10 10          .db $10,$10,$10,$07
       02:C54E  07        
 1303  02:C54F  07 07 10          .db $07,$07,$10,$07
       02:C552  07        
 1304  02:C553  01 07 10          .db $01,$07,$10,$17
       02:C556  17        
 1305  02:C557  1E 17 10          .db $1e,$17,$10,$07
       02:C55A  07        
 1306  02:C55B  01 07 10          .db $01,$07,$10,$17
       02:C55E  17        
 1307  02:C55F  0F 07 10          .db $0f,$07,$10,$13
       02:C562  13        
 1308                     
 1309                     ;
 1310                     ; wave #5
 1311                     ;
 1312  02:C563  00 00 00          .db $00,$00,$00,$00
       02:C566  00        
 1313  02:C567  00 00 00          .db $00,$00,$00,$00
       02:C56A  00        
 1314  02:C56B  00 00 00          .db $00,$00,$00,$00
       02:C56E  00        
 1315  02:C56F  00 00 00          .db $00,$00,$00,$1f
       02:C572  1F        
 1316  02:C573  1E 1C 1A          .db $1e,$1c,$1a,$18
       02:C576  18        
 1317  02:C577  16 14 12          .db $16,$14,$12,$10
       02:C57A  10        
 1318  02:C57B  0E 0C 0A          .db $0e,$0c,$0a,$08
       02:C57E  08        
 1319  02:C57F  06 04 02          .db $06,$04,$02,$01
       02:C582  01        
 1320                     
 1321                     ;
 1322                     ; wave #6
 1323                     ;
 1324  02:C583  10 06 03          .db $10,$06,$03,$02
       02:C586  02        
 1325  02:C587  01 00 00          .db $01,$00,$00,$00
       02:C58A  00        
 1326  02:C58B  00 00 00          .db $00,$00,$00,$01
       02:C58E  01        
 1327  02:C58F  01 02 03          .db $01,$02,$03,$06
       02:C592  06        
 1328  02:C593  10 19 1C          .db $10,$19,$1c,$1d
       02:C596  1D        
 1329  02:C597  1E 1F 1F          .db $1e,$1f,$1f,$1f
       02:C59A  1F        
 1330  02:C59B  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C59E  1F        
 1331  02:C59F  1E 1D 1C          .db $1e,$1d,$1c,$19
       02:C5A2  19        
 1332                     
 1333                     ; OK to here -----------------
 1334                     ;
 1335                     ; wave #7
 1336                     ;
 1337  02:C5A3  1D 0F 09          .db $1d,$0f,$09,$05
       02:C5A6  05        
 1338  02:C5A7  03 01 03          .db $03,$01,$03,$05
       02:C5AA  05        
 1339  02:C5AB  09 0F 15          .db $09,$0f,$15,$19
       02:C5AE  19        
 1340  02:C5AF  1B 1D 1B          .db $1b,$1d,$1b,$19
       02:C5B2  19        
 1341  02:C5B3  15 0F 07          .db $15,$0f,$07,$03
       02:C5B6  03        
 1342  02:C5B7  01 03 07          .db $01,$03,$07,$0f
       02:C5BA  0F        
 1343  02:C5BB  17 1B 1D          .db $17,$1b,$1d,$1b
       02:C5BE  1B        
 1344  02:C5BF  17 0F 01          .db $17,$0f,$01,$0f
       02:C5C2  0F        
 1345                     
 1346                     ;
 1347                     ; wave #8
 1348                     ;
 1349  02:C5C3  10 13 16          .db $10,$13,$16,$18
       02:C5C6  18        
 1350  02:C5C7  1B 1D 1E          .db $1b,$1d,$1e,$1f
       02:C5CA  1F        
 1351  02:C5CB  1F 1F 1E          .db $1f,$1f,$1e,$1d
       02:C5CE  1D        
 1352  02:C5CF  1B 18 16          .db $1b,$18,$16,$13
       02:C5D2  13        
 1353  02:C5D3  10 0C 09          .db $10,$0c,$09,$07
       02:C5D6  07        
 1354  02:C5D7  04 02 01          .db $04,$02,$01,$01
       02:C5DA  01        
 1355  02:C5DB  01 01 01          .db $01,$01,$01,$02
       02:C5DE  02        
 1356  02:C5DF  04 07 09          .db $04,$07,$09,$0c
       02:C5E2  0C        
 1357                     
 1358                     ;
 1359                     ; wave #9
 1360                     ;
 1361  02:C5E3  1B 1D 1B          .db $1b,$1d,$1b,$17
       02:C5E6  17        
 1362  02:C5E7  0F 0F 15          .db $0f,$0f,$15,$19
       02:C5EA  19        
 1363  02:C5EB  19 15 0F          .db $19,$15,$0f,$0f
       02:C5EE  0F        
 1364  02:C5EF  09 05 05          .db $09,$05,$05,$09
       02:C5F2  09        
 1365  02:C5F3  0F 0F 0D          .db $0f,$0f,$0d,$07
       02:C5F6  07        
 1366  02:C5F7  03 01 03          .db $03,$01,$03,$09
       02:C5FA  09        
 1367  02:C5FB  11 13 13          .db $11,$13,$13,$0f
       02:C5FE  0F        
 1368  02:C5FF  0B 0B 0D          .db $0b,$0b,$0d,$17
       02:C602  17        
 1369                     
 1370                     ;
 1371                     ; wave #$0a
 1372                     ;
 1373  02:C603  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C606  1F        
 1374  02:C607  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C60A  1F        
 1375  02:C60B  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C60E  1F        
 1376  02:C60F  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C612  1F        
 1377  02:C613  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C616  1F        
 1378  02:C617  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C61A  1F        
 1379  02:C61B  01 01 01          .db $01,$01,$01,$01
       02:C61E  01        
 1380  02:C61F  01 01 01          .db $01,$01,$01,$01
       02:C622  01        
 1381                     
 1382                     ;
 1383                     ; wave #$0b
 1384                     ;
 1385  02:C623  1F 00 04          .db $1f,$00,$04,$06
       02:C626  06        
 1386  02:C627  08 0A 0C          .db $08,$0a,$0c,$0e
       02:C62A  0E        
 1387  02:C62B  10 12 14          .db $10,$12,$14,$16
       02:C62E  16        
 1388  02:C62F  18 1A 1C          .db $18,$1a,$1c,$1e
       02:C632  1E        
 1389  02:C633  1F 1E 1C          .db $1f,$1e,$1c,$1a
       02:C636  1A        
 1390  02:C637  18 16 14          .db $18,$16,$14,$12
       02:C63A  12        
 1391  02:C63B  10 0E 0C          .db $10,$0e,$0c,$0a
       02:C63E  0A        
 1392  02:C63F  08 06 04          .db $08,$06,$04,$02
       02:C642  02        
 1393                     
 1394                     ;
 1395                     ; wave #$0c
 1396                     ;
 1397  02:C643  12 10 1A          .db $12,$10,$1a,$1f
       02:C646  1F        
 1398  02:C647  18 0D 14          .db $18,$0d,$14,$1c
       02:C64A  1C        
 1399  02:C64B  18 12 18          .db $18,$12,$18,$1c
       02:C64E  1C        
 1400  02:C64F  10 01 05          .db $10,$01,$05,$0b
       02:C652  0B        
 1401  02:C653  05 01 09          .db $05,$01,$09,$10
       02:C656  10        
 1402  02:C657  05 00 03          .db $05,$00,$03,$0d
       02:C65A  0D        
 1403  02:C65B  09 07 10          .db $09,$07,$10,$1a
       02:C65E  1A        
 1404  02:C65F  0D 03 10          .db $0d,$03,$10,$14
       02:C662  14        
 1405                     
 1406                     
 1407                     ;
 1408                     ; wave #$0d
 1409                     ;
 1410  02:C663  0F 15 17          .db $0f,$15,$17,$18
       02:C666  18        
 1411  02:C667  1A 1D 1E          .db $1a,$1d,$1e,$10
       02:C66A  10        
 1412  02:C66B  1F 1F 1D          .db $1f,$1f,$1d,$1c
       02:C66E  1C        
 1413  02:C66F  1A 18 14          .db $1a,$18,$14,$10
       02:C672  10        
 1414  02:C673  0F 0F 0B          .db $0f,$0f,$0b,$07
       02:C676  07        
 1415  02:C677  05 03 02          .db $05,$03,$02,$10
       02:C67A  10        
 1416  02:C67B  00 01 01          .db $00,$01,$01,$02
       02:C67E  02        
 1417  02:C67F  05 07 08          .db $05,$07,$08,$10
       02:C682  10        
 1418                     
 1419                     ;
 1420                     ; wave #$0e
 1421                     ;
 1422  02:C683  1F 1E 1B          .db $1f,$1e,$1b,$17
       02:C686  17        
 1423  02:C687  13 0F 0B          .db $13,$0f,$0b,$07
       02:C68A  07        
 1424  02:C68B  03 0F 0C          .db $03,$0f,$0c,$09
       02:C68E  09        
 1425  02:C68F  07 04 02          .db $07,$04,$02,$01
       02:C692  01        
 1426  02:C693  00 00 01          .db $00,$00,$01,$02
       02:C696  02        
 1427  02:C697  04 07 09          .db $04,$07,$09,$0c
       02:C69A  0C        
 1428  02:C69B  1F 1B 17          .db $1f,$1b,$17,$13
       02:C69E  13        
 1429  02:C69F  0F 0B 07          .db $0f,$0b,$07,$03
       02:C6A2  03        
 1430                     
 1431                     ;
 1432                     ; wave #$0f
 1433                     ;
 1434  02:C6A3  18 1F 1D          .db $18,$1f,$1d,$1d
       02:C6A6  1D        
 1435  02:C6A7  1F 1C 14          .db $1f,$1c,$14,$0f
       02:C6AA  0F        
 1436  02:C6AB  12 1C 1E          .db $12,$1c,$1e,$12
       02:C6AE  12        
 1437  02:C6AF  05 02 03          .db $05,$02,$03,$0a
       02:C6B2  0A        
 1438  02:C6B3  15 1C 1D          .db $15,$1c,$1d,$1a
       02:C6B6  1A        
 1439  02:C6B7  0D 01 03          .db $0d,$01,$03,$0d
       02:C6BA  0D        
 1440  02:C6BB  10 0B 03          .db $10,$0b,$03,$00
       02:C6BE  00        
 1441  02:C6BF  02 02 00          .db $02,$02,$00,$07
       02:C6C2  07        
 1442                     
 1443                     ;
 1444                     ; wave #$10
 1445                     ;
 1446  02:C6C3  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6C6  00        
 1447  02:C6C7  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6CA  00        
 1448  02:C6CB  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6CE  00        
 1449  02:C6CF  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6D2  00        
 1450  02:C6D3  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6D6  00        
 1451  02:C6D7  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6DA  00        
 1452  02:C6DB  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6DE  00        
 1453  02:C6DF  1F 00 1F          .db $1f,$00,$1f,$00
       02:C6E2  00        
 1454                     
 1455                     ;
 1456                     ; wave #$11
 1457                     ;
 1458  02:C6E3  0D 0F 0B          .db $0d,$0f,$0b,$00
       02:C6E6  00        
 1459  02:C6E7  10 1E 1D          .db $10,$1e,$1d,$1f
       02:C6EA  1F        
 1460  02:C6EB  13 10 0F          .db $13,$10,$0f,$04
       02:C6EE  04        
 1461  02:C6EF  0E 0D 10          .db $0e,$0d,$10,$01
       02:C6F2  01        
 1462  02:C6F3  00 02 02          .db $00,$02,$02,$0e
       02:C6F6  0E        
 1463  02:C6F7  01 0D 0F          .db $01,$0d,$0f,$10
       02:C6FA  10        
 1464  02:C6FB  0E 01 01          .db $0e,$01,$01,$03
       02:C6FE  03        
 1465  02:C6FF  0E 01 01          .db $0e,$01,$01,$00
       02:C702  00        
 1466                     
 1467                     ;
 1468                     ; wave #$12
 1469                     ;
 1470  02:C703  10 1A 1F          .db $10,$1a,$1f,$1c
       02:C706  1C        
 1471  02:C707  14 10 11          .db $14,$10,$11,$14
       02:C70A  14        
 1472  02:C70B  16 14 11          .db $16,$14,$11,$10
       02:C70E  10        
 1473  02:C70F  14 1C 1F          .db $14,$1c,$1f,$1a
       02:C712  1A        
 1474  02:C713  10 05 01          .db $10,$05,$01,$03
       02:C716  03        
 1475  02:C717  0B 0F 0E          .db $0b,$0f,$0e,$0b
       02:C71A  0B        
 1476  02:C71B  09 0B 0E          .db $09,$0b,$0e,$0f
       02:C71E  0F        
 1477  02:C71F  0B 03 01          .db $0b,$03,$01,$05
       02:C722  05        
 1478                     
 1479                     ;
 1480                     ; wave #$13
 1481                     ;
 1482  02:C723  16 1E 1E          .db $16,$1e,$1e,$17
       02:C726  17        
 1483  02:C727  0D 06 01          .db $0d,$06,$01,$00
       02:C72A  00        
 1484  02:C72B  00 00 00          .db $00,$00,$00,$00
       02:C72E  00        
 1485  02:C72F  01 03 07          .db $01,$03,$07,$0c
       02:C732  0C        
 1486  02:C733  13 18 1C          .db $13,$18,$1c,$1e
       02:C736  1E        
 1487  02:C737  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C73A  1F        
 1488  02:C73B  1F 1E 19          .db $1f,$1e,$19,$12
       02:C73E  12        
 1489  02:C73F  08 01 01          .db $08,$01,$01,$09
       02:C742  09        
 1490                     
 1491                     ;
 1492                     ; wave #$14
 1493                     ;
 1494  02:C743  14 1A 1E          .db $14,$1a,$1e,$1f
       02:C746  1F        
 1495  02:C747  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C74A  1F        
 1496  02:C74B  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C74E  1F        
 1497  02:C74F  1F 1E 1A          .db $1f,$1e,$1a,$14
       02:C752  14        
 1498  02:C753  0B 05 01          .db $0b,$05,$01,$00
       02:C756  00        
 1499  02:C757  00 00 00          .db $00,$00,$00,$00
       02:C75A  00        
 1500  02:C75B  00 00 00          .db $00,$00,$00,$00
       02:C75E  00        
 1501  02:C75F  00 01 05          .db $00,$01,$05,$0b
       02:C762  0B        
 1502                     
 1503                     ;
 1504                     ; wave #$15
 1505                     ;
 1506  02:C763  17 1E 1D          .db $17,$1e,$1d,$17
       02:C766  17        
 1507  02:C767  10 16 1F          .db $10,$16,$1f,$1c
       02:C76A  1C        
 1508  02:C76B  1A 1E 1F          .db $1a,$1e,$1f,$1f
       02:C76E  1F        
 1509  02:C76F  1C 0E 07          .db $1c,$0e,$07,$0a
       02:C772  0A        
 1510  02:C773  14 18 11          .db $14,$18,$11,$03
       02:C776  03        
 1511  02:C777  00 00 01          .db $00,$00,$01,$05
       02:C77A  05        
 1512  02:C77B  03 00 09          .db $03,$00,$09,$0f
       02:C77E  0F        
 1513  02:C77F  08 02 01          .db $08,$02,$01,$08
       02:C782  08        
 1514                     
 1515                     ;
 1516                     ; wave #$16
 1517                     ;
 1518  02:C783  18 1E 19          .db $18,$1e,$19,$0f
       02:C786  0F        
 1519  02:C787  12 1E 1D          .db $12,$1e,$1d,$1e
       02:C78A  1E        
 1520  02:C78B  1E 1D 1E          .db $1e,$1d,$1e,$12
       02:C78E  12        
 1521  02:C78F  0F 19 1E          .db $0f,$19,$1e,$18
       02:C792  18        
 1522  02:C793  07 01 06          .db $07,$01,$06,$10
       02:C796  10        
 1523  02:C797  0D 01 02          .db $0d,$01,$02,$01
       02:C79A  01        
 1524  02:C79B  01 02 01          .db $01,$02,$01,$0d
       02:C79E  0D        
 1525  02:C79F  10 06 01          .db $10,$06,$01,$07
       02:C7A2  07        
 1526                     
 1527                     ;
 1528                     ; wave #$17
 1529                     ;
 1530  02:C7A3  10 16 1A          .db $10,$16,$1a,$1c
       02:C7A6  1C        
 1531  02:C7A7  1E 1C 1A          .db $1e,$1c,$1a,$16
       02:C7AA  16        
 1532  02:C7AB  10 0A 06          .db $10,$0a,$06,$04
       02:C7AE  04        
 1533  02:C7AF  02 04 06          .db $02,$04,$06,$0a
       02:C7B2  0A        
 1534  02:C7B3  10 18 1C          .db $10,$18,$1c,$1e
       02:C7B6  1E        
 1535  02:C7B7  1C 18 10          .db $1c,$18,$10,$08
       02:C7BA  08        
 1536  02:C7BB  02 08 10          .db $02,$08,$10,$1e
       02:C7BE  1E        
 1537  02:C7BF  10 02 10          .db $10,$02,$10,$02
       02:C7C2  02        
 1538                     
 1539                     ;
 1540                     ; wave #$18
 1541                     ;
 1542  02:C7C3  10 13 16          .db $10,$13,$16,$18
       02:C7C6  18        
 1543  02:C7C7  1B 1D 1E          .db $1b,$1d,$1e,$1f
       02:C7CA  1F        
 1544  02:C7CB  1F 1F 1E          .db $1f,$1f,$1e,$1d
       02:C7CE  1D        
 1545  02:C7CF  1B 18 16          .db $1b,$18,$16,$13
       02:C7D2  13        
 1546  02:C7D3  10 01 04          .db $10,$01,$04,$08
       02:C7D6  08        
 1547  02:C7D7  0C 10 14          .db $0c,$10,$14,$18
       02:C7DA  18        
 1548  02:C7DB  1C 01 04          .db $1c,$01,$04,$08
       02:C7DE  08        
 1549  02:C7DF  0C 10 14          .db $0c,$10,$14,$18
       02:C7E2  18        
 1550                     
 1551                     ;
 1552                     ; wave #$19
 1553                     ;
 1554  02:C7E3  1A 1C 1D          .db $1a,$1c,$1d,$1e
       02:C7E6  1E        
 1555  02:C7E7  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C7EA  1F        
 1556  02:C7EB  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C7EE  1F        
 1557  02:C7EF  1E 1D 1B          .db $1e,$1d,$1b,$19
       02:C7F2  19        
 1558  02:C7F3  06 04 02          .db $06,$04,$02,$01
       02:C7F6  01        
 1559  02:C7F7  00 00 00          .db $00,$00,$00,$00
       02:C7FA  00        
 1560  02:C7FB  00 00 00          .db $00,$00,$00,$00
       02:C7FE  00        
 1561  02:C7FF  01 02 04          .db $01,$02,$04,$06
       02:C802  06        
 1562                     
 1563                     ;
 1564                     ; wave #$1a
 1565                     ;
 1566  02:C803  1B 14 10          .db $1b,$14,$10,$0e
       02:C806  0E        
 1567  02:C807  0C 0B 16          .db $0c,$0b,$16,$09
       02:C80A  09        
 1568  02:C80B  02 07 0A          .db $02,$07,$0a,$05
       02:C80E  05        
 1569  02:C80F  03 03 02          .db $03,$03,$02,$01
       02:C812  01        
 1570  02:C813  0B 15 1C          .db $0b,$15,$1c,$1e
       02:C816  1E        
 1571  02:C817  1A 0C 15          .db $1a,$0c,$15,$19
       02:C81A  19        
 1572  02:C81B  0C 18 07          .db $0c,$18,$07,$12
       02:C81E  12        
 1573  02:C81F  0C 09 16          .db $0c,$09,$16,$1a
       02:C822  1A        
 1574                     
 1575                     ;
 1576                     ; wave #$1b
 1577                     ;
 1578  02:C823  0F 15 1A          .db $0f,$15,$1a,$1c
       02:C826  1C        
 1579  02:C827  1F 1C 1A          .db $1f,$1c,$1a,$15
       02:C82A  15        
 1580  02:C82B  0F 08 04          .db $0f,$08,$04,$02
       02:C82E  02        
 1581  02:C82F  00 02 04          .db $00,$02,$04,$08
       02:C832  08        
 1582  02:C833  0F 17 1C          .db $0f,$17,$1c,$1f
       02:C836  1F        
 1583  02:C837  1C 17 0F          .db $1c,$17,$0f,$06
       02:C83A  06        
 1584  02:C83B  01 02 07          .db $01,$02,$07,$0f
       02:C83E  0F        
 1585  02:C83F  0F 13 0F          .db $0f,$13,$0f,$00
       02:C842  00        
 1586                     
 1587                     ;
 1588                     ; wave #$1c
 1589                     ;
 1590  02:C843  1F 1B 19          .db $1f,$1b,$19,$1c
       02:C846  1C        
 1591  02:C847  1F 1C 1A          .db $1f,$1c,$1a,$17
       02:C84A  17        
 1592  02:C84B  0C 04 03          .db $0c,$04,$03,$02
       02:C84E  02        
 1593  02:C84F  08 0E 0D          .db $08,$0e,$0d,$04
       02:C852  04        
 1594  02:C853  00 06 09          .db $00,$06,$09,$05
       02:C856  05        
 1595  02:C857  00 00 00          .db $00,$00,$00,$01
       02:C85A  01        
 1596  02:C85B  0A 10 11          .db $0a,$10,$11,$12
       02:C85E  12        
 1597  02:C85F  0E 0C 0E          .db $0e,$0c,$0e,$19
       02:C862  19        
 1598                     
 1599                     ;
 1600                     ; wave #$1d
 1601                     ;
 1602  02:C863  0F 02 11          .db $0f,$02,$11,$1f
       02:C866  1F        
 1603  02:C867  0F 1C 0D          .db $0f,$1c,$0d,$00
       02:C86A  00        
 1604  02:C86B  0F 02 11          .db $0f,$02,$11,$1f
       02:C86E  1F        
 1605  02:C86F  0F 1C 0D          .db $0f,$1c,$0d,$00
       02:C872  00        
 1606  02:C873  0F 02 11          .db $0f,$02,$11,$1f
       02:C876  1F        
 1607  02:C877  0F 1C 0D          .db $0f,$1c,$0d,$00
       02:C87A  00        
 1608  02:C87B  0F 02 11          .db $0f,$02,$11,$1f
       02:C87E  1F        
 1609  02:C87F  0F 1C 0D          .db $0f,$1c,$0d,$00
       02:C882  00        
 1610                     
 1611                     ;
 1612                     ; wave #$1e
 1613                     ;
 1614  02:C883  10 0A 14          .db $10,$0a,$14,$1c
       02:C886  1C        
 1615  02:C887  15 1D 16          .db $15,$1d,$16,$10
       02:C88A  10        
 1616  02:C88B  18 11 18          .db $18,$11,$18,$1f
       02:C88E  1F        
 1617  02:C88F  15 1B 12          .db $15,$1b,$12,$0a
       02:C892  0A        
 1618  02:C893  10 08 0E          .db $10,$08,$0e,$14
       02:C896  14        
 1619  02:C897  0A 10 07          .db $0a,$10,$07,$00
       02:C89A  00        
 1620  02:C89B  08 01 09          .db $08,$01,$09,$12
       02:C89E  12        
 1621  02:C89F  0A 12 0B          .db $0a,$12,$0b,$06
       02:C8A2  06        
 1622                     
 1623                     ;
 1624                     ; wave #$1f
 1625                     ;
 1626  02:C8A3  12 19 1D          .db $12,$19,$1d,$1e
       02:C8A6  1E        
 1627  02:C8A7  1F 1F 1F          .db $1f,$1f,$1f,$1e
       02:C8AA  1E        
 1628  02:C8AB  1C 17 12          .db $1c,$17,$12,$0c
       02:C8AE  0C        
 1629  02:C8AF  0D 12 16          .db $0d,$12,$16,$11
       02:C8B2  11        
 1630  02:C8B3  08 04 01          .db $08,$04,$01,$00
       02:C8B6  00        
 1631  02:C8B7  00 00 00          .db $00,$00,$00,$00
       02:C8BA  00        
 1632  02:C8BB  00 00 00          .db $00,$00,$00,$00
       02:C8BE  00        
 1633  02:C8BF  00 01 04          .db $00,$01,$04,$0c
       02:C8C2  0C        
 1634                     
 1635                     ;
 1636                     ; wave #$20
 1637                     ;
 1638  02:C8C3  04 14 1E          .db $04,$14,$1e,$17
       02:C8C6  17        
 1639  02:C8C7  00 17 1E          .db $00,$17,$1e,$16
       02:C8CA  16        
 1640  02:C8CB  10 1A 1F          .db $10,$1a,$1f,$1c
       02:C8CE  1C        
 1641  02:C8CF  12 16 18          .db $12,$16,$18,$10
       02:C8D2  10        
 1642  02:C8D3  06 12 1C          .db $06,$12,$1c,$10
       02:C8D6  10        
 1643  02:C8D7  0C 0E 10          .db $0c,$0e,$10,$06
       02:C8DA  06        
 1644  02:C8DB  02 08 12          .db $02,$08,$12,$0c
       02:C8DE  0C        
 1645  02:C8DF  04 08 0E          .db $04,$08,$0e,$08
       02:C8E2  08        
 1646                     
 1647                     ;
 1648                     ; wave #$21
 1649                     ;
 1650  02:C8E3  0A 0C 0E          .db $0a,$0c,$0e,$0f
       02:C8E6  0F        
 1651  02:C8E7  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C8EA  1F        
 1652  02:C8EB  14 14 13          .db $14,$14,$13,$12
       02:C8EE  12        
 1653  02:C8EF  1B 1B 1B          .db $1b,$1b,$1b,$1b
       02:C8F2  1B        
 1654  02:C8F3  0A 08 06          .db $0a,$08,$06,$04
       02:C8F6  04        
 1655  02:C8F7  0E 0E 0E          .db $0e,$0e,$0e,$0e
       02:C8FA  0E        
 1656  02:C8FB  00 00 00          .db $00,$00,$00,$02
       02:C8FE  02        
 1657  02:C8FF  13 13 13          .db $13,$13,$13,$13
       02:C902  13        
 1658                     
 1659                     ;
 1660                     ; wave #$22
 1661                     ;
 1662  02:C903  1B 1B 05          .db $1b,$1b,$05,$05
       02:C906  05        
 1663  02:C907  09 09 1F          .db $09,$09,$1f,$1f
       02:C90A  1F        
 1664  02:C90B  1B 1B 16          .db $1b,$1b,$16,$16
       02:C90E  16        
 1665  02:C90F  1A 1A 07          .db $1a,$1a,$07,$07
       02:C912  07        
 1666  02:C913  17 17 15          .db $17,$17,$15,$15
       02:C916  15        
 1667  02:C917  19 19 0C          .db $19,$19,$0c,$0c
       02:C91A  0C        
 1668  02:C91B  1B 1B 0C          .db $1b,$1b,$0c,$0c
       02:C91E  0C        
 1669  02:C91F  00 00 03          .db $00,$00,$03,$03
       02:C922  03        
 1670                     
 1671                     ;
 1672                     ; wave #$23
 1673                     ;
 1674  02:C923  1F 1D 1B          .db $1f,$1d,$1b,$19
       02:C926  19        
 1675  02:C927  17 15 13          .db $17,$15,$13,$11
       02:C92A  11        
 1676  02:C92B  0F 0D 0B          .db $0f,$0d,$0b,$09
       02:C92E  09        
 1677  02:C92F  07 05 03          .db $07,$05,$03,$01
       02:C932  01        
 1678  02:C933  00 0F 11          .db $00,$0f,$11,$0d
       02:C936  0D        
 1679  02:C937  13 0B 15          .db $13,$0b,$15,$09
       02:C93A  09        
 1680  02:C93B  17 07 19          .db $17,$07,$19,$05
       02:C93E  05        
 1681  02:C93F  1B 03 1D          .db $1b,$03,$1d,$01
       02:C942  01        
 1682                     
 1683                     ;
 1684                     ; wave #$24
 1685                     ;
 1686  02:C943  0B 0E 11          .db $0b,$0e,$11,$13
       02:C946  13        
 1687  02:C947  1F 1D 1A          .db $1f,$1d,$1a,$17
       02:C94A  17        
 1688  02:C94B  09 05 02          .db $09,$05,$02,$00
       02:C94E  00        
 1689  02:C94F  0A 0B 0E          .db $0a,$0b,$0e,$11
       02:C952  11        
 1690  02:C953  0B 0E 1B          .db $0b,$0e,$1b,$1e
       02:C956  1E        
 1691  02:C957  14 12 1A          .db $14,$12,$1a,$17
       02:C95A  17        
 1692  02:C95B  09 05 0D          .db $09,$05,$0d,$0a
       02:C95E  0A        
 1693  02:C95F  00 01 0E          .db $00,$01,$0e,$11
       02:C962  11        
 1694                     
 1695                     ;
 1696                     ; wave #$25
 1697                     ;
 1698  02:C963  0F 16 1B          .db $0f,$16,$1b,$1e
       02:C966  1E        
 1699  02:C967  1F 1E 1B          .db $1f,$1e,$1b,$16
       02:C96A  16        
 1700  02:C96B  0F 08 04          .db $0f,$08,$04,$01
       02:C96E  01        
 1701  02:C96F  00 01 04          .db $00,$01,$04,$08
       02:C972  08        
 1702  02:C973  0F 00 00          .db $0f,$00,$00,$00
       02:C976  00        
 1703  02:C977  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:C97A  1F        
 1704  02:C97B  1C 18 14          .db $1c,$18,$14,$10
       02:C97E  10        
 1705  02:C97F  0C 07 03          .db $0c,$07,$03,$00
       02:C982  00        
 1706                     
 1707                     ;
 1708                     ; wave #$26
 1709                     ;
 1710  02:C983  02 01 05          .db $02,$01,$05,$0b
       02:C986  0B        
 1711  02:C987  11 17 1B          .db $11,$17,$1b,$1f
       02:C98A  1F        
 1712  02:C98B  1E 1B 17          .db $1e,$1b,$17,$13
       02:C98E  13        
 1713  02:C98F  0F 0B 09          .db $0f,$0b,$09,$0e
       02:C992  0E        
 1714  02:C993  18 1D 1C          .db $18,$1d,$1c,$17
       02:C996  17        
 1715  02:C997  0F 0A 07          .db $0f,$0a,$07,$06
       02:C99A  06        
 1716  02:C99B  11 19 1A          .db $11,$19,$1a,$19
       02:C99E  19        
 1717  02:C99F  10 0B 06          .db $10,$0b,$06,$03
       02:C9A2  03        
 1718                     
 1719                     ;
 1720                     ; wave #$27
 1721                     ;
 1722  02:C9A3  1D 1D 1D          .db $1d,$1d,$1d,$10
       02:C9A6  10        
 1723  02:C9A7  10 10 1D          .db $10,$10,$1d,$1d
       02:C9AA  1D        
 1724  02:C9AB  1D 1D 1B          .db $1d,$1d,$1b,$1b
       02:C9AE  1B        
 1725  02:C9AF  1B 1B 1B          .db $1b,$1b,$1b,$1b
       02:C9B2  1B        
 1726  02:C9B3  00 00 00          .db $00,$00,$00,$00
       02:C9B6  00        
 1727  02:C9B7  00 00 02          .db $00,$00,$02,$02
       02:C9BA  02        
 1728  02:C9BB  02 02 10          .db $02,$02,$10,$10
       02:C9BE  10        
 1729  02:C9BF  10 02 02          .db $10,$02,$02,$02
       02:C9C2  02        
 1730                     
 1731                     ;
 1732                     ; wave #$28
 1733                     ;
 1734  02:C9C3  19 16 10          .db $19,$16,$10,$12
       02:C9C6  12        
 1735  02:C9C7  12 09 16          .db $12,$09,$16,$1f
       02:C9CA  1F        
 1736  02:C9CB  0F 17 0F          .db $0f,$17,$0f,$10
       02:C9CE  10        
 1737  02:C9CF  1D 13 11          .db $1d,$13,$11,$10
       02:C9D2  10        
 1738  02:C9D3  0E 19 1B          .db $0e,$19,$1b,$00
       02:C9D6  00        
 1739  02:C9D7  0F 03 0C          .db $0f,$03,$0c,$12
       02:C9DA  12        
 1740  02:C9DB  17 0F 16          .db $17,$0f,$16,$11
       02:C9DE  11        
 1741  02:C9DF  12 05 0D          .db $12,$05,$0d,$06
       02:C9E2  06        
 1742                     
 1743                     ;
 1744                     ; wave #$29
 1745                     ;
 1746  02:C9E3  00 07 0B          .db $00,$07,$0b,$0b
       02:C9E6  0B        
 1747  02:C9E7  09 03 00          .db $09,$03,$00,$01
       02:C9EA  01        
 1748  02:C9EB  17 17 15          .db $17,$17,$15,$10
       02:C9EE  10        
 1749  02:C9EF  0C 0A 0D          .db $0c,$0a,$0d,$13
       02:C9F2  13        
 1750  02:C9F3  07 0E 12          .db $07,$0e,$12,$11
       02:C9F6  11        
 1751  02:C9F7  0F 09 07          .db $0f,$09,$07,$07
       02:C9FA  07        
 1752  02:C9FB  1F 1E 1D          .db $1f,$1e,$1d,$17
       02:C9FE  17        
 1753  02:C9FF  13 11 13          .db $13,$11,$13,$1a
       02:CA02  1A        
 1754                     
 1755                     ;
 1756                     ; wave #$2a
 1757                     ;
 1758  02:CA03  19 04 03          .db $19,$04,$03,$03
       02:CA06  03        
 1759  02:CA07  02 02 01          .db $02,$02,$01,$01
       02:CA0A  01        
 1760  02:CA0B  03 03 01          .db $03,$03,$01,$01
       02:CA0E  01        
 1761  02:CA0F  01 01 00          .db $01,$01,$00,$01
       02:CA12  01        
 1762  02:CA13  00 01 19          .db $00,$01,$19,$19
       02:CA16  19        
 1763  02:CA17  1B 1B 1B          .db $1b,$1b,$1b,$1b
       02:CA1A  1B        
 1764  02:CA1B  19 1E 1E          .db $19,$1e,$1e,$1e
       02:CA1E  1E        
 1765  02:CA1F  0D 1E 19          .db $0d,$1e,$19,$04
       02:CA22  04        
 1766                     
 1767                     ;
 1768                     ; wave #$2b
 1769                     ;
 1770  02:CA23  0F 15 19          .db $0f,$15,$19,$1b
       02:CA26  1B        
 1771  02:CA27  1D 1E 1F          .db $1d,$1e,$1f,$1e
       02:CA2A  1E        
 1772  02:CA2B  1D 1B 19          .db $1d,$1b,$19,$15
       02:CA2E  15        
 1773  02:CA2F  0F 07 17          .db $0f,$07,$17,$0a
       02:CA32  0A        
 1774  02:CA33  14 0D 12          .db $14,$0d,$12,$0f
       02:CA36  0F        
 1775  02:CA37  10 0A 06          .db $10,$0a,$06,$04
       02:CA3A  04        
 1776  02:CA3B  02 01 00          .db $02,$01,$00,$01
       02:CA3E  01        
 1777  02:CA3F  02 04 06          .db $02,$04,$06,$0a
       02:CA42  0A        
 1778                     
 1779                     ;
 1780                     ; wave #$2c
 1781                     ;
 1782  02:CA43  09 18 1D          .db $09,$18,$1d,$0b
       02:CA46  0B        
 1783  02:CA47  00 06 13          .db $00,$06,$13,$1c
       02:CA4A  1C        
 1784  02:CA4B  18 10 06          .db $18,$10,$06,$02
       02:CA4E  02        
 1785  02:CA4F  00 00 00          .db $00,$00,$00,$00
       02:CA52  00        
 1786  02:CA53  02 08 16          .db $02,$08,$16,$1b
       02:CA56  1B        
 1787  02:CA57  09 03 10          .db $09,$03,$10,$1e
       02:CA5A  1E        
 1788  02:CA5B  1E 1B 16          .db $1e,$1b,$16,$0b
       02:CA5E  0B        
 1789  02:CA5F  05 01 00          .db $05,$01,$00,$00
       02:CA62  00        
 1790                     
 1791                     
 1792                     ;
 1793                     ; frequency data
 1794                     ;
 1795  02:CA63            psg_freqtbl:
 1796  02:CA63  E4 0F             .dw $0fe4       ; A0
 1797  02:CA65  00 0F             .dw $0f00       ; A0#
 1798  02:CA67  28 0E             .dw $0e28       ; B0
 1799  02:CA69  5D 0D             .dw $0d5d       ; C1 (octave starts at 'C')
 1800  02:CA6B  9D 0C             .dw $0c9d       ; C1#
 1801  02:CA6D  E7 0B             .dw $0be7       ; D1
 1802  02:CA6F  3D 0B             .dw $0b3d       ; D1#
 1803  02:CA71  9B 0A             .dw $0a9b       ; E1
 1804  02:CA73  03 0A             .dw $0a03       ; F1
 1805  02:CA75  73 09             .dw $0973       ; F1#
 1806  02:CA77  EB 08             .dw $08eb       ; G1
 1807  02:CA79  6A 08             .dw $086a       ; G1#
 1808  02:CA7B  F2 07             .dw $07f2       ; A1
 1809  02:CA7D  80 07             .dw $0780       ; A1#
 1810  02:CA7F  14 07             .dw $0714       ; B1
 1811  02:CA81  AF 06             .dw $06af       ; C2
 1812  02:CA83  4F 06             .dw $064f
 1813  02:CA85  F4 05             .dw $05f4
 1814  02:CA87  9E 05             .dw $059e
 1815  02:CA89  4E 05             .dw $054e
 1816  02:CA8B  02 05             .dw $0502
 1817  02:CA8D  B9 04             .dw $04b9
 1818  02:CA8F  76 04             .dw $0476
 1819  02:CA91  35 04             .dw $0435
 1820  02:CA93  F9 03             .dw $03f9
 1821  02:CA95  C0 03             .dw $03c0
 1822  02:CA97  8A 03             .dw $038a
 1823  02:CA99  57 03             .dw $0357       ; C3
 1824  02:CA9B  27 03             .dw $0327
 1825  02:CA9D  FA 02             .dw $02fa
 1826  02:CA9F  CF 02             .dw $02cf
 1827  02:CAA1  A7 02             .dw $02a7
 1828  02:CAA3  81 02             .dw $0281
 1829  02:CAA5  5D 02             .dw $025d
 1830  02:CAA7  3B 02             .dw $023b
 1831  02:CAA9  1B 02             .dw $021b
 1832  02:CAAB  FC 01             .dw $01fc
 1833  02:CAAD  E0 01             .dw $01e0
 1834  02:CAAF  C5 01             .dw $01c5
 1835  02:CAB1  AC 01             .dw $01ac       ; C4
 1836  02:CAB3  93 01             .dw $0193
 1837  02:CAB5  7D 01             .dw $017d
 1838  02:CAB7  68 01             .dw $0168
 1839  02:CAB9  53 01             .dw $0153
 1840  02:CABB  40 01             .dw $0140
 1841  02:CABD  2E 01             .dw $012e
 1842  02:CABF  1D 01             .dw $011d
 1843  02:CAC1  0D 01             .dw $010d
 1844  02:CAC3  FE 00             .dw $00fe
 1845  02:CAC5  F0 00             .dw $00f0
 1846  02:CAC7  E3 00             .dw $00e3
 1847  02:CAC9  D6 00             .dw $00d6       ; C5
 1848  02:CACB  CA 00             .dw $00ca
 1849  02:CACD  BE 00             .dw $00be
 1850  02:CACF  B4 00             .dw $00b4
 1851  02:CAD1  AA 00             .dw $00aa
 1852  02:CAD3  A0 00             .dw $00a0
 1853  02:CAD5  97 00             .dw $0097
 1854  02:CAD7  8F 00             .dw $008f
 1855  02:CAD9  87 00             .dw $0087
 1856  02:CADB  7F 00             .dw $007f
 1857  02:CADD  78 00             .dw $0078
 1858  02:CADF  71 00             .dw $0071
 1859  02:CAE1  6B 00             .dw $006b       ; C6
 1860  02:CAE3  65 00             .dw $0065
 1861  02:CAE5  5F 00             .dw $005f
 1862  02:CAE7  5A 00             .dw $005a
 1863  02:CAE9  55 00             .dw $0055
 1864  02:CAEB  50 00             .dw $0050
 1865  02:CAED  4B 00             .dw $004b
 1866  02:CAEF  46 00             .dw $0046
 1867  02:CAF1  43 00             .dw $0043
 1868  02:CAF3  40 00             .dw $0040
 1869  02:CAF5  3C 00             .dw $003c
 1870  02:CAF7  39 00             .dw $0039
 1871  02:CAF9  35 00             .dw $0035       ; C7
 1872  02:CAFB  32 00             .dw $0032
 1873  02:CAFD  30 00             .dw $0030
 1874  02:CAFF  2D 00             .dw $002d
 1875  02:CB01  2A 00             .dw $002a
 1876  02:CB03  28 00             .dw $0028
 1877  02:CB05  26 00             .dw $0026
 1878  02:CB07  24 00             .dw $0024
 1879  02:CB09  22 00             .dw $0022
 1880  02:CB0B  20 00             .dw $0020
 1881  02:CB0D  1E 00             .dw $001e
 1882  02:CB0F  1C 00             .dw $001c
 1883  02:CB11  1B 00             .dw $001b       ; C8
 1884                     
 1885                     
 1886                     ;
 1887                     ; TEMPO DATA
 1888                     ;
 1889                     ; starting with value $23 (as sent to PSG_TEMPO),
 1890                     ; these numbers are the timer values to use for
 1891                     ; that tempo
 1892                     ;
 1893  02:CB13            psg_tempotbl:
 1894  02:CB13  7D 79 76          .db $7d,$79,$76,$73
       02:CB16  73        
 1895  02:CB17  70 6D 6B          .db $70,$6d,$6b,$68
       02:CB1A  68        
 1896  02:CB1B  65 63 61          .db $65,$63,$61,$5f
       02:CB1E  5F        
 1897  02:CB1F  5D 5B 59          .db $5d,$5b,$59,$57
       02:CB22  57        
 1898  02:CB23  56 54 52          .db $56,$54,$52,$51
       02:CB26  51        
 1899  02:CB27  4F 4E 4D          .db $4f,$4e,$4d,$4b
       02:CB2A  4B        
 1900  02:CB2B  4A 49 48          .db $4a,$49,$48,$46
       02:CB2E  46        
 1901  02:CB2F  45 44 43          .db $45,$44,$43,$42
       02:CB32  42        
 1902  02:CB33  41 40 3F          .db $41,$40,$3f,$3e
       02:CB36  3E        
 1903  02:CB37  3E 3D 3C          .db $3e,$3d,$3c,$3b
       02:CB3A  3B        
 1904  02:CB3B  3A 3A 39          .db $3a,$3a,$39,$38
       02:CB3E  38        
 1905  02:CB3F  37 37 36          .db $37,$37,$36,$35
       02:CB42  35        
 1906  02:CB43  35 34 33          .db $35,$34,$33,$33
       02:CB46  33        
 1907  02:CB47  32 32 31          .db $32,$32,$31,$31
       02:CB4A  31        
 1908  02:CB4B  30 30 2F          .db $30,$30,$2f,$2f
       02:CB4E  2F        
 1909  02:CB4F  2E 2E 2D          .db $2e,$2e,$2d,$2d
       02:CB52  2D        
 1910  02:CB53  2C 2C 2B          .db $2c,$2c,$2b,$2b
       02:CB56  2B        
 1911  02:CB57  2A 2A 2A          .db $2a,$2a,$2a,$29
       02:CB5A  29        
 1912  02:CB5B  29 28 28          .db $29,$28,$28,$28
       02:CB5E  28        
 1913  02:CB5F  27 27 27          .db $27,$27,$27,$26
       02:CB62  26        
 1914  02:CB63  26 26 25          .db $26,$26,$25,$25
       02:CB66  25        
 1915  02:CB67  25 24 24          .db $25,$24,$24,$24
       02:CB6A  24        
 1916  02:CB6B  24 23 23          .db $24,$23,$23,$23
       02:CB6E  23        
 1917  02:CB6F  22 22 22          .db $22,$22,$22,$22
       02:CB72  22        
 1918  02:CB73  22 21 21          .db $22,$21,$21,$21
       02:CB76  21        
 1919  02:CB77  20 20 20          .db $20,$20,$20,$20
       02:CB7A  20        
 1920  02:CB7B  1F 1F 1F          .db $1f,$1f,$1f,$1f
       02:CB7E  1F        
 1921  02:CB7F  1F 1E 1E          .db $1f,$1e,$1e,$1e
       02:CB82  1E        
 1922  02:CB83  1E 1E 1D          .db $1e,$1e,$1d,$1d
       02:CB86  1D        
 1923  02:CB87  1D 1D 1D          .db $1d,$1d,$1d,$1c
       02:CB8A  1C        
 1924  02:CB8B  1C 1C 1C          .db $1c,$1c,$1c,$1c
       02:CB8E  1C        
 1925  02:CB8F  1B 1B 1B          .db $1b,$1b,$1b,$1b
       02:CB92  1B        
 1926  02:CB93  1B 1B 1A          .db $1b,$1b,$1a,$1a
       02:CB96  1A        
 1927  02:CB97  1A 1A 1A          .db $1a,$1a,$1a,$1a
       02:CB9A  1A        
 1928  02:CB9B  1A 19 19          .db $1a,$19,$19,$19
       02:CB9E  19        
 1929  02:CB9F  19 19 19          .db $19,$19,$19,$19
       02:CBA2  19        
 1930  02:CBA3  18 18 18          .db $18,$18,$18,$18
       02:CBA6  18        
 1931  02:CBA7  18 18 18          .db $18,$18,$18,$17
       02:CBAA  17        
 1932  02:CBAB  17 17 17          .db $17,$17,$17,$17
       02:CBAE  17        
 1933  02:CBAF  17 17 17          .db $17,$17,$17,$17
       02:CBB2  17        
 1934  02:CBB3  16 16 16          .db $16,$16,$16,$16
       02:CBB6  16        
 1935  02:CBB7  16 16 16          .db $16,$16,$16,$16
       02:CBBA  16        
 1936  02:CBBB  16 15 15          .db $16,$15,$15,$15
       02:CBBE  15        
 1937  02:CBBF  15 15 15          .db $15,$15,$15,$15
       02:CBC2  15        
 1938  02:CBC3  15 15 15          .db $15,$15,$15,$14
       02:CBC6  14        
 1939  02:CBC7  14 14 14          .db $14,$14,$14,$14
       02:CBCA  14        
 1940  02:CBCB  14 14 14          .db $14,$14,$14,$14
       02:CBCE  14        
 1941  02:CBCF  14 14 13          .db $14,$14,$13,$13
       02:CBD2  13        
 1942  02:CBD3  13 13 13          .db $13,$13,$13,$13
       02:CBD6  13        
 1943  02:CBD7  13 13 13          .db $13,$13,$13,$13
       02:CBDA  13        
 1944  02:CBDB  13 13 12          .db $13,$13,$12,$12
       02:CBDE  12        
 1945  02:CBDF  12 12 12          .db $12,$12,$12,$12
       02:CBE2  12        
 1946  02:CBE3  12 12 12          .db $12,$12,$12,$12
       02:CBE6  12        
 1947  02:CBE7  12 12 12          .db $12,$12,$12,$11
       02:CBEA  11        
 1948  02:CBEB  11 11 11          .db $11,$11,$11,$11
       02:CBEE  11        
 1949  02:CBEF  11                .db $11 
 1950                     
 1951                     
 1952                     ;
 1953                     ; Envelope Data
 1954                     ; 
 1955                     
 1956                     
 1957                     ;
 1958                     ; envelope #0
 1959                     ;
 1960  02:CBF0            psg_env0:
 1961                             ENV_RLS $8410
       02:CBF0  FB                 .db $fb
       02:CBF1  10 84              .dw $8410
 1962                             ENV_LEV $7c40
       02:CBF3  FC                 .db $fc
       02:CBF4  40 7C              .dw $7c40
 1963                             ENV_DLY $00,$0000
       02:CBF6  00                 .db $00
       02:CBF7  00 00              .dw $0000
 1964                             ENV_END
       02:CBF9  FF                 .db $ff
 1965                     
 1966                     ;
 1967                     ; envelope #1
 1968                     ;
 1969  02:CBFA            psg_env1:
 1970                             ENV_RLS $fa05
       02:CBFA  FB                 .db $fb
       02:CBFB  05 FA              .dw $fa05
 1971                             ENV_LEV $7c40
       02:CBFD  FC                 .db $fc
       02:CBFE  40 7C              .dw $7c40
 1972                             ENV_DLY $0c,$fe01
       02:CC00  0C                 .db $0c
       02:CC01  01 FE              .dw $fe01
 1973                             ENV_END
       02:CC03  FF                 .db $ff
 1974                     
 1975                     ;
 1976                     ; envelope #2
 1977                     ;
 1978  02:CC04            psg_env2:
 1979                             ENV_RLS $fd05
       02:CC04  FB                 .db $fb
       02:CC05  05 FD              .dw $fd05
 1980                             ENV_LEV $7c40
       02:CC07  FC                 .db $fc
       02:CC08  40 7C              .dw $7c40
 1981                             ENV_DLY $0c,$fe01
       02:CC0A  0C                 .db $0c
       02:CC0B  01 FE              .dw $fe01
 1982                             ENV_END
       02:CC0D  FF                 .db $ff
 1983                     
 1984                     ;
 1985                     ; envelope #3
 1986                     ;
 1987  02:CC0E            psg_env3:
 1988                             ENV_RLS $ff01
       02:CC0E  FB                 .db $fb
       02:CC0F  01 FF              .dw $ff01
 1989                             ENV_LEV $7c40
       02:CC11  FC                 .db $fc
       02:CC12  40 7C              .dw $7c40
 1990                             ENV_DLY $0c,$fe01
       02:CC14  0C                 .db $0c
       02:CC15  01 FE              .dw $fe01
 1991                             ENV_END
       02:CC17  FF                 .db $ff
 1992                     
 1993                     ;
 1994                     ; envelope #4
 1995                     ;
 1996  02:CC18            psg_env4:
 1997                             ENV_RLS $fa05
       02:CC18  FB                 .db $fb
       02:CC19  05 FA              .dw $fa05
 1998                             ENV_LEV $7c40
       02:CC1B  FC                 .db $fc
       02:CC1C  40 7C              .dw $7c40
 1999                             ENV_DLY $00,$ff81
       02:CC1E  00                 .db $00
       02:CC1F  81 FF              .dw $ff81
 2000                             ENV_END
       02:CC21  FF                 .db $ff
 2001                     
 2002                     ;
 2003                     ; envelope #5
 2004                     ;
 2005  02:CC22            psg_env5:
 2006                             ENV_RLS $fa05
       02:CC22  FB                 .db $fb
       02:CC23  05 FA              .dw $fa05
 2007                             ENV_LEV $7c40
       02:CC25  FC                 .db $fc
       02:CC26  40 7C              .dw $7c40
 2008                             ENV_DLY $00,$ff01
       02:CC28  00                 .db $00
       02:CC29  01 FF              .dw $ff01
 2009                             ENV_END
       02:CC2B  FF                 .db $ff
 2010                     
 2011                     ;
 2012                     ; envelope #6
 2013                     ;
 2014  02:CC2C            psg_env6:
 2015                             ENV_RLS $fa05
       02:CC2C  FB                 .db $fb
       02:CC2D  05 FA              .dw $fa05
 2016                             ENV_LEV $7c40
       02:CC2F  FC                 .db $fc
       02:CC30  40 7C              .dw $7c40
 2017                             ENV_DLY $00,$fe01
       02:CC32  00                 .db $00
       02:CC33  01 FE              .dw $fe01
 2018                             ENV_END
       02:CC35  FF                 .db $ff
 2019                     
 2020                     ;
 2021                     ; envelope #7
 2022                     ;
 2023  02:CC36            psg_env7:
 2024                             ENV_RLS $fb05
       02:CC36  FB                 .db $fb
       02:CC37  05 FB              .dw $fb05
 2025                             ENV_LEV $2c40
       02:CC39  FC                 .db $fc
       02:CC3A  40 2C              .dw $2c40
 2026                             ENV_DLY $02,$2801
       02:CC3C  02                 .db $02
       02:CC3D  01 28              .dw $2801
 2027                             ENV_DLY $00,$ff81
       02:CC3F  00                 .db $00
       02:CC40  81 FF              .dw $ff81
 2028                             ENV_END
       02:CC42  FF                 .db $ff
 2029                     
 2030                     ;
 2031                     ; envelope #8
 2032                     ;
 2033  02:CC43            psg_env8:
 2034                             ENV_RLS $fb05
       02:CC43  FB                 .db $fb
       02:CC44  05 FB              .dw $fb05
 2035                             ENV_LEV $3440
       02:CC46  FC                 .db $fc
       02:CC47  40 34              .dw $3440
 2036                             ENV_DLY $03,$1801
       02:CC49  03                 .db $03
       02:CC4A  01 18              .dw $1801
 2037                             ENV_DLY $00,$ff81
       02:CC4C  00                 .db $00
       02:CC4D  81 FF              .dw $ff81
 2038                             ENV_END
       02:CC4F  FF                 .db $ff
 2039                     
 2040                     ;
 2041                     ; envelope #9
 2042                     ;
 2043  02:CC50            psg_env9:
 2044                             ENV_RLS $fb05
       02:CC50  FB                 .db $fb
       02:CC51  05 FB              .dw $fb05
 2045                             ENV_LEV $1c40
       02:CC53  FC                 .db $fc
       02:CC54  40 1C              .dw $1c40
 2046                             ENV_DLY $01,$6001
       02:CC56  01                 .db $01
       02:CC57  01 60              .dw $6001
 2047                             ENV_DLY $02,$fe01
       02:CC59  02                 .db $02
       02:CC5A  01 FE              .dw $fe01
 2048                             ENV_DLY $08,$fc01
       02:CC5C  08                 .db $08
       02:CC5D  01 FC              .dw $fc01
 2049                             ENV_DLY $32,$0081
       02:CC5F  32                 .db $32
       02:CC60  81 00              .dw $0081
 2050                             ENV_END
       02:CC62  FF                 .db $ff
 2051                     
 2052                     ;
 2053                     ; envelope #$0a
 2054                     ;
 2055  02:CC63            psg_enva:
 2056                             ENV_RLS $fd01
       02:CC63  FB                 .db $fb
       02:CC64  01 FD              .dw $fd01
 2057                             ENV_LEV $0440
       02:CC66  FC                 .db $fc
       02:CC67  40 04              .dw $0440
 2058                             ENV_DLY $03,$2801
       02:CC69  03                 .db $03
       02:CC6A  01 28              .dw $2801
 2059                             ENV_DLY $04,$fe01
       02:CC6C  04                 .db $04
       02:CC6D  01 FE              .dw $fe01
 2060                             ENV_END
       02:CC6F  FF                 .db $ff
 2061                     
 2062                     ;
 2063                     ; envelope #$0b
 2064                     ;
 2065  02:CC70            psg_envb:
 2066                             ENV_RLS $fd01
       02:CC70  FB                 .db $fb
       02:CC71  01 FD              .dw $fd01
 2067                             ENV_LEV $0000
       02:CC73  FC                 .db $fc
       02:CC74  00 00              .dw $0000
 2068                             ENV_LEV $0000
       02:CC76  FC                 .db $fc
       02:CC77  00 00              .dw $0000
 2069                             ENV_LEV $7c40
       02:CC79  FC                 .db $fc
       02:CC7A  40 7C              .dw $7c40
 2070                             ENV_DLY $00,$ffc1
       02:CC7C  00                 .db $00
       02:CC7D  C1 FF              .dw $ffc1
 2071                             ENV_END
       02:CC7F  FF                 .db $ff
 2072                     
 2073                     ;
 2074                     ; envelope #$0c
 2075                     ;
 2076  02:CC80            psg_envc:
 2077                             ENV_RLS $fa05
       02:CC80  FB                 .db $fb
       02:CC81  05 FA              .dw $fa05
 2078                             ENV_LEV $0000
       02:CC83  FC                 .db $fc
       02:CC84  00 00              .dw $0000
 2079                             ENV_LEV $0000
       02:CC86  FC                 .db $fc
       02:CC87  00 00              .dw $0000
 2080                             ENV_LEV $6840
       02:CC89  FC                 .db $fc
       02:CC8A  40 68              .dw $6840
 2081                             ENV_DLY $00,$0061
       02:CC8C  00                 .db $00
       02:CC8D  61 00              .dw $0061
 2082                             ENV_END
       02:CC8F  FF                 .db $ff
 2083                     
 2084                     ;
 2085                     ; envelope #$0d
 2086                     ;
 2087  02:CC90            psg_envd:
 2088                             ENV_RLS $fa05
       02:CC90  FB                 .db $fb
       02:CC91  05 FA              .dw $fa05
 2089                             ENV_LEV $7c40
       02:CC93  FC                 .db $fc
       02:CC94  40 7C              .dw $7c40
 2090                             ENV_DLY $04,$f801
       02:CC96  04                 .db $04
       02:CC97  01 F8              .dw $f801
 2091                             ENV_DLY $00,$ff41
       02:CC99  00                 .db $00
       02:CC9A  41 FF              .dw $ff41
 2092                             ENV_END
       02:CC9C  FF                 .db $ff
 2093                     
 2094                     ;
 2095                     ; envelope #$0e
 2096                     ;
 2097  02:CC9D            psg_enve:
 2098                             ENV_RLS $fa05
       02:CC9D  FB                 .db $fb
       02:CC9E  05 FA              .dw $fa05
 2099                             ENV_LEV $7c40
       02:CCA0  FC                 .db $fc
       02:CCA1  40 7C              .dw $7c40
 2100                             ENV_DLY $08,$f801
       02:CCA3  08                 .db $08
       02:CCA4  01 F8              .dw $f801
 2101                             ENV_DLY $00,$ff41
       02:CCA6  00                 .db $00
       02:CCA7  41 FF              .dw $ff41
 2102                             ENV_END
       02:CCA9  FF                 .db $ff
 2103                     
 2104                     ;
 2105                     ; envelope #$0f
 2106                     ;
 2107  02:CCAA            psg_envf:
 2108                             ENV_RLS $ff00
       02:CCAA  FB                 .db $fb
       02:CCAB  00 FF              .dw $ff00
 2109                             ENV_LEV $7c40
       02:CCAD  FC                 .db $fc
       02:CCAE  40 7C              .dw $7c40
 2110                             ENV_DLY $05,$fc01
       02:CCB0  05                 .db $05
       02:CCB1  01 FC              .dw $fc01
 2111                             ENV_LEV $7040
       02:CCB3  FC                 .db $fc
       02:CCB4  40 70              .dw $7040
 2112                             ENV_DLY $05,$fc01
       02:CCB6  05                 .db $05
       02:CCB7  01 FC              .dw $fc01
 2113                             ENV_LEV $6440
       02:CCB9  FC                 .db $fc
       02:CCBA  40 64              .dw $6440
 2114                             ENV_DLY $05,$fc01
       02:CCBC  05                 .db $05
       02:CCBD  01 FC              .dw $fc01
 2115                             ENV_LEV $5840
       02:CCBF  FC                 .db $fc
       02:CCC0  40 58              .dw $5840
 2116                             ENV_DLY $05,$fc01
       02:CCC2  05                 .db $05
       02:CCC3  01 FC              .dw $fc01
 2117                             ENV_LEV $4c40
       02:CCC5  FC                 .db $fc
       02:CCC6  40 4C              .dw $4c40
 2118                             ENV_DLY $05,$fc01
       02:CCC8  05                 .db $05
       02:CCC9  01 FC              .dw $fc01
 2119                             ENV_LEV $4040
       02:CCCB  FC                 .db $fc
       02:CCCC  40 40              .dw $4040
 2120                             ENV_DLY $05,$fc01
       02:CCCE  05                 .db $05
       02:CCCF  01 FC              .dw $fc01
 2121                             ENV_DLY $00,$ff01
       02:CCD1  00                 .db $00
       02:CCD2  01 FF              .dw $ff01
 2122                             ENV_END
       02:CCD4  FF                 .db $ff
 2123                     
 2124                     
 2125                     ; 
 2126                     ; Envelope Header (pointers to data)
 2127                     ;
 2128  02:CCD5            psg_envtbl:
 2129  02:CCD5  F0 CB             .dw psg_env0
 2130  02:CCD7  FA CB             .dw psg_env1
 2131  02:CCD9  04 CC             .dw psg_env2
 2132  02:CCDB  0E CC             .dw psg_env3
 2133  02:CCDD  18 CC             .dw psg_env4
 2134  02:CCDF  22 CC             .dw psg_env5
 2135  02:CCE1  2C CC             .dw psg_env6
 2136  02:CCE3  36 CC             .dw psg_env7
 2137  02:CCE5  43 CC             .dw psg_env8
 2138  02:CCE7  50 CC             .dw psg_env9
 2139  02:CCE9  63 CC             .dw psg_enva
 2140  02:CCEB  70 CC             .dw psg_envb
 2141  02:CCED  80 CC             .dw psg_envc
 2142  02:CCEF  90 CC             .dw psg_envd
 2143  02:CCF1  9D CC             .dw psg_enve
 2144  02:CCF3  AA CC             .dw psg_envf
 2145                     
 2146                     
 2147                     ;
 2148                     ; now, return context to bank established in
 2149                     ; file which included this
 2150                     ;
 2151           0000              .bank   START_BANK
 2152                     
#[4]   sup_hes.asm
 1315                            .endif   ; CDROM
 1316                     
 1317                     ; ----
 1318                     ; disp_on
 1319                     ; ----
 1320                     ; enable display
 1321                     ; ----
 1322                     
 1323           0001             .ifdef HUC
 1324  00:FC98            _disp_on:
 1325  00:FC98  AE 8E 26          ldx   disp_cr
 1326  00:FC9B  A9 01             lda   #1
 1327  00:FC9D  8D 8E 26          sta   disp_cr
 1328  00:FCA0  62                cla
 1329  00:FCA1  60                rts
 1330                            .else
 1335                            .endif   ; HUC
 1336                     
 1337                     ; ----
 1338                     ; disp_off
 1339                     ; ----
 1340                     ; disable display
 1341                     ; ----
 1342                     
 1343           0001             .ifdef HUC
 1344  00:FCA2            _disp_off:
 1345  00:FCA2  AE 8E 26          ldx   disp_cr
 1346  00:FCA5  9C 8E 26          stz   disp_cr
 1347  00:FCA8  62                cla
 1348  00:FCA9  60                rts
 1349                            .else
 1353                            .endif   ; HUC
 1354                     
 1355                     ; ----
 1356                     ; set_intvec
 1357                     ; ----
 1358                     ; set interrupt vector
 1359                     ; ----
 1360                     ; IN : A = vector number
 1361                     ;           0 IRQ2
 1362                     ;           1 IRQ1 (VDC)
 1363                     ;           2 TIMER
 1364                     ;           3 NMI
 1365                     ;           4 VSYNC
 1366                     ;           5 HSYNC
 1367                     ;           6 SOFT RESET (RUN + SELECT)
 1368                     ;      X = vector address low byte
 1369                     ;      Y =   "      "    high byte
 1370                     ; ----
 1371                     
 1372           0001             .if  !(CDROM)
 1373                     
 1374  00:FCAA            set_intvec:
 1375  00:FCAA  08                php
 1376  00:FCAB  78                sei
 1377  00:FCAC  C9 06             cmp   #6
 1378                             blo  .vector
       00:FCAE  90 0A              bcc    .vector
 1379  00:FCB0  D0 14             bne  .exit
 1380  00:FCB2            .reset:
 1381  00:FCB2  8E 84 22          stx   soft_reset
 1382  00:FCB5  8C 85 22          sty   soft_reset+1
 1383  00:FCB8  80 0C             bra  .exit      
 1384  00:FCBA            .vector:
 1385  00:FCBA  48                pha
 1386  00:FCBB  0A                asl   A
 1387  00:FCBC  22                sax
 1388  00:FCBD  9D 00 22          sta   user_jmptbl,X
 1389  00:FCC0  E8                inx
 1390  00:FCC1  98                tya
 1391  00:FCC2  9D 00 22          sta   user_jmptbl,X
 1392  00:FCC5  68                pla
 1393  00:FCC6            .exit:
 1394  00:FCC6  28                plp
 1395  00:FCC7  60                rts
 1396                            .endif   ; !(CDROM)
 1397                     
 1398                     ; ----
 1399                     ; wait_vsync
 1400                     ; ----
 1401                     ; wait the next vsync
 1402                     ; ----
 1403                     ; IN :  A = number of frames to be sync'ed on
 1404                     ; ----
 1405                     ; OUT:  A = number of elapsed frames since last call
 1406                     ; ----
 1407                     
 1408  00:FCC8            wait_vsync:
 1409  00:FCC8  1F F5 03          bbr1 <irq_m,.l1
 1410  00:FCCB  62                cla                     ; return immediately if IRQ1 is redirected
 1411           0001             .ifdef HUC
 1412  00:FCCC  82                clx
 1413                            .endif
 1414  00:FCCD  60                rts
 1415                     
 1416  00:FCCE  78        .l1:    sei                     ; disable interrupts
 1417  00:FCCF  CD 41 22          cmp   irq_cnt           ; calculate how many frames to wait
 1418  00:FCD2  F0 05             beq  .l2
 1419                             bhs  .l3
       00:FCD4  B0 04              bcs    .l3
 1420  00:FCD6  AD 41 22          lda   irq_cnt
 1421  00:FCD9  1A        .l2:    inc   A
 1422                     .l3:    sub   irq_cnt
                0000              .if (1 = 2)            ; from register A (handle
                                  .else
       00:FCDA  38                 sec
       00:FCDB  ED 41 22           sbc    irq_cnt
                                  .endif
 1423  00:FCDE  8D 80 26          sta   vsync_cnt
 1424  00:FCE1  58                cli                     ; re-enable interrupts
 1425                     
 1426  00:FCE2  AD 41 22  .l4:    lda   irq_cnt           ; wait loop
 1427                     .l5:    incw  _rndseed
       00:FCE5  EE 43 27           inc    _rndseed              ; value at stated memory
       00:FCE8  D0 03              bne    .x_00718           ; location
       00:FCEA  EE 44 27           inc    _rndseed+1
       00:FCED            .x_00718:
 1428  00:FCED  CD 41 22          cmp   irq_cnt
 1429  00:FCF0  F0 F3             beq  .l5
 1430  00:FCF2  CE 80 26          dec   vsync_cnt
 1431  00:FCF5  D0 EB             bne  .l4
 1432                     
 1433  00:FCF7  9C 41 22          stz   irq_cnt           ; reset system interrupt counter
 1434  00:FCFA  1A                inc   A                 ; return number of elapsed frames
 1435                     
 1436           0000             .ifndef HUC
 1438                            .else
 1439                     
 1440                         ; ----
 1441                         ; callback support
 1442                     
 1443  00:FCFB  48                pha
 1444  00:FCFC  AD 88 26          lda   joycallback       ; callback valid?
 1445  00:FCFF  10 34             bpl  .t3
 1446  00:FD01  89 01             bit   #$01
 1447  00:FD03  D0 30             bne  .t3
 1448                     
 1449  00:FD05  AD 89 26          lda   joycallback+1     ; get events for all the 
 1450  00:FD08  F0 2B             beq  .t3                ; selected joypads
 1451  00:FD0A  85 F8             sta  <_al
 1452  00:FD0C  C2                cly
 1453  00:FD0D  62                cla
 1454  00:FD0E  46 F8     .t1:    lsr  <_al
 1455  00:FD10  90 03             bcc  .t2
 1456  00:FD12  19 81 26          ora   joybuf,Y
 1457  00:FD15  C8        .t2:    iny
 1458  00:FD16  C0 05             cpy   #5
 1459                             blo  .t1
       00:FD18  90 F4              bcc    .t1
 1460                     
 1461  00:FD1A  2D 8A 26          and   joycallback+2     ; compare with requested state
 1462  00:FD1D  F0 16             beq  .t3
 1463                     
 1464  00:FD1F  EE 88 26          inc   joycallback       ; lock callback feature
 1465  00:FD22  AA                tax                     ; call user routine
 1466  00:FD23  43 20             tma   #5
 1467  00:FD25  48                pha
 1468  00:FD26  AD 8B 26          lda   joycallback+3
 1469  00:FD29  53 20             tam   #5
 1470  00:FD2B  62                cla
 1471  00:FD2C  20 38 FD          jsr  .callback
 1472  00:FD2F  68                pla
 1473  00:FD30  53 20             tam   #5
 1474  00:FD32  CE 88 26          dec   joycallback       ; unlock
 1475                             ; --
 1476  00:FD35  FA        .t3:    plx
 1477  00:FD36  62                cla
 1478  00:FD37  60                rts
 1479                     
 1480                         ; ----
 1481                         ; user routine callback
 1482                         ;
 1483  00:FD38            .callback:
 1484  00:FD38  6C 8C 26          jmp   [joycallback+4]
 1485                            .endif   ; ndef HUC
 1486                     
#[5]   joypad.asm
 1487                            .include  "joypad.asm"   ; read joypad values
    1                     ; ----
    2                     ; read_joypad
    3                     ; ----
    4                     ; poll joypads
    5                     ;
    6                     ; 'joyport' (location $1000) is a control read/write port which only reads
    7                     ; 4 bits at a time; the program uses joyport to toggle the multiplex line
    8                     ;
    9                     ; real logic values are read into the port - the joypad's keys are default
   10                     ; high, and 'pulled' low when pressed.  Therefore, these values must be
   11                     ; inverted/complemented to yield values where '1' means 'pressed'
   12                     ;
   13                     ; bit values for joypad bytes: (MSB = #7; LSB = #0)
   14                     ; -------------------------------------------------
   15                     ; bit 0 (ie $01) = I
   16                     ; bit 1 (ie $02) = II
   17                     ; bit 2 (ie $04) = 'select'
   18                     ; bit 3 (ie $08) = 'run'
   19                     ; bit 4 (ie $10) = UP
   20                     ; bit 5 (ie $20) = RIGHT
   21                     ; bit 6 (ie $40) = DOWN
   22                     ; bit 7 (ie $80) = LEFT
   23                     ; ----
   24                     ; bit values for joypad 6-button bytes: (MSB = #7; LSB = #0)
   25                     ; ----------------------------------------------------------
   26                     ; bit 0   (ie $01) = III
   27                     ; bit 1   (ie $02) = IV
   28                     ; bit 2   (ie $04) = V
   29                     ; bit 3   (ie $08) = VI
   30                     ; bit 4-7 (ie $F0) = exists (all on or all off)
   31                     ; ----
   32                     
   33                     ; Note: Read twice for 6-button joysticks.
   34                     ; First read should be for 'joy' and second for
   35                     ; 'joy6'; need to hide values temporarily while
   36                     ; scanning twice.
   37                     
   38  00:FD3B            read_joypad:
   39                             maplibfunc  lib2_readjoy
       00:FD3B  A8                 tay
       00:FD3C  43 20              tma  #page(lib2_readjoy)
       00:FD3E  48                 pha
       00:FD3F  A9 01              lda  #bank(lib2_readjoy)
       00:FD41  53 20              tam  #page(lib2_readjoy)
       00:FD43  98                 tya
       00:FD44  20 C3 B4           jsr  lib2_readjoy
       00:FD47  A8                 tay
       00:FD48  68                 pla
       00:FD49  53 20              tam  #page(lib2_readjoy)
       00:FD4B  98                 tya
   40  00:FD4C  60                rts
   41                     
   42           0001              .bank   LIB2_BANK
   43                     
   44  01:B4C3            lib2_readjoy:
   45  01:B4C3  AD 27 22          lda   joyena            ; suppress reset during individual read
   46  01:B4C6  48                pha
   47  01:B4C7  9C 27 22          stz   joyena
   48                     
   49           0000             .if (CDROM)
   51                            .else
   52  01:B4CA  20 75 B5          jsr  .readjoys
   53                            .endif
   54                     
   55  01:B4CD  73 28 22          tii   joy, joy6, 5      ; move to 6-button area
       01:B4D0  93 26 05  
       01:B4D3  00        
   56                     
   57           0000             .if (CDROM)
   59                            .else
   60  01:B4D4  20 75 B5          jsr  .readjoys
   61                            .endif
   62                     
   63  01:B4D7  68                pla
   64  01:B4D8  8D 27 22          sta   joyena
   65                     
   66  01:B4DB  73 A7 26          tii   joytmp, joyold, 5         ; restore past info from stash
       01:B4DE  32 22 05  
       01:B4E1  00        
   67  01:B4E2  73 AC 26          tii   joytmp6, joyold6, 5
       01:B4E5  9D 26 05  
       01:B4E8  00        
   68                     
   69                             ;
   70                             ; the '.l2' loop determines if first or
   71                             ; second scans imply a 6-button joystick,
   72                             ; and rearrange bytes if out of order,
   73                             ; and zero the joy6 area if necessary
   74                             ;
   75  01:B4E9  C2                cly
   76  01:B4EA  B9 28 22  .l2:    lda   joy,Y             ; check if 6-button joypad, and
   77  01:B4ED  AA                tax
   78  01:B4EE  29 50             and   #JOY_TYPE6        ; scans became backwards somehow
   79  01:B4F0  C9 50             cmp   #JOY_TYPE6
   80  01:B4F2  D0 0A             bne  .notswap
   81  01:B4F4  B9 93 26          lda   joy6,Y            ; then swap them if they need it
   82  01:B4F7  99 28 22          sta   joy,Y
   83  01:B4FA  22                sax
   84  01:B4FB  99 93 26          sta   joy6,Y
   85                     
   86  01:B4FE            .notswap:
   87  01:B4FE  B9 93 26          lda   joy6,Y            ; verify whether a 6-button exists
   88  01:B501  29 50             and   #JOY_TYPE6
   89  01:B503  C9 50             cmp   #JOY_TYPE6
   90  01:B505  F0 04             beq  .type6
   91  01:B507  62                cla
   92  01:B508  99 93 26          sta   joy6,Y            ; not 6-button, so clear extra entry
   93                     
   94  01:B50B            .type6:
   95  01:B50B  B9 93 26          lda   joy6,Y            ; strip off unused bits
   96  01:B50E  29 5F             and   #(JOY_III | JOY_IV | JOY_V | JOY_VI | JOY_TYPE6)
   97  01:B510  99 93 26          sta   joy6,Y            ; clear unnecessary bits
   98                     
   99                     
  100                             ;
  101                             ; The '.l2a' area sets appropriate values
  102                             ; for all of the joytrg and joybuf areas
  103                             ;
  104                     
  105  01:B513  B9 28 22  .l2a:   lda   joy,Y
  106  01:B516  59 32 22          eor   joyold,Y          ; check against previous value
  107  01:B519  39 28 22          and   joy,Y
  108  01:B51C  99 2D 22          sta   joytrg,Y          ; 'new key pressed' key values
  109                     
  110                         ; ----
  111                         ; buffered 'new key pressed'
  112                         ; see joy_events();
  113                         ;
  114  01:B51F  19 81 26          ora   joybuf,Y          ; collect 'new key pressed'
  115  01:B522  99 81 26          sta   joybuf,Y
  116                     
  117                         ; ----
  118                         ; repeat the joyold/joytrg/joybuf stuff
  119                         ; for 6-button values
  120                         ;
  121  01:B525  B9 93 26          lda   joy6,Y
  122  01:B528  59 9D 26          eor   joyold6,Y
  123  01:B52B  39 93 26          and   joy6,Y
  124  01:B52E  99 98 26          sta   joytrg6,Y
  125  01:B531  19 A2 26          ora   joybuf6,Y
  126  01:B534  99 A2 26          sta   joybuf6,Y
  127                     
  128                         ; ----
  129                         ; next joypad
  130                         ;
  131  01:B537  C8                iny
  132  01:B538  C0 05             cpy   #$05              ; cycle for next of 5 joypads
  133  01:B53A  90 AE             bcc  .l2
  134                     
  135                         ; ----
  136                         ; soft reset check
  137                         ;
  138  01:B53C  C2                cly                     ; start cycle of 5 joypads
  139  01:B53D  AD 27 22  .l3:    lda   joyena            ; find mask of 'important' joysticks
  140  01:B540  39 B9 B5          and  .bitmsk,Y
  141  01:B543  F0 11             beq  .l4                ; not important enough to check
  142  01:B545  B9 2D 22          lda   joytrg,Y
  143  01:B548  C9 04             cmp   #$04              ; 'select' key newly-pressed ?
  144  01:B54A  D0 0A             bne  .l4
  145  01:B54C  B9 28 22          lda   joy,Y
  146  01:B54F  C9 0C             cmp   #$0C              ; 'run+select' currently pressed ?
  147  01:B551  D0 03             bne  .l4
  148                     
  149           0000             .if (DEVELO)
  151                            .else
  152  01:B553  6C 84 22          jmp   [soft_reset]      ; run+select 'soft reset' vector
  153                            .endif   ; (DEVELO)
  154                     
  155  01:B556  C8        .l4:    iny                     ; try next joypad
  156  01:B557  C0 05             cpy   #$05
  157  01:B559  90 E2             bcc  .l3
  158                     
  159                         ; ----
  160                         ; joyread hook
  161                         ;
  162           0001             .ifdef HUC
  163                             tstw  joyhook
       01:B55B  AD 86 26           lda   joyhook               ; value at stated memory
       01:B55E  0D 87 26           ora   joyhook+1             ; location is zero
  164  01:B561  F0 03             beq  .l5
  165  01:B563  20 BE B5          jsr  .hook
  166  01:B566            .l5:
  167                            .endif   ; HUC
  168                     
  169                     
  170                         ; ----
  171                         ; return
  172                         ;
  173  01:B566  73 28 22          tii   joy, joytmp, 5    ; stash values for next read because CDROM
       01:B569  A7 26 05  
       01:B56C  00        
  174  01:B56D  73 93 26          tii   joy6, joytmp6, 5  ; may force another read between VSYNC's
       01:B570  AC 26 05  
       01:B573  00        
  175                     
  176  01:B574  60                rts
  177                     
  178                     
  179           0001             .if !(CDROM)
  180                         ; ----
  181                         ; read 5 joystick values into 'joy' buffer area
  182                         ;
  183  01:B575            .readjoys:
  184  01:B575  73 28 22          tii   joy, joyold, 5
       01:B578  32 22 05  
       01:B57B  00        
  185  01:B57C  A9 01             lda   #$01              ; reset joypad port to joystick #1
  186  01:B57E  8D 00 10          sta   joyport
  187  01:B581  A9 03             lda   #$03
  188  01:B583  8D 00 10          sta   joyport
  189  01:B586  20 B3 B5          jsr   .delay
  190                     
  191  01:B589  C2                cly                     ; counter for 5 joypads
  192  01:B58A  A9 01     .rdlp:  lda   #$01              ; first nybble
  193  01:B58C  8D 00 10          sta   joyport
  194  01:B58F  44 22             bsr  .delay             ; required delay (approx 9 cycles)
  195                     
  196  01:B591  AD 00 10          lda   joyport           ; fetch first nybble
  197  01:B594  0A                asl   A                 ; shift it to 'high' position within byte
  198  01:B595  0A                asl   A
  199  01:B596  0A                asl   A
  200  01:B597  0A                asl   A
  201  01:B598  99 28 22          sta   joy,Y             ; store in 'current' area
  202  01:B59B  9C 00 10          stz   joyport           ; toggle port (to read other 4 key values)
  203  01:B59E  44 13             bsr  .delay             ; delay again
  204  01:B5A0  AD 00 10          lda   joyport           ; fetch second nybble
  205  01:B5A3  29 0F             and   #$0F              ; clear unused bits
  206  01:B5A5  19 28 22          ora   joy,Y             ; merge 2 nybbles into 1 byte
  207  01:B5A8  49 FF             eor   #$FF              ; reset 'sense' of keys
  208  01:B5AA  99 28 22          sta   joy,Y             ; store it
  209  01:B5AD  C8                iny
  210  01:B5AE  C0 05             cpy   #$05              ; cycle for next of 5 joypads
  211  01:B5B0  90 D8             bcc  .rdlp
  212                     
  213  01:B5B2  60                rts
  214                     
  215                     
  216                         ; ----
  217                         ; small delay
  218                         ;
  219  01:B5B3            .delay:
  220  01:B5B3  A2 03             ldx   #3
  221  01:B5B5  CA        .l6:    dex
  222  01:B5B6  D0 FD             bne  .l6
  223  01:B5B8  60                rts
  224                     
  225                            .endif   ; !(CDROM)
  226                     
  227  01:B5B9            .bitmsk:
  228  01:B5B9  01 02 04          .db $01,$02,$04,$08,$10 ; bit-masks for check-reset
       01:B5BC  08 10     
  229                     
  230                         ; ----
  231                         ; user routine
  232                         ;
  233           0001             .ifdef HUC
  234  01:B5BE            .hook:
  235  01:B5BE  6C 86 26          jmp   [joyhook]
  236                            .endif   ; HUC
  237                     
  238                     ; At end of all this lib2_bank stuff, we need to return
  239                     ; to the base context of lib1_bank:
  240                     
  241           0000              .bank  LIB1_BANK
  242                     
#[4]   sup_hes.asm
 1488                     
 1489                     
 1490                     ;[ USER PROGRAM ]
 1491                     
 1492                     ;       .nomlist
 1493                     ;       .list
 1494                     
 1495                             ;...
 1496                     
 1497                     ;       .endif
 1498                     
#[3]   startup.asm
    7                          else
    9                             .endif
#[2]   main.s
   13           60C8              .data
   14           0004              .bank DATA_BANK
   15                     
   16           FD4D              .code
   17                     
   18           60C8        .data
   19           0003        .bank CONST_BANK
   20           4400        .org $4400
   21  03:4400             _sound_dat:
   22  03:4400  CB 44             dw      sound_data_table        ; 0
   23  03:4402  DD 44             dw      loop_point_table        ; 1
   24  03:4404  1A 44             dw      softenve_table          ; 2
   25  03:4406  26 44             dw      softenve_lp_table       ; 3
   26  03:4408  92 44             dw      pitchenve_table         ; 4
   27  03:440A  98 44             dw      pitchenve_lp_table      ; 5
   28  03:440C  A4 44             dw      lfo_data                    ; 6
   29  03:440E  D7 44             dw      sound_data_bank         ; 7
   30  03:4410  E9 44             dw      loop_point_bank         ; 8
   31  03:4412  A4 44             dw      arpeggio_table          ; 9
   32  03:4414  A4 44             dw      arpeggio_lp_table       ; 10
   33  03:4416            _pcewav:
   34  03:4416  A5 44             dw      pce_data_table
   35  03:4418            _xpcmdata
   36  03:4418  CB 44             dw      xpcm_data
   37                     ;       .include "songdata.h"
   38           0003              .bank CONST_BANK
#[3]   effect.h
   39                             .include "effect.h"
    1  03:441A            dutyenve_table:
    2  03:441A            dutyenve_lp_table:
    3                     
    4                     
    5  03:441A            softenve_table:
    6  03:441A  32 44             dw      softenve_000
    7  03:441C  39 44             dw      softenve_001
    8  03:441E  47 44             dw      softenve_002
    9  03:4420  52 44             dw      softenve_003
   10  03:4422  59 44             dw      softenve_004
   11  03:4424  83 44             dw      softenve_005
   12  03:4426            softenve_lp_table:
   13  03:4426  37 44             dw      softenve_lp_000
   14  03:4428  45 44             dw      softenve_lp_001
   15  03:442A  50 44             dw      softenve_lp_002
   16  03:442C  57 44             dw      softenve_lp_003
   17  03:442E  81 44             dw      softenve_lp_004
   18  03:4430  90 44             dw      softenve_lp_005
   19                     
   20  03:4432            softenve_000:
   21  03:4432  11 08 05          db      $11,$08,$05,$03,$02
       03:4435  03 02     
   22  03:4437            softenve_lp_000:
   23  03:4437  00 FF             db      $00,$ff
   24  03:4439            softenve_001:
   25  03:4439  19 14 13          db      $19,$14,$13,$12,$11,$0f,$0c,$07
       03:443C  12 11 0F  
       03:443F  0C 07     
   26  03:4441  05 03 02          db      $05,$03,$02,$01
       03:4444  01        
   27  03:4445            softenve_lp_001:
   28  03:4445  00 FF             db      $00,$ff
   29  03:4447            softenve_002:
   30  03:4447  13 16 07          db      $13,$16,$07,$11,$12,$04,$06,$02
       03:444A  11 12 04  
       03:444D  06 02     
   31  03:444F  01                db      $01
   32  03:4450            softenve_lp_002:
   33  03:4450  00 FF             db      $00,$ff
   34  03:4452            softenve_003:
   35  03:4452  0C 15 1E          db      $0c,$15,$1e,$1b,$1a
       03:4455  1B 1A     
   36  03:4457            softenve_lp_003:
   37  03:4457  17 FF             db      $17,$ff
   38  03:4459            softenve_004:
   39  03:4459  00 00 01          db      $00,$00,$01,$01,$01,$01,$01,$02
       03:445C  01 01 01  
       03:445F  01 02     
   40  03:4461  02 02 02          db      $02,$02,$02,$02,$03,$03,$03,$04
       03:4464  02 03 03  
       03:4467  03 04     
   41  03:4469  04 04 04          db      $04,$04,$04,$05,$05,$05,$05,$06
       03:446C  05 05 05  
       03:446F  05 06     
   42  03:4471  06 07 07          db      $06,$07,$07,$07,$07,$07,$08,$08
       03:4474  07 07 07  
       03:4477  08 08     
   43  03:4479  08 09 09          db      $08,$09,$09,$09,$09,$0a,$0a,$0a
       03:447C  09 09 0A  
       03:447F  0A 0A     
   44  03:4481            softenve_lp_004:
   45  03:4481  0B FF             db      $0b,$ff
   46  03:4483            softenve_005:
   47  03:4483  1E 1A 17          db      $1e,$1a,$17,$16,$15,$14,$13,$12
       03:4486  16 15 14  
       03:4489  13 12     
   48  03:448B  10 0F 0E          db      $10,$0f,$0e,$0d,$0c
       03:448E  0D 0C     
   49  03:4490            softenve_lp_005:
   50  03:4490  0B FF             db      $0b,$ff
   51                     
   52  03:4492            pitchenve_table:
   53  03:4492  9E 44             dw      pitchenve_000
   54  03:4494  A0 44             dw      pitchenve_001
   55  03:4496  A2 44             dw      pitchenve_002
   56  03:4498            pitchenve_lp_table:
   57  03:4498  9E 44             dw      pitchenve_lp_000
   58  03:449A  A0 44             dw      pitchenve_lp_001
   59  03:449C  A2 44             dw      pitchenve_lp_002
   60                     
   61  03:449E            pitchenve_000:
   62  03:449E            pitchenve_lp_000:
   63  03:449E  00 FF             db      $00,$ff
   64  03:44A0            pitchenve_001:
   65  03:44A0            pitchenve_lp_001:
   66  03:44A0  7F FF             db      $7f,$ff
   67  03:44A2            pitchenve_002:
   68  03:44A2            pitchenve_lp_002:
   69  03:44A2  01 FF             db      $01,$ff
   70                     
   71  03:44A4            arpeggio_table:
   72  03:44A4            arpeggio_lp_table:
   73                     
   74                     
   75  03:44A4            lfo_data:
   76  03:44A4            fds_data_table:
   77  03:44A4            fds_effect_select:
   78  03:44A4            fds_4088_data:
   79                     
   80                     
   81  03:44A4            n106_channel:
   82  03:44A4  00                db      0
   83  03:44A5            n106_wave_init:
   84  03:44A5            n106_wave_table:
   85                     
   86                     
   87  03:44A5            vrc7_data_table:
   88                     
   89                     
   90  03:44A5            dpcm_data:
   91                     
   92                     ; begin DPCM samples
   93                     
   94                     ; end DPCM samples
   95                     
   96                     
   97  03:44A5            pce_data_table:
   98  03:44A5  00 00             dw      0
   99  03:44A7  00 00             dw      0
  100  03:44A9  AB 44             dw      pce_002
  101                     
  102  03:44AB            pce_002:
  103  03:44AB  00 02 04          db      $00,$02,$04,$05,$08,$0a,$0c,$0e
       03:44AE  05 08 0A  
       03:44B1  0C 0E     
  104  03:44B3  10 12 13          db      $10,$12,$13,$15,$16,$18,$1b,$1d
       03:44B6  15 16 18  
       03:44B9  1B 1D     
  105  03:44BB  1F 1C 1A          db      $1f,$1c,$1a,$18,$16,$14,$12,$10
       03:44BE  18 16 14  
       03:44C1  12 10     
  106  03:44C3  0F 0D 0B          db      $0f,$0d,$0b,$09,$07,$06,$04,$02
       03:44C6  09 07 06  
       03:44C9  04 02     
  107                     
  108                     
  109  03:44CB            xpcm_data:
  110                     
  111                     
#[4]   turboass.h
  112                             .include        "turboass.h"
    1                     ; Title: TURBOASS
    2                     ; Composer: B-KNOX
    3                     ; Maker: Maker
    4                     ; Programer: PUKE7
    5                     
#[5]   define.inc
    6                             .include "define.inc"
    1           0001      TOTAL_SONGS     equ     $01
    2           0000      SOUND_GENERATOR equ     $00
    3           0004      PTRDPCM         equ      4
    4           0005      PTRFDS          equ      5
    5           0005      PTRVRC7         equ      5
    6           0005      PTRVRC6         equ      5
    7           0005      PTRN106         equ      5
    8           0005      PTRFME7         equ      5
    9           0005      PTRMMC5         equ      5
   10           0005      PTR_TRACK_END           equ      5
   11           0000      PITCH_CORRECTION                equ      0
   12           0000      DPCM_RESTSTOP           equ      0
   13           0000      DPCM_BANKSWITCH         equ      0
   14           0001      DPCM_EXTRA_BANK_START           equ      1
   15           0001      BANK_MAX_IN_4KB         equ     (0 + 0)*2+1
   16           0001      ALLOW_BANK_SWITCH               equ     1
   17                     BANKSWITCH_INIT_MACRO   .macro
   18                             db      0,1,0,0,0,0,0,0
   19                             .endm
   20                     TITLE   .macro
   21                             db      $54, $55, $52, $42, $4f, $41, $53, $53
   22                             db      $00, $00, $00, $00, $00, $00, $00, $00
   23                             db      $00, $00, $00, $00, $00, $00, $00, $00
   24                             db      $00, $00, $00, $00, $00, $00, $00, $00
   25                             .endm
   26                     COMPOSER        .macro
   27                             db      $42, $2d, $4b, $4e, $4f, $58, $00, $00
   28                             db      $00, $00, $00, $00, $00, $00, $00, $00
   29                             db      $00, $00, $00, $00, $00, $00, $00, $00
   30                             db      $00, $00, $00, $00, $00, $00, $00, $00
   31                             .endm
   32                     MAKER   .macro
   33                             db      $4d, $61, $6b, $65, $72, $00, $00, $00
   34                             db      $00, $00, $00, $00, $00, $00, $00, $00
   35                             db      $00, $00, $00, $00, $00, $00, $00, $00
   36                             db      $00, $00, $00, $00, $00, $00, $00, $00
   37                             .endm
   38                     
   39                     
#[4]   turboass.h
    7           0000              .if TOTAL_SONGS > 1
   14                             .endif ; TOTAL_SONGS > 1
   15  03:44CB            sound_data_table:
   16  03:44CB  EF 44             dw      song_000_00
   17  03:44CD  21 45             dw      song_000_01
   18  03:44CF  53 45             dw      song_000_02
   19  03:44D1  85 45             dw      song_000_03
   20  03:44D3  B3 45             dw      song_000_04
   21  03:44D5  1B 46             dw      song_000_05
   22           0001              .if (ALLOW_BANK_SWITCH)
   23  03:44D7            sound_data_bank:
   24  03:44D7  03                db      bank(song_000_00)
   25  03:44D8  03                db      bank(song_000_01)
   26  03:44D9  03                db      bank(song_000_02)
   27  03:44DA  03                db      bank(song_000_03)
   28  03:44DB  03                db      bank(song_000_04)
   29  03:44DC  03                db      bank(song_000_05)
   30  03:44DD            loop_point_table:
   31  03:44DD  1B 45             dw      song_000_00_lp
   32  03:44DF  4D 45             dw      song_000_01_lp
   33  03:44E1  7F 45             dw      song_000_02_lp
   34  03:44E3  AD 45             dw      song_000_03_lp
   35  03:44E5  15 46             dw      song_000_04_lp
   36  03:44E7  9B 48             dw      song_000_05_lp
   37  03:44E9            loop_point_bank:
   38  03:44E9  03                db      bank(song_000_00_lp)
   39  03:44EA  03                db      bank(song_000_01_lp)
   40  03:44EB  03                db      bank(song_000_02_lp)
   41  03:44EC  03                db      bank(song_000_03_lp)
   42  03:44ED  03                db      bank(song_000_04_lp)
   43  03:44EE  03                db      bank(song_000_05_lp)
   44                     
   45                             .endif
   46                     
   47  03:44EF            song_000_00:    ;Trk A
   48  03:44EF  FD 9F F1          db      $fd,$9f,$f1,$07,$fd,$03,$fd,$04 ;Trk A; turboass.mml: 35
       03:44F2  07 FD 03  
       03:44F5  FD 04     
   49  03:44F7  FE 80 32          db      $fe,$80,$32,$83,$34,$83,$39,$83 ;Trk A; turboass.mml: 96
       03:44FA  83 34 83  
       03:44FD  39 83     
   50  03:44FF  3B 83 32          db      $3b,$83,$32,$83,$34,$82,$39,$83 ;Trk A; turboass.mml: 96
       03:4502  83 34 82  
       03:4505  39 83     
   51  03:4507  37 83 32          db      $37,$83,$32,$83,$34,$83,$39,$83 ;Trk A; turboass.mml: 100
       03:450A  83 34 83  
       03:450D  39 83     
   52  03:450F  3B 83 32          db      $3b,$83,$32,$83,$34,$83,$39,$83 ;Trk A; turboass.mml: 104
       03:4512  83 34 83  
       03:4515  39 83     
   53  03:4517  37 83 39          db      $37,$83,$39,$82
       03:451A  82        
   54  03:451B            song_000_00_lp:
   55  03:451B  FC FF EE          db      $fc,$ff,$ee
   56  03:451E  03                db      bank(song_000_00_lp)
   57  03:451F  1B 45             dw      song_000_00_lp
   58                     
   59                     
   60  03:4521            song_000_01:    ;Trk B
   61  03:4521  FD 9F F1          db      $fd,$9f,$f1,$08,$fd,$02,$fd,$04 ;Trk B; turboass.mml: 35
       03:4524  08 FD 02  
       03:4527  FD 04     
   62  03:4529  FE 80 35          db      $fe,$80,$35,$83,$37,$83,$30,$83 ;Trk B; turboass.mml: 97
       03:452C  83 37 83  
       03:452F  30 83     
   63  03:4531  32 83 35          db      $32,$83,$35,$83,$37,$82,$30,$83 ;Trk B; turboass.mml: 97
       03:4534  83 37 82  
       03:4537  30 83     
   64  03:4539  2B 83 25          db      $2b,$83,$25,$83,$27,$83,$20,$83 ;Trk B; turboass.mml: 101
       03:453C  83 27 83  
       03:453F  20 83     
   65  03:4541  22 83 25          db      $22,$83,$25,$83,$27,$83,$20,$83 ;Trk B; turboass.mml: 105
       03:4544  83 27 83  
       03:4547  20 83     
   66  03:4549  3B 83 20          db      $3b,$83,$20,$82
       03:454C  82        
   67  03:454D            song_000_01_lp:
   68  03:454D  FC FF EE          db      $fc,$ff,$ee
   69  03:4550  03                db      bank(song_000_01_lp)
   70  03:4551  4D 45             dw      song_000_01_lp
   71                     
   72                     
   73  03:4553            song_000_02:    ;Trk C
   74  03:4553  FD 9F F1          db      $fd,$9f,$f1,$08,$fd,$02,$fd,$04 ;Trk C; turboass.mml: 35
       03:4556  08 FD 02  
       03:4559  FD 04     
   75  03:455B  39 83 3B          db      $39,$83,$3b,$83,$34,$83,$35,$83 ;Trk C; turboass.mml: 98
       03:455E  83 34 83  
       03:4561  35 83     
   76  03:4563  39 83 3B          db      $39,$83,$3b,$82,$34,$83,$22,$42 ;Trk C; turboass.mml: 102
       03:4566  82 34 83  
       03:4569  22 42     
   77  03:456B  20 41 29          db      $20,$41,$29,$83,$2b,$83,$24,$83 ;Trk C; turboass.mml: 102
       03:456E  83 2B 83  
       03:4571  24 83     
   78  03:4573  25 83 29          db      $25,$83,$29,$83,$2b,$83,$24,$83 ;Trk C; turboass.mml: 106
       03:4576  83 2B 83  
       03:4579  24 83     
   79  03:457B  32 83 24          db      $32,$83,$24,$82
       03:457E  82        
   80  03:457F            song_000_02_lp:
   81  03:457F  FC FF EE          db      $fc,$ff,$ee
   82  03:4582  03                db      bank(song_000_02_lp)
   83  03:4583  7F 45             dw      song_000_02_lp
   84                     
   85                     
   86  03:4585            song_000_03:    ;Trk D
   87  03:4585  FD 9F F1          db      $fd,$9f,$f1,$08,$fd,$02,$fd,$04 ;Trk D; turboass.mml: 35
       03:4588  08 FD 02  
       03:458B  FD 04     
   88  03:458D  FC 83 FC          db      $fc,$83,$fc,$83,$fc,$83,$fc,$83 ;Trk D; turboass.mml: 99
       03:4590  83 FC 83  
       03:4593  FC 83     
   89  03:4595  FC 83 FC          db      $fc,$83,$fc,$82,$fc,$83,$fc,$83 ;Trk D; turboass.mml: 103
       03:4598  82 FC 83  
       03:459B  FC 83     
   90  03:459D  FC 83 FC          db      $fc,$83,$fc,$83,$fc,$83,$fc,$83 ;Trk D; turboass.mml: 107
       03:45A0  83 FC 83  
       03:45A3  FC 83     
   91  03:45A5  FC 83 FC          db      $fc,$83,$fc,$83,$3b,$83,$3b,$83 ;Trk D; turboass.mml: 111
       03:45A8  83 3B 83  
       03:45AB  3B 83     
   92                     
   93  03:45AD            song_000_03_lp:
   94  03:45AD  FC FF EE          db      $fc,$ff,$ee
   95  03:45B0  03                db      bank(song_000_03_lp)
   96  03:45B1  AD 45             dw      song_000_03_lp
   97                     
   98                     
   99  03:45B3            song_000_04:    ;Trk E
  100  03:45B3  FD 9F F1          db      $fd,$9f,$f1,$08,$fd,$02,$f1,$02 ;Trk E; turboass.mml: 35
       03:45B6  08 FD 02  
       03:45B9  F1 02     
  101  03:45BB  FD 05 FC          db      $fd,$05,$fc,$83,$fc,$83,$fc,$83 ;Trk E; turboass.mml: 39
       03:45BE  83 FC 83  
       03:45C1  FC 83     
  102  03:45C3  FC 83 FC          db      $fc,$83,$fc,$83,$fc,$82,$fc,$83 ;Trk E; turboass.mml: 113
       03:45C6  83 FC 82  
       03:45C9  FC 83     
  103  03:45CB  FC 83 FC          db      $fc,$83,$fc,$83,$fc,$83,$19,$10 ;Trk E; turboass.mml: 113
       03:45CE  83 FC 83  
       03:45D1  19 10     
  104  03:45D3  19 11 FC          db      $19,$11,$fc,$10,$19,$11,$19,$10 ;Trk E; turboass.mml: 114
       03:45D6  10 19 11  
       03:45D9  19 10     
  105  03:45DB  FC 10 1B          db      $fc,$10,$1b,$11,$1b,$10,$fc,$10 ;Trk E; turboass.mml: 114
       03:45DE  11 1B 10  
       03:45E1  FC 10     
  106  03:45E3  17 11 17          db      $17,$11,$17,$10,$fc,$10,$17,$11 ;Trk E; turboass.mml: 115
       03:45E6  10 FC 10  
       03:45E9  17 11     
  107  03:45EB  17 10 12          db      $17,$10,$12,$11,$12,$10,$fc,$10 ;Trk E; turboass.mml: 115
       03:45EE  11 12 10  
       03:45F1  FC 10     
  108  03:45F3  12 11 15          db      $12,$11,$15,$10,$fc,$10,$17,$11 ;Trk E; turboass.mml: 116
       03:45F6  10 FC 10  
       03:45F9  17 11     
  109  03:45FB  14 10 FC          db      $14,$10,$fc,$10,$14,$11,$14,$10 ;Trk E; turboass.mml: 117
       03:45FE  10 14 11  
       03:4601  14 10     
  110  03:4603  FC 11 17          db      $fc,$11,$17,$10,$14,$10,$14,$2c ;Trk E; turboass.mml: 117
       03:4606  10 14 10  
       03:4609  14 2C     
  111  03:460B  14 2C 14          db      $14,$2c,$14,$2b,$fc,$83,$10,$42 ;Trk E; turboass.mml: 119
       03:460E  2B FC 83  
       03:4611  10 42     
  112  03:4613  10 82             db      $10,$82
  113  03:4615            song_000_04_lp:
  114  03:4615  FC FF EE          db      $fc,$ff,$ee
  115  03:4618  03                db      bank(song_000_04_lp)
  116  03:4619  15 46             dw      song_000_04_lp
  117                     
  118                     
  119  03:461B            song_000_05:    ;Trk F
  120  03:461B  FD 9F F2          db      $fd,$9f,$f2,$01,$fd,$00,$f8,$01 ;Trk F; turboass.mml: 35
       03:461E  01 FD 00  
       03:4621  F8 01     
  121  03:4623  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 65
       03:4626  02 FD 01  
       03:4629  20 10     
  122  03:462B  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$09 ;Trk F; turboass.mml: 66
       03:462E  01 FD 00  
       03:4631  1B 09     
  123  03:4633  1B 08 F8          db      $1b,$08,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 66
       03:4636  02 F2 01  
       03:4639  FD 02     
  124  03:463B  12 10 F8          db      $12,$10,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 67
       03:463E  00 F2 01  
       03:4641  FD 00     
  125  03:4643  1B 10 F8          db      $1b,$10,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 68
       03:4646  01 F2 00  
       03:4649  F1 02     
  126  03:464B  FD 01 20          db      $fd,$01,$20,$11,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 65
       03:464E  11 F8 00  
       03:4651  F2 01     
  127  03:4653  FD 00 1B          db      $fd,$00,$1b,$08,$1b,$08,$f8,$02 ;Trk F; turboass.mml: 66
       03:4656  08 1B 08  
       03:4659  F8 02     
  128  03:465B  F2 01 FD          db      $f2,$01,$fd,$02,$12,$11,$f8,$00 ;Trk F; turboass.mml: 67
       03:465E  02 12 11  
       03:4661  F8 00     
  129  03:4663  F2 01 FD          db      $f2,$01,$fd,$00,$1b,$10,$f8,$01 ;Trk F; turboass.mml: 68
       03:4666  00 1B 10  
       03:4669  F8 01     
  130  03:466B  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 65
       03:466E  02 FD 01  
       03:4671  20 10     
  131  03:4673  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 66
       03:4676  01 FD 00  
       03:4679  1B 08     
  132  03:467B  1B 09 F8          db      $1b,$09,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 66
       03:467E  02 F2 01  
       03:4681  FD 02     
  133  03:4683  12 10 F8          db      $12,$10,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 67
       03:4686  00 F2 01  
       03:4689  FD 00     
  134  03:468B  1B 10 F8          db      $1b,$10,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 68
       03:468E  02 F2 01  
       03:4691  FD 02     
  135  03:4693  12 11 F8          db      $12,$11,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 69
       03:4696  00 F2 01  
       03:4699  FD 00     
  136  03:469B  1B 08 1B          db      $1b,$08,$1b,$08,$f8,$02,$f2,$01 ;Trk F; turboass.mml: 70
       03:469E  08 F8 02  
       03:46A1  F2 01     
  137  03:46A3  FD 02 12          db      $fd,$02,$12,$10,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 69
       03:46A6  10 F8 00  
       03:46A9  F2 01     
  138  03:46AB  FD 00 1B          db      $fd,$00,$1b,$09,$1b,$08,$f8,$01 ;Trk F; turboass.mml: 70
       03:46AE  09 1B 08  
       03:46B1  F8 01     
  139  03:46B3  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 65
       03:46B6  02 FD 01  
       03:46B9  20 10     
  140  03:46BB  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 66
       03:46BE  01 FD 00  
       03:46C1  1B 08     
  141  03:46C3  1B 09 F8          db      $1b,$09,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 66
       03:46C6  02 F2 01  
       03:46C9  FD 02     
  142  03:46CB  12 10 F8          db      $12,$10,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 67
       03:46CE  00 F2 01  
       03:46D1  FD 00     
  143  03:46D3  1B 10 F8          db      $1b,$10,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 68
       03:46D6  01 F2 00  
       03:46D9  F1 02     
  144  03:46DB  FD 01 20          db      $fd,$01,$20,$11,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 65
       03:46DE  11 F8 00  
       03:46E1  F2 01     
  145  03:46E3  FD 00 1B          db      $fd,$00,$1b,$08,$1b,$08,$f8,$02 ;Trk F; turboass.mml: 66
       03:46E6  08 1B 08  
       03:46E9  F8 02     
  146  03:46EB  F2 01 FD          db      $f2,$01,$fd,$02,$12,$10,$f8,$00 ;Trk F; turboass.mml: 67
       03:46EE  02 12 10  
       03:46F1  F8 00     
  147  03:46F3  F2 01 FD          db      $f2,$01,$fd,$00,$1b,$11,$f8,$01 ;Trk F; turboass.mml: 68
       03:46F6  00 1B 11  
       03:46F9  F8 01     
  148  03:46FB  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 65
       03:46FE  02 FD 01  
       03:4701  20 10     
  149  03:4703  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 66
       03:4706  01 FD 00  
       03:4709  1B 08     
  150  03:470B  1B 08 F8          db      $1b,$08,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 66
       03:470E  02 F2 01  
       03:4711  FD 02     
  151  03:4713  12 11 F8          db      $12,$11,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 67
       03:4716  00 F2 01  
       03:4719  FD 00     
  152  03:471B  1B 10 F8          db      $1b,$10,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 68
       03:471E  02 F2 01  
       03:4721  FD 02     
  153  03:4723  12 11 F8          db      $12,$11,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 69
       03:4726  00 F2 01  
       03:4729  FD 00     
  154  03:472B  1B 08 1B          db      $1b,$08,$1b,$08,$f8,$02,$f2,$01 ;Trk F; turboass.mml: 70
       03:472E  08 F8 02  
       03:4731  F2 01     
  155  03:4733  FD 02 12          db      $fd,$02,$12,$10,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 69
       03:4736  10 F8 00  
       03:4739  F2 01     
  156  03:473B  FD 00 1B          db      $fd,$00,$1b,$08,$1b,$09,$f8,$01 ;Trk F; turboass.mml: 70
       03:473E  08 1B 09  
       03:4741  F8 01     
  157  03:4743  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 72
       03:4746  02 FD 01  
       03:4749  20 10     
  158  03:474B  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 73
       03:474E  01 FD 00  
       03:4751  1B 08     
  159  03:4753  1B 08 F8          db      $1b,$08,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 73
       03:4756  02 F2 01  
       03:4759  FD 02     
  160  03:475B  12 11 F8          db      $12,$11,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 74
       03:475E  00 F2 01  
       03:4761  FD 00     
  161  03:4763  1B 10 F8          db      $1b,$10,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 75
       03:4766  01 F2 00  
       03:4769  F1 02     
  162  03:476B  FD 01 20          db      $fd,$01,$20,$10,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 72
       03:476E  10 F8 00  
       03:4771  F2 01     
  163  03:4773  FD 00 1B          db      $fd,$00,$1b,$09,$1b,$08,$f8,$02 ;Trk F; turboass.mml: 73
       03:4776  09 1B 08  
       03:4779  F8 02     
  164  03:477B  F2 01 FD          db      $f2,$01,$fd,$02,$12,$10,$f8,$00 ;Trk F; turboass.mml: 74
       03:477E  02 12 10  
       03:4781  F8 00     
  165  03:4783  F2 01 FD          db      $f2,$01,$fd,$00,$1b,$11,$f8,$01 ;Trk F; turboass.mml: 75
       03:4786  00 1B 11  
       03:4789  F8 01     
  166  03:478B  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 72
       03:478E  02 FD 01  
       03:4791  20 10     
  167  03:4793  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 73
       03:4796  01 FD 00  
       03:4799  1B 08     
  168  03:479B  1B 08 F8          db      $1b,$08,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 73
       03:479E  02 F2 01  
       03:47A1  FD 02     
  169  03:47A3  12 11 F8          db      $12,$11,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 74
       03:47A6  00 F2 01  
       03:47A9  FD 00     
  170  03:47AB  1B 10 F8          db      $1b,$10,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 75
       03:47AE  01 F2 00  
       03:47B1  F1 02     
  171  03:47B3  FD 01 20          db      $fd,$01,$20,$10,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 76
       03:47B6  10 F8 00  
       03:47B9  F2 01     
  172  03:47BB  FD 00 1B          db      $fd,$00,$1b,$09,$1b,$08,$f8,$01 ;Trk F; turboass.mml: 77
       03:47BE  09 1B 08  
       03:47C1  F8 01     
  173  03:47C3  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 76
       03:47C6  02 FD 01  
       03:47C9  20 10     
  174  03:47CB  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 77
       03:47CE  01 FD 00  
       03:47D1  1B 08     
  175  03:47D3  1B 08 F8          db      $1b,$08,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 77
       03:47D6  01 F2 00  
       03:47D9  F1 02     
  176  03:47DB  FD 01 20          db      $fd,$01,$20,$11,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 79
       03:47DE  11 F8 00  
       03:47E1  F2 01     
  177  03:47E3  FD 00 1B          db      $fd,$00,$1b,$08,$1b,$08,$f8,$02 ;Trk F; turboass.mml: 80
       03:47E6  08 1B 08  
       03:47E9  F8 02     
  178  03:47EB  F2 01 FD          db      $f2,$01,$fd,$02,$12,$11,$f8,$00 ;Trk F; turboass.mml: 81
       03:47EE  02 12 11  
       03:47F1  F8 00     
  179  03:47F3  F2 01 FD          db      $f2,$01,$fd,$00,$1b,$10,$f8,$01 ;Trk F; turboass.mml: 82
       03:47F6  00 1B 10  
       03:47F9  F8 01     
  180  03:47FB  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 79
       03:47FE  02 FD 01  
       03:4801  20 10     
  181  03:4803  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 80
       03:4806  01 FD 00  
       03:4809  1B 08     
  182  03:480B  1B 09 F8          db      $1b,$09,$f8,$02,$f2,$01,$fd,$02 ;Trk F; turboass.mml: 80
       03:480E  02 F2 01  
       03:4811  FD 02     
  183  03:4813  12 10 F8          db      $12,$10,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 81
       03:4816  00 F2 01  
       03:4819  FD 00     
  184  03:481B  1B 10 F8          db      $1b,$10,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 82
       03:481E  01 F2 00  
       03:4821  F1 02     
  185  03:4823  FD 01 20          db      $fd,$01,$20,$11,$f8,$00,$f2,$01 ;Trk F; turboass.mml: 79
       03:4826  11 F8 00  
       03:4829  F2 01     
  186  03:482B  FD 00 1B          db      $fd,$00,$1b,$08,$1b,$08,$f8,$02 ;Trk F; turboass.mml: 80
       03:482E  08 1B 08  
       03:4831  F8 02     
  187  03:4833  F2 01 FD          db      $f2,$01,$fd,$02,$12,$10,$f8,$00 ;Trk F; turboass.mml: 81
       03:4836  02 12 10  
       03:4839  F8 00     
  188  03:483B  F2 01 FD          db      $f2,$01,$fd,$00,$1b,$11,$f8,$01 ;Trk F; turboass.mml: 82
       03:483E  00 1B 11  
       03:4841  F8 01     
  189  03:4843  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$20,$10 ;Trk F; turboass.mml: 83
       03:4846  02 FD 01  
       03:4849  20 10     
  190  03:484B  F8 00 F2          db      $f8,$00,$f2,$01,$fd,$00,$1b,$08 ;Trk F; turboass.mml: 84
       03:484E  01 FD 00  
       03:4851  1B 08     
  191  03:4853  1B 09 F8          db      $1b,$09,$f8,$01,$f2,$00,$f1,$02 ;Trk F; turboass.mml: 84
       03:4856  01 F2 00  
       03:4859  F1 02     
  192  03:485B  FD 01 20          db      $fd,$01,$20,$08,$20,$08,$20,$10 ;Trk F; turboass.mml: 85
       03:485E  08 20 08  
       03:4861  20 10     
  193  03:4863  F8 01 F2          db      $f8,$01,$f2,$00,$f1,$02,$fd,$01 ;Trk F; turboass.mml: 87
       03:4866  00 F1 02  
       03:4869  FD 01     
  194  03:486B  20 83 FC          db      $20,$83,$fc,$83,$fc,$83,$fc,$83 ;Trk F; turboass.mml: 87
       03:486E  83 FC 83  
       03:4871  FC 83     
  195  03:4873  FC 83 FC          db      $fc,$83,$fc,$83,$fc,$83,$fc,$41 ;Trk F; turboass.mml: 89
       03:4876  83 FC 83  
       03:4879  FC 41     
  196  03:487B  F8 01 F2          db      $f8,$01,$f2,$00,$f1,$02,$fd,$01 ;Trk F; turboass.mml: 90
       03:487E  00 F1 02  
       03:4881  FD 01     
  197  03:4883  24 10 F8          db      $24,$10,$f8,$00,$f2,$01,$fd,$00 ;Trk F; turboass.mml: 90
       03:4886  00 F2 01  
       03:4889  FD 00     
  198  03:488B  1B 11 1B          db      $1b,$11,$1b,$10,$1b,$11,$f8,$01 ;Trk F; turboass.mml: 91
       03:488E  10 1B 11  
       03:4891  F8 01     
  199  03:4893  F2 00 F1          db      $f2,$00,$f1,$02,$fd,$01,$24,$82 ;Trk F; turboass.mml: 132
       03:4896  02 FD 01  
       03:4899  24 82     
  200                     
  201  03:489B            song_000_05_lp:
  202  03:489B  FC FF EE          db      $fc,$ff,$ee
  203  03:489E  03                db      bank(song_000_05_lp)
  204  03:489F  9B 48             dw      song_000_05_lp
  205                     
#[3]   effect.h
#[2]   main.s
   40                     ;------------------------------
   41                     ; PCM timer routines
   42           FD4D              .code
   43           0000              .bank START_BANK
   44  00:FD4D            _timer_pcm
   45  00:FD4D  48                pha
   46  00:FD4E  DA                phx
   47  00:FD4F  5A                phy
   48  00:FD50  A5 03             lda     <__temp
   49  00:FD52  85 1C             sta     <__tmr_tmp
   50  00:FD54  A5 04             lda     <__temp+1
   51  00:FD56  85 1D             sta     <__tmr_tmp+1
   52                     ;       lda     <__temp+2
   53                     ;       sta     <__tmr_tmp+2
   54                     ;       lda     <__temp+3
   55                     ;       sta     <__tmr_tmp+3
   56  00:FD58  A5 0B             lda     <__ptr
   57  00:FD5A  85 24             sta     <__tmr_ptr
   58  00:FD5C  A5 0C             lda     <__ptr+1
   59  00:FD5E  85 25             sta     <__tmr_ptr+1
   60  00:FD60  A5 FA             lda     <_bx
   61  00:FD62  85 26             sta     <__tmr_bx
   62  00:FD64  A5 FB             lda     <_bx+1
   63  00:FD66  85 27             sta     <__tmr_bx+1
   64  00:FD68  43 20             tma     #page(_pcm_intr)
   65  00:FD6A  48                pha
   66                             map     _pcm_intr
       00:FD6B  A9 05              lda   #bank(_pcm_intr)        ; addressable memory
       00:FD6D  53 20              tam   #page(_pcm_intr)
   67  00:FD6F  20 D0 A0          jsr     _pcm_intr
   68  00:FD72  68                pla
   69  00:FD73  53 20             tam     #page(_pcm_intr)
   70  00:FD75  A5 1C             lda     <__tmr_tmp
   71  00:FD77  85 03             sta     <__temp
   72  00:FD79  A5 1D             lda     <__tmr_tmp+1
   73  00:FD7B  85 04             sta     <__temp+1
   74                     ;       lda     <__tmr_tmp+2
   75                     ;       sta     <__temp+2
   76                     ;       lda     <__tmr_tmp+3
   77                     ;       sta     <__temp+3
   78  00:FD7D  A5 24             lda     <__tmr_ptr
   79  00:FD7F  85 0B             sta     <__ptr
   80  00:FD81  A5 25             lda     <__tmr_ptr+1
   81  00:FD83  85 0C             sta     <__ptr+1
   82  00:FD85  A5 26             lda     <__tmr_bx
   83  00:FD87  85 FA             sta     <_bx
   84  00:FD89  A5 27             lda     <__tmr_bx+1
   85  00:FD8B  85 FB             sta     <_bx+1
   86  00:FD8D  8D 03 14          sta   irq_status
   87  00:FD90  58                cli
   88  00:FD91  7A                ply
   89  00:FD92  FA                plx
   90  00:FD93  68                pla
   91  00:FD94  40                rti
   92  00:FD95            _vsync_drv
   93  00:FD95  A5 03             lda     <__temp
   94  00:FD97  85 28             sta     <__vs_tmp
   95  00:FD99  A5 04             lda     <__temp+1
   96  00:FD9B  85 29             sta     <__vs_tmp+1
   97  00:FD9D  A5 0B             lda     <__ptr
   98  00:FD9F  85 2A             sta     <__vs_ptr
   99  00:FDA1  A5 0C             lda     <__ptr+1
  100  00:FDA3  85 2B             sta     <__vs_ptr+1
  101  00:FDA5  A5 FA             lda     <_bx
  102  00:FDA7  85 2C             sta     <__vs_bx
  103  00:FDA9  A5 FB             lda     <_bx+1
  104  00:FDAB  85 2D             sta     <__vs_bx+1
  105  00:FDAD  43 20             tma     #page(_drv_intr)
  106  00:FDAF  48                pha
  107                             map     _drv_intr
       00:FDB0  A9 08              lda   #bank(_drv_intr)        ; addressable memory
       00:FDB2  53 20              tam   #page(_drv_intr)
  108  00:FDB4  20 00 A0          jsr     _drv_intr
  109  00:FDB7  68                pla
  110  00:FDB8  53 20             tam     #page(_drv_intr)
  111  00:FDBA  A5 28             lda     <__vs_tmp
  112  00:FDBC  85 03             sta     <__temp
  113  00:FDBE  A5 29             lda     <__vs_tmp+1
  114  00:FDC0  85 04             sta     <__temp+1
  115  00:FDC2  A5 2A             lda     <__vs_ptr
  116  00:FDC4  85 0B             sta     <__ptr
  117  00:FDC6  A5 2B             lda     <__vs_ptr+1
  118  00:FDC8  85 0C             sta     <__ptr+1
  119  00:FDCA  A5 2C             lda     <__vs_bx
  120  00:FDCC  85 FA             sta     <_bx
  121  00:FDCE  A5 2D             lda     <__vs_bx+1
  122  00:FDD0  85 FB             sta     <_bx+1
  123  00:FDD2  60                rts
  124           201C                 .zp
  125  --:201C            __tmr_tmp   .ds 8
  126  --:2024            __tmr_ptr   .ds 2
  127  --:2026            __tmr_bx    .ds 2
  128  --:2028            __vs_tmp   .ds 2
  129  --:202A            __vs_ptr   .ds 2
  130  --:202C            __vs_bx    .ds 2
  131                             ; restore segment and bank
  132           FDD3              .code
  133           0000              .bank START_BANK
  134  05:4000                    .proc _pcm_on
  135                             __pushw
                                 __submi  2,__stack
       05:A000  48                 pha
       05:A001  38                 sec
       05:A002  A5 00              lda    <__stack
       05:A004  E9 02              sbc    #low(2)
       05:A006  85 00              sta    <__stack
       05:A008  A5 01              lda    <__stack+1
       05:A00A  E9 00              sbc    #high(2)
       05:A00C  85 01              sta    <__stack+1
       05:A00E  68                 pla
       05:A00F  22                 sax
       05:A010  92 00              sta    [__stack]
       05:A012  22                 sax
       05:A013  A0 01              ldy    #1
       05:A015  91 00              sta    [__stack],Y
  136                             __ldb   _xpcm_mode
                0000              .if (1 = 2)
                                  .else
       05:A017  AE 61 2A           ldx    _xpcm_mode
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00727
                          ;        dec    A
                          ;.x_00727:
       05:A01A  62                 cla    ; unsigned
                                  .endif
  137                             __notw
       05:A01B  86 03              stx    <__temp
       05:A01D  05 03              ora    <__temp
       05:A01F  82                 clx
       05:A020  D0 01              bne    .x00728
       05:A022  E8                 inx
       05:A023  62        .x00728     cla
  138                             __tstw
                                   ; pha
       05:A024  86 03              stx    <__temp
       05:A026  05 03              ora    <__temp
                                   ; pla
  139                             __lbeq  LL2
       05:A028  D0 03              bne    .x00730
       05:A02A  4C 5C A0           jmp    LL2
       05:A02D            .x00730
  140                             __ldwi  2048
       05:A02D  A2 00              ldx    #low(2048)
       05:A02F  A9 08              lda    #high(2048)
  141                             __stw   _bx
       05:A031  8E FA 20           stx    _bx
       05:A034  8D FB 20           sta    _bx+1
  142                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:A037  B2 00               lda   [__sp]
       05:A039  AA                  tax
       05:A03A  A0 01               ldy   #1
       05:A03C  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  143  05:A03E  20 A4 FB            call  _poke.2
  144                             __ldwi  2052
       05:A041  A2 04              ldx    #low(2052)
       05:A043  A9 08              lda    #high(2052)
  145                             __stw   _bx
       05:A045  8E FA 20           stx    _bx
       05:A048  8D FB 20           sta    _bx+1
  146                             __ldwi  223
       05:A04B  A2 DF              ldx    #low(223)
       05:A04D  A9 00              lda    #high(223)
  147  05:A04F  20 A4 FB            call  _poke.2
  148  05:A052  20 8F A2            call  _ena_irq_tmr
  149                             __ldwi  1
       05:A055  A2 01              ldx    #low(1)
       05:A057  A9 00              lda    #high(1)
  150  05:A059  8E 61 2A            stx   _xpcm_mode
  151  05:A05C            LL2:
  152                     
  153  05:A05C            LL1:
  154                     
  155                             __addmi 2,__stack
       05:A05C  48                 pha
       05:A05D  18                 clc
       05:A05E  A5 00              lda    <__stack
       05:A060  69 02              adc    #low(2)
       05:A062  85 00              sta    <__stack
       05:A064  A5 01              lda    <__stack+1
       05:A066  69 00              adc    #high(2)
       05:A068  85 01              sta    <__stack+1
       05:A06A  68                 pla
  156  05:A06B  60                  rts
  157                             .endp
  158                     
  159  05:406C                    .proc _pcm_off
  160                             __ldb   _xpcm_mode
                0000              .if (1 = 2)
                                  .else
       05:A06C  AE 61 2A           ldx    _xpcm_mode
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00740
                          ;        dec    A
                          ;.x_00740:
       05:A06F  62                 cla    ; unsigned
                                  .endif
  161                             __tstw
                                   ; pha
       05:A070  86 03              stx    <__temp
       05:A072  05 03              ora    <__temp
                                   ; pla
  162                             __lbeq  LL4
       05:A074  D0 03              bne    .x00742
       05:A076  4C 83 A0           jmp    LL4
       05:A079            .x00742
  163  05:A079  20 92 A2            call  _dis_irq_tmr
  164                             __ldwi  0
       05:A07C  A2 00              ldx    #low(0)
       05:A07E  A9 00              lda    #high(0)
  165  05:A080  8E 61 2A            stx   _xpcm_mode
  166  05:A083            LL4:
  167                     
  168  05:A083            LL3:
  169                     
  170  05:A083  60                  rts
  171                             .endp
  172                     
  173  05:4084                    .proc _pcm_set
  174                             __pushw
                                 __submi  2,__stack
       05:A084  48                 pha
       05:A085  38                 sec
       05:A086  A5 00              lda    <__stack
       05:A088  E9 02              sbc    #low(2)
       05:A08A  85 00              sta    <__stack
       05:A08C  A5 01              lda    <__stack+1
       05:A08E  E9 00              sbc    #high(2)
       05:A090  85 01              sta    <__stack+1
       05:A092  68                 pla
       05:A093  22                 sax
       05:A094  92 00              sta    [__stack]
       05:A096  22                 sax
       05:A097  A0 01              ldy    #1
       05:A099  91 00              sta    [__stack],Y
  175                             __ldwi  2048
       05:A09B  A2 00              ldx    #low(2048)
       05:A09D  A9 08              lda    #high(2048)
  176                             __stw   _bx
       05:A09F  8E FA 20           stx    _bx
       05:A0A2  8D FB 20           sta    _bx+1
  177                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:A0A5  B2 00               lda   [__sp]
       05:A0A7  AA                  tax
       05:A0A8  A0 01               ldy   #1
       05:A0AA  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  178  05:A0AC  20 A4 FB            call  _poke.2
  179                             __ldwi  2052
       05:A0AF  A2 04              ldx    #low(2052)
       05:A0B1  A9 08              lda    #high(2052)
  180                             __stw   _bx
       05:A0B3  8E FA 20           stx    _bx
       05:A0B6  8D FB 20           sta    _bx+1
  181                             __ldwi  0
       05:A0B9  A2 00              ldx    #low(0)
       05:A0BB  A9 00              lda    #high(0)
  182  05:A0BD  20 A4 FB            call  _poke.2
  183  05:A0C0            LL5:
  184                     
  185                             __addmi 2,__stack
       05:A0C0  48                 pha
       05:A0C1  18                 clc
       05:A0C2  A5 00              lda    <__stack
       05:A0C4  69 02              adc    #low(2)
       05:A0C6  85 00              sta    <__stack
       05:A0C8  A5 01              lda    <__stack+1
       05:A0CA  69 00              adc    #high(2)
       05:A0CC  85 01              sta    <__stack+1
       05:A0CE  68                 pla
  186  05:A0CF  60                  rts
  187                             .endp
  188                     
  189  05:40D0                    .proc _pcm_intr
  190                             __addmi -1,__stack
       05:A0D0  48                 pha
       05:A0D1  18                 clc
       05:A0D2  A5 00              lda    <__stack
       05:A0D4  69 FF              adc    #low(-1)
       05:A0D6  85 00              sta    <__stack
       05:A0D8  A5 01              lda    <__stack+1
       05:A0DA  69 FF              adc    #high(-1)
       05:A0DC  85 01              sta    <__stack+1
       05:A0DE  68                 pla
  191                             __ldb   _xpcm_mode
                0000              .if (1 = 2)
                                  .else
       05:A0DF  AE 61 2A           ldx    _xpcm_mode
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00755
                          ;        dec    A
                          ;.x_00755:
       05:A0E2  62                 cla    ; unsigned
                                  .endif
  192                             __tstw
                                   ; pha
       05:A0E3  86 03              stx    <__temp
       05:A0E5  05 03              ora    <__temp
                                   ; pla
  193                             __lbeq  LL7
       05:A0E7  D0 03              bne    .x00757
       05:A0E9  4C 7F A2           jmp    LL7
       05:A0EC            .x00757
  194                             __ldb   _xpcm_sp
                0000              .if (1 = 2)
                                  .else
       05:A0EC  AE 63 2A           ldx    _xpcm_sp
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00759
                          ;        dec    A
                          ;.x_00759:
       05:A0EF  62                 cla    ; unsigned
                                  .endif
  195                             __andwi 1
       05:A0F0  22                 sax
       05:A0F1  29 01              and    #low(1)
       05:A0F3  22                 sax
       05:A0F4  29 00              and    #high(1)
  196                             __tstw
                                   ; pha
       05:A0F6  86 03              stx    <__temp
       05:A0F8  05 03              ora    <__temp
                                   ; pla
  197                             __lbeq  LL8
       05:A0FA  D0 03              bne    .x00762
       05:A0FC  4C 6E A1           jmp    LL8
       05:A0FF            .x00762
  198                             __pea_s 0
                                   ; (bytes : 25, cycles : 44)
                          
       05:A0FF  A5 00              lda    <__sp
       05:A101  38                 sec
       05:A102  E9 02              sbc    #2
       05:A104  B0 02              bcs    .x_00763
       05:A106  C6 01              dec    <__sp+1
       05:A108  85 00     .x_00763:   sta    <__sp
       05:A10A  18                 clc
       05:A10B  69 02              adc    #LOW(0+2)
       05:A10D  92 00              sta    [__sp]
       05:A10F  AA                 tax
       05:A110  A5 01              lda    <__sp+1
       05:A112  69 00              adc    #HIGH(0+2)
       05:A114  A0 01              ldy    #1
       05:A116  91 00              sta    [__sp],Y
  199                             __ldw   _xpcm_addr
                0000              .if (1 = 2)
                                  .else
       05:A118  AE 5C 2A           ldx    _xpcm_addr
       05:A11B  AD 5D 2A           lda    _xpcm_addr+1
                                  .endif
  200  05:A11E  20 B1 FB            call  _peek
  201                             __pushw
                                 __submi  2,__stack
       05:A121  48                 pha
       05:A122  38                 sec
       05:A123  A5 00              lda    <__stack
       05:A125  E9 02              sbc    #low(2)
       05:A127  85 00              sta    <__stack
       05:A129  A5 01              lda    <__stack+1
       05:A12B  E9 00              sbc    #high(2)
       05:A12D  85 01              sta    <__stack+1
       05:A12F  68                 pla
       05:A130  22                 sax
       05:A131  92 00              sta    [__stack]
       05:A133  22                 sax
       05:A134  A0 01              ldy    #1
       05:A136  91 00              sta    [__stack],Y
  202                             __ldwi  3
       05:A138  A2 03              ldx    #low(3)
       05:A13A  A9 00              lda    #high(3)
  203  05:A13C  20 89 EA            jsr   asr
  204                             __andwi 30
       05:A13F  22                 sax
       05:A140  29 1E              and    #low(30)
       05:A142  22                 sax
       05:A143  29 00              and    #high(30)
  205                             __stbps
                                 __stw    <__temp
       05:A145  86 03              stx    <__temp
       05:A147  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A149  B2 00              lda    [__stack]
       05:A14B  AA                 tax
       05:A14C  A0 01              ldy    #1
       05:A14E  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A150  86 0B              stx    <__ptr
       05:A152  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A154  A6 03              ldx    <__temp
       05:A156  A5 04              lda    <__temp+1
                                  .endif
       05:A158  22                 sax
       05:A159  92 0B              sta    [__ptr]
       05:A15B  22                 sax
                                 __addmi  2,__stack
       05:A15C  48                 pha
       05:A15D  18                 clc
       05:A15E  A5 00              lda    <__stack
       05:A160  69 02              adc    #low(2)
       05:A162  85 00              sta    <__stack
       05:A164  A5 01              lda    <__stack+1
       05:A166  69 00              adc    #high(2)
       05:A168  85 01              sta    <__stack+1
       05:A16A  68                 pla
  206                             __lbra  LL9
       05:A16B  4C 11 A2           jmp    LL9
  207  05:A16E            LL8:
  208                     
  209                             __pea_s 0
                                   ; (bytes : 25, cycles : 44)
                          
       05:A16E  A5 00              lda    <__sp
       05:A170  38                 sec
       05:A171  E9 02              sbc    #2
       05:A173  B0 02              bcs    .x_00776
       05:A175  C6 01              dec    <__sp+1
       05:A177  85 00     .x_00776:   sta    <__sp
       05:A179  18                 clc
       05:A17A  69 02              adc    #LOW(0+2)
       05:A17C  92 00              sta    [__sp]
       05:A17E  AA                 tax
       05:A17F  A5 01              lda    <__sp+1
       05:A181  69 00              adc    #HIGH(0+2)
       05:A183  A0 01              ldy    #1
       05:A185  91 00              sta    [__sp],Y
  210                             __ldw   _xpcm_addr
                0000              .if (1 = 2)
                                  .else
       05:A187  AE 5C 2A           ldx    _xpcm_addr
       05:A18A  AD 5D 2A           lda    _xpcm_addr+1
                                  .endif
  211                             incw    _xpcm_addr
       05:A18D  EE 5C 2A           inc    _xpcm_addr              ; value at stated memory
       05:A190  D0 03              bne    .x_00778           ; location
       05:A192  EE 5D 2A           inc    _xpcm_addr+1
       05:A195            .x_00778:
  212  05:A195  20 B1 FB            call  _peek
  213                             __pushw
                                 __submi  2,__stack
       05:A198  48                 pha
       05:A199  38                 sec
       05:A19A  A5 00              lda    <__stack
       05:A19C  E9 02              sbc    #low(2)
       05:A19E  85 00              sta    <__stack
       05:A1A0  A5 01              lda    <__stack+1
       05:A1A2  E9 00              sbc    #high(2)
       05:A1A4  85 01              sta    <__stack+1
       05:A1A6  68                 pla
       05:A1A7  22                 sax
       05:A1A8  92 00              sta    [__stack]
       05:A1AA  22                 sax
       05:A1AB  A0 01              ldy    #1
       05:A1AD  91 00              sta    [__stack],Y
  214                             __ldwi  1
       05:A1AF  A2 01              ldx    #low(1)
       05:A1B1  A9 00              lda    #high(1)
  215  05:A1B3  20 60 EA            jsr   asl
  216                             __andwi 30
       05:A1B6  22                 sax
       05:A1B7  29 1E              and    #low(30)
       05:A1B9  22                 sax
       05:A1BA  29 00              and    #high(30)
  217                             __stbps
                                 __stw    <__temp
       05:A1BC  86 03              stx    <__temp
       05:A1BE  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A1C0  B2 00              lda    [__stack]
       05:A1C2  AA                 tax
       05:A1C3  A0 01              ldy    #1
       05:A1C5  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A1C7  86 0B              stx    <__ptr
       05:A1C9  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A1CB  A6 03              ldx    <__temp
       05:A1CD  A5 04              lda    <__temp+1
                                  .endif
       05:A1CF  22                 sax
       05:A1D0  92 0B              sta    [__ptr]
       05:A1D2  22                 sax
                                 __addmi  2,__stack
       05:A1D3  48                 pha
       05:A1D4  18                 clc
       05:A1D5  A5 00              lda    <__stack
       05:A1D7  69 02              adc    #low(2)
       05:A1D9  85 00              sta    <__stack
       05:A1DB  A5 01              lda    <__stack+1
       05:A1DD  69 00              adc    #high(2)
       05:A1DF  85 01              sta    <__stack+1
       05:A1E1  68                 pla
  218                             __ldw   _xpcm_len
                0000              .if (1 = 2)
                                  .else
       05:A1E2  AE 5E 2A           ldx    _xpcm_len
       05:A1E5  AD 5F 2A           lda    _xpcm_len+1
                                  .endif
  219                             __tstw
                                   ; pha
       05:A1E8  86 03              stx    <__temp
       05:A1EA  05 03              ora    <__temp
                                   ; pla
  220                             __lbeq  LL10
       05:A1EC  D0 03              bne    .x00791
       05:A1EE  4C 0E A2           jmp    LL10
       05:A1F1            .x00791
  221                             __ldw   _xpcm_len
                0000              .if (1 = 2)
                                  .else
       05:A1F1  AE 5E 2A           ldx    _xpcm_len
       05:A1F4  AD 5F 2A           lda    _xpcm_len+1
                                  .endif
  222                             __subwi 1
       05:A1F7  38                 sec
       05:A1F8  22                 sax
       05:A1F9  E9 01              sbc    #low(1)
       05:A1FB  22                 sax
       05:A1FC  E9 00              sbc    #high(1)
  223                             __stw   _xpcm_len
       05:A1FE  8E 5E 2A           stx    _xpcm_len
       05:A201  8D 5F 2A           sta    _xpcm_len+1
  224                             __addwi 1
       05:A204  18                 clc
       05:A205  22                 sax
       05:A206  69 01              adc    #low(1)
       05:A208  22                 sax
       05:A209  69 00              adc    #high(1)
  225                             __lbra  LL11
       05:A20B  4C 11 A2           jmp    LL11
  226  05:A20E            LL10:
  227                     
  228  05:A20E  20 6C A0            call  _pcm_off
  229  05:A211            LL11:
  230                     
  231  05:A211            LL9:
  232                     
  233                             __ldb   _xpcm_sp
                0000              .if (1 = 2)
                                  .else
       05:A211  AE 63 2A           ldx    _xpcm_sp
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00798
                          ;        dec    A
                          ;.x_00798:
       05:A214  62                 cla    ; unsigned
                                  .endif
  234                             __pushw
                                 __submi  2,__stack
       05:A215  48                 pha
       05:A216  38                 sec
       05:A217  A5 00              lda    <__stack
       05:A219  E9 02              sbc    #low(2)
       05:A21B  85 00              sta    <__stack
       05:A21D  A5 01              lda    <__stack+1
       05:A21F  E9 00              sbc    #high(2)
       05:A221  85 01              sta    <__stack+1
       05:A223  68                 pla
       05:A224  22                 sax
       05:A225  92 00              sta    [__stack]
       05:A227  22                 sax
       05:A228  A0 01              ldy    #1
       05:A22A  91 00              sta    [__stack],Y
  235                             __ldwi  1
       05:A22C  A2 01              ldx    #low(1)
       05:A22E  A9 00              lda    #high(1)
  236                             __eorws
       05:A230  22                 sax
       05:A231  52 00              eor    [__stack]
       05:A233  22                 sax
       05:A234  A0 01              ldy    #1
       05:A236  51 00              eor    [__stack],Y
                                 __addmi  2,__stack
       05:A238  48                 pha
       05:A239  18                 clc
       05:A23A  A5 00              lda    <__stack
       05:A23C  69 02              adc    #low(2)
       05:A23E  85 00              sta    <__stack
       05:A240  A5 01              lda    <__stack+1
       05:A242  69 00              adc    #high(2)
       05:A244  85 01              sta    <__stack+1
       05:A246  68                 pla
  237  05:A247  8E 63 2A            stx   _xpcm_sp
  238                             __ldwi  2048
       05:A24A  A2 00              ldx    #low(2048)
       05:A24C  A9 08              lda    #high(2048)
  239                             __stw   _bx
       05:A24E  8E FA 20           stx    _bx
       05:A251  8D FB 20           sta    _bx+1
  240                             __ldwi  5
       05:A254  A2 05              ldx    #low(5)
       05:A256  A9 00              lda    #high(5)
  241  05:A258  20 A4 FB            call  _poke.2
  242                             __ldwi  2054
       05:A25B  A2 06              ldx    #low(2054)
       05:A25D  A9 08              lda    #high(2054)
  243                             __stw   _bx
       05:A25F  8E FA 20           stx    _bx
       05:A262  8D FB 20           sta    _bx+1
  244                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A265  A0 00              ldy    #0
       05:A267  B1 00              lda    [__sp],Y
       05:A269  AA                 tax
       05:A26A  62                 cla
                          ;        bpl    .x_00809   ; signed
                          ;        dec    A
                          ;.x_00809:
                                  .else
                                  .endif
  245  05:A26B  20 A4 FB            call  _poke.2
  246                             __ldwi  2048
       05:A26E  A2 00              ldx    #low(2048)
       05:A270  A9 08              lda    #high(2048)
  247                             __stw   _bx
       05:A272  8E FA 20           stx    _bx
       05:A275  8D FB 20           sta    _bx+1
  248                             __ldb   _reg_ch
                0000              .if (1 = 2)
                                  .else
       05:A278  AE 87 29           ldx    _reg_ch
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00813
                          ;        dec    A
                          ;.x_00813:
       05:A27B  62                 cla    ; unsigned
                                  .endif
  249  05:A27C  20 A4 FB            call  _poke.2
  250  05:A27F            LL7:
  251                     
  252  05:A27F            LL6:
  253                     
  254                             __addmi 1,__stack
       05:A27F  48                 pha
       05:A280  18                 clc
       05:A281  A5 00              lda    <__stack
       05:A283  69 01              adc    #low(1)
       05:A285  85 00              sta    <__stack
       05:A287  A5 01              lda    <__stack+1
       05:A289  69 00              adc    #high(1)
       05:A28B  85 01              sta    <__stack+1
       05:A28D  68                 pla
  255  05:A28E  60                  rts
  256                             .endp
  257                     
  258  05:428F                .proc _ena_irq_tmr
  259  05:A28F  A7 F5             smb   #2,<irq_m
  260  05:A291  60                rts
  261                             .endp
  262  05:4292                .proc _dis_irq_tmr
  263  05:A292  27 F5             rmb   #2,<irq_m
  264  05:A294  60                rts
  265                             .endp
  266  05:4295                    .proc _set_pcmintr
  267  05:A295  9C 03 14          stz   irq_status
  268                             stw   #_timer_pcm,timer_jmp
       05:A298  A9 4D              lda    LOW_BYTE #_timer_pcm
       05:A29A  8D 04 22           sta    LOW_BYTE timer_jmp
       05:A29D  A9 FD              lda    HIGH_BYTE #_timer_pcm
       05:A29F  8D 05 22           sta    HIGH_BYTE timer_jmp
  269  05:A2A2  27 F5             rmb   #2,<irq_m
  270  05:A2A4  A9 00             lda   #0
  271  05:A2A6  8D 00 0C          sta   timer_cnt
  272  05:A2A9  A9 01             lda   #$1
  273  05:A2AB  8D 01 0C          sta   timer_ctrl
  274  05:A2AE  58                cli
  275  05:A2AF  60                rts
  276                             .endp
  277  05:42B0                    .proc _chg_pcmbank
  278  05:A2B0  8A                txa
  279  05:A2B1  53 08             tam #3
  280  05:A2B3  60                rts
  281                             .endp
  282  05:42B4                    .proc _init_pcmdrv
  283                             __ldwi  0
       05:A2B4  A2 00              ldx    #low(0)
       05:A2B6  A9 00              lda    #high(0)
  284  05:A2B8  8E 63 2A            stx   _xpcm_sp
  285                             __ldwi  0
       05:A2BB  A2 00              ldx    #low(0)
       05:A2BD  A9 00              lda    #high(0)
  286  05:A2BF  8E 62 2A            stx   _xpcm_sw
  287                             __ldwi  0
       05:A2C2  A2 00              ldx    #low(0)
       05:A2C4  A9 00              lda    #high(0)
  288  05:A2C6  8E 61 2A            stx   _xpcm_mode
  289  05:A2C9  20 95 A2            call  _set_pcmintr
  290  05:A2CC            LL12:
  291                     
  292  05:A2CC  60                  rts
  293                             .endp
  294                     
  295  05:42CD                    .proc _chg_cbank
  296  05:A2CD  8A                txa
  297  05:A2CE  53 04             tam #2
  298  05:A2D0  60                rts
  299                             .endp
  300  05:42D1                    .proc _now_cbank
  301  05:A2D1  43 04             tma #2
  302  05:A2D3  AA                tax
  303  05:A2D4  62                cla
  304  05:A2D5  60                rts
  305                             .endp
  306  05:42D6                    .proc _def_cbank
  307  05:A2D6  A9 03             lda #CONST_BANK+_bank_base
  308  05:A2D8  53 04             tam #2
  309  05:A2DA  60                rts
  310                             .endp
  311  05:42DB                    .proc _mixvol
  312                             __pushw
                                 __submi  2,__stack
       05:A2DB  48                 pha
       05:A2DC  38                 sec
       05:A2DD  A5 00              lda    <__stack
       05:A2DF  E9 02              sbc    #low(2)
       05:A2E1  85 00              sta    <__stack
       05:A2E3  A5 01              lda    <__stack+1
       05:A2E5  E9 00              sbc    #high(2)
       05:A2E7  85 01              sta    <__stack+1
       05:A2E9  68                 pla
       05:A2EA  22                 sax
       05:A2EB  92 00              sta    [__stack]
       05:A2ED  22                 sax
       05:A2EE  A0 01              ldy    #1
       05:A2F0  91 00              sta    [__stack],Y
  313                             __ldb   _reg_ch
                0000              .if (1 = 2)
                                  .else
       05:A2F2  AE 87 29           ldx    _reg_ch
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00822
                          ;        dec    A
                          ;.x_00822:
       05:A2F5  62                 cla    ; unsigned
                                  .endif
  314                             __stw   <__temp
       05:A2F6  86 03              stx    <__temp
       05:A2F8  85 04              sta    <__temp+1
  315                             __ldwi  5
       05:A2FA  A2 05              ldx    #low(5)
       05:A2FC  A9 00              lda    #high(5)
  316  05:A2FE  20 FC E8            jsr   eqzp
  317                             __lbeq  LL15
       05:A301  D0 03              bne    .x00825
       05:A303  4C 0A A3           jmp    LL15
       05:A306            .x00825
  318                             __ldb   _xpcm_sw
                0000              .if (1 = 2)
                                  .else
       05:A306  AE 62 2A           ldx    _xpcm_sw
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_00827
                          ;        dec    A
                          ;.x_00827:
       05:A309  62                 cla    ; unsigned
                                  .endif
  319  05:A30A            LL15:
  320                     
  321                             __boolw
       05:A30A  86 03              stx    <__temp
       05:A30C  05 03              ora    <__temp
       05:A30E  82                 clx
       05:A30F  F0 01              beq    .x00828
       05:A311  E8                 inx
       05:A312  62        .x00828     cla
  322                             __tstw
                                   ; pha
       05:A313  86 03              stx    <__temp
       05:A315  05 03              ora    <__temp
                                   ; pla
  323                             __lbeq  LL14
       05:A317  D0 03              bne    .x00830
       05:A319  4C 64 A3           jmp    LL14
       05:A31C            .x00830
  324                             __ldwi  2052
       05:A31C  A2 04              ldx    #low(2052)
       05:A31E  A9 08              lda    #high(2052)
  325                             __stw   _bx
       05:A320  8E FA 20           stx    _bx
       05:A323  8D FB 20           sta    _bx+1
  326                             __ldwi  192
       05:A326  A2 C0              ldx    #low(192)
       05:A328  A9 00              lda    #high(192)
  327                             __pushw
                                 __submi  2,__stack
       05:A32A  48                 pha
       05:A32B  38                 sec
       05:A32C  A5 00              lda    <__stack
       05:A32E  E9 02              sbc    #low(2)
       05:A330  85 00              sta    <__stack
       05:A332  A5 01              lda    <__stack+1
       05:A334  E9 00              sbc    #high(2)
       05:A336  85 01              sta    <__stack+1
       05:A338  68                 pla
       05:A339  22                 sax
       05:A33A  92 00              sta    [__stack]
       05:A33C  22                 sax
       05:A33D  A0 01              ldy    #1
       05:A33F  91 00              sta    [__stack],Y
  328                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A341  A0 02              ldy    #2
       05:A343  B1 00              lda    [__sp],Y
       05:A345  AA                 tax
       05:A346  62                 cla
                          ;        bpl    .x_00836   ; signed
                          ;        dec    A
                          ;.x_00836:
                                  .else
                                  .endif
  329                             __orws
       05:A347  22                 sax
       05:A348  12 00              ora    [__stack]
       05:A34A  22                 sax
       05:A34B  A0 01              ldy    #1
       05:A34D  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       05:A34F  48                 pha
       05:A350  18                 clc
       05:A351  A5 00              lda    <__stack
       05:A353  69 02              adc    #low(2)
       05:A355  85 00              sta    <__stack
       05:A357  A5 01              lda    <__stack+1
       05:A359  69 00              adc    #high(2)
       05:A35B  85 01              sta    <__stack+1
       05:A35D  68                 pla
  330  05:A35E  20 A4 FB            call  _poke.2
  331                             __lbra  LL13
       05:A361  4C D5 A3           jmp    LL13
  332  05:A364            LL14:
  333                     
  334                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A364  A0 00              ldy    #0
       05:A366  B1 00              lda    [__sp],Y
       05:A368  AA                 tax
       05:A369  62                 cla
                          ;        bpl    .x_00840   ; signed
                          ;        dec    A
                          ;.x_00840:
                                  .else
                                  .endif
  335                             __notw
       05:A36A  86 03              stx    <__temp
       05:A36C  05 03              ora    <__temp
       05:A36E  82                 clx
       05:A36F  D0 01              bne    .x00841
       05:A371  E8                 inx
       05:A372  62        .x00841     cla
  336                             __tstw
                                   ; pha
       05:A373  86 03              stx    <__temp
       05:A375  05 03              ora    <__temp
                                   ; pla
  337                             __lbeq  LL16
       05:A377  D0 03              bne    .x00843
       05:A379  4C 90 A3           jmp    LL16
       05:A37C            .x00843
  338                             __ldwi  2052
       05:A37C  A2 04              ldx    #low(2052)
       05:A37E  A9 08              lda    #high(2052)
  339                             __stw   _bx
       05:A380  8E FA 20           stx    _bx
       05:A383  8D FB 20           sta    _bx+1
  340                             __ldwi  0
       05:A386  A2 00              ldx    #low(0)
       05:A388  A9 00              lda    #high(0)
  341  05:A38A  20 A4 FB            call  _poke.2
  342                             __lbra  LL17
       05:A38D  4C D5 A3           jmp    LL17
  343  05:A390            LL16:
  344                     
  345                             __ldwi  2052
       05:A390  A2 04              ldx    #low(2052)
       05:A392  A9 08              lda    #high(2052)
  346                             __stw   _bx
       05:A394  8E FA 20           stx    _bx
       05:A397  8D FB 20           sta    _bx+1
  347                             __ldwi  128
       05:A39A  A2 80              ldx    #low(128)
       05:A39C  A9 00              lda    #high(128)
  348                             __pushw
                                 __submi  2,__stack
       05:A39E  48                 pha
       05:A39F  38                 sec
       05:A3A0  A5 00              lda    <__stack
       05:A3A2  E9 02              sbc    #low(2)
       05:A3A4  85 00              sta    <__stack
       05:A3A6  A5 01              lda    <__stack+1
       05:A3A8  E9 00              sbc    #high(2)
       05:A3AA  85 01              sta    <__stack+1
       05:A3AC  68                 pla
       05:A3AD  22                 sax
       05:A3AE  92 00              sta    [__stack]
       05:A3B0  22                 sax
       05:A3B1  A0 01              ldy    #1
       05:A3B3  91 00              sta    [__stack],Y
  349                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A3B5  A0 02              ldy    #2
       05:A3B7  B1 00              lda    [__sp],Y
       05:A3B9  AA                 tax
       05:A3BA  62                 cla
                          ;        bpl    .x_00853   ; signed
                          ;        dec    A
                          ;.x_00853:
                                  .else
                                  .endif
  350                             __orws
       05:A3BB  22                 sax
       05:A3BC  12 00              ora    [__stack]
       05:A3BE  22                 sax
       05:A3BF  A0 01              ldy    #1
       05:A3C1  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       05:A3C3  48                 pha
       05:A3C4  18                 clc
       05:A3C5  A5 00              lda    <__stack
       05:A3C7  69 02              adc    #low(2)
       05:A3C9  85 00              sta    <__stack
       05:A3CB  A5 01              lda    <__stack+1
       05:A3CD  69 00              adc    #high(2)
       05:A3CF  85 01              sta    <__stack+1
       05:A3D1  68                 pla
  351  05:A3D2  20 A4 FB            call  _poke.2
  352  05:A3D5            LL17:
  353                     
  354  05:A3D5            LL13:
  355                     
  356                             __addmi 2,__stack
       05:A3D5  48                 pha
       05:A3D6  18                 clc
       05:A3D7  A5 00              lda    <__stack
       05:A3D9  69 02              adc    #low(2)
       05:A3DB  85 00              sta    <__stack
       05:A3DD  A5 01              lda    <__stack+1
       05:A3DF  69 00              adc    #high(2)
       05:A3E1  85 01              sta    <__stack+1
       05:A3E3  68                 pla
  357  05:A3E4  60                  rts
  358                             .endp
  359                     
  360  05:43E5                    .proc _snd_saw
  361                             __pushw
                                 __submi  2,__stack
       05:A3E5  48                 pha
       05:A3E6  38                 sec
       05:A3E7  A5 00              lda    <__stack
       05:A3E9  E9 02              sbc    #low(2)
       05:A3EB  85 00              sta    <__stack
       05:A3ED  A5 01              lda    <__stack+1
       05:A3EF  E9 00              sbc    #high(2)
       05:A3F1  85 01              sta    <__stack+1
       05:A3F3  68                 pla
       05:A3F4  22                 sax
       05:A3F5  92 00              sta    [__stack]
       05:A3F7  22                 sax
       05:A3F8  A0 01              ldy    #1
       05:A3FA  91 00              sta    [__stack],Y
  362                             __addmi -1,__stack
       05:A3FC  48                 pha
       05:A3FD  18                 clc
       05:A3FE  A5 00              lda    <__stack
       05:A400  69 FF              adc    #low(-1)
       05:A402  85 00              sta    <__stack
       05:A404  A5 01              lda    <__stack+1
       05:A406  69 FF              adc    #high(-1)
       05:A408  85 01              sta    <__stack+1
       05:A40A  68                 pla
  363                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       05:A40B  A0 01               ldy   #1
       05:A40D  B1 00               lda   [__sp],Y
       05:A40F  AA                  tax
       05:A410  C8                  iny
       05:A411  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  364  05:A413  8E 87 29            stx   _reg_ch
  365                             __ldwi  2048
       05:A416  A2 00              ldx    #low(2048)
       05:A418  A9 08              lda    #high(2048)
  366                             __stw   _bx
       05:A41A  8E FA 20           stx    _bx
       05:A41D  8D FB 20           sta    _bx+1
  367                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       05:A420  A0 01               ldy   #1
       05:A422  B1 00               lda   [__sp],Y
       05:A424  AA                  tax
       05:A425  C8                  iny
       05:A426  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  368  05:A428  20 A4 FB            call  _poke.2
  369                             __ldwi  2052
       05:A42B  A2 04              ldx    #low(2052)
       05:A42D  A9 08              lda    #high(2052)
  370                             __stw   _bx
       05:A42F  8E FA 20           stx    _bx
       05:A432  8D FB 20           sta    _bx+1
  371                             __ldwi  0
       05:A435  A2 00              ldx    #low(0)
       05:A437  A9 00              lda    #high(0)
  372  05:A439  20 A4 FB            call  _poke.2
  373                             __stbi_s        0,0
                0001              .if (0 < 256)
                                   ; short index (bytes :  8/ 9, cycles : 15)
                          
       05:A43C  A9 00              lda    #LOW(0)
       05:A43E  A0 00              ldy    #0
       05:A440  91 00              sta    [__sp],Y
       05:A442  AA                 tax
                          ;        lda    #HIGH(0)
       05:A443  62                 cla
                                  .else
                                  .endif
  374  05:A444            LL19:
  375                     
  376                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A444  A0 00              ldy    #0
       05:A446  B1 00              lda    [__sp],Y
       05:A448  AA                 tax
       05:A449  62                 cla
                          ;        bpl    .x_00868   ; signed
                          ;        dec    A
                          ;.x_00868:
                                  .else
                                  .endif
  377                             __stw   <__temp
       05:A44A  86 03              stx    <__temp
       05:A44C  85 04              sta    <__temp+1
  378                             __ldwi  32
       05:A44E  A2 20              ldx    #low(32)
       05:A450  A9 00              lda    #high(32)
  379  05:A452  20 A3 E9            jsr   ltzp
  380                             __lbne  LL21
       05:A455  F0 03              beq    .x00871
       05:A457  4C 7A A4           jmp    LL21
       05:A45A            .x00871
  381                             __lbra  LL22
       05:A45A  4C 90 A4           jmp    LL22
  382  05:A45D            LL20:
  383                     
  384                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A45D  A0 00              ldy    #0
       05:A45F  B1 00              lda    [__sp],Y
       05:A461  AA                 tax
       05:A462  62                 cla
                          ;        bpl    .x_00873   ; signed
                          ;        dec    A
                          ;.x_00873:
                                  .else
                                  .endif
  385                             __addwi 1
       05:A463  18                 clc
       05:A464  22                 sax
       05:A465  69 01              adc    #low(1)
       05:A467  22                 sax
       05:A468  69 00              adc    #high(1)
  386                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       05:A46A  22                 sax
       05:A46B  A0 00              ldy    #0
       05:A46D  91 00              sta    [__sp],Y
       05:A46F  22                 sax
                                  .else
                                  .endif
  387                             __subwi 1
       05:A470  38                 sec
       05:A471  22                 sax
       05:A472  E9 01              sbc    #low(1)
       05:A474  22                 sax
       05:A475  E9 00              sbc    #high(1)
  388                             __lbra  LL19
       05:A477  4C 44 A4           jmp    LL19
  389  05:A47A            LL21:
  390                     
  391                             __ldwi  2054
       05:A47A  A2 06              ldx    #low(2054)
       05:A47C  A9 08              lda    #high(2054)
  392                             __stw   _bx
       05:A47E  8E FA 20           stx    _bx
       05:A481  8D FB 20           sta    _bx+1
  393                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A484  A0 00              ldy    #0
       05:A486  B1 00              lda    [__sp],Y
       05:A488  AA                 tax
       05:A489  62                 cla
                          ;        bpl    .x_00880   ; signed
                          ;        dec    A
                          ;.x_00880:
                                  .else
                                  .endif
  394  05:A48A  20 A4 FB            call  _poke.2
  395                             __lbra  LL20
       05:A48D  4C 5D A4           jmp    LL20
  396  05:A490            LL22:
  397                     
  398                             __ldwi  2053
       05:A490  A2 05              ldx    #low(2053)
       05:A492  A9 08              lda    #high(2053)
  399                             __stw   _bx
       05:A494  8E FA 20           stx    _bx
       05:A497  8D FB 20           sta    _bx+1
  400                             __ldwi  _panpod
       05:A49A  A2 C2              ldx    #low(_panpod)
       05:A49C  A9 29              lda    #high(_panpod)
  401                             __addw_s        1
                0001              .if (1 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       05:A49E  A0 01              ldy    #1
       05:A4A0  18                 clc
       05:A4A1  22                 sax
       05:A4A2  71 00              adc    [__sp],Y
       05:A4A4  22                 sax
       05:A4A5  C8                 iny
       05:A4A6  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  402                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       05:A4A8  86 0B              stx    <__ptr
       05:A4AA  85 0C              sta    <__ptr+1
       05:A4AC  B2 0B              lda    [__ptr]
       05:A4AE  AA                 tax
       05:A4AF  62                 cla
                          ;        bpl    .x_00886   ; signed
                          ;        dec    A
                          ;.x_00886:
  403  05:A4B0  20 A4 FB            call  _poke.2
  404                             __ldwi  2052
       05:A4B3  A2 04              ldx    #low(2052)
       05:A4B5  A9 08              lda    #high(2052)
  405                             __stw   _bx
       05:A4B7  8E FA 20           stx    _bx
       05:A4BA  8D FB 20           sta    _bx+1
  406                             __ldwi  128
       05:A4BD  A2 80              ldx    #low(128)
       05:A4BF  A9 00              lda    #high(128)
  407  05:A4C1  20 A4 FB            call  _poke.2
  408  05:A4C4            LL18:
  409                     
  410                             __addmi 3,__stack
       05:A4C4  48                 pha
       05:A4C5  18                 clc
       05:A4C6  A5 00              lda    <__stack
       05:A4C8  69 03              adc    #low(3)
       05:A4CA  85 00              sta    <__stack
       05:A4CC  A5 01              lda    <__stack+1
       05:A4CE  69 00              adc    #high(3)
       05:A4D0  85 01              sta    <__stack+1
       05:A4D2  68                 pla
  411  05:A4D3  60                  rts
  412                             .endp
  413                     
  414  05:44D4                    .proc _snd_chg
  415                             __pushw
                                 __submi  2,__stack
       05:A4D4  48                 pha
       05:A4D5  38                 sec
       05:A4D6  A5 00              lda    <__stack
       05:A4D8  E9 02              sbc    #low(2)
       05:A4DA  85 00              sta    <__stack
       05:A4DC  A5 01              lda    <__stack+1
       05:A4DE  E9 00              sbc    #high(2)
       05:A4E0  85 01              sta    <__stack+1
       05:A4E2  68                 pla
       05:A4E3  22                 sax
       05:A4E4  92 00              sta    [__stack]
       05:A4E6  22                 sax
       05:A4E7  A0 01              ldy    #1
       05:A4E9  91 00              sta    [__stack],Y
  416                             __addmi -3,__stack
       05:A4EB  48                 pha
       05:A4EC  18                 clc
       05:A4ED  A5 00              lda    <__stack
       05:A4EF  69 FD              adc    #low(-3)
       05:A4F1  85 00              sta    <__stack
       05:A4F3  A5 01              lda    <__stack+1
       05:A4F5  69 FF              adc    #high(-3)
       05:A4F7  85 01              sta    <__stack+1
       05:A4F9  68                 pla
  417                             __ldwi  _pcewav
       05:A4FA  A2 16              ldx    #low(_pcewav)
       05:A4FC  A9 44              lda    #high(_pcewav)
  418                             __stw   __ptr
       05:A4FE  8E 0B 20           stx    __ptr
       05:A501  8D 0C 20           sta    __ptr+1
  419                             __ldwp  __ptr
       05:A504  B2 0B              lda    [__ptr]
       05:A506  AA                 tax
       05:A507  A0 01              ldy    #1
       05:A509  B1 0B              lda    [__ptr],Y
  420                             __pushw
                                 __submi  2,__stack
       05:A50B  48                 pha
       05:A50C  38                 sec
       05:A50D  A5 00              lda    <__stack
       05:A50F  E9 02              sbc    #low(2)
       05:A511  85 00              sta    <__stack
       05:A513  A5 01              lda    <__stack+1
       05:A515  E9 00              sbc    #high(2)
       05:A517  85 01              sta    <__stack+1
       05:A519  68                 pla
       05:A51A  22                 sax
       05:A51B  92 00              sta    [__stack]
       05:A51D  22                 sax
       05:A51E  A0 01              ldy    #1
       05:A520  91 00              sta    [__stack],Y
  421                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       05:A522  A0 05               ldy   #5
       05:A524  B1 00               lda   [__sp],Y
       05:A526  AA                  tax
       05:A527  C8                  iny
       05:A528  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  422                             __pushw
                                 __submi  2,__stack
       05:A52A  48                 pha
       05:A52B  38                 sec
       05:A52C  A5 00              lda    <__stack
       05:A52E  E9 02              sbc    #low(2)
       05:A530  85 00              sta    <__stack
       05:A532  A5 01              lda    <__stack+1
       05:A534  E9 00              sbc    #high(2)
       05:A536  85 01              sta    <__stack+1
       05:A538  68                 pla
       05:A539  22                 sax
       05:A53A  92 00              sta    [__stack]
       05:A53C  22                 sax
       05:A53D  A0 01              ldy    #1
       05:A53F  91 00              sta    [__stack],Y
  423                             __ldwi  1
       05:A541  A2 01              ldx    #low(1)
       05:A543  A9 00              lda    #high(1)
  424  05:A545  20 60 EA            jsr   asl
  425                             __addws
       05:A548  22                 sax
       05:A549  18                 clc
       05:A54A  72 00              adc    [__stack]
       05:A54C  22                 sax
       05:A54D  A0 01              ldy    #1
       05:A54F  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       05:A551  48                 pha
       05:A552  18                 clc
       05:A553  A5 00              lda    <__stack
       05:A555  69 02              adc    #low(2)
       05:A557  85 00              sta    <__stack
       05:A559  A5 01              lda    <__stack+1
       05:A55B  69 00              adc    #high(2)
       05:A55D  85 01              sta    <__stack+1
       05:A55F  68                 pla
  426                             __stw   __ptr
       05:A560  8E 0B 20           stx    __ptr
       05:A563  8D 0C 20           sta    __ptr+1
  427                             __ldwp  __ptr
       05:A566  B2 0B              lda    [__ptr]
       05:A568  AA                 tax
       05:A569  A0 01              ldy    #1
       05:A56B  B1 0B              lda    [__ptr],Y
  428                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       05:A56D  22                 sax
       05:A56E  A0 00              ldy    #0
       05:A570  91 00              sta    [__sp],Y
       05:A572  22                 sax
       05:A573  C8                 iny
       05:A574  91 00              sta    [__sp],Y
                                  .else
                                  .endif
  429                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       05:A576  A0 05               ldy   #5
       05:A578  B1 00               lda   [__sp],Y
       05:A57A  AA                  tax
       05:A57B  C8                  iny
       05:A57C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  430  05:A57E  8E 87 29            stx   _reg_ch
  431                             __ldwi  2048
       05:A581  A2 00              ldx    #low(2048)
       05:A583  A9 08              lda    #high(2048)
  432                             __stw   _bx
       05:A585  8E FA 20           stx    _bx
       05:A588  8D FB 20           sta    _bx+1
  433                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       05:A58B  A0 05               ldy   #5
       05:A58D  B1 00               lda   [__sp],Y
       05:A58F  AA                  tax
       05:A590  C8                  iny
       05:A591  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  434  05:A593  20 A4 FB            call  _poke.2
  435                             __ldwi  2052
       05:A596  A2 04              ldx    #low(2052)
       05:A598  A9 08              lda    #high(2052)
  436                             __stw   _bx
       05:A59A  8E FA 20           stx    _bx
       05:A59D  8D FB 20           sta    _bx+1
  437                             __ldwi  0
       05:A5A0  A2 00              ldx    #low(0)
       05:A5A2  A9 00              lda    #high(0)
  438  05:A5A4  20 A4 FB            call  _poke.2
  439                             __stbi_s        0,2
                0001              .if (2 < 256)
                                   ; short index (bytes :  8/ 9, cycles : 15)
                          
       05:A5A7  A9 00              lda    #LOW(0)
       05:A5A9  A0 02              ldy    #2
       05:A5AB  91 00              sta    [__sp],Y
       05:A5AD  AA                 tax
                          ;        lda    #HIGH(0)
       05:A5AE  62                 cla
                                  .else
                                  .endif
  440  05:A5AF            LL24:
  441                     
  442                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A5AF  A0 02              ldy    #2
       05:A5B1  B1 00              lda    [__sp],Y
       05:A5B3  AA                 tax
       05:A5B4  62                 cla
                          ;        bpl    .x_00916   ; signed
                          ;        dec    A
                          ;.x_00916:
                                  .else
                                  .endif
  443                             __stw   <__temp
       05:A5B5  86 03              stx    <__temp
       05:A5B7  85 04              sta    <__temp+1
  444                             __ldwi  32
       05:A5B9  A2 20              ldx    #low(32)
       05:A5BB  A9 00              lda    #high(32)
  445  05:A5BD  20 A3 E9            jsr   ltzp
  446                             __lbne  LL26
       05:A5C0  F0 03              beq    .x00919
       05:A5C2  4C E5 A5           jmp    LL26
       05:A5C5            .x00919
  447                             __lbra  LL27
       05:A5C5  4C 1B A6           jmp    LL27
  448  05:A5C8            LL25:
  449                     
  450                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:A5C8  A0 02              ldy    #2
       05:A5CA  B1 00              lda    [__sp],Y
       05:A5CC  AA                 tax
       05:A5CD  62                 cla
                          ;        bpl    .x_00921   ; signed
                          ;        dec    A
                          ;.x_00921:
                                  .else
                                  .endif
  451                             __addwi 1
       05:A5CE  18                 clc
       05:A5CF  22                 sax
       05:A5D0  69 01              adc    #low(1)
       05:A5D2  22                 sax
       05:A5D3  69 00              adc    #high(1)
  452                             __stb_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       05:A5D5  22                 sax
       05:A5D6  A0 02              ldy    #2
       05:A5D8  91 00              sta    [__sp],Y
       05:A5DA  22                 sax
                                  .else
                                  .endif
  453                             __subwi 1
       05:A5DB  38                 sec
       05:A5DC  22                 sax
       05:A5DD  E9 01              sbc    #low(1)
       05:A5DF  22                 sax
       05:A5E0  E9 00              sbc    #high(1)
  454                             __lbra  LL24
       05:A5E2  4C AF A5           jmp    LL24
  455  05:A5E5            LL26:
  456                     
  457                             __ldwi  2054
       05:A5E5  A2 06              ldx    #low(2054)
       05:A5E7  A9 08              lda    #high(2054)
  458                             __stw   _bx
       05:A5E9  8E FA 20           stx    _bx
       05:A5EC  8D FB 20           sta    _bx+1
  459                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:A5EF  B2 00               lda   [__sp]
       05:A5F1  AA                  tax
       05:A5F2  A0 01               ldy   #1
       05:A5F4  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  460                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       05:A5F6  86 0B              stx    <__ptr
       05:A5F8  85 0C              sta    <__ptr+1
       05:A5FA  B2 0B              lda    [__ptr]
       05:A5FC  AA                 tax
       05:A5FD  62                 cla
                          ;        bpl    .x_00929   ; signed
                          ;        dec    A
                          ;.x_00929:
  461  05:A5FE  20 A4 FB            call  _poke.2
  462                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:A601  B2 00               lda   [__sp]
       05:A603  AA                  tax
       05:A604  A0 01               ldy   #1
       05:A606  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  463                             __incw_s        0
                                   ; (bytes : 16, cycles : 24/40)
                          
       05:A608  48                 pha
       05:A609  A0 00              ldy    #0
       05:A60B  8A                 txa
       05:A60C  1A                 inc    A
       05:A60D  91 00              sta    [__sp],Y
       05:A60F  D0 06              bne    .x_00931
       05:A611  C8                 iny
       05:A612  B1 00              lda    [__sp],Y
       05:A614  1A                 inc    A
       05:A615  91 00              sta    [__sp],Y
       05:A617            .x_00931:
       05:A617  68                 pla
  464                             __lbra  LL25
       05:A618  4C C8 A5           jmp    LL25
  465  05:A61B            LL27:
  466                     
  467                             __ldwi  2052
       05:A61B  A2 04              ldx    #low(2052)
       05:A61D  A9 08              lda    #high(2052)
  468                             __stw   _bx
       05:A61F  8E FA 20           stx    _bx
       05:A622  8D FB 20           sta    _bx+1
  469                             __ldwi  128
       05:A625  A2 80              ldx    #low(128)
       05:A627  A9 00              lda    #high(128)
  470  05:A629  20 A4 FB            call  _poke.2
  471  05:A62C            LL23:
  472                     
  473                             __addmi 7,__stack
       05:A62C  48                 pha
       05:A62D  18                 clc
       05:A62E  A5 00              lda    <__stack
       05:A630  69 07              adc    #low(7)
       05:A632  85 00              sta    <__stack
       05:A634  A5 01              lda    <__stack+1
       05:A636  69 00              adc    #high(7)
       05:A638  85 01              sta    <__stack+1
       05:A63A  68                 pla
  474  05:A63B  60                  rts
  475                             .endp
  476                     
  477  05:463C                    .proc _set_drvintr
  478                             stw   #_vsync_drv,vsync_hook
       05:A63C  A9 95              lda    LOW_BYTE #_vsync_drv
       05:A63E  8D 08 22           sta    LOW_BYTE vsync_hook
       05:A641  A9 FD              lda    HIGH_BYTE #_vsync_drv
       05:A643  8D 09 22           sta    HIGH_BYTE vsync_hook
  479  05:A646  C7 F5             smb   #4,<irq_m         ; enable new code
  480  05:A648  D7 F5             smb   #5,<irq_m         ; disable system card code
  481  05:A64A  60                rts
  482                             .endp
  483  05:464B                    .proc _drv_init
  484                             __addmi -2,__stack
       05:A64B  48                 pha
       05:A64C  18                 clc
       05:A64D  A5 00              lda    <__stack
       05:A64F  69 FE              adc    #low(-2)
       05:A651  85 00              sta    <__stack
       05:A653  A5 01              lda    <__stack+1
       05:A655  69 FF              adc    #high(-2)
       05:A657  85 01              sta    <__stack+1
       05:A659  68                 pla
  485  05:A65A  20 D1 A2            call  _now_cbank
  486  05:A65D  8E A1 29            stx   _ch_topbank
  487                             __ldwi  0
       05:A660  A2 00              ldx    #low(0)
       05:A662  A9 00              lda    #high(0)
  488                             __stw   _i
       05:A664  8E 24 2A           stx    _i
       05:A667  8D 25 2A           sta    _i+1
  489  05:A66A            LL29:
  490                     
  491                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A66A  AE 24 2A           ldx    _i
       05:A66D  AD 25 2A           lda    _i+1
                                  .endif
  492                             __stw   <__temp
       05:A670  86 03              stx    <__temp
       05:A672  85 04              sta    <__temp+1
  493                             __ldwi  6
       05:A674  A2 06              ldx    #low(6)
       05:A676  A9 00              lda    #high(6)
  494  05:A678  20 A3 E9            jsr   ltzp
  495                             __lbne  LL31
       05:A67B  F0 03              beq    .x00944
       05:A67D  4C 94 A6           jmp    LL31
       05:A680            .x00944
  496                             __lbra  LL32
       05:A680  4C 8C AA           jmp    LL32
  497  05:A683            LL30:
  498                     
  499                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A683  AE 24 2A           ldx    _i
       05:A686  AD 25 2A           lda    _i+1
                                  .endif
  500                             incw    _i
       05:A689  EE 24 2A           inc    _i              ; value at stated memory
       05:A68C  D0 03              bne    .x_00947           ; location
       05:A68E  EE 25 2A           inc    _i+1
       05:A691            .x_00947:
  501                             __lbra  LL29
       05:A691  4C 6A A6           jmp    LL29
  502  05:A694            LL31:
  503                     
  504                             __ldwi  _lfo_num
       05:A694  A2 2C              ldx    #low(_lfo_num)
       05:A696  A9 2A              lda    #high(_lfo_num)
  505                             __addw  _i
       05:A698  18                 clc
       05:A699  22                 sax
       05:A69A  6D 24 2A           adc    _i
       05:A69D  22                 sax
       05:A69E  6D 25 2A           adc    _i+1
  506                             __pushw
                                 __submi  2,__stack
       05:A6A1  48                 pha
       05:A6A2  38                 sec
       05:A6A3  A5 00              lda    <__stack
       05:A6A5  E9 02              sbc    #low(2)
       05:A6A7  85 00              sta    <__stack
       05:A6A9  A5 01              lda    <__stack+1
       05:A6AB  E9 00              sbc    #high(2)
       05:A6AD  85 01              sta    <__stack+1
       05:A6AF  68                 pla
       05:A6B0  22                 sax
       05:A6B1  92 00              sta    [__stack]
       05:A6B3  22                 sax
       05:A6B4  A0 01              ldy    #1
       05:A6B6  91 00              sta    [__stack],Y
  507                             __ldwi  _note_sw
       05:A6B8  A2 B2              ldx    #low(_note_sw)
       05:A6BA  A9 29              lda    #high(_note_sw)
  508                             __addw  _i
       05:A6BC  18                 clc
       05:A6BD  22                 sax
       05:A6BE  6D 24 2A           adc    _i
       05:A6C1  22                 sax
       05:A6C2  6D 25 2A           adc    _i+1
  509                             __pushw
                                 __submi  2,__stack
       05:A6C5  48                 pha
       05:A6C6  38                 sec
       05:A6C7  A5 00              lda    <__stack
       05:A6C9  E9 02              sbc    #low(2)
       05:A6CB  85 00              sta    <__stack
       05:A6CD  A5 01              lda    <__stack+1
       05:A6CF  E9 00              sbc    #high(2)
       05:A6D1  85 01              sta    <__stack+1
       05:A6D3  68                 pla
       05:A6D4  22                 sax
       05:A6D5  92 00              sta    [__stack]
       05:A6D7  22                 sax
       05:A6D8  A0 01              ldy    #1
       05:A6DA  91 00              sta    [__stack],Y
  510                             __ldwi  _panpod
       05:A6DC  A2 C2              ldx    #low(_panpod)
       05:A6DE  A9 29              lda    #high(_panpod)
  511                             __addw  _i
       05:A6E0  18                 clc
       05:A6E1  22                 sax
       05:A6E2  6D 24 2A           adc    _i
       05:A6E5  22                 sax
       05:A6E6  6D 25 2A           adc    _i+1
  512                             __pushw
                                 __submi  2,__stack
       05:A6E9  48                 pha
       05:A6EA  38                 sec
       05:A6EB  A5 00              lda    <__stack
       05:A6ED  E9 02              sbc    #low(2)
       05:A6EF  85 00              sta    <__stack
       05:A6F1  A5 01              lda    <__stack+1
       05:A6F3  E9 00              sbc    #high(2)
       05:A6F5  85 01              sta    <__stack+1
       05:A6F7  68                 pla
       05:A6F8  22                 sax
       05:A6F9  92 00              sta    [__stack]
       05:A6FB  22                 sax
       05:A6FC  A0 01              ldy    #1
       05:A6FE  91 00              sta    [__stack],Y
  513                             __ldwi  _pitch_sw
       05:A700  A2 AA              ldx    #low(_pitch_sw)
       05:A702  A9 29              lda    #high(_pitch_sw)
  514                             __addw  _i
       05:A704  18                 clc
       05:A705  22                 sax
       05:A706  6D 24 2A           adc    _i
       05:A709  22                 sax
       05:A70A  6D 25 2A           adc    _i+1
  515                             __pushw
                                 __submi  2,__stack
       05:A70D  48                 pha
       05:A70E  38                 sec
       05:A70F  A5 00              lda    <__stack
       05:A711  E9 02              sbc    #low(2)
       05:A713  85 00              sta    <__stack
       05:A715  A5 01              lda    <__stack+1
       05:A717  E9 00              sbc    #high(2)
       05:A719  85 01              sta    <__stack+1
       05:A71B  68                 pla
       05:A71C  22                 sax
       05:A71D  92 00              sta    [__stack]
       05:A71F  22                 sax
       05:A720  A0 01              ldy    #1
       05:A722  91 00              sta    [__stack],Y
  516                             __ldwi  255
       05:A724  A2 FF              ldx    #low(255)
       05:A726  A9 00              lda    #high(255)
  517                             __stbps
                                 __stw    <__temp
       05:A728  86 03              stx    <__temp
       05:A72A  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A72C  B2 00              lda    [__stack]
       05:A72E  AA                 tax
       05:A72F  A0 01              ldy    #1
       05:A731  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A733  86 0B              stx    <__ptr
       05:A735  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A737  A6 03              ldx    <__temp
       05:A739  A5 04              lda    <__temp+1
                                  .endif
       05:A73B  22                 sax
       05:A73C  92 0B              sta    [__ptr]
       05:A73E  22                 sax
                                 __addmi  2,__stack
       05:A73F  48                 pha
       05:A740  18                 clc
       05:A741  A5 00              lda    <__stack
       05:A743  69 02              adc    #low(2)
       05:A745  85 00              sta    <__stack
       05:A747  A5 01              lda    <__stack+1
       05:A749  69 00              adc    #high(2)
       05:A74B  85 01              sta    <__stack+1
       05:A74D  68                 pla
  518                             __stbps
                                 __stw    <__temp
       05:A74E  86 03              stx    <__temp
       05:A750  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A752  B2 00              lda    [__stack]
       05:A754  AA                 tax
       05:A755  A0 01              ldy    #1
       05:A757  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A759  86 0B              stx    <__ptr
       05:A75B  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A75D  A6 03              ldx    <__temp
       05:A75F  A5 04              lda    <__temp+1
                                  .endif
       05:A761  22                 sax
       05:A762  92 0B              sta    [__ptr]
       05:A764  22                 sax
                                 __addmi  2,__stack
       05:A765  48                 pha
       05:A766  18                 clc
       05:A767  A5 00              lda    <__stack
       05:A769  69 02              adc    #low(2)
       05:A76B  85 00              sta    <__stack
       05:A76D  A5 01              lda    <__stack+1
       05:A76F  69 00              adc    #high(2)
       05:A771  85 01              sta    <__stack+1
       05:A773  68                 pla
  519                             __stbps
                                 __stw    <__temp
       05:A774  86 03              stx    <__temp
       05:A776  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A778  B2 00              lda    [__stack]
       05:A77A  AA                 tax
       05:A77B  A0 01              ldy    #1
       05:A77D  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A77F  86 0B              stx    <__ptr
       05:A781  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A783  A6 03              ldx    <__temp
       05:A785  A5 04              lda    <__temp+1
                                  .endif
       05:A787  22                 sax
       05:A788  92 0B              sta    [__ptr]
       05:A78A  22                 sax
                                 __addmi  2,__stack
       05:A78B  48                 pha
       05:A78C  18                 clc
       05:A78D  A5 00              lda    <__stack
       05:A78F  69 02              adc    #low(2)
       05:A791  85 00              sta    <__stack
       05:A793  A5 01              lda    <__stack+1
       05:A795  69 00              adc    #high(2)
       05:A797  85 01              sta    <__stack+1
       05:A799  68                 pla
  520                             __stbps
                                 __stw    <__temp
       05:A79A  86 03              stx    <__temp
       05:A79C  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A79E  B2 00              lda    [__stack]
       05:A7A0  AA                 tax
       05:A7A1  A0 01              ldy    #1
       05:A7A3  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A7A5  86 0B              stx    <__ptr
       05:A7A7  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A7A9  A6 03              ldx    <__temp
       05:A7AB  A5 04              lda    <__temp+1
                                  .endif
       05:A7AD  22                 sax
       05:A7AE  92 0B              sta    [__ptr]
       05:A7B0  22                 sax
                                 __addmi  2,__stack
       05:A7B1  48                 pha
       05:A7B2  18                 clc
       05:A7B3  A5 00              lda    <__stack
       05:A7B5  69 02              adc    #low(2)
       05:A7B7  85 00              sta    <__stack
       05:A7B9  A5 01              lda    <__stack+1
       05:A7BB  69 00              adc    #high(2)
       05:A7BD  85 01              sta    <__stack+1
       05:A7BF  68                 pla
  521                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A7C0  AE 24 2A           ldx    _i
       05:A7C3  AD 25 2A           lda    _i+1
                                  .endif
  522                             __aslw
       05:A7C6  22                 sax
       05:A7C7  0A                 asl    A
       05:A7C8  22                 sax
       05:A7C9  2A                 rol    A
  523                             __addwi _seq_pos
       05:A7CA  18                 clc
       05:A7CB  22                 sax
       05:A7CC  69 D4              adc    #low(_seq_pos)
       05:A7CE  22                 sax
       05:A7CF  69 29              adc    #high(_seq_pos)
  524                             __pushw
                                 __submi  2,__stack
       05:A7D1  48                 pha
       05:A7D2  38                 sec
       05:A7D3  A5 00              lda    <__stack
       05:A7D5  E9 02              sbc    #low(2)
       05:A7D7  85 00              sta    <__stack
       05:A7D9  A5 01              lda    <__stack+1
       05:A7DB  E9 00              sbc    #high(2)
       05:A7DD  85 01              sta    <__stack+1
       05:A7DF  68                 pla
       05:A7E0  22                 sax
       05:A7E1  92 00              sta    [__stack]
       05:A7E3  22                 sax
       05:A7E4  A0 01              ldy    #1
       05:A7E6  91 00              sta    [__stack],Y
  525                             __ldwi  _sound_dat
       05:A7E8  A2 00              ldx    #low(_sound_dat)
       05:A7EA  A9 44              lda    #high(_sound_dat)
  526                             __stw   __ptr
       05:A7EC  8E 0B 20           stx    __ptr
       05:A7EF  8D 0C 20           sta    __ptr+1
  527                             __ldwp  __ptr
       05:A7F2  B2 0B              lda    [__ptr]
       05:A7F4  AA                 tax
       05:A7F5  A0 01              ldy    #1
       05:A7F7  B1 0B              lda    [__ptr],Y
  528                             __pushw
                                 __submi  2,__stack
       05:A7F9  48                 pha
       05:A7FA  38                 sec
       05:A7FB  A5 00              lda    <__stack
       05:A7FD  E9 02              sbc    #low(2)
       05:A7FF  85 00              sta    <__stack
       05:A801  A5 01              lda    <__stack+1
       05:A803  E9 00              sbc    #high(2)
       05:A805  85 01              sta    <__stack+1
       05:A807  68                 pla
       05:A808  22                 sax
       05:A809  92 00              sta    [__stack]
       05:A80B  22                 sax
       05:A80C  A0 01              ldy    #1
       05:A80E  91 00              sta    [__stack],Y
  529                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A810  AE 24 2A           ldx    _i
       05:A813  AD 25 2A           lda    _i+1
                                  .endif
  530                             __pushw
                                 __submi  2,__stack
       05:A816  48                 pha
       05:A817  38                 sec
       05:A818  A5 00              lda    <__stack
       05:A81A  E9 02              sbc    #low(2)
       05:A81C  85 00              sta    <__stack
       05:A81E  A5 01              lda    <__stack+1
       05:A820  E9 00              sbc    #high(2)
       05:A822  85 01              sta    <__stack+1
       05:A824  68                 pla
       05:A825  22                 sax
       05:A826  92 00              sta    [__stack]
       05:A828  22                 sax
       05:A829  A0 01              ldy    #1
       05:A82B  91 00              sta    [__stack],Y
  531                             __ldwi  1
       05:A82D  A2 01              ldx    #low(1)
       05:A82F  A9 00              lda    #high(1)
  532  05:A831  20 60 EA            jsr   asl
  533                             __addws
       05:A834  22                 sax
       05:A835  18                 clc
       05:A836  72 00              adc    [__stack]
       05:A838  22                 sax
       05:A839  A0 01              ldy    #1
       05:A83B  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       05:A83D  48                 pha
       05:A83E  18                 clc
       05:A83F  A5 00              lda    <__stack
       05:A841  69 02              adc    #low(2)
       05:A843  85 00              sta    <__stack
       05:A845  A5 01              lda    <__stack+1
       05:A847  69 00              adc    #high(2)
       05:A849  85 01              sta    <__stack+1
       05:A84B  68                 pla
  534                             __stw   __ptr
       05:A84C  8E 0B 20           stx    __ptr
       05:A84F  8D 0C 20           sta    __ptr+1
  535                             __ldwp  __ptr
       05:A852  B2 0B              lda    [__ptr]
       05:A854  AA                 tax
       05:A855  A0 01              ldy    #1
       05:A857  B1 0B              lda    [__ptr],Y
  536                             __stwps
                                 __stw    <__temp
       05:A859  86 03              stx    <__temp
       05:A85B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A85D  B2 00              lda    [__stack]
       05:A85F  AA                 tax
       05:A860  A0 01              ldy    #1
       05:A862  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A864  86 0B              stx    <__ptr
       05:A866  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A868  A6 03              ldx    <__temp
       05:A86A  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:A86C  22                 sax
       05:A86D  92 0B              sta    [__ptr]
       05:A86F  22                 sax
       05:A870  A0 01              ldy    #1
       05:A872  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:A874  48                 pha
       05:A875  18                 clc
       05:A876  A5 00              lda    <__stack
       05:A878  69 02              adc    #low(2)
       05:A87A  85 00              sta    <__stack
       05:A87C  A5 01              lda    <__stack+1
       05:A87E  69 00              adc    #high(2)
       05:A880  85 01              sta    <__stack+1
       05:A882  68                 pla
  537                             __ldwi  _loop_cnt
       05:A883  A2 CA              ldx    #low(_loop_cnt)
       05:A885  A9 29              lda    #high(_loop_cnt)
  538                             __addw  _i
       05:A887  18                 clc
       05:A888  22                 sax
       05:A889  6D 24 2A           adc    _i
       05:A88C  22                 sax
       05:A88D  6D 25 2A           adc    _i+1
  539                             __pushw
                                 __submi  2,__stack
       05:A890  48                 pha
       05:A891  38                 sec
       05:A892  A5 00              lda    <__stack
       05:A894  E9 02              sbc    #low(2)
       05:A896  85 00              sta    <__stack
       05:A898  A5 01              lda    <__stack+1
       05:A89A  E9 00              sbc    #high(2)
       05:A89C  85 01              sta    <__stack+1
       05:A89E  68                 pla
       05:A89F  22                 sax
       05:A8A0  92 00              sta    [__stack]
       05:A8A2  22                 sax
       05:A8A3  A0 01              ldy    #1
       05:A8A5  91 00              sta    [__stack],Y
  540                             __ldwi  _detune
       05:A8A7  A2 BA              ldx    #low(_detune)
       05:A8A9  A9 29              lda    #high(_detune)
  541                             __addw  _i
       05:A8AB  18                 clc
       05:A8AC  22                 sax
       05:A8AD  6D 24 2A           adc    _i
       05:A8B0  22                 sax
       05:A8B1  6D 25 2A           adc    _i+1
  542                             __pushw
                                 __submi  2,__stack
       05:A8B4  48                 pha
       05:A8B5  38                 sec
       05:A8B6  A5 00              lda    <__stack
       05:A8B8  E9 02              sbc    #low(2)
       05:A8BA  85 00              sta    <__stack
       05:A8BC  A5 01              lda    <__stack+1
       05:A8BE  E9 00              sbc    #high(2)
       05:A8C0  85 01              sta    <__stack+1
       05:A8C2  68                 pla
       05:A8C3  22                 sax
       05:A8C4  92 00              sta    [__stack]
       05:A8C6  22                 sax
       05:A8C7  A0 01              ldy    #1
       05:A8C9  91 00              sta    [__stack],Y
  543                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A8CB  AE 24 2A           ldx    _i
       05:A8CE  AD 25 2A           lda    _i+1
                                  .endif
  544                             __aslw
       05:A8D1  22                 sax
       05:A8D2  0A                 asl    A
       05:A8D3  22                 sax
       05:A8D4  2A                 rol    A
  545                             __addwi _note_envadr
       05:A8D5  18                 clc
       05:A8D6  22                 sax
       05:A8D7  69 14              adc    #low(_note_envadr)
       05:A8D9  22                 sax
       05:A8DA  69 2A              adc    #high(_note_envadr)
  546                             __pushw
                                 __submi  2,__stack
       05:A8DC  48                 pha
       05:A8DD  38                 sec
       05:A8DE  A5 00              lda    <__stack
       05:A8E0  E9 02              sbc    #low(2)
       05:A8E2  85 00              sta    <__stack
       05:A8E4  A5 01              lda    <__stack+1
       05:A8E6  E9 00              sbc    #high(2)
       05:A8E8  85 01              sta    <__stack+1
       05:A8EA  68                 pla
       05:A8EB  22                 sax
       05:A8EC  92 00              sta    [__stack]
       05:A8EE  22                 sax
       05:A8EF  A0 01              ldy    #1
       05:A8F1  91 00              sta    [__stack],Y
  547                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A8F3  AE 24 2A           ldx    _i
       05:A8F6  AD 25 2A           lda    _i+1
                                  .endif
  548                             __aslw
       05:A8F9  22                 sax
       05:A8FA  0A                 asl    A
       05:A8FB  22                 sax
       05:A8FC  2A                 rol    A
  549                             __addwi _pitch_envadr
       05:A8FD  18                 clc
       05:A8FE  22                 sax
       05:A8FF  69 F4              adc    #low(_pitch_envadr)
       05:A901  22                 sax
       05:A902  69 29              adc    #high(_pitch_envadr)
  550                             __pushw
                                 __submi  2,__stack
       05:A904  48                 pha
       05:A905  38                 sec
       05:A906  A5 00              lda    <__stack
       05:A908  E9 02              sbc    #low(2)
       05:A90A  85 00              sta    <__stack
       05:A90C  A5 01              lda    <__stack+1
       05:A90E  E9 00              sbc    #high(2)
       05:A910  85 01              sta    <__stack+1
       05:A912  68                 pla
       05:A913  22                 sax
       05:A914  92 00              sta    [__stack]
       05:A916  22                 sax
       05:A917  A0 01              ldy    #1
       05:A919  91 00              sta    [__stack],Y
  551                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:A91B  AE 24 2A           ldx    _i
       05:A91E  AD 25 2A           lda    _i+1
                                  .endif
  552                             __aslw
       05:A921  22                 sax
       05:A922  0A                 asl    A
       05:A923  22                 sax
       05:A924  2A                 rol    A
  553                             __addwi _volume_envadr
       05:A925  18                 clc
       05:A926  22                 sax
       05:A927  69 04              adc    #low(_volume_envadr)
       05:A929  22                 sax
       05:A92A  69 2A              adc    #high(_volume_envadr)
  554                             __pushw
                                 __submi  2,__stack
       05:A92C  48                 pha
       05:A92D  38                 sec
       05:A92E  A5 00              lda    <__stack
       05:A930  E9 02              sbc    #low(2)
       05:A932  85 00              sta    <__stack
       05:A934  A5 01              lda    <__stack+1
       05:A936  E9 00              sbc    #high(2)
       05:A938  85 01              sta    <__stack+1
       05:A93A  68                 pla
       05:A93B  22                 sax
       05:A93C  92 00              sta    [__stack]
       05:A93E  22                 sax
       05:A93F  A0 01              ldy    #1
       05:A941  91 00              sta    [__stack],Y
  555                             __ldwi  0
       05:A943  A2 00              ldx    #low(0)
       05:A945  A9 00              lda    #high(0)
  556                             __stwps
                                 __stw    <__temp
       05:A947  86 03              stx    <__temp
       05:A949  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A94B  B2 00              lda    [__stack]
       05:A94D  AA                 tax
       05:A94E  A0 01              ldy    #1
       05:A950  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A952  86 0B              stx    <__ptr
       05:A954  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A956  A6 03              ldx    <__temp
       05:A958  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:A95A  22                 sax
       05:A95B  92 0B              sta    [__ptr]
       05:A95D  22                 sax
       05:A95E  A0 01              ldy    #1
       05:A960  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:A962  48                 pha
       05:A963  18                 clc
       05:A964  A5 00              lda    <__stack
       05:A966  69 02              adc    #low(2)
       05:A968  85 00              sta    <__stack
       05:A96A  A5 01              lda    <__stack+1
       05:A96C  69 00              adc    #high(2)
       05:A96E  85 01              sta    <__stack+1
       05:A970  68                 pla
  557                             __stwps
                                 __stw    <__temp
       05:A971  86 03              stx    <__temp
       05:A973  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A975  B2 00              lda    [__stack]
       05:A977  AA                 tax
       05:A978  A0 01              ldy    #1
       05:A97A  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A97C  86 0B              stx    <__ptr
       05:A97E  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A980  A6 03              ldx    <__temp
       05:A982  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:A984  22                 sax
       05:A985  92 0B              sta    [__ptr]
       05:A987  22                 sax
       05:A988  A0 01              ldy    #1
       05:A98A  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:A98C  48                 pha
       05:A98D  18                 clc
       05:A98E  A5 00              lda    <__stack
       05:A990  69 02              adc    #low(2)
       05:A992  85 00              sta    <__stack
       05:A994  A5 01              lda    <__stack+1
       05:A996  69 00              adc    #high(2)
       05:A998  85 01              sta    <__stack+1
       05:A99A  68                 pla
  558                             __stwps
                                 __stw    <__temp
       05:A99B  86 03              stx    <__temp
       05:A99D  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A99F  B2 00              lda    [__stack]
       05:A9A1  AA                 tax
       05:A9A2  A0 01              ldy    #1
       05:A9A4  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A9A6  86 0B              stx    <__ptr
       05:A9A8  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A9AA  A6 03              ldx    <__temp
       05:A9AC  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:A9AE  22                 sax
       05:A9AF  92 0B              sta    [__ptr]
       05:A9B1  22                 sax
       05:A9B2  A0 01              ldy    #1
       05:A9B4  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:A9B6  48                 pha
       05:A9B7  18                 clc
       05:A9B8  A5 00              lda    <__stack
       05:A9BA  69 02              adc    #low(2)
       05:A9BC  85 00              sta    <__stack
       05:A9BE  A5 01              lda    <__stack+1
       05:A9C0  69 00              adc    #high(2)
       05:A9C2  85 01              sta    <__stack+1
       05:A9C4  68                 pla
  559                             __stbps
                                 __stw    <__temp
       05:A9C5  86 03              stx    <__temp
       05:A9C7  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A9C9  B2 00              lda    [__stack]
       05:A9CB  AA                 tax
       05:A9CC  A0 01              ldy    #1
       05:A9CE  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A9D0  86 0B              stx    <__ptr
       05:A9D2  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A9D4  A6 03              ldx    <__temp
       05:A9D6  A5 04              lda    <__temp+1
                                  .endif
       05:A9D8  22                 sax
       05:A9D9  92 0B              sta    [__ptr]
       05:A9DB  22                 sax
                                 __addmi  2,__stack
       05:A9DC  48                 pha
       05:A9DD  18                 clc
       05:A9DE  A5 00              lda    <__stack
       05:A9E0  69 02              adc    #low(2)
       05:A9E2  85 00              sta    <__stack
       05:A9E4  A5 01              lda    <__stack+1
       05:A9E6  69 00              adc    #high(2)
       05:A9E8  85 01              sta    <__stack+1
       05:A9EA  68                 pla
  560                             __stbps
                                 __stw    <__temp
       05:A9EB  86 03              stx    <__temp
       05:A9ED  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:A9EF  B2 00              lda    [__stack]
       05:A9F1  AA                 tax
       05:A9F2  A0 01              ldy    #1
       05:A9F4  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:A9F6  86 0B              stx    <__ptr
       05:A9F8  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:A9FA  A6 03              ldx    <__temp
       05:A9FC  A5 04              lda    <__temp+1
                                  .endif
       05:A9FE  22                 sax
       05:A9FF  92 0B              sta    [__ptr]
       05:AA01  22                 sax
                                 __addmi  2,__stack
       05:AA02  48                 pha
       05:AA03  18                 clc
       05:AA04  A5 00              lda    <__stack
       05:AA06  69 02              adc    #low(2)
       05:AA08  85 00              sta    <__stack
       05:AA0A  A5 01              lda    <__stack+1
       05:AA0C  69 00              adc    #high(2)
       05:AA0E  85 01              sta    <__stack+1
       05:AA10  68                 pla
  561                             __ldwi  _ch_bank
       05:AA11  A2 98              ldx    #low(_ch_bank)
       05:AA13  A9 29              lda    #high(_ch_bank)
  562                             __addw  _i
       05:AA15  18                 clc
       05:AA16  22                 sax
       05:AA17  6D 24 2A           adc    _i
       05:AA1A  22                 sax
       05:AA1B  6D 25 2A           adc    _i+1
  563                             __pushw
                                 __submi  2,__stack
       05:AA1E  48                 pha
       05:AA1F  38                 sec
       05:AA20  A5 00              lda    <__stack
       05:AA22  E9 02              sbc    #low(2)
       05:AA24  85 00              sta    <__stack
       05:AA26  A5 01              lda    <__stack+1
       05:AA28  E9 00              sbc    #high(2)
       05:AA2A  85 01              sta    <__stack+1
       05:AA2C  68                 pla
       05:AA2D  22                 sax
       05:AA2E  92 00              sta    [__stack]
       05:AA30  22                 sax
       05:AA31  A0 01              ldy    #1
       05:AA33  91 00              sta    [__stack],Y
  564                             __ldwi  _sound_dat
       05:AA35  A2 00              ldx    #low(_sound_dat)
       05:AA37  A9 44              lda    #high(_sound_dat)
  565                             __addwi 14
       05:AA39  18                 clc
       05:AA3A  22                 sax
       05:AA3B  69 0E              adc    #low(14)
       05:AA3D  22                 sax
       05:AA3E  69 00              adc    #high(14)
  566                             __stw   __ptr
       05:AA40  8E 0B 20           stx    __ptr
       05:AA43  8D 0C 20           sta    __ptr+1
  567                             __ldwp  __ptr
       05:AA46  B2 0B              lda    [__ptr]
       05:AA48  AA                 tax
       05:AA49  A0 01              ldy    #1
       05:AA4B  B1 0B              lda    [__ptr],Y
  568                             __addw  _i
       05:AA4D  18                 clc
       05:AA4E  22                 sax
       05:AA4F  6D 24 2A           adc    _i
       05:AA52  22                 sax
       05:AA53  6D 25 2A           adc    _i+1
  569                             __stw   __ptr
       05:AA56  8E 0B 20           stx    __ptr
       05:AA59  8D 0C 20           sta    __ptr+1
  570                             __ldwp  __ptr
       05:AA5C  B2 0B              lda    [__ptr]
       05:AA5E  AA                 tax
       05:AA5F  A0 01              ldy    #1
       05:AA61  B1 0B              lda    [__ptr],Y
  571                             __stbps
                                 __stw    <__temp
       05:AA63  86 03              stx    <__temp
       05:AA65  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:AA67  B2 00              lda    [__stack]
       05:AA69  AA                 tax
       05:AA6A  A0 01              ldy    #1
       05:AA6C  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:AA6E  86 0B              stx    <__ptr
       05:AA70  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:AA72  A6 03              ldx    <__temp
       05:AA74  A5 04              lda    <__temp+1
                                  .endif
       05:AA76  22                 sax
       05:AA77  92 0B              sta    [__ptr]
       05:AA79  22                 sax
                                 __addmi  2,__stack
       05:AA7A  48                 pha
       05:AA7B  18                 clc
       05:AA7C  A5 00              lda    <__stack
       05:AA7E  69 02              adc    #low(2)
       05:AA80  85 00              sta    <__stack
       05:AA82  A5 01              lda    <__stack+1
       05:AA84  69 00              adc    #high(2)
       05:AA86  85 01              sta    <__stack+1
       05:AA88  68                 pla
  572                             __lbra  LL30
       05:AA89  4C 83 A6           jmp    LL30
  573  05:AA8C            LL32:
  574                     
  575                             __ldwi  0
       05:AA8C  A2 00              ldx    #low(0)
       05:AA8E  A9 00              lda    #high(0)
  576                             __stw   _i
       05:AA90  8E 24 2A           stx    _i
       05:AA93  8D 25 2A           sta    _i+1
  577  05:AA96            LL33:
  578                     
  579                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:AA96  AE 24 2A           ldx    _i
       05:AA99  AD 25 2A           lda    _i+1
                                  .endif
  580                             __stw   <__temp
       05:AA9C  86 03              stx    <__temp
       05:AA9E  85 04              sta    <__temp+1
  581                             __ldwi  2
       05:AAA0  A2 02              ldx    #low(2)
       05:AAA2  A9 00              lda    #high(2)
  582  05:AAA4  20 A3 E9            jsr   ltzp
  583                             __lbne  LL35
       05:AAA7  F0 03              beq    .x01095
       05:AAA9  4C C0 AA           jmp    LL35
       05:AAAC            .x01095
  584                             __lbra  LL36
       05:AAAC  4C 5B AB           jmp    LL36
  585  05:AAAF            LL34:
  586                     
  587                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:AAAF  AE 24 2A           ldx    _i
       05:AAB2  AD 25 2A           lda    _i+1
                                  .endif
  588                             incw    _i
       05:AAB5  EE 24 2A           inc    _i              ; value at stated memory
       05:AAB8  D0 03              bne    .x_01098           ; location
       05:AABA  EE 25 2A           inc    _i+1
       05:AABD            .x_01098:
  589                             __lbra  LL33
       05:AABD  4C 96 AA           jmp    LL33
  590  05:AAC0            LL35:
  591                     
  592                             __ldwi  _noise_sw
       05:AAC0  A2 2A              ldx    #low(_noise_sw)
       05:AAC2  A9 2A              lda    #high(_noise_sw)
  593                             __addw  _i
       05:AAC4  18                 clc
       05:AAC5  22                 sax
       05:AAC6  6D 24 2A           adc    _i
       05:AAC9  22                 sax
       05:AACA  6D 25 2A           adc    _i+1
  594                             __pushw
                                 __submi  2,__stack
       05:AACD  48                 pha
       05:AACE  38                 sec
       05:AACF  A5 00              lda    <__stack
       05:AAD1  E9 02              sbc    #low(2)
       05:AAD3  85 00              sta    <__stack
       05:AAD5  A5 01              lda    <__stack+1
       05:AAD7  E9 00              sbc    #high(2)
       05:AAD9  85 01              sta    <__stack+1
       05:AADB  68                 pla
       05:AADC  22                 sax
       05:AADD  92 00              sta    [__stack]
       05:AADF  22                 sax
       05:AAE0  A0 01              ldy    #1
       05:AAE2  91 00              sta    [__stack],Y
  595                             __ldwi  _noise_freq
       05:AAE4  A2 28              ldx    #low(_noise_freq)
       05:AAE6  A9 2A              lda    #high(_noise_freq)
  596                             __addw  _i
       05:AAE8  18                 clc
       05:AAE9  22                 sax
       05:AAEA  6D 24 2A           adc    _i
       05:AAED  22                 sax
       05:AAEE  6D 25 2A           adc    _i+1
  597                             __pushw
                                 __submi  2,__stack
       05:AAF1  48                 pha
       05:AAF2  38                 sec
       05:AAF3  A5 00              lda    <__stack
       05:AAF5  E9 02              sbc    #low(2)
       05:AAF7  85 00              sta    <__stack
       05:AAF9  A5 01              lda    <__stack+1
       05:AAFB  E9 00              sbc    #high(2)
       05:AAFD  85 01              sta    <__stack+1
       05:AAFF  68                 pla
       05:AB00  22                 sax
       05:AB01  92 00              sta    [__stack]
       05:AB03  22                 sax
       05:AB04  A0 01              ldy    #1
       05:AB06  91 00              sta    [__stack],Y
  598                             __ldwi  0
       05:AB08  A2 00              ldx    #low(0)
       05:AB0A  A9 00              lda    #high(0)
  599                             __stbps
                                 __stw    <__temp
       05:AB0C  86 03              stx    <__temp
       05:AB0E  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:AB10  B2 00              lda    [__stack]
       05:AB12  AA                 tax
       05:AB13  A0 01              ldy    #1
       05:AB15  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:AB17  86 0B              stx    <__ptr
       05:AB19  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:AB1B  A6 03              ldx    <__temp
       05:AB1D  A5 04              lda    <__temp+1
                                  .endif
       05:AB1F  22                 sax
       05:AB20  92 0B              sta    [__ptr]
       05:AB22  22                 sax
                                 __addmi  2,__stack
       05:AB23  48                 pha
       05:AB24  18                 clc
       05:AB25  A5 00              lda    <__stack
       05:AB27  69 02              adc    #low(2)
       05:AB29  85 00              sta    <__stack
       05:AB2B  A5 01              lda    <__stack+1
       05:AB2D  69 00              adc    #high(2)
       05:AB2F  85 01              sta    <__stack+1
       05:AB31  68                 pla
  600                             __stbps
                                 __stw    <__temp
       05:AB32  86 03              stx    <__temp
       05:AB34  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:AB36  B2 00              lda    [__stack]
       05:AB38  AA                 tax
       05:AB39  A0 01              ldy    #1
       05:AB3B  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:AB3D  86 0B              stx    <__ptr
       05:AB3F  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:AB41  A6 03              ldx    <__temp
       05:AB43  A5 04              lda    <__temp+1
                                  .endif
       05:AB45  22                 sax
       05:AB46  92 0B              sta    [__ptr]
       05:AB48  22                 sax
                                 __addmi  2,__stack
       05:AB49  48                 pha
       05:AB4A  18                 clc
       05:AB4B  A5 00              lda    <__stack
       05:AB4D  69 02              adc    #low(2)
       05:AB4F  85 00              sta    <__stack
       05:AB51  A5 01              lda    <__stack+1
       05:AB53  69 00              adc    #high(2)
       05:AB55  85 01              sta    <__stack+1
       05:AB57  68                 pla
  601                             __lbra  LL34
       05:AB58  4C AF AA           jmp    LL34
  602  05:AB5B            LL36:
  603                     
  604                             __ldwi  2049
       05:AB5B  A2 01              ldx    #low(2049)
       05:AB5D  A9 08              lda    #high(2049)
  605                             __stw   _bx
       05:AB5F  8E FA 20           stx    _bx
       05:AB62  8D FB 20           sta    _bx+1
  606                             __ldwi  255
       05:AB65  A2 FF              ldx    #low(255)
       05:AB67  A9 00              lda    #high(255)
  607  05:AB69  20 A4 FB            call  _poke.2
  608                             __ldwi  0
       05:AB6C  A2 00              ldx    #low(0)
       05:AB6E  A9 00              lda    #high(0)
  609                             __stw   _i
       05:AB70  8E 24 2A           stx    _i
       05:AB73  8D 25 2A           sta    _i+1
  610  05:AB76            LL37:
  611                     
  612                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:AB76  AE 24 2A           ldx    _i
       05:AB79  AD 25 2A           lda    _i+1
                                  .endif
  613                             __stw   <__temp
       05:AB7C  86 03              stx    <__temp
       05:AB7E  85 04              sta    <__temp+1
  614                             __ldwi  6
       05:AB80  A2 06              ldx    #low(6)
       05:AB82  A9 00              lda    #high(6)
  615  05:AB84  20 A3 E9            jsr   ltzp
  616                             __lbne  LL39
       05:AB87  F0 03              beq    .x01130
       05:AB89  4C A0 AB           jmp    LL39
       05:AB8C            .x01130
  617                             __lbra  LL40
       05:AB8C  4C FA AB           jmp    LL40
  618  05:AB8F            LL38:
  619                     
  620                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:AB8F  AE 24 2A           ldx    _i
       05:AB92  AD 25 2A           lda    _i+1
                                  .endif
  621                             incw    _i
       05:AB95  EE 24 2A           inc    _i              ; value at stated memory
       05:AB98  D0 03              bne    .x_01133           ; location
       05:AB9A  EE 25 2A           inc    _i+1
       05:AB9D            .x_01133:
  622                             __lbra  LL37
       05:AB9D  4C 76 AB           jmp    LL37
  623  05:ABA0            LL39:
  624                     
  625                             __ldw   _i
                0000              .if (1 = 2)
                                  .else
       05:ABA0  AE 24 2A           ldx    _i
       05:ABA3  AD 25 2A           lda    _i+1
                                  .endif
  626  05:ABA6  20 E5 A3            call  _snd_saw
  627                             __ldwi  _ch_cnt
       05:ABA9  A2 88              ldx    #low(_ch_cnt)
       05:ABAB  A9 29              lda    #high(_ch_cnt)
  628                             __addw  _i
       05:ABAD  18                 clc
       05:ABAE  22                 sax
       05:ABAF  6D 24 2A           adc    _i
       05:ABB2  22                 sax
       05:ABB3  6D 25 2A           adc    _i+1
  629                             __pushw
                                 __submi  2,__stack
       05:ABB6  48                 pha
       05:ABB7  38                 sec
       05:ABB8  A5 00              lda    <__stack
       05:ABBA  E9 02              sbc    #low(2)
       05:ABBC  85 00              sta    <__stack
       05:ABBE  A5 01              lda    <__stack+1
       05:ABC0  E9 00              sbc    #high(2)
       05:ABC2  85 01              sta    <__stack+1
       05:ABC4  68                 pla
       05:ABC5  22                 sax
       05:ABC6  92 00              sta    [__stack]
       05:ABC8  22                 sax
       05:ABC9  A0 01              ldy    #1
       05:ABCB  91 00              sta    [__stack],Y
  630                             __ldwi  0
       05:ABCD  A2 00              ldx    #low(0)
       05:ABCF  A9 00              lda    #high(0)
  631                             __stbps
                                 __stw    <__temp
       05:ABD1  86 03              stx    <__temp
       05:ABD3  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:ABD5  B2 00              lda    [__stack]
       05:ABD7  AA                 tax
       05:ABD8  A0 01              ldy    #1
       05:ABDA  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:ABDC  86 0B              stx    <__ptr
       05:ABDE  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:ABE0  A6 03              ldx    <__temp
       05:ABE2  A5 04              lda    <__temp+1
                                  .endif
       05:ABE4  22                 sax
       05:ABE5  92 0B              sta    [__ptr]
       05:ABE7  22                 sax
                                 __addmi  2,__stack
       05:ABE8  48                 pha
       05:ABE9  18                 clc
       05:ABEA  A5 00              lda    <__stack
       05:ABEC  69 02              adc    #low(2)
       05:ABEE  85 00              sta    <__stack
       05:ABF0  A5 01              lda    <__stack+1
       05:ABF2  69 00              adc    #high(2)
       05:ABF4  85 01              sta    <__stack+1
       05:ABF6  68                 pla
  632                             __lbra  LL38
       05:ABF7  4C 8F AB           jmp    LL38
  633  05:ABFA            LL40:
  634                     
  635  05:ABFA  20 B4 A2            call  _init_pcmdrv
  636  05:ABFD  20 3C A6            call  _set_drvintr
  637  05:AC00            LL28:
  638                     
  639                             __addmi 2,__stack
       05:AC00  48                 pha
       05:AC01  18                 clc
       05:AC02  A5 00              lda    <__stack
       05:AC04  69 02              adc    #low(2)
       05:AC06  85 00              sta    <__stack
       05:AC08  A5 01              lda    <__stack+1
       05:AC0A  69 00              adc    #high(2)
       05:AC0C  85 01              sta    <__stack+1
       05:AC0E  68                 pla
  640  05:AC0F  60                  rts
  641                             .endp
  642                     
  643  05:4C10                    .proc _set_vol
  644                             __pushw
                                 __submi  2,__stack
       05:AC10  48                 pha
       05:AC11  38                 sec
       05:AC12  A5 00              lda    <__stack
       05:AC14  E9 02              sbc    #low(2)
       05:AC16  85 00              sta    <__stack
       05:AC18  A5 01              lda    <__stack+1
       05:AC1A  E9 00              sbc    #high(2)
       05:AC1C  85 01              sta    <__stack+1
       05:AC1E  68                 pla
       05:AC1F  22                 sax
       05:AC20  92 00              sta    [__stack]
       05:AC22  22                 sax
       05:AC23  A0 01              ldy    #1
       05:AC25  91 00              sta    [__stack],Y
  645                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:AC27  B2 00               lda   [__sp]
       05:AC29  AA                  tax
       05:AC2A  A0 01               ldy   #1
       05:AC2C  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  646                             __andwi 128
       05:AC2E  22                 sax
       05:AC2F  29 80              and    #low(128)
       05:AC31  22                 sax
       05:AC32  29 00              and    #high(128)
  647                             __tstw
                                   ; pha
       05:AC34  86 03              stx    <__temp
       05:AC36  05 03              ora    <__temp
                                   ; pla
  648                             __lbeq  LL42
       05:AC38  D0 03              bne    .x01154
       05:AC3A  4C A8 AC           jmp    LL42
       05:AC3D            .x01154
  649                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       05:AC3D  A0 02               ldy   #2
       05:AC3F  B1 00               lda   [__sp],Y
       05:AC41  AA                  tax
       05:AC42  C8                  iny
       05:AC43  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  650                             __aslw
       05:AC45  22                 sax
       05:AC46  0A                 asl    A
       05:AC47  22                 sax
       05:AC48  2A                 rol    A
  651                             __addwi _volume_envadr
       05:AC49  18                 clc
       05:AC4A  22                 sax
       05:AC4B  69 04              adc    #low(_volume_envadr)
       05:AC4D  22                 sax
       05:AC4E  69 2A              adc    #high(_volume_envadr)
  652                             __pushw
                                 __submi  2,__stack
       05:AC50  48                 pha
       05:AC51  38                 sec
       05:AC52  A5 00              lda    <__stack
       05:AC54  E9 02              sbc    #low(2)
       05:AC56  85 00              sta    <__stack
       05:AC58  A5 01              lda    <__stack+1
       05:AC5A  E9 00              sbc    #high(2)
       05:AC5C  85 01              sta    <__stack+1
       05:AC5E  68                 pla
       05:AC5F  22                 sax
       05:AC60  92 00              sta    [__stack]
       05:AC62  22                 sax
       05:AC63  A0 01              ldy    #1
       05:AC65  91 00              sta    [__stack],Y
  653                             __ldwi  0
       05:AC67  A2 00              ldx    #low(0)
       05:AC69  A9 00              lda    #high(0)
  654                             __stwps
                                 __stw    <__temp
       05:AC6B  86 03              stx    <__temp
       05:AC6D  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:AC6F  B2 00              lda    [__stack]
       05:AC71  AA                 tax
       05:AC72  A0 01              ldy    #1
       05:AC74  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:AC76  86 0B              stx    <__ptr
       05:AC78  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:AC7A  A6 03              ldx    <__temp
       05:AC7C  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:AC7E  22                 sax
       05:AC7F  92 0B              sta    [__ptr]
       05:AC81  22                 sax
       05:AC82  A0 01              ldy    #1
       05:AC84  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:AC86  48                 pha
       05:AC87  18                 clc
       05:AC88  A5 00              lda    <__stack
       05:AC8A  69 02              adc    #low(2)
       05:AC8C  85 00              sta    <__stack
       05:AC8E  A5 01              lda    <__stack+1
       05:AC90  69 00              adc    #high(2)
       05:AC92  85 01              sta    <__stack+1
       05:AC94  68                 pla
  655                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:AC95  B2 00               lda   [__sp]
       05:AC97  AA                  tax
       05:AC98  A0 01               ldy   #1
       05:AC9A  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  656                             __andwi 31
       05:AC9C  22                 sax
       05:AC9D  29 1F              and    #low(31)
       05:AC9F  22                 sax
       05:ACA0  29 00              and    #high(31)
  657  05:ACA2  20 DB A2            call  _mixvol
  658                             __lbra  LL43
       05:ACA5  4C 9A AD           jmp    LL43
  659  05:ACA8            LL42:
  660                     
  661                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       05:ACA8  B2 00               lda   [__sp]
       05:ACAA  AA                  tax
       05:ACAB  A0 01               ldy   #1
       05:ACAD  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
  662                             __andwi 127
       05:ACAF  22                 sax
       05:ACB0  29 7F              and    #low(127)
       05:ACB2  22                 sax
       05:ACB3  29 00              and    #high(127)
  663                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       05:ACB5  22                 sax
       05:ACB6  A0 00              ldy    #0
       05:ACB8  91 00              sta    [__sp],Y
       05:ACBA  22                 sax
       05:ACBB  C8                 iny
       05:ACBC  91 00              sta    [__sp],Y
                                  .else
                                  .endif
  664                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       05:ACBE  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01175
                          ;        dec    A
                          ;.x_01175:
       05:ACC1  62                 cla    ; unsigned
                                  .endif
  665  05:ACC2  20 CD A2            call  _chg_cbank
  666                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       05:ACC5  A0 02               ldy   #2
       05:ACC7  B1 00               lda   [__sp],Y
       05:ACC9  AA                  tax
       05:ACCA  C8                  iny
       05:ACCB  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  667                             __aslw
       05:ACCD  22                 sax
       05:ACCE  0A                 asl    A
       05:ACCF  22                 sax
       05:ACD0  2A                 rol    A
  668                             __addwi _volume_envadr
       05:ACD1  18                 clc
       05:ACD2  22                 sax
       05:ACD3  69 04              adc    #low(_volume_envadr)
       05:ACD5  22                 sax
       05:ACD6  69 2A              adc    #high(_volume_envadr)
  669                             __pushw
                                 __submi  2,__stack
       05:ACD8  48                 pha
       05:ACD9  38                 sec
       05:ACDA  A5 00              lda    <__stack
       05:ACDC  E9 02              sbc    #low(2)
       05:ACDE  85 00              sta    <__stack
       05:ACE0  A5 01              lda    <__stack+1
       05:ACE2  E9 00              sbc    #high(2)
       05:ACE4  85 01              sta    <__stack+1
       05:ACE6  68                 pla
       05:ACE7  22                 sax
       05:ACE8  92 00              sta    [__stack]
       05:ACEA  22                 sax
       05:ACEB  A0 01              ldy    #1
       05:ACED  91 00              sta    [__stack],Y
  670                             __ldwi  _sound_dat
       05:ACEF  A2 00              ldx    #low(_sound_dat)
       05:ACF1  A9 44              lda    #high(_sound_dat)
  671                             __addwi 4
       05:ACF3  18                 clc
       05:ACF4  22                 sax
       05:ACF5  69 04              adc    #low(4)
       05:ACF7  22                 sax
       05:ACF8  69 00              adc    #high(4)
  672                             __stw   __ptr
       05:ACFA  8E 0B 20           stx    __ptr
       05:ACFD  8D 0C 20           sta    __ptr+1
  673                             __ldwp  __ptr
       05:AD00  B2 0B              lda    [__ptr]
       05:AD02  AA                 tax
       05:AD03  A0 01              ldy    #1
       05:AD05  B1 0B              lda    [__ptr],Y
  674                             __pushw
                                 __submi  2,__stack
       05:AD07  48                 pha
       05:AD08  38                 sec
       05:AD09  A5 00              lda    <__stack
       05:AD0B  E9 02              sbc    #low(2)
       05:AD0D  85 00              sta    <__stack
       05:AD0F  A5 01              lda    <__stack+1
       05:AD11  E9 00              sbc    #high(2)
       05:AD13  85 01              sta    <__stack+1
       05:AD15  68                 pla
       05:AD16  22                 sax
       05:AD17  92 00              sta    [__stack]
       05:AD19  22                 sax
       05:AD1A  A0 01              ldy    #1
       05:AD1C  91 00              sta    [__stack],Y
  675                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       05:AD1E  A0 04               ldy   #4
       05:AD20  B1 00               lda   [__sp],Y
       05:AD22  AA                  tax
       05:AD23  C8                  iny
       05:AD24  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  676                             __pushw
                                 __submi  2,__stack
       05:AD26  48                 pha
       05:AD27  38                 sec
       05:AD28  A5 00              lda    <__stack
       05:AD2A  E9 02              sbc    #low(2)
       05:AD2C  85 00              sta    <__stack
       05:AD2E  A5 01              lda    <__stack+1
       05:AD30  E9 00              sbc    #high(2)
       05:AD32  85 01              sta    <__stack+1
       05:AD34  68                 pla
       05:AD35  22                 sax
       05:AD36  92 00              sta    [__stack]
       05:AD38  22                 sax
       05:AD39  A0 01              ldy    #1
       05:AD3B  91 00              sta    [__stack],Y
  677                             __ldwi  1
       05:AD3D  A2 01              ldx    #low(1)
       05:AD3F  A9 00              lda    #high(1)
  678  05:AD41  20 60 EA            jsr   asl
  679                             __addws
       05:AD44  22                 sax
       05:AD45  18                 clc
       05:AD46  72 00              adc    [__stack]
       05:AD48  22                 sax
       05:AD49  A0 01              ldy    #1
       05:AD4B  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       05:AD4D  48                 pha
       05:AD4E  18                 clc
       05:AD4F  A5 00              lda    <__stack
       05:AD51  69 02              adc    #low(2)
       05:AD53  85 00              sta    <__stack
       05:AD55  A5 01              lda    <__stack+1
       05:AD57  69 00              adc    #high(2)
       05:AD59  85 01              sta    <__stack+1
       05:AD5B  68                 pla
  680                             __stw   __ptr
       05:AD5C  8E 0B 20           stx    __ptr
       05:AD5F  8D 0C 20           sta    __ptr+1
  681                             __ldwp  __ptr
       05:AD62  B2 0B              lda    [__ptr]
       05:AD64  AA                 tax
       05:AD65  A0 01              ldy    #1
       05:AD67  B1 0B              lda    [__ptr],Y
  682                             __stwps
                                 __stw    <__temp
       05:AD69  86 03              stx    <__temp
       05:AD6B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:AD6D  B2 00              lda    [__stack]
       05:AD6F  AA                 tax
       05:AD70  A0 01              ldy    #1
       05:AD72  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:AD74  86 0B              stx    <__ptr
       05:AD76  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:AD78  A6 03              ldx    <__temp
       05:AD7A  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:AD7C  22                 sax
       05:AD7D  92 0B              sta    [__ptr]
       05:AD7F  22                 sax
       05:AD80  A0 01              ldy    #1
       05:AD82  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:AD84  48                 pha
       05:AD85  18                 clc
       05:AD86  A5 00              lda    <__stack
       05:AD88  69 02              adc    #low(2)
       05:AD8A  85 00              sta    <__stack
       05:AD8C  A5 01              lda    <__stack+1
       05:AD8E  69 00              adc    #high(2)
       05:AD90  85 01              sta    <__stack+1
       05:AD92  68                 pla
  683                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       05:AD93  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01203
                          ;        dec    A
                          ;.x_01203:
       05:AD96  62                 cla    ; unsigned
                                  .endif
  684  05:AD97  20 CD A2            call  _chg_cbank
  685  05:AD9A            LL43:
  686                     
  687  05:AD9A            LL41:
  688                     
  689                             __addmi 4,__stack
       05:AD9A  48                 pha
       05:AD9B  18                 clc
       05:AD9C  A5 00              lda    <__stack
       05:AD9E  69 04              adc    #low(4)
       05:ADA0  85 00              sta    <__stack
       05:ADA2  A5 01              lda    <__stack+1
       05:ADA4  69 00              adc    #high(4)
       05:ADA6  85 01              sta    <__stack+1
       05:ADA8  68                 pla
  690  05:ADA9  60                  rts
  691                             .endp
  692                     
  693  05:4DAA                    .proc _set_note
  694                             __pushw
                                 __submi  2,__stack
       05:ADAA  48                 pha
       05:ADAB  38                 sec
       05:ADAC  A5 00              lda    <__stack
       05:ADAE  E9 02              sbc    #low(2)
       05:ADB0  85 00              sta    <__stack
       05:ADB2  A5 01              lda    <__stack+1
       05:ADB4  E9 00              sbc    #high(2)
       05:ADB6  85 01              sta    <__stack+1
       05:ADB8  68                 pla
       05:ADB9  22                 sax
       05:ADBA  92 00              sta    [__stack]
       05:ADBC  22                 sax
       05:ADBD  A0 01              ldy    #1
       05:ADBF  91 00              sta    [__stack],Y
  695                             __addmi -1,__stack
       05:ADC1  48                 pha
       05:ADC2  18                 clc
       05:ADC3  A5 00              lda    <__stack
       05:ADC5  69 FF              adc    #low(-1)
       05:ADC7  85 00              sta    <__stack
       05:ADC9  A5 01              lda    <__stack+1
       05:ADCB  69 FF              adc    #high(-1)
       05:ADCD  85 01              sta    <__stack+1
       05:ADCF  68                 pla
  696                             __ldb_s 1
                0001              .if (1 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:ADD0  A0 01              ldy    #1
       05:ADD2  B1 00              lda    [__sp],Y
       05:ADD4  AA                 tax
       05:ADD5  62                 cla
                          ;        bpl    .x_01208   ; signed
                          ;        dec    A
                          ;.x_01208:
                                  .else
                                  .endif
  697                             __addwi 3
       05:ADD6  18                 clc
       05:ADD7  22                 sax
       05:ADD8  69 03              adc    #low(3)
       05:ADDA  22                 sax
       05:ADDB  69 00              adc    #high(3)
  698                             __andwi 15
       05:ADDD  22                 sax
       05:ADDE  29 0F              and    #low(15)
       05:ADE0  22                 sax
       05:ADE1  29 00              and    #high(15)
  699                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       05:ADE3  22                 sax
       05:ADE4  A0 00              ldy    #0
       05:ADE6  91 00              sta    [__sp],Y
       05:ADE8  22                 sax
                                  .else
                                  .endif
  700                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:ADE9  A0 00              ldy    #0
       05:ADEB  B1 00              lda    [__sp],Y
       05:ADED  AA                 tax
       05:ADEE  62                 cla
                          ;        bpl    .x_01212   ; signed
                          ;        dec    A
                          ;.x_01212:
                                  .else
                                  .endif
  701                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       05:ADEF  A8                 tay
       05:ADF0  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       05:ADF2  18                 clc
       05:ADF3  69 04              adc    #4
                                  .endif
       05:ADF5  85 02              sta    <__arg_idx
       05:ADF7  42                 say
                                  .else
                                  .endif
                          
       05:ADF8  99 60 2A           sta    __arg-(4),Y
       05:ADFB  8A                 txa
       05:ADFC  99 61 2A           sta    __arg-(4-1),Y
  702                             __ldwi  2
       05:ADFF  A2 02              ldx    #low(2)
       05:AE01  A9 00              lda    #high(2)
  703                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       05:AE03  A4 02              ldy    <__arg_idx
                                  .endif
                          
       05:AE05  8A                 txa
       05:AE06  99 62 2A           sta    __arg-(2),Y
  704                             __ldwi  5
       05:AE09  A2 05              ldx    #low(5)
       05:AE0B  A9 00              lda    #high(5)
  705                             __pushw
                                 __submi  2,__stack
       05:AE0D  48                 pha
       05:AE0E  38                 sec
       05:AE0F  A5 00              lda    <__stack
       05:AE11  E9 02              sbc    #low(2)
       05:AE13  85 00              sta    <__stack
       05:AE15  A5 01              lda    <__stack+1
       05:AE17  E9 00              sbc    #high(2)
       05:AE19  85 01              sta    <__stack+1
       05:AE1B  68                 pla
       05:AE1C  22                 sax
       05:AE1D  92 00              sta    [__stack]
       05:AE1F  22                 sax
       05:AE20  A0 01              ldy    #1
       05:AE22  91 00              sta    [__stack],Y
  706                             __ldb_s 5
                0001              .if (5 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:AE24  A0 05              ldy    #5
       05:AE26  B1 00              lda    [__sp],Y
       05:AE28  AA                 tax
       05:AE29  62                 cla
                          ;        bpl    .x_01220   ; signed
                          ;        dec    A
                          ;.x_01220:
                                  .else
                                  .endif
  707                             __pushw
                                 __submi  2,__stack
       05:AE2A  48                 pha
       05:AE2B  38                 sec
       05:AE2C  A5 00              lda    <__stack
       05:AE2E  E9 02              sbc    #low(2)
       05:AE30  85 00              sta    <__stack
       05:AE32  A5 01              lda    <__stack+1
       05:AE34  E9 00              sbc    #high(2)
       05:AE36  85 01              sta    <__stack+1
       05:AE38  68                 pla
       05:AE39  22                 sax
       05:AE3A  92 00              sta    [__stack]
       05:AE3C  22                 sax
       05:AE3D  A0 01              ldy    #1
       05:AE3F  91 00              sta    [__stack],Y
  708                             __ldwi  2
       05:AE41  A2 02              ldx    #low(2)
       05:AE43  A9 00              lda    #high(2)
  709  05:AE45  20 60 EA            jsr   asl
  710                             __addws
       05:AE48  22                 sax
       05:AE49  18                 clc
       05:AE4A  72 00              adc    [__stack]
       05:AE4C  22                 sax
       05:AE4D  A0 01              ldy    #1
       05:AE4F  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       05:AE51  48                 pha
       05:AE52  18                 clc
       05:AE53  A5 00              lda    <__stack
       05:AE55  69 02              adc    #low(2)
       05:AE57  85 00              sta    <__stack
       05:AE59  A5 01              lda    <__stack+1
       05:AE5B  69 00              adc    #high(2)
       05:AE5D  85 01              sta    <__stack+1
       05:AE5F  68                 pla
  711                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       05:AE60  A4 02              ldy    <__arg_idx
                                  .endif
                          
       05:AE62  8A                 txa
       05:AE63  99 63 2A           sta    __arg-(1),Y
  712                             __ldwi  13
       05:AE66  A2 0D              ldx    #low(13)
       05:AE68  A9 00              lda    #high(13)
  713  05:AE6A  20 2F EF            call  _put_hex.4
  714                             __ldwi  _seq_freq
       05:AE6D  A2 E4              ldx    #low(_seq_freq)
       05:AE6F  A9 29              lda    #high(_seq_freq)
  715                             __pushw
                                 __submi  2,__stack
       05:AE71  48                 pha
       05:AE72  38                 sec
       05:AE73  A5 00              lda    <__stack
       05:AE75  E9 02              sbc    #low(2)
       05:AE77  85 00              sta    <__stack
       05:AE79  A5 01              lda    <__stack+1
       05:AE7B  E9 00              sbc    #high(2)
       05:AE7D  85 01              sta    <__stack+1
       05:AE7F  68                 pla
       05:AE80  22                 sax
       05:AE81  92 00              sta    [__stack]
       05:AE83  22                 sax
       05:AE84  A0 01              ldy    #1
       05:AE86  91 00              sta    [__stack],Y
  716                             __ldb_s 5
                0001              .if (5 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:AE88  A0 05              ldy    #5
       05:AE8A  B1 00              lda    [__sp],Y
       05:AE8C  AA                 tax
       05:AE8D  62                 cla
                          ;        bpl    .x_01231   ; signed
                          ;        dec    A
                          ;.x_01231:
                                  .else
                                  .endif
  717                             __aslw
       05:AE8E  22                 sax
       05:AE8F  0A                 asl    A
       05:AE90  22                 sax
       05:AE91  2A                 rol    A
  718                             __addws
       05:AE92  22                 sax
       05:AE93  18                 clc
       05:AE94  72 00              adc    [__stack]
       05:AE96  22                 sax
       05:AE97  A0 01              ldy    #1
       05:AE99  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       05:AE9B  48                 pha
       05:AE9C  18                 clc
       05:AE9D  A5 00              lda    <__stack
       05:AE9F  69 02              adc    #low(2)
       05:AEA1  85 00              sta    <__stack
       05:AEA3  A5 01              lda    <__stack+1
       05:AEA5  69 00              adc    #high(2)
       05:AEA7  85 01              sta    <__stack+1
       05:AEA9  68                 pla
  719                             __pushw
                                 __submi  2,__stack
       05:AEAA  48                 pha
       05:AEAB  38                 sec
       05:AEAC  A5 00              lda    <__stack
       05:AEAE  E9 02              sbc    #low(2)
       05:AEB0  85 00              sta    <__stack
       05:AEB2  A5 01              lda    <__stack+1
       05:AEB4  E9 00              sbc    #high(2)
       05:AEB6  85 01              sta    <__stack+1
       05:AEB8  68                 pla
       05:AEB9  22                 sax
       05:AEBA  92 00              sta    [__stack]
       05:AEBC  22                 sax
       05:AEBD  A0 01              ldy    #1
       05:AEBF  91 00              sta    [__stack],Y
  720                             __ldwi  _freq
       05:AEC1  A2 1C              ldx    #low(_freq)
       05:AEC3  A9 40              lda    #high(_freq)
  721                             __pushw
                                 __submi  2,__stack
       05:AEC5  48                 pha
       05:AEC6  38                 sec
       05:AEC7  A5 00              lda    <__stack
       05:AEC9  E9 02              sbc    #low(2)
       05:AECB  85 00              sta    <__stack
       05:AECD  A5 01              lda    <__stack+1
       05:AECF  E9 00              sbc    #high(2)
       05:AED1  85 01              sta    <__stack+1
       05:AED3  68                 pla
       05:AED4  22                 sax
       05:AED5  92 00              sta    [__stack]
       05:AED7  22                 sax
       05:AED8  A0 01              ldy    #1
       05:AEDA  91 00              sta    [__stack],Y
  722                             __ldb_s 4
                0001              .if (4 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:AEDC  A0 04              ldy    #4
       05:AEDE  B1 00              lda    [__sp],Y
       05:AEE0  AA                 tax
       05:AEE1  62                 cla
                          ;        bpl    .x_01240   ; signed
                          ;        dec    A
                          ;.x_01240:
                                  .else
                                  .endif
  723                             __andwi 15
       05:AEE2  22                 sax
       05:AEE3  29 0F              and    #low(15)
       05:AEE5  22                 sax
       05:AEE6  29 00              and    #high(15)
  724                             __aslw
       05:AEE8  22                 sax
       05:AEE9  0A                 asl    A
       05:AEEA  22                 sax
       05:AEEB  2A                 rol    A
  725                             __addws
       05:AEEC  22                 sax
       05:AEED  18                 clc
       05:AEEE  72 00              adc    [__stack]
       05:AEF0  22                 sax
       05:AEF1  A0 01              ldy    #1
       05:AEF3  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       05:AEF5  48                 pha
       05:AEF6  18                 clc
       05:AEF7  A5 00              lda    <__stack
       05:AEF9  69 02              adc    #low(2)
       05:AEFB  85 00              sta    <__stack
       05:AEFD  A5 01              lda    <__stack+1
       05:AEFF  69 00              adc    #high(2)
       05:AF01  85 01              sta    <__stack+1
       05:AF03  68                 pla
  726                             __stw   __ptr
       05:AF04  8E 0B 20           stx    __ptr
       05:AF07  8D 0C 20           sta    __ptr+1
  727                             __ldwp  __ptr
       05:AF0A  B2 0B              lda    [__ptr]
       05:AF0C  AA                 tax
       05:AF0D  A0 01              ldy    #1
       05:AF0F  B1 0B              lda    [__ptr],Y
  728                             __pushw
                                 __submi  2,__stack
       05:AF11  48                 pha
       05:AF12  38                 sec
       05:AF13  A5 00              lda    <__stack
       05:AF15  E9 02              sbc    #low(2)
       05:AF17  85 00              sta    <__stack
       05:AF19  A5 01              lda    <__stack+1
       05:AF1B  E9 00              sbc    #high(2)
       05:AF1D  85 01              sta    <__stack+1
       05:AF1F  68                 pla
       05:AF20  22                 sax
       05:AF21  92 00              sta    [__stack]
       05:AF23  22                 sax
       05:AF24  A0 01              ldy    #1
       05:AF26  91 00              sta    [__stack],Y
  729                             __ldb_s 5
                0001              .if (5 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       05:AF28  A0 05              ldy    #5
       05:AF2A  B1 00              lda    [__sp],Y
       05:AF2C  AA                 tax
       05:AF2D  62                 cla
                          ;        bpl    .x_01249   ; signed
                          ;        dec    A
                          ;.x_01249:
                                  .else
                                  .endif
  730                             __pushw
                                 __submi  2,__stack
       05:AF2E  48                 pha
       05:AF2F  38                 sec
       05:AF30  A5 00              lda    <__stack
       05:AF32  E9 02              sbc    #low(2)
       05:AF34  85 00              sta    <__stack
       05:AF36  A5 01              lda    <__stack+1
       05:AF38  E9 00              sbc    #high(2)
       05:AF3A  85 01              sta    <__stack+1
       05:AF3C  68                 pla
       05:AF3D  22                 sax
       05:AF3E  92 00              sta    [__stack]
       05:AF40  22                 sax
       05:AF41  A0 01              ldy    #1
       05:AF43  91 00              sta    [__stack],Y
  731                             __ldwi  4
       05:AF45  A2 04              ldx    #low(4)
       05:AF47  A9 00              lda    #high(4)
  732  05:AF49  20 89 EA            jsr   asr
  733  05:AF4C  20 89 EA            jsr   asr
  734                             __stwps
                                 __stw    <__temp
       05:AF4F  86 03              stx    <__temp
       05:AF51  85 04              sta    <__temp+1
                                 __ldwp    __stack
       05:AF53  B2 00              lda    [__stack]
       05:AF55  AA                 tax
       05:AF56  A0 01              ldy    #1
       05:AF58  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       05:AF5A  86 0B              stx    <__ptr
       05:AF5C  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       05:AF5E  A6 03              ldx    <__temp
       05:AF60  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       05:AF62  22                 sax
       05:AF63  92 0B              sta    [__ptr]
       05:AF65  22                 sax
       05:AF66  A0 01              ldy    #1
       05:AF68  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       05:AF6A  48                 pha
       05:AF6B  18                 clc
       05:AF6C  A5 00              lda    <__stack
       05:AF6E  69 02              adc    #low(2)
       05:AF70  85 00              sta    <__stack
       05:AF72  A5 01              lda    <__stack+1
       05:AF74  69 00              adc    #high(2)
       05:AF76  85 01              sta    <__stack+1
       05:AF78  68                 pla
  735  05:AF79            LL44:
  736                     
  737                             __addmi 5,__stack
       05:AF79  48                 pha
       05:AF7A  18                 clc
       05:AF7B  A5 00              lda    <__stack
       05:AF7D  69 05              adc    #low(5)
       05:AF7F  85 00              sta    <__stack
       05:AF81  A5 01              lda    <__stack+1
       05:AF83  69 00              adc    #high(5)
       05:AF85  85 01              sta    <__stack+1
       05:AF87  68                 pla
  738  05:AF88  60                  rts
  739                             .endp
  740                     
  741  06:4000                    .proc _seq
  742                             __pushw
                                 __submi  2,__stack
       06:A000  48                 pha
       06:A001  38                 sec
       06:A002  A5 00              lda    <__stack
       06:A004  E9 02              sbc    #low(2)
       06:A006  85 00              sta    <__stack
       06:A008  A5 01              lda    <__stack+1
       06:A00A  E9 00              sbc    #high(2)
       06:A00C  85 01              sta    <__stack+1
       06:A00E  68                 pla
       06:A00F  22                 sax
       06:A010  92 00              sta    [__stack]
       06:A012  22                 sax
       06:A013  A0 01              ldy    #1
       06:A015  91 00              sta    [__stack],Y
  743                             __addmi -4,__stack
       06:A017  48                 pha
       06:A018  18                 clc
       06:A019  A5 00              lda    <__stack
       06:A01B  69 FC              adc    #low(-4)
       06:A01D  85 00              sta    <__stack
       06:A01F  A5 01              lda    <__stack+1
       06:A021  69 FF              adc    #high(-4)
       06:A023  85 01              sta    <__stack+1
       06:A025  68                 pla
  744  06:A026            LL46:
  745                     
  746                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       06:A026  A0 04               ldy   #4
       06:A028  B1 00               lda   [__sp],Y
       06:A02A  AA                  tax
       06:A02B  C8                  iny
       06:A02C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  747                             __stw   <__temp
       06:A02E  86 03              stx    <__temp
       06:A030  85 04              sta    <__temp+1
  748                             __ldwi  144
       06:A032  A2 90              ldx    #low(144)
       06:A034  A9 00              lda    #high(144)
  749  06:A036  20 FA E9            jsr   gezp
  750                             __lbeq  LL47
       06:A039  D0 03              bne    .x01267
       06:A03B  4C 4D AF           jmp    LL47
       06:A03E            .x01267
  751                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       06:A03E  A0 04               ldy   #4
       06:A040  B1 00               lda   [__sp],Y
       06:A042  AA                  tax
       06:A043  C8                  iny
       06:A044  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  752                             __stw   <__temp
       06:A046  86 03              stx    <__temp
       06:A048  85 04              sta    <__temp+1
  753                             __ldwi  236
       06:A04A  A2 EC              ldx    #low(236)
       06:A04C  A9 00              lda    #high(236)
  754  06:A04E  20 FA E9            jsr   gezp
  755                             __lbeq  LL48
       06:A051  D0 03              bne    .x01271
       06:A053  4C 9C AB           jmp    LL48
       06:A056            .x01271
  756                             __ldwi  _seqproc
       06:A056  A2 D3              ldx    #low(_seqproc)
       06:A058  A9 FD              lda    #high(_seqproc)
  757                             __pushw
                                 __submi  2,__stack
       06:A05A  48                 pha
       06:A05B  38                 sec
       06:A05C  A5 00              lda    <__stack
       06:A05E  E9 02              sbc    #low(2)
       06:A060  85 00              sta    <__stack
       06:A062  A5 01              lda    <__stack+1
       06:A064  E9 00              sbc    #high(2)
       06:A066  85 01              sta    <__stack+1
       06:A068  68                 pla
       06:A069  22                 sax
       06:A06A  92 00              sta    [__stack]
       06:A06C  22                 sax
       06:A06D  A0 01              ldy    #1
       06:A06F  91 00              sta    [__stack],Y
  758                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A071  A0 06               ldy   #6
       06:A073  B1 00               lda   [__sp],Y
       06:A075  AA                  tax
       06:A076  C8                  iny
       06:A077  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  759                             __subwi 236
       06:A079  38                 sec
       06:A07A  22                 sax
       06:A07B  E9 EC              sbc    #low(236)
       06:A07D  22                 sax
       06:A07E  E9 00              sbc    #high(236)
  760                             __aslw
       06:A080  22                 sax
       06:A081  0A                 asl    A
       06:A082  22                 sax
       06:A083  2A                 rol    A
  761                             __addws
       06:A084  22                 sax
       06:A085  18                 clc
       06:A086  72 00              adc    [__stack]
       06:A088  22                 sax
       06:A089  A0 01              ldy    #1
       06:A08B  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:A08D  48                 pha
       06:A08E  18                 clc
       06:A08F  A5 00              lda    <__stack
       06:A091  69 02              adc    #low(2)
       06:A093  85 00              sta    <__stack
       06:A095  A5 01              lda    <__stack+1
       06:A097  69 00              adc    #high(2)
       06:A099  85 01              sta    <__stack+1
       06:A09B  68                 pla
  762                             __stw   __ptr
       06:A09C  8E 0B 20           stx    __ptr
       06:A09F  8D 0C 20           sta    __ptr+1
  763                             __ldwp  __ptr
       06:A0A2  B2 0B              lda    [__ptr]
       06:A0A4  AA                 tax
       06:A0A5  A0 01              ldy    #1
       06:A0A7  B1 0B              lda    [__ptr],Y
  764                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:A0A9  22                 sax
       06:A0AA  A0 00              ldy    #0
       06:A0AC  91 00              sta    [__sp],Y
       06:A0AE  22                 sax
       06:A0AF  C8                 iny
       06:A0B0  91 00              sta    [__sp],Y
                                  .else
                                  .endif
  765                     ;  make jump
  766                     ;  sax
  767  06:A0B2  48          pha
  768  06:A0B3  22          sax
  769  06:A0B4  48          pha
  770  06:A0B5  60          rts
  771  06:A0B6            SEQ_FF:
  772  06:A0B6  EA          nop
  773                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       06:A0B7  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01284
                          ;        dec    A
                          ;.x_01284:
       06:A0BA  62                 cla    ; unsigned
                                  .endif
  774  06:A0BB  20 00 80            call  _chg_cbank
  775                             __ldwi  _sound_dat
       06:A0BE  A2 00              ldx    #low(_sound_dat)
       06:A0C0  A9 44              lda    #high(_sound_dat)
  776                             __addwi 2
       06:A0C2  18                 clc
       06:A0C3  22                 sax
       06:A0C4  69 02              adc    #low(2)
       06:A0C6  22                 sax
       06:A0C7  69 00              adc    #high(2)
  777                             __stw   __ptr
       06:A0C9  8E 0B 20           stx    __ptr
       06:A0CC  8D 0C 20           sta    __ptr+1
  778                             __ldwp  __ptr
       06:A0CF  B2 0B              lda    [__ptr]
       06:A0D1  AA                 tax
       06:A0D2  A0 01              ldy    #1
       06:A0D4  B1 0B              lda    [__ptr],Y
  779                             __pushw
                                 __submi  2,__stack
       06:A0D6  48                 pha
       06:A0D7  38                 sec
       06:A0D8  A5 00              lda    <__stack
       06:A0DA  E9 02              sbc    #low(2)
       06:A0DC  85 00              sta    <__stack
       06:A0DE  A5 01              lda    <__stack+1
       06:A0E0  E9 00              sbc    #high(2)
       06:A0E2  85 01              sta    <__stack+1
       06:A0E4  68                 pla
       06:A0E5  22                 sax
       06:A0E6  92 00              sta    [__stack]
       06:A0E8  22                 sax
       06:A0E9  A0 01              ldy    #1
       06:A0EB  91 00              sta    [__stack],Y
  780                             __ldw_s 8
                0001              .if (8 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (8 = 0)
                                   .else
       06:A0ED  A0 08               ldy   #8
       06:A0EF  B1 00               lda   [__sp],Y
       06:A0F1  AA                  tax
       06:A0F2  C8                  iny
       06:A0F3  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  781                             __pushw
                                 __submi  2,__stack
       06:A0F5  48                 pha
       06:A0F6  38                 sec
       06:A0F7  A5 00              lda    <__stack
       06:A0F9  E9 02              sbc    #low(2)
       06:A0FB  85 00              sta    <__stack
       06:A0FD  A5 01              lda    <__stack+1
       06:A0FF  E9 00              sbc    #high(2)
       06:A101  85 01              sta    <__stack+1
       06:A103  68                 pla
       06:A104  22                 sax
       06:A105  92 00              sta    [__stack]
       06:A107  22                 sax
       06:A108  A0 01              ldy    #1
       06:A10A  91 00              sta    [__stack],Y
  782                             __ldwi  1
       06:A10C  A2 01              ldx    #low(1)
       06:A10E  A9 00              lda    #high(1)
  783  06:A110  20 60 EA            jsr   asl
  784                             __addws
       06:A113  22                 sax
       06:A114  18                 clc
       06:A115  72 00              adc    [__stack]
       06:A117  22                 sax
       06:A118  A0 01              ldy    #1
       06:A11A  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:A11C  48                 pha
       06:A11D  18                 clc
       06:A11E  A5 00              lda    <__stack
       06:A120  69 02              adc    #low(2)
       06:A122  85 00              sta    <__stack
       06:A124  A5 01              lda    <__stack+1
       06:A126  69 00              adc    #high(2)
       06:A128  85 01              sta    <__stack+1
       06:A12A  68                 pla
  785                             __stw   __ptr
       06:A12B  8E 0B 20           stx    __ptr
       06:A12E  8D 0C 20           sta    __ptr+1
  786                             __ldwp  __ptr
       06:A131  B2 0B              lda    [__ptr]
       06:A133  AA                 tax
       06:A134  A0 01              ldy    #1
       06:A136  B1 0B              lda    [__ptr],Y
  787                             __stw   _seq_ptr
       06:A138  8E D2 29           stx    _seq_ptr
       06:A13B  8D D3 29           sta    _seq_ptr+1
  788                             __ldwi  _sound_dat
       06:A13E  A2 00              ldx    #low(_sound_dat)
       06:A140  A9 44              lda    #high(_sound_dat)
  789                             __addwi 16
       06:A142  18                 clc
       06:A143  22                 sax
       06:A144  69 10              adc    #low(16)
       06:A146  22                 sax
       06:A147  69 00              adc    #high(16)
  790                             __stw   __ptr
       06:A149  8E 0B 20           stx    __ptr
       06:A14C  8D 0C 20           sta    __ptr+1
  791                             __ldwp  __ptr
       06:A14F  B2 0B              lda    [__ptr]
       06:A151  AA                 tax
       06:A152  A0 01              ldy    #1
       06:A154  B1 0B              lda    [__ptr],Y
  792                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A156  A0 06              ldy    #6
       06:A158  18                 clc
       06:A159  22                 sax
       06:A15A  71 00              adc    [__sp],Y
       06:A15C  22                 sax
       06:A15D  C8                 iny
       06:A15E  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  793                             __stw   __ptr
       06:A160  8E 0B 20           stx    __ptr
       06:A163  8D 0C 20           sta    __ptr+1
  794                             __ldwp  __ptr
       06:A166  B2 0B              lda    [__ptr]
       06:A168  AA                 tax
       06:A169  A0 01              ldy    #1
       06:A16B  B1 0B              lda    [__ptr],Y
  795  06:A16D  8E A0 29            stx   _ch_nowbank
  796                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       06:A170  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01308
                          ;        dec    A
                          ;.x_01308:
       06:A173  62                 cla    ; unsigned
                                  .endif
  797  06:A174  20 00 80            call  _chg_cbank
  798  06:A177  4C 99 AB                  jmp endpoint
  799  06:A17A            SEQ_FE:
  800  06:A17A  EA          nop
  801                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A17B  AE D2 29           ldx    _seq_ptr
       06:A17E  AD D3 29           lda    _seq_ptr+1
                                  .endif
  802                             __addwi 2
       06:A181  18                 clc
       06:A182  22                 sax
       06:A183  69 02              adc    #low(2)
       06:A185  22                 sax
       06:A186  69 00              adc    #high(2)
  803                             __stw   _seq_ptr
       06:A188  8E D2 29           stx    _seq_ptr
       06:A18B  8D D3 29           sta    _seq_ptr+1
  804  06:A18E  4C 99 AB          jmp endpoint
  805  06:A191            SEQ_F9:
  806  06:A191  EA          nop
  807                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A192  AE D2 29           ldx    _seq_ptr
       06:A195  AD D3 29           lda    _seq_ptr+1
                                  .endif
  808                             __addwi 2
       06:A198  18                 clc
       06:A199  22                 sax
       06:A19A  69 02              adc    #low(2)
       06:A19C  22                 sax
       06:A19D  69 00              adc    #high(2)
  809                             __stw   _seq_ptr
       06:A19F  8E D2 29           stx    _seq_ptr
       06:A1A2  8D D3 29           sta    _seq_ptr+1
  810  06:A1A5  4C 99 AB          jmp endpoint
  811  06:A1A8            SEQ_FD:
  812  06:A1A8  EA          nop
  813                             incw    _seq_ptr
       06:A1A9  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A1AC  D0 03              bne    .x_01315           ; location
       06:A1AE  EE D3 29           inc    _seq_ptr+1
       06:A1B1            .x_01315:
  814                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A1B1  AE D2 29           ldx    _seq_ptr
       06:A1B4  AD D3 29           lda    _seq_ptr+1
                                  .endif
  815                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A1B7  86 0B              stx    <__ptr
       06:A1B9  85 0C              sta    <__ptr+1
       06:A1BB  B2 0B              lda    [__ptr]
       06:A1BD  AA                 tax
       06:A1BE  62                 cla
                          ;        bpl    .x_01317   ; signed
                          ;        dec    A
                          ;.x_01317:
  816                             __stw   _j
       06:A1BF  8E 26 2A           stx    _j
       06:A1C2  8D 27 2A           sta    _j+1
  817                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A1C5  AE D2 29           ldx    _seq_ptr
       06:A1C8  AD D3 29           lda    _seq_ptr+1
                                  .endif
  818                             incw    _seq_ptr
       06:A1CB  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A1CE  D0 03              bne    .x_01320           ; location
       06:A1D0  EE D3 29           inc    _seq_ptr+1
       06:A1D3            .x_01320:
  819                             __ldwi  _ch_vol
       06:A1D3  A2 90              ldx    #low(_ch_vol)
       06:A1D5  A9 29              lda    #high(_ch_vol)
  820                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A1D7  A0 06              ldy    #6
       06:A1D9  18                 clc
       06:A1DA  22                 sax
       06:A1DB  71 00              adc    [__sp],Y
       06:A1DD  22                 sax
       06:A1DE  C8                 iny
       06:A1DF  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  821                             __pushw
                                 __submi  2,__stack
       06:A1E1  48                 pha
       06:A1E2  38                 sec
       06:A1E3  A5 00              lda    <__stack
       06:A1E5  E9 02              sbc    #low(2)
       06:A1E7  85 00              sta    <__stack
       06:A1E9  A5 01              lda    <__stack+1
       06:A1EB  E9 00              sbc    #high(2)
       06:A1ED  85 01              sta    <__stack+1
       06:A1EF  68                 pla
       06:A1F0  22                 sax
       06:A1F1  92 00              sta    [__stack]
       06:A1F3  22                 sax
       06:A1F4  A0 01              ldy    #1
       06:A1F6  91 00              sta    [__stack],Y
  822                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A1F8  AE 26 2A           ldx    _j
       06:A1FB  AD 27 2A           lda    _j+1
                                  .endif
  823                             __stbps
                                 __stw    <__temp
       06:A1FE  86 03              stx    <__temp
       06:A200  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A202  B2 00              lda    [__stack]
       06:A204  AA                 tax
       06:A205  A0 01              ldy    #1
       06:A207  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A209  86 0B              stx    <__ptr
       06:A20B  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A20D  A6 03              ldx    <__temp
       06:A20F  A5 04              lda    <__temp+1
                                  .endif
       06:A211  22                 sax
       06:A212  92 0B              sta    [__ptr]
       06:A214  22                 sax
                                 __addmi  2,__stack
       06:A215  48                 pha
       06:A216  18                 clc
       06:A217  A5 00              lda    <__stack
       06:A219  69 02              adc    #low(2)
       06:A21B  85 00              sta    <__stack
       06:A21D  A5 01              lda    <__stack+1
       06:A21F  69 00              adc    #high(2)
       06:A221  85 01              sta    <__stack+1
       06:A223  68                 pla
  824                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A224  A0 06               ldy   #6
       06:A226  B1 00               lda   [__sp],Y
       06:A228  AA                  tax
       06:A229  C8                  iny
       06:A22A  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  825                             __pushw
                                 __submi  2,__stack
       06:A22C  48                 pha
       06:A22D  38                 sec
       06:A22E  A5 00              lda    <__stack
       06:A230  E9 02              sbc    #low(2)
       06:A232  85 00              sta    <__stack
       06:A234  A5 01              lda    <__stack+1
       06:A236  E9 00              sbc    #high(2)
       06:A238  85 01              sta    <__stack+1
       06:A23A  68                 pla
       06:A23B  22                 sax
       06:A23C  92 00              sta    [__stack]
       06:A23E  22                 sax
       06:A23F  A0 01              ldy    #1
       06:A241  91 00              sta    [__stack],Y
  826                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A243  AE 26 2A           ldx    _j
       06:A246  AD 27 2A           lda    _j+1
                                  .endif
  827  06:A249  20 12 80            call  _set_vol
  828  06:A24C  4C 99 AB          jmp endpoint
  829  06:A24F            SEQ_FC:
  830  06:A24F  EA          nop
  831                             incw    _seq_ptr
       06:A250  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A253  D0 03              bne    .x_01336           ; location
       06:A255  EE D3 29           inc    _seq_ptr+1
       06:A258            .x_01336:
  832                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A258  AE D2 29           ldx    _seq_ptr
       06:A25B  AD D3 29           lda    _seq_ptr+1
                                  .endif
  833                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A25E  86 0B              stx    <__ptr
       06:A260  85 0C              sta    <__ptr+1
       06:A262  B2 0B              lda    [__ptr]
       06:A264  AA                 tax
       06:A265  62                 cla
                          ;        bpl    .x_01338   ; signed
                          ;        dec    A
                          ;.x_01338:
  834                             __stw   _j
       06:A266  8E 26 2A           stx    _j
       06:A269  8D 27 2A           sta    _j+1
  835                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A26C  AE D2 29           ldx    _seq_ptr
       06:A26F  AD D3 29           lda    _seq_ptr+1
                                  .endif
  836                             incw    _seq_ptr
       06:A272  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A275  D0 03              bne    .x_01341           ; location
       06:A277  EE D3 29           inc    _seq_ptr+1
       06:A27A            .x_01341:
  837                             __ldwi  0
       06:A27A  A2 00              ldx    #low(0)
       06:A27C  A9 00              lda    #high(0)
  838  06:A27E  20 24 80            call  _mixvol
  839                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A281  A0 06               ldy   #6
       06:A283  B1 00               lda   [__sp],Y
       06:A285  AA                  tax
       06:A286  C8                  iny
       06:A287  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  840                             __stw   <__temp
       06:A289  86 03              stx    <__temp
       06:A28B  85 04              sta    <__temp+1
  841                             __ldwi  5
       06:A28D  A2 05              ldx    #low(5)
       06:A28F  A9 00              lda    #high(5)
  842  06:A291  20 FC E8            jsr   eqzp
  843                             __lbeq  LL50
       06:A294  D0 03              bne    .x01346
       06:A296  4C 9D A2           jmp    LL50
       06:A299            .x01346
  844                             __ldb   _xpcm_sw
                0000              .if (1 = 2)
                                  .else
       06:A299  AE 62 2A           ldx    _xpcm_sw
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01348
                          ;        dec    A
                          ;.x_01348:
       06:A29C  62                 cla    ; unsigned
                                  .endif
  845  06:A29D            LL50:
  846                     
  847                             __boolw
       06:A29D  86 03              stx    <__temp
       06:A29F  05 03              ora    <__temp
       06:A2A1  82                 clx
       06:A2A2  F0 01              beq    .x01349
       06:A2A4  E8                 inx
       06:A2A5  62        .x01349     cla
  848                             __tstw
                                   ; pha
       06:A2A6  86 03              stx    <__temp
       06:A2A8  05 03              ora    <__temp
                                   ; pla
  849                             __lbeq  LL49
       06:A2AA  D0 03              bne    .x01351
       06:A2AC  4C B2 A2           jmp    LL49
       06:A2AF            .x01351
  850  06:A2AF  20 36 80            call  _pcm_off
  851  06:A2B2            LL49:
  852                     
  853                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A2B2  A0 06               ldy   #6
       06:A2B4  B1 00               lda   [__sp],Y
       06:A2B6  AA                  tax
       06:A2B7  C8                  iny
       06:A2B8  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  854                             __aslw
       06:A2BA  22                 sax
       06:A2BB  0A                 asl    A
       06:A2BC  22                 sax
       06:A2BD  2A                 rol    A
  855                             __addwi _volume_envadr
       06:A2BE  18                 clc
       06:A2BF  22                 sax
       06:A2C0  69 04              adc    #low(_volume_envadr)
       06:A2C2  22                 sax
       06:A2C3  69 2A              adc    #high(_volume_envadr)
  856                             __pushw
                                 __submi  2,__stack
       06:A2C5  48                 pha
       06:A2C6  38                 sec
       06:A2C7  A5 00              lda    <__stack
       06:A2C9  E9 02              sbc    #low(2)
       06:A2CB  85 00              sta    <__stack
       06:A2CD  A5 01              lda    <__stack+1
       06:A2CF  E9 00              sbc    #high(2)
       06:A2D1  85 01              sta    <__stack+1
       06:A2D3  68                 pla
       06:A2D4  22                 sax
       06:A2D5  92 00              sta    [__stack]
       06:A2D7  22                 sax
       06:A2D8  A0 01              ldy    #1
       06:A2DA  91 00              sta    [__stack],Y
  857                             __ldwi  0
       06:A2DC  A2 00              ldx    #low(0)
       06:A2DE  A9 00              lda    #high(0)
  858                             __stwps
                                 __stw    <__temp
       06:A2E0  86 03              stx    <__temp
       06:A2E2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A2E4  B2 00              lda    [__stack]
       06:A2E6  AA                 tax
       06:A2E7  A0 01              ldy    #1
       06:A2E9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A2EB  86 0B              stx    <__ptr
       06:A2ED  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A2EF  A6 03              ldx    <__temp
       06:A2F1  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:A2F3  22                 sax
       06:A2F4  92 0B              sta    [__ptr]
       06:A2F6  22                 sax
       06:A2F7  A0 01              ldy    #1
       06:A2F9  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:A2FB  48                 pha
       06:A2FC  18                 clc
       06:A2FD  A5 00              lda    <__stack
       06:A2FF  69 02              adc    #low(2)
       06:A301  85 00              sta    <__stack
       06:A303  A5 01              lda    <__stack+1
       06:A305  69 00              adc    #high(2)
       06:A307  85 01              sta    <__stack+1
       06:A309  68                 pla
  859                             __ldwi  _ch_cnt
       06:A30A  A2 88              ldx    #low(_ch_cnt)
       06:A30C  A9 29              lda    #high(_ch_cnt)
  860                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A30E  A0 06              ldy    #6
       06:A310  18                 clc
       06:A311  22                 sax
       06:A312  71 00              adc    [__sp],Y
       06:A314  22                 sax
       06:A315  C8                 iny
       06:A316  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  861                             __pushw
                                 __submi  2,__stack
       06:A318  48                 pha
       06:A319  38                 sec
       06:A31A  A5 00              lda    <__stack
       06:A31C  E9 02              sbc    #low(2)
       06:A31E  85 00              sta    <__stack
       06:A320  A5 01              lda    <__stack+1
       06:A322  E9 00              sbc    #high(2)
       06:A324  85 01              sta    <__stack+1
       06:A326  68                 pla
       06:A327  22                 sax
       06:A328  92 00              sta    [__stack]
       06:A32A  22                 sax
       06:A32B  A0 01              ldy    #1
       06:A32D  91 00              sta    [__stack],Y
  862                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A32F  AE 26 2A           ldx    _j
       06:A332  AD 27 2A           lda    _j+1
                                  .endif
  863                             __stbps
                                 __stw    <__temp
       06:A335  86 03              stx    <__temp
       06:A337  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A339  B2 00              lda    [__stack]
       06:A33B  AA                 tax
       06:A33C  A0 01              ldy    #1
       06:A33E  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A340  86 0B              stx    <__ptr
       06:A342  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A344  A6 03              ldx    <__temp
       06:A346  A5 04              lda    <__temp+1
                                  .endif
       06:A348  22                 sax
       06:A349  92 0B              sta    [__ptr]
       06:A34B  22                 sax
                                 __addmi  2,__stack
       06:A34C  48                 pha
       06:A34D  18                 clc
       06:A34E  A5 00              lda    <__stack
       06:A350  69 02              adc    #low(2)
       06:A352  85 00              sta    <__stack
       06:A354  A5 01              lda    <__stack+1
       06:A356  69 00              adc    #high(2)
       06:A358  85 01              sta    <__stack+1
       06:A35A  68                 pla
  864                             __lbra  LL45
       06:A35B  4C 00 BB           jmp    LL45
  865  06:A35E  4C 99 AB          jmp endpoint
  866  06:A361            SEQ_FB:
  867  06:A361  EA          nop
  868                             incw    _seq_ptr
       06:A362  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A365  D0 03              bne    .x_01377           ; location
       06:A367  EE D3 29           inc    _seq_ptr+1
       06:A36A            .x_01377:
  869                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A36A  AE D2 29           ldx    _seq_ptr
       06:A36D  AD D3 29           lda    _seq_ptr+1
                                  .endif
  870                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A370  86 0B              stx    <__ptr
       06:A372  85 0C              sta    <__ptr+1
       06:A374  B2 0B              lda    [__ptr]
       06:A376  AA                 tax
       06:A377  62                 cla
                          ;        bpl    .x_01379   ; signed
                          ;        dec    A
                          ;.x_01379:
  871                             __stw   _j
       06:A378  8E 26 2A           stx    _j
       06:A37B  8D 27 2A           sta    _j+1
  872                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A37E  AE D2 29           ldx    _seq_ptr
       06:A381  AD D3 29           lda    _seq_ptr+1
                                  .endif
  873                             incw    _seq_ptr
       06:A384  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A387  D0 03              bne    .x_01382           ; location
       06:A389  EE D3 29           inc    _seq_ptr+1
       06:A38C            .x_01382:
  874                             __ldwi  _lfo_num
       06:A38C  A2 2C              ldx    #low(_lfo_num)
       06:A38E  A9 2A              lda    #high(_lfo_num)
  875                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A390  A0 06              ldy    #6
       06:A392  18                 clc
       06:A393  22                 sax
       06:A394  71 00              adc    [__sp],Y
       06:A396  22                 sax
       06:A397  C8                 iny
       06:A398  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  876                             __pushw
                                 __submi  2,__stack
       06:A39A  48                 pha
       06:A39B  38                 sec
       06:A39C  A5 00              lda    <__stack
       06:A39E  E9 02              sbc    #low(2)
       06:A3A0  85 00              sta    <__stack
       06:A3A2  A5 01              lda    <__stack+1
       06:A3A4  E9 00              sbc    #high(2)
       06:A3A6  85 01              sta    <__stack+1
       06:A3A8  68                 pla
       06:A3A9  22                 sax
       06:A3AA  92 00              sta    [__stack]
       06:A3AC  22                 sax
       06:A3AD  A0 01              ldy    #1
       06:A3AF  91 00              sta    [__stack],Y
  877                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A3B1  AE 26 2A           ldx    _j
       06:A3B4  AD 27 2A           lda    _j+1
                                  .endif
  878                             __stbps
                                 __stw    <__temp
       06:A3B7  86 03              stx    <__temp
       06:A3B9  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A3BB  B2 00              lda    [__stack]
       06:A3BD  AA                 tax
       06:A3BE  A0 01              ldy    #1
       06:A3C0  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A3C2  86 0B              stx    <__ptr
       06:A3C4  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A3C6  A6 03              ldx    <__temp
       06:A3C8  A5 04              lda    <__temp+1
                                  .endif
       06:A3CA  22                 sax
       06:A3CB  92 0B              sta    [__ptr]
       06:A3CD  22                 sax
                                 __addmi  2,__stack
       06:A3CE  48                 pha
       06:A3CF  18                 clc
       06:A3D0  A5 00              lda    <__stack
       06:A3D2  69 02              adc    #low(2)
       06:A3D4  85 00              sta    <__stack
       06:A3D6  A5 01              lda    <__stack+1
       06:A3D8  69 00              adc    #high(2)
       06:A3DA  85 01              sta    <__stack+1
       06:A3DC  68                 pla
  879                             __ldwi  _lfo_sw
       06:A3DD  A2 54              ldx    #low(_lfo_sw)
       06:A3DF  A9 2A              lda    #high(_lfo_sw)
  880                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A3E1  A0 06              ldy    #6
       06:A3E3  18                 clc
       06:A3E4  22                 sax
       06:A3E5  71 00              adc    [__sp],Y
       06:A3E7  22                 sax
       06:A3E8  C8                 iny
       06:A3E9  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  881                             __pushw
                                 __submi  2,__stack
       06:A3EB  48                 pha
       06:A3EC  38                 sec
       06:A3ED  A5 00              lda    <__stack
       06:A3EF  E9 02              sbc    #low(2)
       06:A3F1  85 00              sta    <__stack
       06:A3F3  A5 01              lda    <__stack+1
       06:A3F5  E9 00              sbc    #high(2)
       06:A3F7  85 01              sta    <__stack+1
       06:A3F9  68                 pla
       06:A3FA  22                 sax
       06:A3FB  92 00              sta    [__stack]
       06:A3FD  22                 sax
       06:A3FE  A0 01              ldy    #1
       06:A400  91 00              sta    [__stack],Y
  882                             __ldwi  0
       06:A402  A2 00              ldx    #low(0)
       06:A404  A9 00              lda    #high(0)
  883                             __stbps
                                 __stw    <__temp
       06:A406  86 03              stx    <__temp
       06:A408  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A40A  B2 00              lda    [__stack]
       06:A40C  AA                 tax
       06:A40D  A0 01              ldy    #1
       06:A40F  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A411  86 0B              stx    <__ptr
       06:A413  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A415  A6 03              ldx    <__temp
       06:A417  A5 04              lda    <__temp+1
                                  .endif
       06:A419  22                 sax
       06:A41A  92 0B              sta    [__ptr]
       06:A41C  22                 sax
                                 __addmi  2,__stack
       06:A41D  48                 pha
       06:A41E  18                 clc
       06:A41F  A5 00              lda    <__stack
       06:A421  69 02              adc    #low(2)
       06:A423  85 00              sta    <__stack
       06:A425  A5 01              lda    <__stack+1
       06:A427  69 00              adc    #high(2)
       06:A429  85 01              sta    <__stack+1
       06:A42B  68                 pla
  884                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       06:A42C  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01406
                          ;        dec    A
                          ;.x_01406:
       06:A42F  62                 cla    ; unsigned
                                  .endif
  885  06:A430  20 00 80            call  _chg_cbank
  886                             __ldwi  _lfo_cnt
       06:A433  A2 34              ldx    #low(_lfo_cnt)
       06:A435  A9 2A              lda    #high(_lfo_cnt)
  887                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A437  A0 06              ldy    #6
       06:A439  18                 clc
       06:A43A  22                 sax
       06:A43B  71 00              adc    [__sp],Y
       06:A43D  22                 sax
       06:A43E  C8                 iny
       06:A43F  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  888                             __pushw
                                 __submi  2,__stack
       06:A441  48                 pha
       06:A442  38                 sec
       06:A443  A5 00              lda    <__stack
       06:A445  E9 02              sbc    #low(2)
       06:A447  85 00              sta    <__stack
       06:A449  A5 01              lda    <__stack+1
       06:A44B  E9 00              sbc    #high(2)
       06:A44D  85 01              sta    <__stack+1
       06:A44F  68                 pla
       06:A450  22                 sax
       06:A451  92 00              sta    [__stack]
       06:A453  22                 sax
       06:A454  A0 01              ldy    #1
       06:A456  91 00              sta    [__stack],Y
  889                             __ldwi  _sound_dat
       06:A458  A2 00              ldx    #low(_sound_dat)
       06:A45A  A9 44              lda    #high(_sound_dat)
  890                             __addwi 12
       06:A45C  18                 clc
       06:A45D  22                 sax
       06:A45E  69 0C              adc    #low(12)
       06:A460  22                 sax
       06:A461  69 00              adc    #high(12)
  891                             __stw   __ptr
       06:A463  8E 0B 20           stx    __ptr
       06:A466  8D 0C 20           sta    __ptr+1
  892                             __ldwp  __ptr
       06:A469  B2 0B              lda    [__ptr]
       06:A46B  AA                 tax
       06:A46C  A0 01              ldy    #1
       06:A46E  B1 0B              lda    [__ptr],Y
  893                             __pushw
                                 __submi  2,__stack
       06:A470  48                 pha
       06:A471  38                 sec
       06:A472  A5 00              lda    <__stack
       06:A474  E9 02              sbc    #low(2)
       06:A476  85 00              sta    <__stack
       06:A478  A5 01              lda    <__stack+1
       06:A47A  E9 00              sbc    #high(2)
       06:A47C  85 01              sta    <__stack+1
       06:A47E  68                 pla
       06:A47F  22                 sax
       06:A480  92 00              sta    [__stack]
       06:A482  22                 sax
       06:A483  A0 01              ldy    #1
       06:A485  91 00              sta    [__stack],Y
  894                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A487  AE 26 2A           ldx    _j
       06:A48A  AD 27 2A           lda    _j+1
                                  .endif
  895                             __pushw
                                 __submi  2,__stack
       06:A48D  48                 pha
       06:A48E  38                 sec
       06:A48F  A5 00              lda    <__stack
       06:A491  E9 02              sbc    #low(2)
       06:A493  85 00              sta    <__stack
       06:A495  A5 01              lda    <__stack+1
       06:A497  E9 00              sbc    #high(2)
       06:A499  85 01              sta    <__stack+1
       06:A49B  68                 pla
       06:A49C  22                 sax
       06:A49D  92 00              sta    [__stack]
       06:A49F  22                 sax
       06:A4A0  A0 01              ldy    #1
       06:A4A2  91 00              sta    [__stack],Y
  896                             __ldwi  2
       06:A4A4  A2 02              ldx    #low(2)
       06:A4A6  A9 00              lda    #high(2)
  897  06:A4A8  20 60 EA            jsr   asl
  898                             __addws
       06:A4AB  22                 sax
       06:A4AC  18                 clc
       06:A4AD  72 00              adc    [__stack]
       06:A4AF  22                 sax
       06:A4B0  A0 01              ldy    #1
       06:A4B2  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:A4B4  48                 pha
       06:A4B5  18                 clc
       06:A4B6  A5 00              lda    <__stack
       06:A4B8  69 02              adc    #low(2)
       06:A4BA  85 00              sta    <__stack
       06:A4BC  A5 01              lda    <__stack+1
       06:A4BE  69 00              adc    #high(2)
       06:A4C0  85 01              sta    <__stack+1
       06:A4C2  68                 pla
  899                             __stw   __ptr
       06:A4C3  8E 0B 20           stx    __ptr
       06:A4C6  8D 0C 20           sta    __ptr+1
  900                             __ldwp  __ptr
       06:A4C9  B2 0B              lda    [__ptr]
       06:A4CB  AA                 tax
       06:A4CC  A0 01              ldy    #1
       06:A4CE  B1 0B              lda    [__ptr],Y
  901                             __stbps
                                 __stw    <__temp
       06:A4D0  86 03              stx    <__temp
       06:A4D2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A4D4  B2 00              lda    [__stack]
       06:A4D6  AA                 tax
       06:A4D7  A0 01              ldy    #1
       06:A4D9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A4DB  86 0B              stx    <__ptr
       06:A4DD  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A4DF  A6 03              ldx    <__temp
       06:A4E1  A5 04              lda    <__temp+1
                                  .endif
       06:A4E3  22                 sax
       06:A4E4  92 0B              sta    [__ptr]
       06:A4E6  22                 sax
                                 __addmi  2,__stack
       06:A4E7  48                 pha
       06:A4E8  18                 clc
       06:A4E9  A5 00              lda    <__stack
       06:A4EB  69 02              adc    #low(2)
       06:A4ED  85 00              sta    <__stack
       06:A4EF  A5 01              lda    <__stack+1
       06:A4F1  69 00              adc    #high(2)
       06:A4F3  85 01              sta    <__stack+1
       06:A4F5  68                 pla
  902                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       06:A4F6  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01432
                          ;        dec    A
                          ;.x_01432:
       06:A4F9  62                 cla    ; unsigned
                                  .endif
  903  06:A4FA  20 00 80            call  _chg_cbank
  904  06:A4FD  4C 99 AB          jmp endpoint
  905  06:A500            SEQ_FA:
  906  06:A500  EA          nop
  907                             incw    _seq_ptr
       06:A501  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A504  D0 03              bne    .x_01433           ; location
       06:A506  EE D3 29           inc    _seq_ptr+1
       06:A509            .x_01433:
  908                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A509  AE D2 29           ldx    _seq_ptr
       06:A50C  AD D3 29           lda    _seq_ptr+1
                                  .endif
  909                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A50F  86 0B              stx    <__ptr
       06:A511  85 0C              sta    <__ptr+1
       06:A513  B2 0B              lda    [__ptr]
       06:A515  AA                 tax
       06:A516  62                 cla
                          ;        bpl    .x_01435   ; signed
                          ;        dec    A
                          ;.x_01435:
  910                             __stw   _j
       06:A517  8E 26 2A           stx    _j
       06:A51A  8D 27 2A           sta    _j+1
  911                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A51D  AE D2 29           ldx    _seq_ptr
       06:A520  AD D3 29           lda    _seq_ptr+1
                                  .endif
  912                             incw    _seq_ptr
       06:A523  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A526  D0 03              bne    .x_01438           ; location
       06:A528  EE D3 29           inc    _seq_ptr+1
       06:A52B            .x_01438:
  913                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A52B  AE 26 2A           ldx    _j
       06:A52E  AD 27 2A           lda    _j+1
                                  .endif
  914                             __stw   <__temp
       06:A531  86 03              stx    <__temp
       06:A533  85 04              sta    <__temp+1
  915                             __ldwi  255
       06:A535  A2 FF              ldx    #low(255)
       06:A537  A9 00              lda    #high(255)
  916  06:A539  20 FC E8            jsr   eqzp
  917                             __lbeq  LL51
       06:A53C  D0 03              bne    .x01442
       06:A53E  4C 93 A5           jmp    LL51
       06:A541            .x01442
  918                             __ldwi  _detune
       06:A541  A2 BA              ldx    #low(_detune)
       06:A543  A9 29              lda    #high(_detune)
  919                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A545  A0 06              ldy    #6
       06:A547  18                 clc
       06:A548  22                 sax
       06:A549  71 00              adc    [__sp],Y
       06:A54B  22                 sax
       06:A54C  C8                 iny
       06:A54D  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  920                             __pushw
                                 __submi  2,__stack
       06:A54F  48                 pha
       06:A550  38                 sec
       06:A551  A5 00              lda    <__stack
       06:A553  E9 02              sbc    #low(2)
       06:A555  85 00              sta    <__stack
       06:A557  A5 01              lda    <__stack+1
       06:A559  E9 00              sbc    #high(2)
       06:A55B  85 01              sta    <__stack+1
       06:A55D  68                 pla
       06:A55E  22                 sax
       06:A55F  92 00              sta    [__stack]
       06:A561  22                 sax
       06:A562  A0 01              ldy    #1
       06:A564  91 00              sta    [__stack],Y
  921                             __ldwi  0
       06:A566  A2 00              ldx    #low(0)
       06:A568  A9 00              lda    #high(0)
  922                             __stbps
                                 __stw    <__temp
       06:A56A  86 03              stx    <__temp
       06:A56C  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A56E  B2 00              lda    [__stack]
       06:A570  AA                 tax
       06:A571  A0 01              ldy    #1
       06:A573  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A575  86 0B              stx    <__ptr
       06:A577  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A579  A6 03              ldx    <__temp
       06:A57B  A5 04              lda    <__temp+1
                                  .endif
       06:A57D  22                 sax
       06:A57E  92 0B              sta    [__ptr]
       06:A580  22                 sax
                                 __addmi  2,__stack
       06:A581  48                 pha
       06:A582  18                 clc
       06:A583  A5 00              lda    <__stack
       06:A585  69 02              adc    #low(2)
       06:A587  85 00              sta    <__stack
       06:A589  A5 01              lda    <__stack+1
       06:A58B  69 00              adc    #high(2)
       06:A58D  85 01              sta    <__stack+1
       06:A58F  68                 pla
  923                             __lbra  LL52
       06:A590  4C E4 A5           jmp    LL52
  924  06:A593            LL51:
  925                     
  926                             __ldwi  _detune
       06:A593  A2 BA              ldx    #low(_detune)
       06:A595  A9 29              lda    #high(_detune)
  927                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A597  A0 06              ldy    #6
       06:A599  18                 clc
       06:A59A  22                 sax
       06:A59B  71 00              adc    [__sp],Y
       06:A59D  22                 sax
       06:A59E  C8                 iny
       06:A59F  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  928                             __pushw
                                 __submi  2,__stack
       06:A5A1  48                 pha
       06:A5A2  38                 sec
       06:A5A3  A5 00              lda    <__stack
       06:A5A5  E9 02              sbc    #low(2)
       06:A5A7  85 00              sta    <__stack
       06:A5A9  A5 01              lda    <__stack+1
       06:A5AB  E9 00              sbc    #high(2)
       06:A5AD  85 01              sta    <__stack+1
       06:A5AF  68                 pla
       06:A5B0  22                 sax
       06:A5B1  92 00              sta    [__stack]
       06:A5B3  22                 sax
       06:A5B4  A0 01              ldy    #1
       06:A5B6  91 00              sta    [__stack],Y
  929                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A5B8  AE 26 2A           ldx    _j
       06:A5BB  AD 27 2A           lda    _j+1
                                  .endif
  930                             __stbps
                                 __stw    <__temp
       06:A5BE  86 03              stx    <__temp
       06:A5C0  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A5C2  B2 00              lda    [__stack]
       06:A5C4  AA                 tax
       06:A5C5  A0 01              ldy    #1
       06:A5C7  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A5C9  86 0B              stx    <__ptr
       06:A5CB  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A5CD  A6 03              ldx    <__temp
       06:A5CF  A5 04              lda    <__temp+1
                                  .endif
       06:A5D1  22                 sax
       06:A5D2  92 0B              sta    [__ptr]
       06:A5D4  22                 sax
                                 __addmi  2,__stack
       06:A5D5  48                 pha
       06:A5D6  18                 clc
       06:A5D7  A5 00              lda    <__stack
       06:A5D9  69 02              adc    #low(2)
       06:A5DB  85 00              sta    <__stack
       06:A5DD  A5 01              lda    <__stack+1
       06:A5DF  69 00              adc    #high(2)
       06:A5E1  85 01              sta    <__stack+1
       06:A5E3  68                 pla
  931  06:A5E4            LL52:
  932                     
  933  06:A5E4  4C 99 AB          jmp endpoint
  934  06:A5E7            SEQ_F8:
  935  06:A5E7  EA          nop
  936                             incw    _seq_ptr
       06:A5E8  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A5EB  D0 03              bne    .x_01466           ; location
       06:A5ED  EE D3 29           inc    _seq_ptr+1
       06:A5F0            .x_01466:
  937                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A5F0  AE D2 29           ldx    _seq_ptr
       06:A5F3  AD D3 29           lda    _seq_ptr+1
                                  .endif
  938                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A5F6  86 0B              stx    <__ptr
       06:A5F8  85 0C              sta    <__ptr+1
       06:A5FA  B2 0B              lda    [__ptr]
       06:A5FC  AA                 tax
       06:A5FD  62                 cla
                          ;        bpl    .x_01468   ; signed
                          ;        dec    A
                          ;.x_01468:
  939                             __stw   _j
       06:A5FE  8E 26 2A           stx    _j
       06:A601  8D 27 2A           sta    _j+1
  940                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A604  AE D2 29           ldx    _seq_ptr
       06:A607  AD D3 29           lda    _seq_ptr+1
                                  .endif
  941                             incw    _seq_ptr
       06:A60A  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A60D  D0 03              bne    .x_01471           ; location
       06:A60F  EE D3 29           inc    _seq_ptr+1
       06:A612            .x_01471:
  942                             __ldwi  _pitch_sw
       06:A612  A2 AA              ldx    #low(_pitch_sw)
       06:A614  A9 29              lda    #high(_pitch_sw)
  943                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A616  A0 06              ldy    #6
       06:A618  18                 clc
       06:A619  22                 sax
       06:A61A  71 00              adc    [__sp],Y
       06:A61C  22                 sax
       06:A61D  C8                 iny
       06:A61E  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  944                             __pushw
                                 __submi  2,__stack
       06:A620  48                 pha
       06:A621  38                 sec
       06:A622  A5 00              lda    <__stack
       06:A624  E9 02              sbc    #low(2)
       06:A626  85 00              sta    <__stack
       06:A628  A5 01              lda    <__stack+1
       06:A62A  E9 00              sbc    #high(2)
       06:A62C  85 01              sta    <__stack+1
       06:A62E  68                 pla
       06:A62F  22                 sax
       06:A630  92 00              sta    [__stack]
       06:A632  22                 sax
       06:A633  A0 01              ldy    #1
       06:A635  91 00              sta    [__stack],Y
  945                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A637  AE 26 2A           ldx    _j
       06:A63A  AD 27 2A           lda    _j+1
                                  .endif
  946                             __stbps
                                 __stw    <__temp
       06:A63D  86 03              stx    <__temp
       06:A63F  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A641  B2 00              lda    [__stack]
       06:A643  AA                 tax
       06:A644  A0 01              ldy    #1
       06:A646  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A648  86 0B              stx    <__ptr
       06:A64A  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A64C  A6 03              ldx    <__temp
       06:A64E  A5 04              lda    <__temp+1
                                  .endif
       06:A650  22                 sax
       06:A651  92 0B              sta    [__ptr]
       06:A653  22                 sax
                                 __addmi  2,__stack
       06:A654  48                 pha
       06:A655  18                 clc
       06:A656  A5 00              lda    <__stack
       06:A658  69 02              adc    #low(2)
       06:A65A  85 00              sta    <__stack
       06:A65C  A5 01              lda    <__stack+1
       06:A65E  69 00              adc    #high(2)
       06:A660  85 01              sta    <__stack+1
       06:A662  68                 pla
  947  06:A663  4C 99 AB          jmp endpoint
  948  06:A666            SEQ_F7:
  949  06:A666  EA          nop
  950                             incw    _seq_ptr
       06:A667  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A66A  D0 03              bne    .x_01483           ; location
       06:A66C  EE D3 29           inc    _seq_ptr+1
       06:A66F            .x_01483:
  951                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A66F  AE D2 29           ldx    _seq_ptr
       06:A672  AD D3 29           lda    _seq_ptr+1
                                  .endif
  952                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A675  86 0B              stx    <__ptr
       06:A677  85 0C              sta    <__ptr+1
       06:A679  B2 0B              lda    [__ptr]
       06:A67B  AA                 tax
       06:A67C  62                 cla
                          ;        bpl    .x_01485   ; signed
                          ;        dec    A
                          ;.x_01485:
  953                             __stw   _j
       06:A67D  8E 26 2A           stx    _j
       06:A680  8D 27 2A           sta    _j+1
  954                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A683  AE D2 29           ldx    _seq_ptr
       06:A686  AD D3 29           lda    _seq_ptr+1
                                  .endif
  955                             incw    _seq_ptr
       06:A689  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A68C  D0 03              bne    .x_01488           ; location
       06:A68E  EE D3 29           inc    _seq_ptr+1
       06:A691            .x_01488:
  956                             __ldwi  _note_sw
       06:A691  A2 B2              ldx    #low(_note_sw)
       06:A693  A9 29              lda    #high(_note_sw)
  957                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A695  A0 06              ldy    #6
       06:A697  18                 clc
       06:A698  22                 sax
       06:A699  71 00              adc    [__sp],Y
       06:A69B  22                 sax
       06:A69C  C8                 iny
       06:A69D  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  958                             __pushw
                                 __submi  2,__stack
       06:A69F  48                 pha
       06:A6A0  38                 sec
       06:A6A1  A5 00              lda    <__stack
       06:A6A3  E9 02              sbc    #low(2)
       06:A6A5  85 00              sta    <__stack
       06:A6A7  A5 01              lda    <__stack+1
       06:A6A9  E9 00              sbc    #high(2)
       06:A6AB  85 01              sta    <__stack+1
       06:A6AD  68                 pla
       06:A6AE  22                 sax
       06:A6AF  92 00              sta    [__stack]
       06:A6B1  22                 sax
       06:A6B2  A0 01              ldy    #1
       06:A6B4  91 00              sta    [__stack],Y
  959                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A6B6  AE 26 2A           ldx    _j
       06:A6B9  AD 27 2A           lda    _j+1
                                  .endif
  960                             __stbps
                                 __stw    <__temp
       06:A6BC  86 03              stx    <__temp
       06:A6BE  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A6C0  B2 00              lda    [__stack]
       06:A6C2  AA                 tax
       06:A6C3  A0 01              ldy    #1
       06:A6C5  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A6C7  86 0B              stx    <__ptr
       06:A6C9  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A6CB  A6 03              ldx    <__temp
       06:A6CD  A5 04              lda    <__temp+1
                                  .endif
       06:A6CF  22                 sax
       06:A6D0  92 0B              sta    [__ptr]
       06:A6D2  22                 sax
                                 __addmi  2,__stack
       06:A6D3  48                 pha
       06:A6D4  18                 clc
       06:A6D5  A5 00              lda    <__stack
       06:A6D7  69 02              adc    #low(2)
       06:A6D9  85 00              sta    <__stack
       06:A6DB  A5 01              lda    <__stack+1
       06:A6DD  69 00              adc    #high(2)
       06:A6DF  85 01              sta    <__stack+1
       06:A6E1  68                 pla
  961  06:A6E2  4C 99 AB          jmp endpoint
  962  06:A6E5            SEQ_F4:
  963  06:A6E5  EA          nop
  964                             incw    _seq_ptr
       06:A6E6  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A6E9  D0 03              bne    .x_01500           ; location
       06:A6EB  EE D3 29           inc    _seq_ptr+1
       06:A6EE            .x_01500:
  965                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A6EE  AE D2 29           ldx    _seq_ptr
       06:A6F1  AD D3 29           lda    _seq_ptr+1
                                  .endif
  966                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A6F4  86 0B              stx    <__ptr
       06:A6F6  85 0C              sta    <__ptr+1
       06:A6F8  B2 0B              lda    [__ptr]
       06:A6FA  AA                 tax
       06:A6FB  62                 cla
                          ;        bpl    .x_01502   ; signed
                          ;        dec    A
                          ;.x_01502:
  967                             __stw   _j
       06:A6FC  8E 26 2A           stx    _j
       06:A6FF  8D 27 2A           sta    _j+1
  968                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A702  AE D2 29           ldx    _seq_ptr
       06:A705  AD D3 29           lda    _seq_ptr+1
                                  .endif
  969                             incw    _seq_ptr
       06:A708  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A70B  D0 03              bne    .x_01505           ; location
       06:A70D  EE D3 29           inc    _seq_ptr+1
       06:A710            .x_01505:
  970                             __ldwi  _ch_cnt
       06:A710  A2 88              ldx    #low(_ch_cnt)
       06:A712  A9 29              lda    #high(_ch_cnt)
  971                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A714  A0 06              ldy    #6
       06:A716  18                 clc
       06:A717  22                 sax
       06:A718  71 00              adc    [__sp],Y
       06:A71A  22                 sax
       06:A71B  C8                 iny
       06:A71C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
  972                             __pushw
                                 __submi  2,__stack
       06:A71E  48                 pha
       06:A71F  38                 sec
       06:A720  A5 00              lda    <__stack
       06:A722  E9 02              sbc    #low(2)
       06:A724  85 00              sta    <__stack
       06:A726  A5 01              lda    <__stack+1
       06:A728  E9 00              sbc    #high(2)
       06:A72A  85 01              sta    <__stack+1
       06:A72C  68                 pla
       06:A72D  22                 sax
       06:A72E  92 00              sta    [__stack]
       06:A730  22                 sax
       06:A731  A0 01              ldy    #1
       06:A733  91 00              sta    [__stack],Y
  973                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A735  AE 26 2A           ldx    _j
       06:A738  AD 27 2A           lda    _j+1
                                  .endif
  974                             __stbps
                                 __stw    <__temp
       06:A73B  86 03              stx    <__temp
       06:A73D  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A73F  B2 00              lda    [__stack]
       06:A741  AA                 tax
       06:A742  A0 01              ldy    #1
       06:A744  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A746  86 0B              stx    <__ptr
       06:A748  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A74A  A6 03              ldx    <__temp
       06:A74C  A5 04              lda    <__temp+1
                                  .endif
       06:A74E  22                 sax
       06:A74F  92 0B              sta    [__ptr]
       06:A751  22                 sax
                                 __addmi  2,__stack
       06:A752  48                 pha
       06:A753  18                 clc
       06:A754  A5 00              lda    <__stack
       06:A756  69 02              adc    #low(2)
       06:A758  85 00              sta    <__stack
       06:A75A  A5 01              lda    <__stack+1
       06:A75C  69 00              adc    #high(2)
       06:A75E  85 01              sta    <__stack+1
       06:A760  68                 pla
  975  06:A761  4C 99 AB          jmp endpoint
  976  06:A764            SEQ_F2:
  977  06:A764  EA          nop
  978                             incw    _seq_ptr
       06:A765  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A768  D0 03              bne    .x_01517           ; location
       06:A76A  EE D3 29           inc    _seq_ptr+1
       06:A76D            .x_01517:
  979                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A76D  AE D2 29           ldx    _seq_ptr
       06:A770  AD D3 29           lda    _seq_ptr+1
                                  .endif
  980                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A773  86 0B              stx    <__ptr
       06:A775  85 0C              sta    <__ptr+1
       06:A777  B2 0B              lda    [__ptr]
       06:A779  AA                 tax
       06:A77A  62                 cla
                          ;        bpl    .x_01519   ; signed
                          ;        dec    A
                          ;.x_01519:
  981                             __stw   _j
       06:A77B  8E 26 2A           stx    _j
       06:A77E  8D 27 2A           sta    _j+1
  982                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A781  AE D2 29           ldx    _seq_ptr
       06:A784  AD D3 29           lda    _seq_ptr+1
                                  .endif
  983                             incw    _seq_ptr
       06:A787  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A78A  D0 03              bne    .x_01522           ; location
       06:A78C  EE D3 29           inc    _seq_ptr+1
       06:A78F            .x_01522:
  984                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A78F  A0 06               ldy   #6
       06:A791  B1 00               lda   [__sp],Y
       06:A793  AA                  tax
       06:A794  C8                  iny
       06:A795  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  985                             __stw   <__temp
       06:A797  86 03              stx    <__temp
       06:A799  85 04              sta    <__temp+1
  986                             __ldwi  3
       06:A79B  A2 03              ldx    #low(3)
       06:A79D  A9 00              lda    #high(3)
  987  06:A79F  20 CC E9            jsr   gtzp
  988                             __lbeq  LL53
       06:A7A2  D0 03              bne    .x01526
       06:A7A4  4C D0 A8           jmp    LL53
       06:A7A7            .x01526
  989                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A7A7  AE 26 2A           ldx    _j
       06:A7AA  AD 27 2A           lda    _j+1
                                  .endif
  990                             __tstw
                                   ; pha
       06:A7AD  86 03              stx    <__temp
       06:A7AF  05 03              ora    <__temp
                                   ; pla
  991                             __lbeq  LL54
       06:A7B1  D0 03              bne    .x01529
       06:A7B3  4C 3C A8           jmp    LL54
       06:A7B6            .x01529
  992                             __ldwi  _noise_sw
       06:A7B6  A2 2A              ldx    #low(_noise_sw)
       06:A7B8  A9 2A              lda    #high(_noise_sw)
  993                             __pushw
                                 __submi  2,__stack
       06:A7BA  48                 pha
       06:A7BB  38                 sec
       06:A7BC  A5 00              lda    <__stack
       06:A7BE  E9 02              sbc    #low(2)
       06:A7C0  85 00              sta    <__stack
       06:A7C2  A5 01              lda    <__stack+1
       06:A7C4  E9 00              sbc    #high(2)
       06:A7C6  85 01              sta    <__stack+1
       06:A7C8  68                 pla
       06:A7C9  22                 sax
       06:A7CA  92 00              sta    [__stack]
       06:A7CC  22                 sax
       06:A7CD  A0 01              ldy    #1
       06:A7CF  91 00              sta    [__stack],Y
  994                             __ldw_s 8
                0001              .if (8 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (8 = 0)
                                   .else
       06:A7D1  A0 08               ldy   #8
       06:A7D3  B1 00               lda   [__sp],Y
       06:A7D5  AA                  tax
       06:A7D6  C8                  iny
       06:A7D7  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
  995                             __subwi 4
       06:A7D9  38                 sec
       06:A7DA  22                 sax
       06:A7DB  E9 04              sbc    #low(4)
       06:A7DD  22                 sax
       06:A7DE  E9 00              sbc    #high(4)
  996                             __addws
       06:A7E0  22                 sax
       06:A7E1  18                 clc
       06:A7E2  72 00              adc    [__stack]
       06:A7E4  22                 sax
       06:A7E5  A0 01              ldy    #1
       06:A7E7  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:A7E9  48                 pha
       06:A7EA  18                 clc
       06:A7EB  A5 00              lda    <__stack
       06:A7ED  69 02              adc    #low(2)
       06:A7EF  85 00              sta    <__stack
       06:A7F1  A5 01              lda    <__stack+1
       06:A7F3  69 00              adc    #high(2)
       06:A7F5  85 01              sta    <__stack+1
       06:A7F7  68                 pla
  997                             __pushw
                                 __submi  2,__stack
       06:A7F8  48                 pha
       06:A7F9  38                 sec
       06:A7FA  A5 00              lda    <__stack
       06:A7FC  E9 02              sbc    #low(2)
       06:A7FE  85 00              sta    <__stack
       06:A800  A5 01              lda    <__stack+1
       06:A802  E9 00              sbc    #high(2)
       06:A804  85 01              sta    <__stack+1
       06:A806  68                 pla
       06:A807  22                 sax
       06:A808  92 00              sta    [__stack]
       06:A80A  22                 sax
       06:A80B  A0 01              ldy    #1
       06:A80D  91 00              sta    [__stack],Y
  998                             __ldwi  1
       06:A80F  A2 01              ldx    #low(1)
       06:A811  A9 00              lda    #high(1)
  999                             __stbps
                                 __stw    <__temp
       06:A813  86 03              stx    <__temp
       06:A815  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A817  B2 00              lda    [__stack]
       06:A819  AA                 tax
       06:A81A  A0 01              ldy    #1
       06:A81C  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A81E  86 0B              stx    <__ptr
       06:A820  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A822  A6 03              ldx    <__temp
       06:A824  A5 04              lda    <__temp+1
                                  .endif
       06:A826  22                 sax
       06:A827  92 0B              sta    [__ptr]
       06:A829  22                 sax
                                 __addmi  2,__stack
       06:A82A  48                 pha
       06:A82B  18                 clc
       06:A82C  A5 00              lda    <__stack
       06:A82E  69 02              adc    #low(2)
       06:A830  85 00              sta    <__stack
       06:A832  A5 01              lda    <__stack+1
       06:A834  69 00              adc    #high(2)
       06:A836  85 01              sta    <__stack+1
       06:A838  68                 pla
 1000                             __lbra  LL55
       06:A839  4C D0 A8           jmp    LL55
 1001  06:A83C            LL54:
 1002                     
 1003                             __ldwi  _noise_sw
       06:A83C  A2 2A              ldx    #low(_noise_sw)
       06:A83E  A9 2A              lda    #high(_noise_sw)
 1004                             __pushw
                                 __submi  2,__stack
       06:A840  48                 pha
       06:A841  38                 sec
       06:A842  A5 00              lda    <__stack
       06:A844  E9 02              sbc    #low(2)
       06:A846  85 00              sta    <__stack
       06:A848  A5 01              lda    <__stack+1
       06:A84A  E9 00              sbc    #high(2)
       06:A84C  85 01              sta    <__stack+1
       06:A84E  68                 pla
       06:A84F  22                 sax
       06:A850  92 00              sta    [__stack]
       06:A852  22                 sax
       06:A853  A0 01              ldy    #1
       06:A855  91 00              sta    [__stack],Y
 1005                             __ldw_s 8
                0001              .if (8 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (8 = 0)
                                   .else
       06:A857  A0 08               ldy   #8
       06:A859  B1 00               lda   [__sp],Y
       06:A85B  AA                  tax
       06:A85C  C8                  iny
       06:A85D  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1006                             __subwi 4
       06:A85F  38                 sec
       06:A860  22                 sax
       06:A861  E9 04              sbc    #low(4)
       06:A863  22                 sax
       06:A864  E9 00              sbc    #high(4)
 1007                             __addws
       06:A866  22                 sax
       06:A867  18                 clc
       06:A868  72 00              adc    [__stack]
       06:A86A  22                 sax
       06:A86B  A0 01              ldy    #1
       06:A86D  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:A86F  48                 pha
       06:A870  18                 clc
       06:A871  A5 00              lda    <__stack
       06:A873  69 02              adc    #low(2)
       06:A875  85 00              sta    <__stack
       06:A877  A5 01              lda    <__stack+1
       06:A879  69 00              adc    #high(2)
       06:A87B  85 01              sta    <__stack+1
       06:A87D  68                 pla
 1008                             __pushw
                                 __submi  2,__stack
       06:A87E  48                 pha
       06:A87F  38                 sec
       06:A880  A5 00              lda    <__stack
       06:A882  E9 02              sbc    #low(2)
       06:A884  85 00              sta    <__stack
       06:A886  A5 01              lda    <__stack+1
       06:A888  E9 00              sbc    #high(2)
       06:A88A  85 01              sta    <__stack+1
       06:A88C  68                 pla
       06:A88D  22                 sax
       06:A88E  92 00              sta    [__stack]
       06:A890  22                 sax
       06:A891  A0 01              ldy    #1
       06:A893  91 00              sta    [__stack],Y
 1009                             __ldwi  0
       06:A895  A2 00              ldx    #low(0)
       06:A897  A9 00              lda    #high(0)
 1010                             __stbps
                                 __stw    <__temp
       06:A899  86 03              stx    <__temp
       06:A89B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A89D  B2 00              lda    [__stack]
       06:A89F  AA                 tax
       06:A8A0  A0 01              ldy    #1
       06:A8A2  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A8A4  86 0B              stx    <__ptr
       06:A8A6  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A8A8  A6 03              ldx    <__temp
       06:A8AA  A5 04              lda    <__temp+1
                                  .endif
       06:A8AC  22                 sax
       06:A8AD  92 0B              sta    [__ptr]
       06:A8AF  22                 sax
                                 __addmi  2,__stack
       06:A8B0  48                 pha
       06:A8B1  18                 clc
       06:A8B2  A5 00              lda    <__stack
       06:A8B4  69 02              adc    #low(2)
       06:A8B6  85 00              sta    <__stack
       06:A8B8  A5 01              lda    <__stack+1
       06:A8BA  69 00              adc    #high(2)
       06:A8BC  85 01              sta    <__stack+1
       06:A8BE  68                 pla
 1011                             __ldwi  2055
       06:A8BF  A2 07              ldx    #low(2055)
       06:A8C1  A9 08              lda    #high(2055)
 1012                             __stw   _bx
       06:A8C3  8E FA 20           stx    _bx
       06:A8C6  8D FB 20           sta    _bx+1
 1013                             __ldwi  0
       06:A8C9  A2 00              ldx    #low(0)
       06:A8CB  A9 00              lda    #high(0)
 1014  06:A8CD  20 A4 FB            call  _poke.2
 1015  06:A8D0            LL55:
 1016                     
 1017  06:A8D0            LL53:
 1018                     
 1019  06:A8D0  4C 99 AB          jmp endpoint
 1020  06:A8D3            SEQ_F1:
 1021  06:A8D3  EA          nop
 1022                             incw    _seq_ptr
       06:A8D4  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A8D7  D0 03              bne    .x_01566           ; location
       06:A8D9  EE D3 29           inc    _seq_ptr+1
       06:A8DC            .x_01566:
 1023                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A8DC  AE D2 29           ldx    _seq_ptr
       06:A8DF  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1024                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A8E2  86 0B              stx    <__ptr
       06:A8E4  85 0C              sta    <__ptr+1
       06:A8E6  B2 0B              lda    [__ptr]
       06:A8E8  AA                 tax
       06:A8E9  62                 cla
                          ;        bpl    .x_01568   ; signed
                          ;        dec    A
                          ;.x_01568:
 1025                             __stw   _j
       06:A8EA  8E 26 2A           stx    _j
       06:A8ED  8D 27 2A           sta    _j+1
 1026                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A8F0  AE D2 29           ldx    _seq_ptr
       06:A8F3  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1027                             incw    _seq_ptr
       06:A8F6  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A8F9  D0 03              bne    .x_01571           ; location
       06:A8FB  EE D3 29           inc    _seq_ptr+1
       06:A8FE            .x_01571:
 1028                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       06:A8FE  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01573
                          ;        dec    A
                          ;.x_01573:
       06:A901  62                 cla    ; unsigned
                                  .endif
 1029  06:A902  20 00 80            call  _chg_cbank
 1030                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A905  A0 06               ldy   #6
       06:A907  B1 00               lda   [__sp],Y
       06:A909  AA                  tax
       06:A90A  C8                  iny
       06:A90B  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1031                             __pushw
                                 __submi  2,__stack
       06:A90D  48                 pha
       06:A90E  38                 sec
       06:A90F  A5 00              lda    <__stack
       06:A911  E9 02              sbc    #low(2)
       06:A913  85 00              sta    <__stack
       06:A915  A5 01              lda    <__stack+1
       06:A917  E9 00              sbc    #high(2)
       06:A919  85 01              sta    <__stack+1
       06:A91B  68                 pla
       06:A91C  22                 sax
       06:A91D  92 00              sta    [__stack]
       06:A91F  22                 sax
       06:A920  A0 01              ldy    #1
       06:A922  91 00              sta    [__stack],Y
 1032                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A924  AE 26 2A           ldx    _j
       06:A927  AD 27 2A           lda    _j+1
                                  .endif
 1033  06:A92A  20 48 80            call  _snd_chg
 1034                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       06:A92D  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01579
                          ;        dec    A
                          ;.x_01579:
       06:A930  62                 cla    ; unsigned
                                  .endif
 1035  06:A931  20 00 80            call  _chg_cbank
 1036  06:A934  4C 99 AB          jmp endpoint
 1037  06:A937            SEQ_F0:
 1038  06:A937  EA          nop
 1039                             incw    _seq_ptr
       06:A938  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A93B  D0 03              bne    .x_01580           ; location
       06:A93D  EE D3 29           inc    _seq_ptr+1
       06:A940            .x_01580:
 1040                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A940  AE D2 29           ldx    _seq_ptr
       06:A943  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1041                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A946  86 0B              stx    <__ptr
       06:A948  85 0C              sta    <__ptr+1
       06:A94A  B2 0B              lda    [__ptr]
       06:A94C  AA                 tax
       06:A94D  62                 cla
                          ;        bpl    .x_01582   ; signed
                          ;        dec    A
                          ;.x_01582:
 1042                             __stw   _j
       06:A94E  8E 26 2A           stx    _j
       06:A951  8D 27 2A           sta    _j+1
 1043                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A954  AE D2 29           ldx    _seq_ptr
       06:A957  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1044                             incw    _seq_ptr
       06:A95A  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A95D  D0 03              bne    .x_01585           ; location
       06:A95F  EE D3 29           inc    _seq_ptr+1
       06:A962            .x_01585:
 1045                             __ldwi  _panpod
       06:A962  A2 C2              ldx    #low(_panpod)
       06:A964  A9 29              lda    #high(_panpod)
 1046                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:A966  A0 06              ldy    #6
       06:A968  18                 clc
       06:A969  22                 sax
       06:A96A  71 00              adc    [__sp],Y
       06:A96C  22                 sax
       06:A96D  C8                 iny
       06:A96E  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1047                             __pushw
                                 __submi  2,__stack
       06:A970  48                 pha
       06:A971  38                 sec
       06:A972  A5 00              lda    <__stack
       06:A974  E9 02              sbc    #low(2)
       06:A976  85 00              sta    <__stack
       06:A978  A5 01              lda    <__stack+1
       06:A97A  E9 00              sbc    #high(2)
       06:A97C  85 01              sta    <__stack+1
       06:A97E  68                 pla
       06:A97F  22                 sax
       06:A980  92 00              sta    [__stack]
       06:A982  22                 sax
       06:A983  A0 01              ldy    #1
       06:A985  91 00              sta    [__stack],Y
 1048                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A987  AE 26 2A           ldx    _j
       06:A98A  AD 27 2A           lda    _j+1
                                  .endif
 1049                             __stbps
                                 __stw    <__temp
       06:A98D  86 03              stx    <__temp
       06:A98F  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:A991  B2 00              lda    [__stack]
       06:A993  AA                 tax
       06:A994  A0 01              ldy    #1
       06:A996  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:A998  86 0B              stx    <__ptr
       06:A99A  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:A99C  A6 03              ldx    <__temp
       06:A99E  A5 04              lda    <__temp+1
                                  .endif
       06:A9A0  22                 sax
       06:A9A1  92 0B              sta    [__ptr]
       06:A9A3  22                 sax
                                 __addmi  2,__stack
       06:A9A4  48                 pha
       06:A9A5  18                 clc
       06:A9A6  A5 00              lda    <__stack
       06:A9A8  69 02              adc    #low(2)
       06:A9AA  85 00              sta    <__stack
       06:A9AC  A5 01              lda    <__stack+1
       06:A9AE  69 00              adc    #high(2)
       06:A9B0  85 01              sta    <__stack+1
       06:A9B2  68                 pla
 1050                             __ldwi  2053
       06:A9B3  A2 05              ldx    #low(2053)
       06:A9B5  A9 08              lda    #high(2053)
 1051                             __stw   _bx
       06:A9B7  8E FA 20           stx    _bx
       06:A9BA  8D FB 20           sta    _bx+1
 1052                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:A9BD  AE 26 2A           ldx    _j
       06:A9C0  AD 27 2A           lda    _j+1
                                  .endif
 1053  06:A9C3  20 A4 FB            call  _poke.2
 1054  06:A9C6  4C 99 AB          jmp endpoint
 1055  06:A9C9            SEQ_EF:
 1056  06:A9C9  EA          nop
 1057                             incw    _seq_ptr
       06:A9CA  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A9CD  D0 03              bne    .x_01600           ; location
       06:A9CF  EE D3 29           inc    _seq_ptr+1
       06:A9D2            .x_01600:
 1058                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A9D2  AE D2 29           ldx    _seq_ptr
       06:A9D5  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1059                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:A9D8  86 0B              stx    <__ptr
       06:A9DA  85 0C              sta    <__ptr+1
       06:A9DC  B2 0B              lda    [__ptr]
       06:A9DE  AA                 tax
       06:A9DF  62                 cla
                          ;        bpl    .x_01602   ; signed
                          ;        dec    A
                          ;.x_01602:
 1060                             __stw   _j
       06:A9E0  8E 26 2A           stx    _j
       06:A9E3  8D 27 2A           sta    _j+1
 1061                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:A9E6  AE D2 29           ldx    _seq_ptr
       06:A9E9  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1062                             incw    _seq_ptr
       06:A9EC  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:A9EF  D0 03              bne    .x_01605           ; location
       06:A9F1  EE D3 29           inc    _seq_ptr+1
       06:A9F4            .x_01605:
 1063                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:A9F4  A0 06               ldy   #6
       06:A9F6  B1 00               lda   [__sp],Y
       06:A9F8  AA                  tax
       06:A9F9  C8                  iny
       06:A9FA  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1064                             __stw   <__temp
       06:A9FC  86 03              stx    <__temp
       06:A9FE  85 04              sta    <__temp+1
 1065                             __ldwi  5
       06:AA00  A2 05              ldx    #low(5)
       06:AA02  A9 00              lda    #high(5)
 1066  06:AA04  20 FC E8            jsr   eqzp
 1067                             __lbeq  LL56
       06:AA07  D0 03              bne    .x01609
       06:AA09  4C 29 AA           jmp    LL56
       06:AA0C            .x01609
 1068                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AA0C  AE 26 2A           ldx    _j
       06:AA0F  AD 27 2A           lda    _j+1
                                  .endif
 1069  06:AA12  8E 62 2A            stx   _xpcm_sw
 1070                             __ldb   _xpcm_sw
                0000              .if (1 = 2)
                                  .else
       06:AA15  AE 62 2A           ldx    _xpcm_sw
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01612
                          ;        dec    A
                          ;.x_01612:
       06:AA18  62                 cla    ; unsigned
                                  .endif
 1071                             __tstw
                                   ; pha
       06:AA19  86 03              stx    <__temp
       06:AA1B  05 03              ora    <__temp
                                   ; pla
 1072                             __lbeq  LL57
       06:AA1D  D0 03              bne    .x01614
       06:AA1F  4C 29 AA           jmp    LL57
       06:AA22            .x01614
 1073                             __ldwi  5
       06:AA22  A2 05              ldx    #low(5)
       06:AA24  A9 00              lda    #high(5)
 1074  06:AA26  20 5A 80            call  _pcm_on
 1075  06:AA29            LL57:
 1076                     
 1077  06:AA29            LL56:
 1078                     
 1079  06:AA29  4C 99 AB          jmp endpoint
 1080  06:AA2C            SEQ_EE:
 1081  06:AA2C  EA          nop
 1082                             incw    _seq_ptr
       06:AA2D  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AA30  D0 03              bne    .x_01616           ; location
       06:AA32  EE D3 29           inc    _seq_ptr+1
       06:AA35            .x_01616:
 1083                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AA35  AE D2 29           ldx    _seq_ptr
       06:AA38  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1084                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AA3B  86 0B              stx    <__ptr
       06:AA3D  85 0C              sta    <__ptr+1
       06:AA3F  B2 0B              lda    [__ptr]
       06:AA41  AA                 tax
       06:AA42  62                 cla
                          ;        bpl    .x_01618   ; signed
                          ;        dec    A
                          ;.x_01618:
 1085                             __stw   _j
       06:AA43  8E 26 2A           stx    _j
       06:AA46  8D 27 2A           sta    _j+1
 1086                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AA49  AE D2 29           ldx    _seq_ptr
       06:AA4C  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1087                             incw    _seq_ptr
       06:AA4F  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AA52  D0 03              bne    .x_01621           ; location
       06:AA54  EE D3 29           inc    _seq_ptr+1
       06:AA57            .x_01621:
 1088                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AA57  AE D2 29           ldx    _seq_ptr
       06:AA5A  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1089                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AA5D  86 0B              stx    <__ptr
       06:AA5F  85 0C              sta    <__ptr+1
       06:AA61  B2 0B              lda    [__ptr]
       06:AA63  AA                 tax
       06:AA64  62                 cla
                          ;        bpl    .x_01623   ; signed
                          ;        dec    A
                          ;.x_01623:
 1090                             __pushw
                                 __submi  2,__stack
       06:AA65  48                 pha
       06:AA66  38                 sec
       06:AA67  A5 00              lda    <__stack
       06:AA69  E9 02              sbc    #low(2)
       06:AA6B  85 00              sta    <__stack
       06:AA6D  A5 01              lda    <__stack+1
       06:AA6F  E9 00              sbc    #high(2)
       06:AA71  85 01              sta    <__stack+1
       06:AA73  68                 pla
       06:AA74  22                 sax
       06:AA75  92 00              sta    [__stack]
       06:AA77  22                 sax
       06:AA78  A0 01              ldy    #1
       06:AA7A  91 00              sta    [__stack],Y
 1091                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AA7C  AE D2 29           ldx    _seq_ptr
       06:AA7F  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1092                             __addwi 1
       06:AA82  18                 clc
       06:AA83  22                 sax
       06:AA84  69 01              adc    #low(1)
       06:AA86  22                 sax
       06:AA87  69 00              adc    #high(1)
 1093                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AA89  86 0B              stx    <__ptr
       06:AA8B  85 0C              sta    <__ptr+1
       06:AA8D  B2 0B              lda    [__ptr]
       06:AA8F  AA                 tax
       06:AA90  62                 cla
                          ;        bpl    .x_01628   ; signed
                          ;        dec    A
                          ;.x_01628:
 1094                             __pushw
                                 __submi  2,__stack
       06:AA91  48                 pha
       06:AA92  38                 sec
       06:AA93  A5 00              lda    <__stack
       06:AA95  E9 02              sbc    #low(2)
       06:AA97  85 00              sta    <__stack
       06:AA99  A5 01              lda    <__stack+1
       06:AA9B  E9 00              sbc    #high(2)
       06:AA9D  85 01              sta    <__stack+1
       06:AA9F  68                 pla
       06:AAA0  22                 sax
       06:AAA1  92 00              sta    [__stack]
       06:AAA3  22                 sax
       06:AAA4  A0 01              ldy    #1
       06:AAA6  91 00              sta    [__stack],Y
 1095                             __ldwi  8
       06:AAA8  A2 08              ldx    #low(8)
       06:AAAA  A9 00              lda    #high(8)
 1096  06:AAAC  20 60 EA            jsr   asl
 1097                             __orws
       06:AAAF  22                 sax
       06:AAB0  12 00              ora    [__stack]
       06:AAB2  22                 sax
       06:AAB3  A0 01              ldy    #1
       06:AAB5  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       06:AAB7  48                 pha
       06:AAB8  18                 clc
       06:AAB9  A5 00              lda    <__stack
       06:AABB  69 02              adc    #low(2)
       06:AABD  85 00              sta    <__stack
       06:AABF  A5 01              lda    <__stack+1
       06:AAC1  69 00              adc    #high(2)
       06:AAC3  85 01              sta    <__stack+1
       06:AAC5  68                 pla
 1098                             __stw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:AAC6  22                 sax
       06:AAC7  A0 02              ldy    #2
       06:AAC9  91 00              sta    [__sp],Y
       06:AACB  22                 sax
       06:AACC  C8                 iny
       06:AACD  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1099                             __stw   _seq_ptr
       06:AACF  8E D2 29           stx    _seq_ptr
       06:AAD2  8D D3 29           sta    _seq_ptr+1
 1100                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AAD5  AE 26 2A           ldx    _j
       06:AAD8  AD 27 2A           lda    _j+1
                                  .endif
 1101  06:AADB  20 00 80            call  _chg_cbank
 1102                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AADE  AE 26 2A           ldx    _j
       06:AAE1  AD 27 2A           lda    _j+1
                                  .endif
 1103  06:AAE4  8E A0 29            stx   _ch_nowbank
 1104  06:AAE7  4C 99 AB          jmp endpoint
 1105  06:AAEA            SEQ_ED:
 1106  06:AAEA  EA          nop
 1107                             incw    _seq_ptr
       06:AAEB  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AAEE  D0 03              bne    .x_01638           ; location
       06:AAF0  EE D3 29           inc    _seq_ptr+1
       06:AAF3            .x_01638:
 1108                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AAF3  AE D2 29           ldx    _seq_ptr
       06:AAF6  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1109                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AAF9  86 0B              stx    <__ptr
       06:AAFB  85 0C              sta    <__ptr+1
       06:AAFD  B2 0B              lda    [__ptr]
       06:AAFF  AA                 tax
       06:AB00  62                 cla
                          ;        bpl    .x_01640   ; signed
                          ;        dec    A
                          ;.x_01640:
 1110                             __stw   _j
       06:AB01  8E 26 2A           stx    _j
       06:AB04  8D 27 2A           sta    _j+1
 1111                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AB07  AE D2 29           ldx    _seq_ptr
       06:AB0A  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1112                             incw    _seq_ptr
       06:AB0D  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AB10  D0 03              bne    .x_01643           ; location
       06:AB12  EE D3 29           inc    _seq_ptr+1
       06:AB15            .x_01643:
 1113                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AB15  AE 26 2A           ldx    _j
       06:AB18  AD 27 2A           lda    _j+1
                                  .endif
 1114                             __stw   <__temp
       06:AB1B  86 03              stx    <__temp
       06:AB1D  85 04              sta    <__temp+1
 1115                             __ldwi  255
       06:AB1F  A2 FF              ldx    #low(255)
       06:AB21  A9 00              lda    #high(255)
 1116  06:AB23  20 FC E8            jsr   eqzp
 1117                             __lbeq  LL58
       06:AB26  D0 03              bne    .x01647
       06:AB28  4C 3F AB           jmp    LL58
       06:AB2B            .x01647
 1118                             __ldwi  2057
       06:AB2B  A2 09              ldx    #low(2057)
       06:AB2D  A9 08              lda    #high(2057)
 1119                             __stw   _bx
       06:AB2F  8E FA 20           stx    _bx
       06:AB32  8D FB 20           sta    _bx+1
 1120                             __ldwi  0
       06:AB35  A2 00              ldx    #low(0)
       06:AB37  A9 00              lda    #high(0)
 1121  06:AB39  20 A4 FB            call  _poke.2
 1122                             __lbra  LL59
       06:AB3C  4C 58 AB           jmp    LL59
 1123  06:AB3F            LL58:
 1124                     
 1125                             __ldwi  2057
       06:AB3F  A2 09              ldx    #low(2057)
       06:AB41  A9 08              lda    #high(2057)
 1126                             __stw   _bx
       06:AB43  8E FA 20           stx    _bx
       06:AB46  8D FB 20           sta    _bx+1
 1127                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AB49  AE 26 2A           ldx    _j
       06:AB4C  AD 27 2A           lda    _j+1
                                  .endif
 1128                             __orwi  128
       06:AB4F  22                 sax
       06:AB50  09 80              ora    #low(128)
       06:AB52  22                 sax
       06:AB53  09 00              ora    #high(128)
 1129  06:AB55  20 A4 FB            call  _poke.2
 1130  06:AB58            LL59:
 1131                     
 1132  06:AB58  4C 99 AB          jmp endpoint
 1133  06:AB5B            SEQ_EC:
 1134  06:AB5B  EA          nop
 1135                             incw    _seq_ptr
       06:AB5C  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AB5F  D0 03              bne    .x_01656           ; location
       06:AB61  EE D3 29           inc    _seq_ptr+1
       06:AB64            .x_01656:
 1136                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AB64  AE D2 29           ldx    _seq_ptr
       06:AB67  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1137                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AB6A  86 0B              stx    <__ptr
       06:AB6C  85 0C              sta    <__ptr+1
       06:AB6E  B2 0B              lda    [__ptr]
       06:AB70  AA                 tax
       06:AB71  62                 cla
                          ;        bpl    .x_01658   ; signed
                          ;        dec    A
                          ;.x_01658:
 1138                             __stw   _j
       06:AB72  8E 26 2A           stx    _j
       06:AB75  8D 27 2A           sta    _j+1
 1139                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AB78  AE D2 29           ldx    _seq_ptr
       06:AB7B  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1140                             incw    _seq_ptr
       06:AB7E  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AB81  D0 03              bne    .x_01661           ; location
       06:AB83  EE D3 29           inc    _seq_ptr+1
       06:AB86            .x_01661:
 1141                             __ldwi  2056
       06:AB86  A2 08              ldx    #low(2056)
       06:AB88  A9 08              lda    #high(2056)
 1142                             __stw   _bx
       06:AB8A  8E FA 20           stx    _bx
       06:AB8D  8D FB 20           sta    _bx+1
 1143                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AB90  AE 26 2A           ldx    _j
       06:AB93  AD 27 2A           lda    _j+1
                                  .endif
 1144  06:AB96  20 A4 FB            call  _poke.2
 1145  06:AB99            endpoint:
 1146                             __lbra  LL60
       06:AB99  4C 33 AF           jmp    LL60
 1147  06:AB9C            LL48:
 1148                     
 1149                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       06:AB9C  A0 04               ldy   #4
       06:AB9E  B1 00               lda   [__sp],Y
       06:ABA0  AA                  tax
       06:ABA1  C8                  iny
       06:ABA2  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1150                             __stw   <__temp
       06:ABA4  86 03              stx    <__temp
       06:ABA6  85 04              sta    <__temp+1
 1151                             __ldwi  161
       06:ABA8  A2 A1              ldx    #low(161)
       06:ABAA  A9 00              lda    #high(161)
 1152  06:ABAC  20 FC E8            jsr   eqzp
 1153                             __lbeq  LL61
       06:ABAF  D0 03              bne    .x01669
       06:ABB1  4C CB AC           jmp    LL61
       06:ABB4            .x01669
 1154                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:ABB4  AE D2 29           ldx    _seq_ptr
       06:ABB7  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1155                             incw    _seq_ptr
       06:ABBA  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:ABBD  D0 03              bne    .x_01671           ; location
       06:ABBF  EE D3 29           inc    _seq_ptr+1
       06:ABC2            .x_01671:
 1156                             __ldwi  _loop_cnt
       06:ABC2  A2 CA              ldx    #low(_loop_cnt)
       06:ABC4  A9 29              lda    #high(_loop_cnt)
 1157                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:ABC6  A0 06              ldy    #6
       06:ABC8  18                 clc
       06:ABC9  22                 sax
       06:ABCA  71 00              adc    [__sp],Y
       06:ABCC  22                 sax
       06:ABCD  C8                 iny
       06:ABCE  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1158                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:ABD0  86 0B              stx    <__ptr
       06:ABD2  85 0C              sta    <__ptr+1
       06:ABD4  B2 0B              lda    [__ptr]
       06:ABD6  AA                 tax
       06:ABD7  62                 cla
                          ;        bpl    .x_01674   ; signed
                          ;        dec    A
                          ;.x_01674:
 1159                             __stw   <__temp
       06:ABD8  86 03              stx    <__temp
       06:ABDA  85 04              sta    <__temp+1
 1160                             __ldwi  1
       06:ABDC  A2 01              ldx    #low(1)
       06:ABDE  A9 00              lda    #high(1)
 1161  06:ABE0  20 FC E8            jsr   eqzp
 1162                             __lbeq  LL62
       06:ABE3  D0 03              bne    .x01677
       06:ABE5  4C B8 AC           jmp    LL62
       06:ABE8            .x01677
 1163                             __ldwi  _loop_cnt
       06:ABE8  A2 CA              ldx    #low(_loop_cnt)
       06:ABEA  A9 29              lda    #high(_loop_cnt)
 1164                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:ABEC  A0 06              ldy    #6
       06:ABEE  18                 clc
       06:ABEF  22                 sax
       06:ABF0  71 00              adc    [__sp],Y
       06:ABF2  22                 sax
       06:ABF3  C8                 iny
       06:ABF4  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1165                             __pushw
                                 __submi  2,__stack
       06:ABF6  48                 pha
       06:ABF7  38                 sec
       06:ABF8  A5 00              lda    <__stack
       06:ABFA  E9 02              sbc    #low(2)
       06:ABFC  85 00              sta    <__stack
       06:ABFE  A5 01              lda    <__stack+1
       06:AC00  E9 00              sbc    #high(2)
       06:AC02  85 01              sta    <__stack+1
       06:AC04  68                 pla
       06:AC05  22                 sax
       06:AC06  92 00              sta    [__stack]
       06:AC08  22                 sax
       06:AC09  A0 01              ldy    #1
       06:AC0B  91 00              sta    [__stack],Y
 1166                             __ldwi  0
       06:AC0D  A2 00              ldx    #low(0)
       06:AC0F  A9 00              lda    #high(0)
 1167                             __stbps
                                 __stw    <__temp
       06:AC11  86 03              stx    <__temp
       06:AC13  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:AC15  B2 00              lda    [__stack]
       06:AC17  AA                 tax
       06:AC18  A0 01              ldy    #1
       06:AC1A  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:AC1C  86 0B              stx    <__ptr
       06:AC1E  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:AC20  A6 03              ldx    <__temp
       06:AC22  A5 04              lda    <__temp+1
                                  .endif
       06:AC24  22                 sax
       06:AC25  92 0B              sta    [__ptr]
       06:AC27  22                 sax
                                 __addmi  2,__stack
       06:AC28  48                 pha
       06:AC29  18                 clc
       06:AC2A  A5 00              lda    <__stack
       06:AC2C  69 02              adc    #low(2)
       06:AC2E  85 00              sta    <__stack
       06:AC30  A5 01              lda    <__stack+1
       06:AC32  69 00              adc    #high(2)
       06:AC34  85 01              sta    <__stack+1
       06:AC36  68                 pla
 1168                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AC37  AE D2 29           ldx    _seq_ptr
       06:AC3A  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1169                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AC3D  86 0B              stx    <__ptr
       06:AC3F  85 0C              sta    <__ptr+1
       06:AC41  B2 0B              lda    [__ptr]
       06:AC43  AA                 tax
       06:AC44  62                 cla
                          ;        bpl    .x_01690   ; signed
                          ;        dec    A
                          ;.x_01690:
 1170                             __pushw
                                 __submi  2,__stack
       06:AC45  48                 pha
       06:AC46  38                 sec
       06:AC47  A5 00              lda    <__stack
       06:AC49  E9 02              sbc    #low(2)
       06:AC4B  85 00              sta    <__stack
       06:AC4D  A5 01              lda    <__stack+1
       06:AC4F  E9 00              sbc    #high(2)
       06:AC51  85 01              sta    <__stack+1
       06:AC53  68                 pla
       06:AC54  22                 sax
       06:AC55  92 00              sta    [__stack]
       06:AC57  22                 sax
       06:AC58  A0 01              ldy    #1
       06:AC5A  91 00              sta    [__stack],Y
 1171                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AC5C  AE D2 29           ldx    _seq_ptr
       06:AC5F  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1172                             __addwi 1
       06:AC62  18                 clc
       06:AC63  22                 sax
       06:AC64  69 01              adc    #low(1)
       06:AC66  22                 sax
       06:AC67  69 00              adc    #high(1)
 1173                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AC69  86 0B              stx    <__ptr
       06:AC6B  85 0C              sta    <__ptr+1
       06:AC6D  B2 0B              lda    [__ptr]
       06:AC6F  AA                 tax
       06:AC70  62                 cla
                          ;        bpl    .x_01695   ; signed
                          ;        dec    A
                          ;.x_01695:
 1174                             __pushw
                                 __submi  2,__stack
       06:AC71  48                 pha
       06:AC72  38                 sec
       06:AC73  A5 00              lda    <__stack
       06:AC75  E9 02              sbc    #low(2)
       06:AC77  85 00              sta    <__stack
       06:AC79  A5 01              lda    <__stack+1
       06:AC7B  E9 00              sbc    #high(2)
       06:AC7D  85 01              sta    <__stack+1
       06:AC7F  68                 pla
       06:AC80  22                 sax
       06:AC81  92 00              sta    [__stack]
       06:AC83  22                 sax
       06:AC84  A0 01              ldy    #1
       06:AC86  91 00              sta    [__stack],Y
 1175                             __ldwi  8
       06:AC88  A2 08              ldx    #low(8)
       06:AC8A  A9 00              lda    #high(8)
 1176  06:AC8C  20 60 EA            jsr   asl
 1177                             __orws
       06:AC8F  22                 sax
       06:AC90  12 00              ora    [__stack]
       06:AC92  22                 sax
       06:AC93  A0 01              ldy    #1
       06:AC95  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       06:AC97  48                 pha
       06:AC98  18                 clc
       06:AC99  A5 00              lda    <__stack
       06:AC9B  69 02              adc    #low(2)
       06:AC9D  85 00              sta    <__stack
       06:AC9F  A5 01              lda    <__stack+1
       06:ACA1  69 00              adc    #high(2)
       06:ACA3  85 01              sta    <__stack+1
       06:ACA5  68                 pla
 1178                             __stw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:ACA6  22                 sax
       06:ACA7  A0 02              ldy    #2
       06:ACA9  91 00              sta    [__sp],Y
       06:ACAB  22                 sax
       06:ACAC  C8                 iny
       06:ACAD  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1179                             __stw   _seq_ptr
       06:ACAF  8E D2 29           stx    _seq_ptr
       06:ACB2  8D D3 29           sta    _seq_ptr+1
 1180                             __lbra  LL63
       06:ACB5  4C CB AC           jmp    LL63
 1181  06:ACB8            LL62:
 1182                     
 1183                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:ACB8  AE D2 29           ldx    _seq_ptr
       06:ACBB  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1184                             __addwi 2
       06:ACBE  18                 clc
       06:ACBF  22                 sax
       06:ACC0  69 02              adc    #low(2)
       06:ACC2  22                 sax
       06:ACC3  69 00              adc    #high(2)
 1185                             __stw   _seq_ptr
       06:ACC5  8E D2 29           stx    _seq_ptr
       06:ACC8  8D D3 29           sta    _seq_ptr+1
 1186  06:ACCB            LL63:
 1187                     
 1188  06:ACCB            LL61:
 1189                     
 1190                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       06:ACCB  A0 04               ldy   #4
       06:ACCD  B1 00               lda   [__sp],Y
       06:ACCF  AA                  tax
       06:ACD0  C8                  iny
       06:ACD1  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1191                             __stw   <__temp
       06:ACD3  86 03              stx    <__temp
       06:ACD5  85 04              sta    <__temp+1
 1192                             __ldwi  160
       06:ACD7  A2 A0              ldx    #low(160)
       06:ACD9  A9 00              lda    #high(160)
 1193  06:ACDB  20 FC E8            jsr   eqzp
 1194                             __lbeq  LL64
       06:ACDE  D0 03              bne    .x01710
       06:ACE0  4C 33 AF           jmp    LL64
       06:ACE3            .x01710
 1195                             incw    _seq_ptr
       06:ACE3  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:ACE6  D0 03              bne    .x_01711           ; location
       06:ACE8  EE D3 29           inc    _seq_ptr+1
       06:ACEB            .x_01711:
 1196                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:ACEB  AE D2 29           ldx    _seq_ptr
       06:ACEE  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1197                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:ACF1  86 0B              stx    <__ptr
       06:ACF3  85 0C              sta    <__ptr+1
       06:ACF5  B2 0B              lda    [__ptr]
       06:ACF7  AA                 tax
       06:ACF8  62                 cla
                          ;        bpl    .x_01713   ; signed
                          ;        dec    A
                          ;.x_01713:
 1198                             __stw   _j
       06:ACF9  8E 26 2A           stx    _j
       06:ACFC  8D 27 2A           sta    _j+1
 1199                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:ACFF  AE D2 29           ldx    _seq_ptr
       06:AD02  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1200                             incw    _seq_ptr
       06:AD05  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AD08  D0 03              bne    .x_01716           ; location
       06:AD0A  EE D3 29           inc    _seq_ptr+1
       06:AD0D            .x_01716:
 1201                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AD0D  AE D2 29           ldx    _seq_ptr
       06:AD10  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1202                             incw    _seq_ptr
       06:AD13  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:AD16  D0 03              bne    .x_01718           ; location
       06:AD18  EE D3 29           inc    _seq_ptr+1
       06:AD1B            .x_01718:
 1203                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AD1B  86 0B              stx    <__ptr
       06:AD1D  85 0C              sta    <__ptr+1
       06:AD1F  B2 0B              lda    [__ptr]
       06:AD21  AA                 tax
       06:AD22  62                 cla
                          ;        bpl    .x_01719   ; signed
                          ;        dec    A
                          ;.x_01719:
 1204                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:AD23  22                 sax
       06:AD24  A0 00              ldy    #0
       06:AD26  91 00              sta    [__sp],Y
       06:AD28  22                 sax
       06:AD29  C8                 iny
       06:AD2A  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1205                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AD2C  AE D2 29           ldx    _seq_ptr
       06:AD2F  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1206                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AD32  86 0B              stx    <__ptr
       06:AD34  85 0C              sta    <__ptr+1
       06:AD36  B2 0B              lda    [__ptr]
       06:AD38  AA                 tax
       06:AD39  62                 cla
                          ;        bpl    .x_01722   ; signed
                          ;        dec    A
                          ;.x_01722:
 1207                             __pushw
                                 __submi  2,__stack
       06:AD3A  48                 pha
       06:AD3B  38                 sec
       06:AD3C  A5 00              lda    <__stack
       06:AD3E  E9 02              sbc    #low(2)
       06:AD40  85 00              sta    <__stack
       06:AD42  A5 01              lda    <__stack+1
       06:AD44  E9 00              sbc    #high(2)
       06:AD46  85 01              sta    <__stack+1
       06:AD48  68                 pla
       06:AD49  22                 sax
       06:AD4A  92 00              sta    [__stack]
       06:AD4C  22                 sax
       06:AD4D  A0 01              ldy    #1
       06:AD4F  91 00              sta    [__stack],Y
 1208                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AD51  AE D2 29           ldx    _seq_ptr
       06:AD54  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1209                             __addwi 1
       06:AD57  18                 clc
       06:AD58  22                 sax
       06:AD59  69 01              adc    #low(1)
       06:AD5B  22                 sax
       06:AD5C  69 00              adc    #high(1)
 1210                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AD5E  86 0B              stx    <__ptr
       06:AD60  85 0C              sta    <__ptr+1
       06:AD62  B2 0B              lda    [__ptr]
       06:AD64  AA                 tax
       06:AD65  62                 cla
                          ;        bpl    .x_01727   ; signed
                          ;        dec    A
                          ;.x_01727:
 1211                             __pushw
                                 __submi  2,__stack
       06:AD66  48                 pha
       06:AD67  38                 sec
       06:AD68  A5 00              lda    <__stack
       06:AD6A  E9 02              sbc    #low(2)
       06:AD6C  85 00              sta    <__stack
       06:AD6E  A5 01              lda    <__stack+1
       06:AD70  E9 00              sbc    #high(2)
       06:AD72  85 01              sta    <__stack+1
       06:AD74  68                 pla
       06:AD75  22                 sax
       06:AD76  92 00              sta    [__stack]
       06:AD78  22                 sax
       06:AD79  A0 01              ldy    #1
       06:AD7B  91 00              sta    [__stack],Y
 1212                             __ldwi  8
       06:AD7D  A2 08              ldx    #low(8)
       06:AD7F  A9 00              lda    #high(8)
 1213  06:AD81  20 60 EA            jsr   asl
 1214                             __orws
       06:AD84  22                 sax
       06:AD85  12 00              ora    [__stack]
       06:AD87  22                 sax
       06:AD88  A0 01              ldy    #1
       06:AD8A  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       06:AD8C  48                 pha
       06:AD8D  18                 clc
       06:AD8E  A5 00              lda    <__stack
       06:AD90  69 02              adc    #low(2)
       06:AD92  85 00              sta    <__stack
       06:AD94  A5 01              lda    <__stack+1
       06:AD96  69 00              adc    #high(2)
       06:AD98  85 01              sta    <__stack+1
       06:AD9A  68                 pla
 1215                             __stw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:AD9B  22                 sax
       06:AD9C  A0 02              ldy    #2
       06:AD9E  91 00              sta    [__sp],Y
       06:ADA0  22                 sax
       06:ADA1  C8                 iny
       06:ADA2  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1216                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:ADA4  AE D2 29           ldx    _seq_ptr
       06:ADA7  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1217                             __addwi 2
       06:ADAA  18                 clc
       06:ADAB  22                 sax
       06:ADAC  69 02              adc    #low(2)
       06:ADAE  22                 sax
       06:ADAF  69 00              adc    #high(2)
 1218                             __stw   _seq_ptr
       06:ADB1  8E D2 29           stx    _seq_ptr
       06:ADB4  8D D3 29           sta    _seq_ptr+1
 1219                             __ldwi  _loop_cnt
       06:ADB7  A2 CA              ldx    #low(_loop_cnt)
       06:ADB9  A9 29              lda    #high(_loop_cnt)
 1220                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:ADBB  A0 06              ldy    #6
       06:ADBD  18                 clc
       06:ADBE  22                 sax
       06:ADBF  71 00              adc    [__sp],Y
       06:ADC1  22                 sax
       06:ADC2  C8                 iny
       06:ADC3  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1221                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:ADC5  86 0B              stx    <__ptr
       06:ADC7  85 0C              sta    <__ptr+1
       06:ADC9  B2 0B              lda    [__ptr]
       06:ADCB  AA                 tax
       06:ADCC  62                 cla
                          ;        bpl    .x_01739   ; signed
                          ;        dec    A
                          ;.x_01739:
 1222                             __stw   <__temp
       06:ADCD  86 03              stx    <__temp
       06:ADCF  85 04              sta    <__temp+1
 1223                             __ldwi  1
       06:ADD1  A2 01              ldx    #low(1)
       06:ADD3  A9 00              lda    #high(1)
 1224  06:ADD5  20 FC E8            jsr   eqzp
 1225                             __lbeq  LL65
       06:ADD8  D0 03              bne    .x01742
       06:ADDA  4C 2F AE           jmp    LL65
       06:ADDD            .x01742
 1226                             __ldwi  _loop_cnt
       06:ADDD  A2 CA              ldx    #low(_loop_cnt)
       06:ADDF  A9 29              lda    #high(_loop_cnt)
 1227                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:ADE1  A0 06              ldy    #6
       06:ADE3  18                 clc
       06:ADE4  22                 sax
       06:ADE5  71 00              adc    [__sp],Y
       06:ADE7  22                 sax
       06:ADE8  C8                 iny
       06:ADE9  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1228                             __pushw
                                 __submi  2,__stack
       06:ADEB  48                 pha
       06:ADEC  38                 sec
       06:ADED  A5 00              lda    <__stack
       06:ADEF  E9 02              sbc    #low(2)
       06:ADF1  85 00              sta    <__stack
       06:ADF3  A5 01              lda    <__stack+1
       06:ADF5  E9 00              sbc    #high(2)
       06:ADF7  85 01              sta    <__stack+1
       06:ADF9  68                 pla
       06:ADFA  22                 sax
       06:ADFB  92 00              sta    [__stack]
       06:ADFD  22                 sax
       06:ADFE  A0 01              ldy    #1
       06:AE00  91 00              sta    [__stack],Y
 1229                             __ldwi  0
       06:AE02  A2 00              ldx    #low(0)
       06:AE04  A9 00              lda    #high(0)
 1230                             __stbps
                                 __stw    <__temp
       06:AE06  86 03              stx    <__temp
       06:AE08  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:AE0A  B2 00              lda    [__stack]
       06:AE0C  AA                 tax
       06:AE0D  A0 01              ldy    #1
       06:AE0F  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:AE11  86 0B              stx    <__ptr
       06:AE13  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:AE15  A6 03              ldx    <__temp
       06:AE17  A5 04              lda    <__temp+1
                                  .endif
       06:AE19  22                 sax
       06:AE1A  92 0B              sta    [__ptr]
       06:AE1C  22                 sax
                                 __addmi  2,__stack
       06:AE1D  48                 pha
       06:AE1E  18                 clc
       06:AE1F  A5 00              lda    <__stack
       06:AE21  69 02              adc    #low(2)
       06:AE23  85 00              sta    <__stack
       06:AE25  A5 01              lda    <__stack+1
       06:AE27  69 00              adc    #high(2)
       06:AE29  85 01              sta    <__stack+1
       06:AE2B  68                 pla
 1231                             __lbra  LL66
       06:AE2C  4C 33 AF           jmp    LL66
 1232  06:AE2F            LL65:
 1233                     
 1234                             __ldwi  _loop_cnt
       06:AE2F  A2 CA              ldx    #low(_loop_cnt)
       06:AE31  A9 29              lda    #high(_loop_cnt)
 1235                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:AE33  A0 06              ldy    #6
       06:AE35  18                 clc
       06:AE36  22                 sax
       06:AE37  71 00              adc    [__sp],Y
       06:AE39  22                 sax
       06:AE3A  C8                 iny
       06:AE3B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1236                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AE3D  86 0B              stx    <__ptr
       06:AE3F  85 0C              sta    <__ptr+1
       06:AE41  B2 0B              lda    [__ptr]
       06:AE43  AA                 tax
       06:AE44  62                 cla
                          ;        bpl    .x_01757   ; signed
                          ;        dec    A
                          ;.x_01757:
 1237                             __stw   <__temp
       06:AE45  86 03              stx    <__temp
       06:AE47  85 04              sta    <__temp+1
 1238                             __ldwi  1
       06:AE49  A2 01              ldx    #low(1)
       06:AE4B  A9 00              lda    #high(1)
 1239  06:AE4D  20 CC E9            jsr   gtzp
 1240                             __lbeq  LL67
       06:AE50  D0 03              bne    .x01760
       06:AE52  4C B9 AE           jmp    LL67
       06:AE55            .x01760
 1241                             __ldwi  _loop_cnt
       06:AE55  A2 CA              ldx    #low(_loop_cnt)
       06:AE57  A9 29              lda    #high(_loop_cnt)
 1242                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:AE59  A0 06              ldy    #6
       06:AE5B  18                 clc
       06:AE5C  22                 sax
       06:AE5D  71 00              adc    [__sp],Y
       06:AE5F  22                 sax
       06:AE60  C8                 iny
       06:AE61  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1243                             __pushw
                                 __submi  2,__stack
       06:AE63  48                 pha
       06:AE64  38                 sec
       06:AE65  A5 00              lda    <__stack
       06:AE67  E9 02              sbc    #low(2)
       06:AE69  85 00              sta    <__stack
       06:AE6B  A5 01              lda    <__stack+1
       06:AE6D  E9 00              sbc    #high(2)
       06:AE6F  85 01              sta    <__stack+1
       06:AE71  68                 pla
       06:AE72  22                 sax
       06:AE73  92 00              sta    [__stack]
       06:AE75  22                 sax
       06:AE76  A0 01              ldy    #1
       06:AE78  91 00              sta    [__stack],Y
 1244                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AE7A  86 0B              stx    <__ptr
       06:AE7C  85 0C              sta    <__ptr+1
       06:AE7E  B2 0B              lda    [__ptr]
       06:AE80  AA                 tax
       06:AE81  62                 cla
                          ;        bpl    .x_01765   ; signed
                          ;        dec    A
                          ;.x_01765:
 1245                             __subwi 1
       06:AE82  38                 sec
       06:AE83  22                 sax
       06:AE84  E9 01              sbc    #low(1)
       06:AE86  22                 sax
       06:AE87  E9 00              sbc    #high(1)
 1246                             __stbps
                                 __stw    <__temp
       06:AE89  86 03              stx    <__temp
       06:AE8B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:AE8D  B2 00              lda    [__stack]
       06:AE8F  AA                 tax
       06:AE90  A0 01              ldy    #1
       06:AE92  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:AE94  86 0B              stx    <__ptr
       06:AE96  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:AE98  A6 03              ldx    <__temp
       06:AE9A  A5 04              lda    <__temp+1
                                  .endif
       06:AE9C  22                 sax
       06:AE9D  92 0B              sta    [__ptr]
       06:AE9F  22                 sax
                                 __addmi  2,__stack
       06:AEA0  48                 pha
       06:AEA1  18                 clc
       06:AEA2  A5 00              lda    <__stack
       06:AEA4  69 02              adc    #low(2)
       06:AEA6  85 00              sta    <__stack
       06:AEA8  A5 01              lda    <__stack+1
       06:AEAA  69 00              adc    #high(2)
       06:AEAC  85 01              sta    <__stack+1
       06:AEAE  68                 pla
 1247                             __addwi 1
       06:AEAF  18                 clc
       06:AEB0  22                 sax
       06:AEB1  69 01              adc    #low(1)
       06:AEB3  22                 sax
       06:AEB4  69 00              adc    #high(1)
 1248                             __lbra  LL68
       06:AEB6  4C 11 AF           jmp    LL68
 1249  06:AEB9            LL67:
 1250                     
 1251                             __ldwi  _loop_cnt
       06:AEB9  A2 CA              ldx    #low(_loop_cnt)
       06:AEBB  A9 29              lda    #high(_loop_cnt)
 1252                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:AEBD  A0 06              ldy    #6
       06:AEBF  18                 clc
       06:AEC0  22                 sax
       06:AEC1  71 00              adc    [__sp],Y
       06:AEC3  22                 sax
       06:AEC4  C8                 iny
       06:AEC5  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1253                             __pushw
                                 __submi  2,__stack
       06:AEC7  48                 pha
       06:AEC8  38                 sec
       06:AEC9  A5 00              lda    <__stack
       06:AECB  E9 02              sbc    #low(2)
       06:AECD  85 00              sta    <__stack
       06:AECF  A5 01              lda    <__stack+1
       06:AED1  E9 00              sbc    #high(2)
       06:AED3  85 01              sta    <__stack+1
       06:AED5  68                 pla
       06:AED6  22                 sax
       06:AED7  92 00              sta    [__stack]
       06:AED9  22                 sax
       06:AEDA  A0 01              ldy    #1
       06:AEDC  91 00              sta    [__stack],Y
 1254                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:AEDE  AE 26 2A           ldx    _j
       06:AEE1  AD 27 2A           lda    _j+1
                                  .endif
 1255                             __subwi 1
       06:AEE4  38                 sec
       06:AEE5  22                 sax
       06:AEE6  E9 01              sbc    #low(1)
       06:AEE8  22                 sax
       06:AEE9  E9 00              sbc    #high(1)
 1256                             __stbps
                                 __stw    <__temp
       06:AEEB  86 03              stx    <__temp
       06:AEED  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:AEEF  B2 00              lda    [__stack]
       06:AEF1  AA                 tax
       06:AEF2  A0 01              ldy    #1
       06:AEF4  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:AEF6  86 0B              stx    <__ptr
       06:AEF8  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:AEFA  A6 03              ldx    <__temp
       06:AEFC  A5 04              lda    <__temp+1
                                  .endif
       06:AEFE  22                 sax
       06:AEFF  92 0B              sta    [__ptr]
       06:AF01  22                 sax
                                 __addmi  2,__stack
       06:AF02  48                 pha
       06:AF03  18                 clc
       06:AF04  A5 00              lda    <__stack
       06:AF06  69 02              adc    #low(2)
       06:AF08  85 00              sta    <__stack
       06:AF0A  A5 01              lda    <__stack+1
       06:AF0C  69 00              adc    #high(2)
       06:AF0E  85 01              sta    <__stack+1
       06:AF10  68                 pla
 1257  06:AF11            LL68:
 1258                     
 1259                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       06:AF11  A0 02               ldy   #2
       06:AF13  B1 00               lda   [__sp],Y
       06:AF15  AA                  tax
       06:AF16  C8                  iny
       06:AF17  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1260                             __stw   _seq_ptr
       06:AF19  8E D2 29           stx    _seq_ptr
       06:AF1C  8D D3 29           sta    _seq_ptr+1
 1261                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       06:AF1F  B2 00               lda   [__sp]
       06:AF21  AA                  tax
       06:AF22  A0 01               ldy   #1
       06:AF24  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 1262  06:AF26  20 00 80            call  _chg_cbank
 1263                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       06:AF29  B2 00               lda   [__sp]
       06:AF2B  AA                  tax
       06:AF2C  A0 01               ldy   #1
       06:AF2E  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 1264  06:AF30  8E A0 29            stx   _ch_nowbank
 1265  06:AF33            LL66:
 1266                     
 1267  06:AF33            LL64:
 1268                     
 1269  06:AF33            LL60:
 1270                     
 1271                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:AF33  AE D2 29           ldx    _seq_ptr
       06:AF36  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1272                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:AF39  86 0B              stx    <__ptr
       06:AF3B  85 0C              sta    <__ptr+1
       06:AF3D  B2 0B              lda    [__ptr]
       06:AF3F  AA                 tax
       06:AF40  62                 cla
                          ;        bpl    .x_01792   ; signed
                          ;        dec    A
                          ;.x_01792:
 1273                             __stw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:AF41  22                 sax
       06:AF42  A0 04              ldy    #4
       06:AF44  91 00              sta    [__sp],Y
       06:AF46  22                 sax
       06:AF47  C8                 iny
       06:AF48  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1274                             __lbra  LL46
       06:AF4A  4C 26 A0           jmp    LL46
 1275  06:AF4D            LL47:
 1276                     
 1277                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       06:AF4D  A0 04               ldy   #4
       06:AF4F  B1 00               lda   [__sp],Y
       06:AF51  AA                  tax
       06:AF52  C8                  iny
       06:AF53  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1278                             __stw   <__temp
       06:AF55  86 03              stx    <__temp
       06:AF57  85 04              sta    <__temp+1
 1279                             __ldwi  144
       06:AF59  A2 90              ldx    #low(144)
       06:AF5B  A9 00              lda    #high(144)
 1280  06:AF5D  20 A3 E9            jsr   ltzp
 1281                             __lbeq  LL69
       06:AF60  D0 03              bne    .x01798
       06:AF62  4C 00 BB           jmp    LL69
       06:AF65            .x01798
 1282                             __ldwi  _note_data
       06:AF65  A2 A2              ldx    #low(_note_data)
       06:AF67  A9 29              lda    #high(_note_data)
 1283                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:AF69  A0 06              ldy    #6
       06:AF6B  18                 clc
       06:AF6C  22                 sax
       06:AF6D  71 00              adc    [__sp],Y
       06:AF6F  22                 sax
       06:AF70  C8                 iny
       06:AF71  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1284                             __pushw
                                 __submi  2,__stack
       06:AF73  48                 pha
       06:AF74  38                 sec
       06:AF75  A5 00              lda    <__stack
       06:AF77  E9 02              sbc    #low(2)
       06:AF79  85 00              sta    <__stack
       06:AF7B  A5 01              lda    <__stack+1
       06:AF7D  E9 00              sbc    #high(2)
       06:AF7F  85 01              sta    <__stack+1
       06:AF81  68                 pla
       06:AF82  22                 sax
       06:AF83  92 00              sta    [__stack]
       06:AF85  22                 sax
       06:AF86  A0 01              ldy    #1
       06:AF88  91 00              sta    [__stack],Y
 1285                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:AF8A  A0 06               ldy   #6
       06:AF8C  B1 00               lda   [__sp],Y
       06:AF8E  AA                  tax
       06:AF8F  C8                  iny
       06:AF90  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1286                             __stbps
                                 __stw    <__temp
       06:AF92  86 03              stx    <__temp
       06:AF94  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:AF96  B2 00              lda    [__stack]
       06:AF98  AA                 tax
       06:AF99  A0 01              ldy    #1
       06:AF9B  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:AF9D  86 0B              stx    <__ptr
       06:AF9F  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:AFA1  A6 03              ldx    <__temp
       06:AFA3  A5 04              lda    <__temp+1
                                  .endif
       06:AFA5  22                 sax
       06:AFA6  92 0B              sta    [__ptr]
       06:AFA8  22                 sax
                                 __addmi  2,__stack
       06:AFA9  48                 pha
       06:AFAA  18                 clc
       06:AFAB  A5 00              lda    <__stack
       06:AFAD  69 02              adc    #low(2)
       06:AFAF  85 00              sta    <__stack
       06:AFB1  A5 01              lda    <__stack+1
       06:AFB3  69 00              adc    #high(2)
       06:AFB5  85 01              sta    <__stack+1
       06:AFB7  68                 pla
 1287                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:AFB8  A0 06               ldy   #6
       06:AFBA  B1 00               lda   [__sp],Y
       06:AFBC  AA                  tax
       06:AFBD  C8                  iny
       06:AFBE  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1288                             __stw   <__temp
       06:AFC0  86 03              stx    <__temp
       06:AFC2  85 04              sta    <__temp+1
 1289                             __ldwi  5
       06:AFC4  A2 05              ldx    #low(5)
       06:AFC6  A9 00              lda    #high(5)
 1290  06:AFC8  20 FC E8            jsr   eqzp
 1291                             __lbeq  LL71
       06:AFCB  D0 03              bne    .x01813
       06:AFCD  4C D4 AF           jmp    LL71
       06:AFD0            .x01813
 1292                             __ldb   _xpcm_sw
                0000              .if (1 = 2)
                                  .else
       06:AFD0  AE 62 2A           ldx    _xpcm_sw
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01815
                          ;        dec    A
                          ;.x_01815:
       06:AFD3  62                 cla    ; unsigned
                                  .endif
 1293  06:AFD4            LL71:
 1294                     
 1295                             __boolw
       06:AFD4  86 03              stx    <__temp
       06:AFD6  05 03              ora    <__temp
       06:AFD8  82                 clx
       06:AFD9  F0 01              beq    .x01816
       06:AFDB  E8                 inx
       06:AFDC  62        .x01816     cla
 1296                             __tstw
                                   ; pha
       06:AFDD  86 03              stx    <__temp
       06:AFDF  05 03              ora    <__temp
                                   ; pla
 1297                             __lbeq  LL70
       06:AFE1  D0 03              bne    .x01818
       06:AFE3  4C 75 B1           jmp    LL70
       06:AFE6            .x01818
 1298                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       06:AFE6  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01820
                          ;        dec    A
                          ;.x_01820:
       06:AFE9  62                 cla    ; unsigned
                                  .endif
 1299  06:AFEA  20 00 80            call  _chg_cbank
 1300  06:AFED  20 36 80            call  _pcm_off
 1301                             __ldw   _xpcmdata
                0000              .if (1 = 2)
                                  .else
       06:AFF0  AE 18 44           ldx    _xpcmdata
       06:AFF3  AD 19 44           lda    _xpcmdata+1
                                  .endif
 1302                             __pushw
                                 __submi  2,__stack
       06:AFF6  48                 pha
       06:AFF7  38                 sec
       06:AFF8  A5 00              lda    <__stack
       06:AFFA  E9 02              sbc    #low(2)
       06:AFFC  85 00              sta    <__stack
       06:AFFE  A5 01              lda    <__stack+1
       06:B000  E9 00              sbc    #high(2)
       06:B002  85 01              sta    <__stack+1
       06:B004  68                 pla
       06:B005  22                 sax
       06:B006  92 00              sta    [__stack]
       06:B008  22                 sax
       06:B009  A0 01              ldy    #1
       06:B00B  91 00              sta    [__stack],Y
 1303                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B00D  A0 06               ldy   #6
       06:B00F  B1 00               lda   [__sp],Y
       06:B011  AA                  tax
       06:B012  C8                  iny
       06:B013  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1304                             __pushw
                                 __submi  2,__stack
       06:B015  48                 pha
       06:B016  38                 sec
       06:B017  A5 00              lda    <__stack
       06:B019  E9 02              sbc    #low(2)
       06:B01B  85 00              sta    <__stack
       06:B01D  A5 01              lda    <__stack+1
       06:B01F  E9 00              sbc    #high(2)
       06:B021  85 01              sta    <__stack+1
       06:B023  68                 pla
       06:B024  22                 sax
       06:B025  92 00              sta    [__stack]
       06:B027  22                 sax
       06:B028  A0 01              ldy    #1
       06:B02A  91 00              sta    [__stack],Y
 1305                             __ldwi  3
       06:B02C  A2 03              ldx    #low(3)
       06:B02E  A9 00              lda    #high(3)
 1306  06:B030  20 60 EA            jsr   asl
 1307                             __addws
       06:B033  22                 sax
       06:B034  18                 clc
       06:B035  72 00              adc    [__stack]
       06:B037  22                 sax
       06:B038  A0 01              ldy    #1
       06:B03A  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B03C  48                 pha
       06:B03D  18                 clc
       06:B03E  A5 00              lda    <__stack
       06:B040  69 02              adc    #low(2)
       06:B042  85 00              sta    <__stack
       06:B044  A5 01              lda    <__stack+1
       06:B046  69 00              adc    #high(2)
       06:B048  85 01              sta    <__stack+1
       06:B04A  68                 pla
 1308                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:B04B  22                 sax
       06:B04C  A0 00              ldy    #0
       06:B04E  91 00              sta    [__sp],Y
       06:B050  22                 sax
       06:B051  C8                 iny
       06:B052  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1309                             __stw   __ptr
       06:B054  8E 0B 20           stx    __ptr
       06:B057  8D 0C 20           sta    __ptr+1
 1310                             __ldwp  __ptr
       06:B05A  B2 0B              lda    [__ptr]
       06:B05C  AA                 tax
       06:B05D  A0 01              ldy    #1
       06:B05F  B1 0B              lda    [__ptr],Y
 1311                             __stw   _xpcm_addr
       06:B061  8E 5C 2A           stx    _xpcm_addr
       06:B064  8D 5D 2A           sta    _xpcm_addr+1
 1312                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       06:B067  B2 00               lda   [__sp]
       06:B069  AA                  tax
       06:B06A  A0 01               ldy   #1
       06:B06C  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 1313                             __addwi 2
       06:B06E  18                 clc
       06:B06F  22                 sax
       06:B070  69 02              adc    #low(2)
       06:B072  22                 sax
       06:B073  69 00              adc    #high(2)
 1314                             __stw   __ptr
       06:B075  8E 0B 20           stx    __ptr
       06:B078  8D 0C 20           sta    __ptr+1
 1315                             __ldwp  __ptr
       06:B07B  B2 0B              lda    [__ptr]
       06:B07D  AA                 tax
       06:B07E  A0 01              ldy    #1
       06:B080  B1 0B              lda    [__ptr],Y
 1316                             __stw   _xpcm_len
       06:B082  8E 5E 2A           stx    _xpcm_len
       06:B085  8D 5F 2A           sta    _xpcm_len+1
 1317                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       06:B088  B2 00               lda   [__sp]
       06:B08A  AA                  tax
       06:B08B  A0 01               ldy   #1
       06:B08D  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 1318                             __addwi 4
       06:B08F  18                 clc
       06:B090  22                 sax
       06:B091  69 04              adc    #low(4)
       06:B093  22                 sax
       06:B094  69 00              adc    #high(4)
 1319                             __stw   __ptr
       06:B096  8E 0B 20           stx    __ptr
       06:B099  8D 0C 20           sta    __ptr+1
 1320                             __ldwp  __ptr
       06:B09C  B2 0B              lda    [__ptr]
       06:B09E  AA                 tax
       06:B09F  A0 01              ldy    #1
       06:B0A1  B1 0B              lda    [__ptr],Y
 1321  06:B0A3  8E 60 2A            stx   _xpcm_bank
 1322                             __ldb   _xpcm_bank
                0000              .if (1 = 2)
                                  .else
       06:B0A6  AE 60 2A           ldx    _xpcm_bank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01844
                          ;        dec    A
                          ;.x_01844:
       06:B0A9  62                 cla    ; unsigned
                                  .endif
 1323  06:B0AA  20 6C 80            call  _chg_pcmbank
 1324                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B0AD  A0 06               ldy   #6
       06:B0AF  B1 00               lda   [__sp],Y
       06:B0B1  AA                  tax
       06:B0B2  C8                  iny
       06:B0B3  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1325  06:B0B5  20 5A 80            call  _pcm_on
 1326                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       06:B0B8  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01847
                          ;        dec    A
                          ;.x_01847:
       06:B0BB  62                 cla    ; unsigned
                                  .endif
 1327  06:B0BC  20 00 80            call  _chg_cbank
 1328                             incw    _seq_ptr
       06:B0BF  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:B0C2  D0 03              bne    .x_01848           ; location
       06:B0C4  EE D3 29           inc    _seq_ptr+1
       06:B0C7            .x_01848:
 1329                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:B0C7  AE D2 29           ldx    _seq_ptr
       06:B0CA  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1330                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B0CD  86 0B              stx    <__ptr
       06:B0CF  85 0C              sta    <__ptr+1
       06:B0D1  B2 0B              lda    [__ptr]
       06:B0D3  AA                 tax
       06:B0D4  62                 cla
                          ;        bpl    .x_01850   ; signed
                          ;        dec    A
                          ;.x_01850:
 1331                             __stw   _j
       06:B0D5  8E 26 2A           stx    _j
       06:B0D8  8D 27 2A           sta    _j+1
 1332                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:B0DB  AE D2 29           ldx    _seq_ptr
       06:B0DE  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1333                             incw    _seq_ptr
       06:B0E1  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:B0E4  D0 03              bne    .x_01853           ; location
       06:B0E6  EE D3 29           inc    _seq_ptr+1
       06:B0E9            .x_01853:
 1334                             __ldwi  _ch_cnt
       06:B0E9  A2 88              ldx    #low(_ch_cnt)
       06:B0EB  A9 29              lda    #high(_ch_cnt)
 1335                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B0ED  A0 06              ldy    #6
       06:B0EF  18                 clc
       06:B0F0  22                 sax
       06:B0F1  71 00              adc    [__sp],Y
       06:B0F3  22                 sax
       06:B0F4  C8                 iny
       06:B0F5  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1336                             __pushw
                                 __submi  2,__stack
       06:B0F7  48                 pha
       06:B0F8  38                 sec
       06:B0F9  A5 00              lda    <__stack
       06:B0FB  E9 02              sbc    #low(2)
       06:B0FD  85 00              sta    <__stack
       06:B0FF  A5 01              lda    <__stack+1
       06:B101  E9 00              sbc    #high(2)
       06:B103  85 01              sta    <__stack+1
       06:B105  68                 pla
       06:B106  22                 sax
       06:B107  92 00              sta    [__stack]
       06:B109  22                 sax
       06:B10A  A0 01              ldy    #1
       06:B10C  91 00              sta    [__stack],Y
 1337                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:B10E  AE 26 2A           ldx    _j
       06:B111  AD 27 2A           lda    _j+1
                                  .endif
 1338                             __stbps
                                 __stw    <__temp
       06:B114  86 03              stx    <__temp
       06:B116  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B118  B2 00              lda    [__stack]
       06:B11A  AA                 tax
       06:B11B  A0 01              ldy    #1
       06:B11D  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B11F  86 0B              stx    <__ptr
       06:B121  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B123  A6 03              ldx    <__temp
       06:B125  A5 04              lda    <__temp+1
                                  .endif
       06:B127  22                 sax
       06:B128  92 0B              sta    [__ptr]
       06:B12A  22                 sax
                                 __addmi  2,__stack
       06:B12B  48                 pha
       06:B12C  18                 clc
       06:B12D  A5 00              lda    <__stack
       06:B12F  69 02              adc    #low(2)
       06:B131  85 00              sta    <__stack
       06:B133  A5 01              lda    <__stack+1
       06:B135  69 00              adc    #high(2)
       06:B137  85 01              sta    <__stack+1
       06:B139  68                 pla
 1339                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B13A  A0 06               ldy   #6
       06:B13C  B1 00               lda   [__sp],Y
       06:B13E  AA                  tax
       06:B13F  C8                  iny
       06:B140  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1340                             __pushw
                                 __submi  2,__stack
       06:B142  48                 pha
       06:B143  38                 sec
       06:B144  A5 00              lda    <__stack
       06:B146  E9 02              sbc    #low(2)
       06:B148  85 00              sta    <__stack
       06:B14A  A5 01              lda    <__stack+1
       06:B14C  E9 00              sbc    #high(2)
       06:B14E  85 01              sta    <__stack+1
       06:B150  68                 pla
       06:B151  22                 sax
       06:B152  92 00              sta    [__stack]
       06:B154  22                 sax
       06:B155  A0 01              ldy    #1
       06:B157  91 00              sta    [__stack],Y
 1341                             __ldwi  _ch_vol
       06:B159  A2 90              ldx    #low(_ch_vol)
       06:B15B  A9 29              lda    #high(_ch_vol)
 1342                             __addw_s        8
                0001              .if (8 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B15D  A0 08              ldy    #8
       06:B15F  18                 clc
       06:B160  22                 sax
       06:B161  71 00              adc    [__sp],Y
       06:B163  22                 sax
       06:B164  C8                 iny
       06:B165  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1343                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B167  86 0B              stx    <__ptr
       06:B169  85 0C              sta    <__ptr+1
       06:B16B  B2 0B              lda    [__ptr]
       06:B16D  AA                 tax
       06:B16E  62                 cla
                          ;        bpl    .x_01870   ; signed
                          ;        dec    A
                          ;.x_01870:
 1344  06:B16F  20 12 80            call  _set_vol
 1345                             __lbra  LL45
       06:B172  4C 00 BB           jmp    LL45
 1346  06:B175            LL70:
 1347                     
 1348                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       06:B175  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01873
                          ;        dec    A
                          ;.x_01873:
       06:B178  62                 cla    ; unsigned
                                  .endif
 1349  06:B179  20 00 80            call  _chg_cbank
 1350                             __ldwi  _note_sw
       06:B17C  A2 B2              ldx    #low(_note_sw)
       06:B17E  A9 29              lda    #high(_note_sw)
 1351                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B180  A0 06              ldy    #6
       06:B182  18                 clc
       06:B183  22                 sax
       06:B184  71 00              adc    [__sp],Y
       06:B186  22                 sax
       06:B187  C8                 iny
       06:B188  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1352                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B18A  86 0B              stx    <__ptr
       06:B18C  85 0C              sta    <__ptr+1
       06:B18E  B2 0B              lda    [__ptr]
       06:B190  AA                 tax
       06:B191  62                 cla
                          ;        bpl    .x_01876   ; signed
                          ;        dec    A
                          ;.x_01876:
 1353                             __stw   <__temp
       06:B192  86 03              stx    <__temp
       06:B194  85 04              sta    <__temp+1
 1354                             __ldwi  255
       06:B196  A2 FF              ldx    #low(255)
       06:B198  A9 00              lda    #high(255)
 1355  06:B19A  20 FC E8            jsr   eqzp
 1356                             __lbeq  LL72
       06:B19D  D0 03              bne    .x01879
       06:B19F  4C FD B1           jmp    LL72
       06:B1A2            .x01879
 1357                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B1A2  A0 06               ldy   #6
       06:B1A4  B1 00               lda   [__sp],Y
       06:B1A6  AA                  tax
       06:B1A7  C8                  iny
       06:B1A8  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1358                             __aslw
       06:B1AA  22                 sax
       06:B1AB  0A                 asl    A
       06:B1AC  22                 sax
       06:B1AD  2A                 rol    A
 1359                             __addwi _note_envadr
       06:B1AE  18                 clc
       06:B1AF  22                 sax
       06:B1B0  69 14              adc    #low(_note_envadr)
       06:B1B2  22                 sax
       06:B1B3  69 2A              adc    #high(_note_envadr)
 1360                             __pushw
                                 __submi  2,__stack
       06:B1B5  48                 pha
       06:B1B6  38                 sec
       06:B1B7  A5 00              lda    <__stack
       06:B1B9  E9 02              sbc    #low(2)
       06:B1BB  85 00              sta    <__stack
       06:B1BD  A5 01              lda    <__stack+1
       06:B1BF  E9 00              sbc    #high(2)
       06:B1C1  85 01              sta    <__stack+1
       06:B1C3  68                 pla
       06:B1C4  22                 sax
       06:B1C5  92 00              sta    [__stack]
       06:B1C7  22                 sax
       06:B1C8  A0 01              ldy    #1
       06:B1CA  91 00              sta    [__stack],Y
 1361                             __ldwi  0
       06:B1CC  A2 00              ldx    #low(0)
       06:B1CE  A9 00              lda    #high(0)
 1362                             __stwps
                                 __stw    <__temp
       06:B1D0  86 03              stx    <__temp
       06:B1D2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B1D4  B2 00              lda    [__stack]
       06:B1D6  AA                 tax
       06:B1D7  A0 01              ldy    #1
       06:B1D9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B1DB  86 0B              stx    <__ptr
       06:B1DD  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B1DF  A6 03              ldx    <__temp
       06:B1E1  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:B1E3  22                 sax
       06:B1E4  92 0B              sta    [__ptr]
       06:B1E6  22                 sax
       06:B1E7  A0 01              ldy    #1
       06:B1E9  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:B1EB  48                 pha
       06:B1EC  18                 clc
       06:B1ED  A5 00              lda    <__stack
       06:B1EF  69 02              adc    #low(2)
       06:B1F1  85 00              sta    <__stack
       06:B1F3  A5 01              lda    <__stack+1
       06:B1F5  69 00              adc    #high(2)
       06:B1F7  85 01              sta    <__stack+1
       06:B1F9  68                 pla
 1363                             __lbra  LL73
       06:B1FA  4C D9 B2           jmp    LL73
 1364  06:B1FD            LL72:
 1365                     
 1366                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B1FD  A0 06               ldy   #6
       06:B1FF  B1 00               lda   [__sp],Y
       06:B201  AA                  tax
       06:B202  C8                  iny
       06:B203  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1367                             __aslw
       06:B205  22                 sax
       06:B206  0A                 asl    A
       06:B207  22                 sax
       06:B208  2A                 rol    A
 1368                             __addwi _note_envadr
       06:B209  18                 clc
       06:B20A  22                 sax
       06:B20B  69 14              adc    #low(_note_envadr)
       06:B20D  22                 sax
       06:B20E  69 2A              adc    #high(_note_envadr)
 1369                             __pushw
                                 __submi  2,__stack
       06:B210  48                 pha
       06:B211  38                 sec
       06:B212  A5 00              lda    <__stack
       06:B214  E9 02              sbc    #low(2)
       06:B216  85 00              sta    <__stack
       06:B218  A5 01              lda    <__stack+1
       06:B21A  E9 00              sbc    #high(2)
       06:B21C  85 01              sta    <__stack+1
       06:B21E  68                 pla
       06:B21F  22                 sax
       06:B220  92 00              sta    [__stack]
       06:B222  22                 sax
       06:B223  A0 01              ldy    #1
       06:B225  91 00              sta    [__stack],Y
 1370                             __ldwi  _sound_dat
       06:B227  A2 00              ldx    #low(_sound_dat)
       06:B229  A9 44              lda    #high(_sound_dat)
 1371                             __addwi 18
       06:B22B  18                 clc
       06:B22C  22                 sax
       06:B22D  69 12              adc    #low(18)
       06:B22F  22                 sax
       06:B230  69 00              adc    #high(18)
 1372                             __stw   __ptr
       06:B232  8E 0B 20           stx    __ptr
       06:B235  8D 0C 20           sta    __ptr+1
 1373                             __ldwp  __ptr
       06:B238  B2 0B              lda    [__ptr]
       06:B23A  AA                 tax
       06:B23B  A0 01              ldy    #1
       06:B23D  B1 0B              lda    [__ptr],Y
 1374                             __pushw
                                 __submi  2,__stack
       06:B23F  48                 pha
       06:B240  38                 sec
       06:B241  A5 00              lda    <__stack
       06:B243  E9 02              sbc    #low(2)
       06:B245  85 00              sta    <__stack
       06:B247  A5 01              lda    <__stack+1
       06:B249  E9 00              sbc    #high(2)
       06:B24B  85 01              sta    <__stack+1
       06:B24D  68                 pla
       06:B24E  22                 sax
       06:B24F  92 00              sta    [__stack]
       06:B251  22                 sax
       06:B252  A0 01              ldy    #1
       06:B254  91 00              sta    [__stack],Y
 1375                             __ldwi  _note_sw
       06:B256  A2 B2              ldx    #low(_note_sw)
       06:B258  A9 29              lda    #high(_note_sw)
 1376                             __addw_s        10
                0001              .if (10 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B25A  A0 0A              ldy    #10
       06:B25C  18                 clc
       06:B25D  22                 sax
       06:B25E  71 00              adc    [__sp],Y
       06:B260  22                 sax
       06:B261  C8                 iny
       06:B262  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1377                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B264  86 0B              stx    <__ptr
       06:B266  85 0C              sta    <__ptr+1
       06:B268  B2 0B              lda    [__ptr]
       06:B26A  AA                 tax
       06:B26B  62                 cla
                          ;        bpl    .x_01907   ; signed
                          ;        dec    A
                          ;.x_01907:
 1378                             __pushw
                                 __submi  2,__stack
       06:B26C  48                 pha
       06:B26D  38                 sec
       06:B26E  A5 00              lda    <__stack
       06:B270  E9 02              sbc    #low(2)
       06:B272  85 00              sta    <__stack
       06:B274  A5 01              lda    <__stack+1
       06:B276  E9 00              sbc    #high(2)
       06:B278  85 01              sta    <__stack+1
       06:B27A  68                 pla
       06:B27B  22                 sax
       06:B27C  92 00              sta    [__stack]
       06:B27E  22                 sax
       06:B27F  A0 01              ldy    #1
       06:B281  91 00              sta    [__stack],Y
 1379                             __ldwi  1
       06:B283  A2 01              ldx    #low(1)
       06:B285  A9 00              lda    #high(1)
 1380  06:B287  20 60 EA            jsr   asl
 1381                             __addws
       06:B28A  22                 sax
       06:B28B  18                 clc
       06:B28C  72 00              adc    [__stack]
       06:B28E  22                 sax
       06:B28F  A0 01              ldy    #1
       06:B291  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B293  48                 pha
       06:B294  18                 clc
       06:B295  A5 00              lda    <__stack
       06:B297  69 02              adc    #low(2)
       06:B299  85 00              sta    <__stack
       06:B29B  A5 01              lda    <__stack+1
       06:B29D  69 00              adc    #high(2)
       06:B29F  85 01              sta    <__stack+1
       06:B2A1  68                 pla
 1382                             __stw   __ptr
       06:B2A2  8E 0B 20           stx    __ptr
       06:B2A5  8D 0C 20           sta    __ptr+1
 1383                             __ldwp  __ptr
       06:B2A8  B2 0B              lda    [__ptr]
       06:B2AA  AA                 tax
       06:B2AB  A0 01              ldy    #1
       06:B2AD  B1 0B              lda    [__ptr],Y
 1384                             __stwps
                                 __stw    <__temp
       06:B2AF  86 03              stx    <__temp
       06:B2B1  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B2B3  B2 00              lda    [__stack]
       06:B2B5  AA                 tax
       06:B2B6  A0 01              ldy    #1
       06:B2B8  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B2BA  86 0B              stx    <__ptr
       06:B2BC  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B2BE  A6 03              ldx    <__temp
       06:B2C0  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:B2C2  22                 sax
       06:B2C3  92 0B              sta    [__ptr]
       06:B2C5  22                 sax
       06:B2C6  A0 01              ldy    #1
       06:B2C8  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:B2CA  48                 pha
       06:B2CB  18                 clc
       06:B2CC  A5 00              lda    <__stack
       06:B2CE  69 02              adc    #low(2)
       06:B2D0  85 00              sta    <__stack
       06:B2D2  A5 01              lda    <__stack+1
       06:B2D4  69 00              adc    #high(2)
       06:B2D6  85 01              sta    <__stack+1
       06:B2D8  68                 pla
 1385  06:B2D9            LL73:
 1386                     
 1387                             __ldwi  _pitch_sw
       06:B2D9  A2 AA              ldx    #low(_pitch_sw)
       06:B2DB  A9 29              lda    #high(_pitch_sw)
 1388                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B2DD  A0 06              ldy    #6
       06:B2DF  18                 clc
       06:B2E0  22                 sax
       06:B2E1  71 00              adc    [__sp],Y
       06:B2E3  22                 sax
       06:B2E4  C8                 iny
       06:B2E5  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1389                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B2E7  86 0B              stx    <__ptr
       06:B2E9  85 0C              sta    <__ptr+1
       06:B2EB  B2 0B              lda    [__ptr]
       06:B2ED  AA                 tax
       06:B2EE  62                 cla
                          ;        bpl    .x_01924   ; signed
                          ;        dec    A
                          ;.x_01924:
 1390                             __stw   <__temp
       06:B2EF  86 03              stx    <__temp
       06:B2F1  85 04              sta    <__temp+1
 1391                             __ldwi  255
       06:B2F3  A2 FF              ldx    #low(255)
       06:B2F5  A9 00              lda    #high(255)
 1392  06:B2F7  20 FC E8            jsr   eqzp
 1393                             __lbeq  LL74
       06:B2FA  D0 03              bne    .x01927
       06:B2FC  4C 5A B3           jmp    LL74
       06:B2FF            .x01927
 1394                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B2FF  A0 06               ldy   #6
       06:B301  B1 00               lda   [__sp],Y
       06:B303  AA                  tax
       06:B304  C8                  iny
       06:B305  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1395                             __aslw
       06:B307  22                 sax
       06:B308  0A                 asl    A
       06:B309  22                 sax
       06:B30A  2A                 rol    A
 1396                             __addwi _pitch_envadr
       06:B30B  18                 clc
       06:B30C  22                 sax
       06:B30D  69 F4              adc    #low(_pitch_envadr)
       06:B30F  22                 sax
       06:B310  69 29              adc    #high(_pitch_envadr)
 1397                             __pushw
                                 __submi  2,__stack
       06:B312  48                 pha
       06:B313  38                 sec
       06:B314  A5 00              lda    <__stack
       06:B316  E9 02              sbc    #low(2)
       06:B318  85 00              sta    <__stack
       06:B31A  A5 01              lda    <__stack+1
       06:B31C  E9 00              sbc    #high(2)
       06:B31E  85 01              sta    <__stack+1
       06:B320  68                 pla
       06:B321  22                 sax
       06:B322  92 00              sta    [__stack]
       06:B324  22                 sax
       06:B325  A0 01              ldy    #1
       06:B327  91 00              sta    [__stack],Y
 1398                             __ldwi  0
       06:B329  A2 00              ldx    #low(0)
       06:B32B  A9 00              lda    #high(0)
 1399                             __stwps
                                 __stw    <__temp
       06:B32D  86 03              stx    <__temp
       06:B32F  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B331  B2 00              lda    [__stack]
       06:B333  AA                 tax
       06:B334  A0 01              ldy    #1
       06:B336  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B338  86 0B              stx    <__ptr
       06:B33A  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B33C  A6 03              ldx    <__temp
       06:B33E  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:B340  22                 sax
       06:B341  92 0B              sta    [__ptr]
       06:B343  22                 sax
       06:B344  A0 01              ldy    #1
       06:B346  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:B348  48                 pha
       06:B349  18                 clc
       06:B34A  A5 00              lda    <__stack
       06:B34C  69 02              adc    #low(2)
       06:B34E  85 00              sta    <__stack
       06:B350  A5 01              lda    <__stack+1
       06:B352  69 00              adc    #high(2)
       06:B354  85 01              sta    <__stack+1
       06:B356  68                 pla
 1400                             __lbra  LL75
       06:B357  4C 36 B4           jmp    LL75
 1401  06:B35A            LL74:
 1402                     
 1403                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B35A  A0 06               ldy   #6
       06:B35C  B1 00               lda   [__sp],Y
       06:B35E  AA                  tax
       06:B35F  C8                  iny
       06:B360  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1404                             __aslw
       06:B362  22                 sax
       06:B363  0A                 asl    A
       06:B364  22                 sax
       06:B365  2A                 rol    A
 1405                             __addwi _pitch_envadr
       06:B366  18                 clc
       06:B367  22                 sax
       06:B368  69 F4              adc    #low(_pitch_envadr)
       06:B36A  22                 sax
       06:B36B  69 29              adc    #high(_pitch_envadr)
 1406                             __pushw
                                 __submi  2,__stack
       06:B36D  48                 pha
       06:B36E  38                 sec
       06:B36F  A5 00              lda    <__stack
       06:B371  E9 02              sbc    #low(2)
       06:B373  85 00              sta    <__stack
       06:B375  A5 01              lda    <__stack+1
       06:B377  E9 00              sbc    #high(2)
       06:B379  85 01              sta    <__stack+1
       06:B37B  68                 pla
       06:B37C  22                 sax
       06:B37D  92 00              sta    [__stack]
       06:B37F  22                 sax
       06:B380  A0 01              ldy    #1
       06:B382  91 00              sta    [__stack],Y
 1407                             __ldwi  _sound_dat
       06:B384  A2 00              ldx    #low(_sound_dat)
       06:B386  A9 44              lda    #high(_sound_dat)
 1408                             __addwi 8
       06:B388  18                 clc
       06:B389  22                 sax
       06:B38A  69 08              adc    #low(8)
       06:B38C  22                 sax
       06:B38D  69 00              adc    #high(8)
 1409                             __stw   __ptr
       06:B38F  8E 0B 20           stx    __ptr
       06:B392  8D 0C 20           sta    __ptr+1
 1410                             __ldwp  __ptr
       06:B395  B2 0B              lda    [__ptr]
       06:B397  AA                 tax
       06:B398  A0 01              ldy    #1
       06:B39A  B1 0B              lda    [__ptr],Y
 1411                             __pushw
                                 __submi  2,__stack
       06:B39C  48                 pha
       06:B39D  38                 sec
       06:B39E  A5 00              lda    <__stack
       06:B3A0  E9 02              sbc    #low(2)
       06:B3A2  85 00              sta    <__stack
       06:B3A4  A5 01              lda    <__stack+1
       06:B3A6  E9 00              sbc    #high(2)
       06:B3A8  85 01              sta    <__stack+1
       06:B3AA  68                 pla
       06:B3AB  22                 sax
       06:B3AC  92 00              sta    [__stack]
       06:B3AE  22                 sax
       06:B3AF  A0 01              ldy    #1
       06:B3B1  91 00              sta    [__stack],Y
 1412                             __ldwi  _pitch_sw
       06:B3B3  A2 AA              ldx    #low(_pitch_sw)
       06:B3B5  A9 29              lda    #high(_pitch_sw)
 1413                             __addw_s        10
                0001              .if (10 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B3B7  A0 0A              ldy    #10
       06:B3B9  18                 clc
       06:B3BA  22                 sax
       06:B3BB  71 00              adc    [__sp],Y
       06:B3BD  22                 sax
       06:B3BE  C8                 iny
       06:B3BF  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1414                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B3C1  86 0B              stx    <__ptr
       06:B3C3  85 0C              sta    <__ptr+1
       06:B3C5  B2 0B              lda    [__ptr]
       06:B3C7  AA                 tax
       06:B3C8  62                 cla
                          ;        bpl    .x_01955   ; signed
                          ;        dec    A
                          ;.x_01955:
 1415                             __pushw
                                 __submi  2,__stack
       06:B3C9  48                 pha
       06:B3CA  38                 sec
       06:B3CB  A5 00              lda    <__stack
       06:B3CD  E9 02              sbc    #low(2)
       06:B3CF  85 00              sta    <__stack
       06:B3D1  A5 01              lda    <__stack+1
       06:B3D3  E9 00              sbc    #high(2)
       06:B3D5  85 01              sta    <__stack+1
       06:B3D7  68                 pla
       06:B3D8  22                 sax
       06:B3D9  92 00              sta    [__stack]
       06:B3DB  22                 sax
       06:B3DC  A0 01              ldy    #1
       06:B3DE  91 00              sta    [__stack],Y
 1416                             __ldwi  1
       06:B3E0  A2 01              ldx    #low(1)
       06:B3E2  A9 00              lda    #high(1)
 1417  06:B3E4  20 60 EA            jsr   asl
 1418                             __addws
       06:B3E7  22                 sax
       06:B3E8  18                 clc
       06:B3E9  72 00              adc    [__stack]
       06:B3EB  22                 sax
       06:B3EC  A0 01              ldy    #1
       06:B3EE  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B3F0  48                 pha
       06:B3F1  18                 clc
       06:B3F2  A5 00              lda    <__stack
       06:B3F4  69 02              adc    #low(2)
       06:B3F6  85 00              sta    <__stack
       06:B3F8  A5 01              lda    <__stack+1
       06:B3FA  69 00              adc    #high(2)
       06:B3FC  85 01              sta    <__stack+1
       06:B3FE  68                 pla
 1419                             __stw   __ptr
       06:B3FF  8E 0B 20           stx    __ptr
       06:B402  8D 0C 20           sta    __ptr+1
 1420                             __ldwp  __ptr
       06:B405  B2 0B              lda    [__ptr]
       06:B407  AA                 tax
       06:B408  A0 01              ldy    #1
       06:B40A  B1 0B              lda    [__ptr],Y
 1421                             __stwps
                                 __stw    <__temp
       06:B40C  86 03              stx    <__temp
       06:B40E  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B410  B2 00              lda    [__stack]
       06:B412  AA                 tax
       06:B413  A0 01              ldy    #1
       06:B415  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B417  86 0B              stx    <__ptr
       06:B419  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B41B  A6 03              ldx    <__temp
       06:B41D  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:B41F  22                 sax
       06:B420  92 0B              sta    [__ptr]
       06:B422  22                 sax
       06:B423  A0 01              ldy    #1
       06:B425  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:B427  48                 pha
       06:B428  18                 clc
       06:B429  A5 00              lda    <__stack
       06:B42B  69 02              adc    #low(2)
       06:B42D  85 00              sta    <__stack
       06:B42F  A5 01              lda    <__stack+1
       06:B431  69 00              adc    #high(2)
       06:B433  85 01              sta    <__stack+1
       06:B435  68                 pla
 1422  06:B436            LL75:
 1423                     
 1424                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       06:B436  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_01971
                          ;        dec    A
                          ;.x_01971:
       06:B439  62                 cla    ; unsigned
                                  .endif
 1425  06:B43A  20 00 80            call  _chg_cbank
 1426                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B43D  A0 06               ldy   #6
       06:B43F  B1 00               lda   [__sp],Y
       06:B441  AA                  tax
       06:B442  C8                  iny
       06:B443  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1427                             __stw   <__temp
       06:B445  86 03              stx    <__temp
       06:B447  85 04              sta    <__temp+1
 1428                             __ldwi  3
       06:B449  A2 03              ldx    #low(3)
       06:B44B  A9 00              lda    #high(3)
 1429  06:B44D  20 CC E9            jsr   gtzp
 1430                             __lbeq  LL77
       06:B450  D0 03              bne    .x01975
       06:B452  4C 9F B4           jmp    LL77
       06:B455            .x01975
 1431                             __ldwi  _noise_sw
       06:B455  A2 2A              ldx    #low(_noise_sw)
       06:B457  A9 2A              lda    #high(_noise_sw)
 1432                             __pushw
                                 __submi  2,__stack
       06:B459  48                 pha
       06:B45A  38                 sec
       06:B45B  A5 00              lda    <__stack
       06:B45D  E9 02              sbc    #low(2)
       06:B45F  85 00              sta    <__stack
       06:B461  A5 01              lda    <__stack+1
       06:B463  E9 00              sbc    #high(2)
       06:B465  85 01              sta    <__stack+1
       06:B467  68                 pla
       06:B468  22                 sax
       06:B469  92 00              sta    [__stack]
       06:B46B  22                 sax
       06:B46C  A0 01              ldy    #1
       06:B46E  91 00              sta    [__stack],Y
 1433                             __ldw_s 8
                0001              .if (8 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (8 = 0)
                                   .else
       06:B470  A0 08               ldy   #8
       06:B472  B1 00               lda   [__sp],Y
       06:B474  AA                  tax
       06:B475  C8                  iny
       06:B476  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1434                             __subwi 4
       06:B478  38                 sec
       06:B479  22                 sax
       06:B47A  E9 04              sbc    #low(4)
       06:B47C  22                 sax
       06:B47D  E9 00              sbc    #high(4)
 1435                             __addws
       06:B47F  22                 sax
       06:B480  18                 clc
       06:B481  72 00              adc    [__stack]
       06:B483  22                 sax
       06:B484  A0 01              ldy    #1
       06:B486  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B488  48                 pha
       06:B489  18                 clc
       06:B48A  A5 00              lda    <__stack
       06:B48C  69 02              adc    #low(2)
       06:B48E  85 00              sta    <__stack
       06:B490  A5 01              lda    <__stack+1
       06:B492  69 00              adc    #high(2)
       06:B494  85 01              sta    <__stack+1
       06:B496  68                 pla
 1436                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B497  86 0B              stx    <__ptr
       06:B499  85 0C              sta    <__ptr+1
       06:B49B  B2 0B              lda    [__ptr]
       06:B49D  AA                 tax
       06:B49E  62                 cla
                          ;        bpl    .x_01983   ; signed
                          ;        dec    A
                          ;.x_01983:
 1437  06:B49F            LL77:
 1438                     
 1439                             __boolw
       06:B49F  86 03              stx    <__temp
       06:B4A1  05 03              ora    <__temp
       06:B4A3  82                 clx
       06:B4A4  F0 01              beq    .x01984
       06:B4A6  E8                 inx
       06:B4A7  62        .x01984     cla
 1440                             __tstw
                                   ; pha
       06:B4A8  86 03              stx    <__temp
       06:B4AA  05 03              ora    <__temp
                                   ; pla
 1441                             __lbeq  LL76
       06:B4AC  D0 03              bne    .x01986
       06:B4AE  4C 41 B6           jmp    LL76
       06:B4B1            .x01986
 1442                             __ldwi  _noise_freq
       06:B4B1  A2 28              ldx    #low(_noise_freq)
       06:B4B3  A9 2A              lda    #high(_noise_freq)
 1443                             __pushw
                                 __submi  2,__stack
       06:B4B5  48                 pha
       06:B4B6  38                 sec
       06:B4B7  A5 00              lda    <__stack
       06:B4B9  E9 02              sbc    #low(2)
       06:B4BB  85 00              sta    <__stack
       06:B4BD  A5 01              lda    <__stack+1
       06:B4BF  E9 00              sbc    #high(2)
       06:B4C1  85 01              sta    <__stack+1
       06:B4C3  68                 pla
       06:B4C4  22                 sax
       06:B4C5  92 00              sta    [__stack]
       06:B4C7  22                 sax
       06:B4C8  A0 01              ldy    #1
       06:B4CA  91 00              sta    [__stack],Y
 1444                             __ldw_s 8
                0001              .if (8 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (8 = 0)
                                   .else
       06:B4CC  A0 08               ldy   #8
       06:B4CE  B1 00               lda   [__sp],Y
       06:B4D0  AA                  tax
       06:B4D1  C8                  iny
       06:B4D2  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1445                             __subwi 4
       06:B4D4  38                 sec
       06:B4D5  22                 sax
       06:B4D6  E9 04              sbc    #low(4)
       06:B4D8  22                 sax
       06:B4D9  E9 00              sbc    #high(4)
 1446                             __addws
       06:B4DB  22                 sax
       06:B4DC  18                 clc
       06:B4DD  72 00              adc    [__stack]
       06:B4DF  22                 sax
       06:B4E0  A0 01              ldy    #1
       06:B4E2  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B4E4  48                 pha
       06:B4E5  18                 clc
       06:B4E6  A5 00              lda    <__stack
       06:B4E8  69 02              adc    #low(2)
       06:B4EA  85 00              sta    <__stack
       06:B4EC  A5 01              lda    <__stack+1
       06:B4EE  69 00              adc    #high(2)
       06:B4F0  85 01              sta    <__stack+1
       06:B4F2  68                 pla
 1447                             __pushw
                                 __submi  2,__stack
       06:B4F3  48                 pha
       06:B4F4  38                 sec
       06:B4F5  A5 00              lda    <__stack
       06:B4F7  E9 02              sbc    #low(2)
       06:B4F9  85 00              sta    <__stack
       06:B4FB  A5 01              lda    <__stack+1
       06:B4FD  E9 00              sbc    #high(2)
       06:B4FF  85 01              sta    <__stack+1
       06:B501  68                 pla
       06:B502  22                 sax
       06:B503  92 00              sta    [__stack]
       06:B505  22                 sax
       06:B506  A0 01              ldy    #1
       06:B508  91 00              sta    [__stack],Y
 1448                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B50A  A0 06               ldy   #6
       06:B50C  B1 00               lda   [__sp],Y
       06:B50E  AA                  tax
       06:B50F  C8                  iny
       06:B510  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1449                             __andwi 31
       06:B512  22                 sax
       06:B513  29 1F              and    #low(31)
       06:B515  22                 sax
       06:B516  29 00              and    #high(31)
 1450                             __stbps
                                 __stw    <__temp
       06:B518  86 03              stx    <__temp
       06:B51A  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B51C  B2 00              lda    [__stack]
       06:B51E  AA                 tax
       06:B51F  A0 01              ldy    #1
       06:B521  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B523  86 0B              stx    <__ptr
       06:B525  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B527  A6 03              ldx    <__temp
       06:B529  A5 04              lda    <__temp+1
                                  .endif
       06:B52B  22                 sax
       06:B52C  92 0B              sta    [__ptr]
       06:B52E  22                 sax
                                 __addmi  2,__stack
       06:B52F  48                 pha
       06:B530  18                 clc
       06:B531  A5 00              lda    <__stack
       06:B533  69 02              adc    #low(2)
       06:B535  85 00              sta    <__stack
       06:B537  A5 01              lda    <__stack+1
       06:B539  69 00              adc    #high(2)
       06:B53B  85 01              sta    <__stack+1
       06:B53D  68                 pla
 1451                             __ldwi  2055
       06:B53E  A2 07              ldx    #low(2055)
       06:B540  A9 08              lda    #high(2055)
 1452                             __stw   _bx
       06:B542  8E FA 20           stx    _bx
       06:B545  8D FB 20           sta    _bx+1
 1453                             __ldwi  128
       06:B548  A2 80              ldx    #low(128)
       06:B54A  A9 00              lda    #high(128)
 1454                             __pushw
                                 __submi  2,__stack
       06:B54C  48                 pha
       06:B54D  38                 sec
       06:B54E  A5 00              lda    <__stack
       06:B550  E9 02              sbc    #low(2)
       06:B552  85 00              sta    <__stack
       06:B554  A5 01              lda    <__stack+1
       06:B556  E9 00              sbc    #high(2)
       06:B558  85 01              sta    <__stack+1
       06:B55A  68                 pla
       06:B55B  22                 sax
       06:B55C  92 00              sta    [__stack]
       06:B55E  22                 sax
       06:B55F  A0 01              ldy    #1
       06:B561  91 00              sta    [__stack],Y
 1455                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B563  A0 06               ldy   #6
       06:B565  B1 00               lda   [__sp],Y
       06:B567  AA                  tax
       06:B568  C8                  iny
       06:B569  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1456                             __andwi 31
       06:B56B  22                 sax
       06:B56C  29 1F              and    #low(31)
       06:B56E  22                 sax
       06:B56F  29 00              and    #high(31)
 1457                             __orws
       06:B571  22                 sax
       06:B572  12 00              ora    [__stack]
       06:B574  22                 sax
       06:B575  A0 01              ldy    #1
       06:B577  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       06:B579  48                 pha
       06:B57A  18                 clc
       06:B57B  A5 00              lda    <__stack
       06:B57D  69 02              adc    #low(2)
       06:B57F  85 00              sta    <__stack
       06:B581  A5 01              lda    <__stack+1
       06:B583  69 00              adc    #high(2)
       06:B585  85 01              sta    <__stack+1
       06:B587  68                 pla
 1458  06:B588  20 A4 FB            call  _poke.2
 1459                             incw    _seq_ptr
       06:B58B  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:B58E  D0 03              bne    .x_02013           ; location
       06:B590  EE D3 29           inc    _seq_ptr+1
       06:B593            .x_02013:
 1460                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:B593  AE D2 29           ldx    _seq_ptr
       06:B596  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1461                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B599  86 0B              stx    <__ptr
       06:B59B  85 0C              sta    <__ptr+1
       06:B59D  B2 0B              lda    [__ptr]
       06:B59F  AA                 tax
       06:B5A0  62                 cla
                          ;        bpl    .x_02015   ; signed
                          ;        dec    A
                          ;.x_02015:
 1462                             __stw   _j
       06:B5A1  8E 26 2A           stx    _j
       06:B5A4  8D 27 2A           sta    _j+1
 1463                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:B5A7  AE D2 29           ldx    _seq_ptr
       06:B5AA  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1464                             incw    _seq_ptr
       06:B5AD  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:B5B0  D0 03              bne    .x_02018           ; location
       06:B5B2  EE D3 29           inc    _seq_ptr+1
       06:B5B5            .x_02018:
 1465                             __ldwi  _ch_cnt
       06:B5B5  A2 88              ldx    #low(_ch_cnt)
       06:B5B7  A9 29              lda    #high(_ch_cnt)
 1466                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B5B9  A0 06              ldy    #6
       06:B5BB  18                 clc
       06:B5BC  22                 sax
       06:B5BD  71 00              adc    [__sp],Y
       06:B5BF  22                 sax
       06:B5C0  C8                 iny
       06:B5C1  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1467                             __pushw
                                 __submi  2,__stack
       06:B5C3  48                 pha
       06:B5C4  38                 sec
       06:B5C5  A5 00              lda    <__stack
       06:B5C7  E9 02              sbc    #low(2)
       06:B5C9  85 00              sta    <__stack
       06:B5CB  A5 01              lda    <__stack+1
       06:B5CD  E9 00              sbc    #high(2)
       06:B5CF  85 01              sta    <__stack+1
       06:B5D1  68                 pla
       06:B5D2  22                 sax
       06:B5D3  92 00              sta    [__stack]
       06:B5D5  22                 sax
       06:B5D6  A0 01              ldy    #1
       06:B5D8  91 00              sta    [__stack],Y
 1468                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:B5DA  AE 26 2A           ldx    _j
       06:B5DD  AD 27 2A           lda    _j+1
                                  .endif
 1469                             __stbps
                                 __stw    <__temp
       06:B5E0  86 03              stx    <__temp
       06:B5E2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B5E4  B2 00              lda    [__stack]
       06:B5E6  AA                 tax
       06:B5E7  A0 01              ldy    #1
       06:B5E9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B5EB  86 0B              stx    <__ptr
       06:B5ED  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B5EF  A6 03              ldx    <__temp
       06:B5F1  A5 04              lda    <__temp+1
                                  .endif
       06:B5F3  22                 sax
       06:B5F4  92 0B              sta    [__ptr]
       06:B5F6  22                 sax
                                 __addmi  2,__stack
       06:B5F7  48                 pha
       06:B5F8  18                 clc
       06:B5F9  A5 00              lda    <__stack
       06:B5FB  69 02              adc    #low(2)
       06:B5FD  85 00              sta    <__stack
       06:B5FF  A5 01              lda    <__stack+1
       06:B601  69 00              adc    #high(2)
       06:B603  85 01              sta    <__stack+1
       06:B605  68                 pla
 1470                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B606  A0 06               ldy   #6
       06:B608  B1 00               lda   [__sp],Y
       06:B60A  AA                  tax
       06:B60B  C8                  iny
       06:B60C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1471                             __pushw
                                 __submi  2,__stack
       06:B60E  48                 pha
       06:B60F  38                 sec
       06:B610  A5 00              lda    <__stack
       06:B612  E9 02              sbc    #low(2)
       06:B614  85 00              sta    <__stack
       06:B616  A5 01              lda    <__stack+1
       06:B618  E9 00              sbc    #high(2)
       06:B61A  85 01              sta    <__stack+1
       06:B61C  68                 pla
       06:B61D  22                 sax
       06:B61E  92 00              sta    [__stack]
       06:B620  22                 sax
       06:B621  A0 01              ldy    #1
       06:B623  91 00              sta    [__stack],Y
 1472                             __ldwi  _ch_vol
       06:B625  A2 90              ldx    #low(_ch_vol)
       06:B627  A9 29              lda    #high(_ch_vol)
 1473                             __addw_s        8
                0001              .if (8 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B629  A0 08              ldy    #8
       06:B62B  18                 clc
       06:B62C  22                 sax
       06:B62D  71 00              adc    [__sp],Y
       06:B62F  22                 sax
       06:B630  C8                 iny
       06:B631  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1474                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B633  86 0B              stx    <__ptr
       06:B635  85 0C              sta    <__ptr+1
       06:B637  B2 0B              lda    [__ptr]
       06:B639  AA                 tax
       06:B63A  62                 cla
                          ;        bpl    .x_02035   ; signed
                          ;        dec    A
                          ;.x_02035:
 1475  06:B63B  20 12 80            call  _set_vol
 1476                             __lbra  LL45
       06:B63E  4C 00 BB           jmp    LL45
 1477  06:B641            LL76:
 1478                     
 1479                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       06:B641  A0 04               ldy   #4
       06:B643  B1 00               lda   [__sp],Y
       06:B645  AA                  tax
       06:B646  C8                  iny
       06:B647  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1480                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       06:B649  A8                 tay
       06:B64A  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       06:B64C  18                 clc
       06:B64D  69 04              adc    #4
                                  .endif
       06:B64F  85 02              sta    <__arg_idx
       06:B651  42                 say
                                  .else
                                  .endif
                          
       06:B652  99 60 2A           sta    __arg-(4),Y
       06:B655  8A                 txa
       06:B656  99 61 2A           sta    __arg-(4-1),Y
 1481                             __ldwi  2
       06:B659  A2 02              ldx    #low(2)
       06:B65B  A9 00              lda    #high(2)
 1482                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       06:B65D  A4 02              ldy    <__arg_idx
                                  .endif
                          
       06:B65F  8A                 txa
       06:B660  99 62 2A           sta    __arg-(2),Y
 1483                             __ldwi  5
       06:B663  A2 05              ldx    #low(5)
       06:B665  A9 00              lda    #high(5)
 1484                             __pushw
                                 __submi  2,__stack
       06:B667  48                 pha
       06:B668  38                 sec
       06:B669  A5 00              lda    <__stack
       06:B66B  E9 02              sbc    #low(2)
       06:B66D  85 00              sta    <__stack
       06:B66F  A5 01              lda    <__stack+1
       06:B671  E9 00              sbc    #high(2)
       06:B673  85 01              sta    <__stack+1
       06:B675  68                 pla
       06:B676  22                 sax
       06:B677  92 00              sta    [__stack]
       06:B679  22                 sax
       06:B67A  A0 01              ldy    #1
       06:B67C  91 00              sta    [__stack],Y
 1485                             __ldw_s 8
                0001              .if (8 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (8 = 0)
                                   .else
       06:B67E  A0 08               ldy   #8
       06:B680  B1 00               lda   [__sp],Y
       06:B682  AA                  tax
       06:B683  C8                  iny
       06:B684  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1486                             __pushw
                                 __submi  2,__stack
       06:B686  48                 pha
       06:B687  38                 sec
       06:B688  A5 00              lda    <__stack
       06:B68A  E9 02              sbc    #low(2)
       06:B68C  85 00              sta    <__stack
       06:B68E  A5 01              lda    <__stack+1
       06:B690  E9 00              sbc    #high(2)
       06:B692  85 01              sta    <__stack+1
       06:B694  68                 pla
       06:B695  22                 sax
       06:B696  92 00              sta    [__stack]
       06:B698  22                 sax
       06:B699  A0 01              ldy    #1
       06:B69B  91 00              sta    [__stack],Y
 1487                             __ldwi  2
       06:B69D  A2 02              ldx    #low(2)
       06:B69F  A9 00              lda    #high(2)
 1488  06:B6A1  20 60 EA            jsr   asl
 1489                             __addws
       06:B6A4  22                 sax
       06:B6A5  18                 clc
       06:B6A6  72 00              adc    [__stack]
       06:B6A8  22                 sax
       06:B6A9  A0 01              ldy    #1
       06:B6AB  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B6AD  48                 pha
       06:B6AE  18                 clc
       06:B6AF  A5 00              lda    <__stack
       06:B6B1  69 02              adc    #low(2)
       06:B6B3  85 00              sta    <__stack
       06:B6B5  A5 01              lda    <__stack+1
       06:B6B7  69 00              adc    #high(2)
       06:B6B9  85 01              sta    <__stack+1
       06:B6BB  68                 pla
 1490                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       06:B6BC  A4 02              ldy    <__arg_idx
                                  .endif
                          
       06:B6BE  8A                 txa
       06:B6BF  99 63 2A           sta    __arg-(1),Y
 1491                             __ldwi  11
       06:B6C2  A2 0B              ldx    #low(11)
       06:B6C4  A9 00              lda    #high(11)
 1492  06:B6C6  20 2F EF            call  _put_hex.4
 1493                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       06:B6C9  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_02054
                          ;        dec    A
                          ;.x_02054:
       06:B6CC  62                 cla    ; unsigned
                                  .endif
 1494  06:B6CD  20 00 80            call  _chg_cbank
 1495                             __ldwi  _lfo_sw
       06:B6D0  A2 54              ldx    #low(_lfo_sw)
       06:B6D2  A9 2A              lda    #high(_lfo_sw)
 1496                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B6D4  A0 06              ldy    #6
       06:B6D6  18                 clc
       06:B6D7  22                 sax
       06:B6D8  71 00              adc    [__sp],Y
       06:B6DA  22                 sax
       06:B6DB  C8                 iny
       06:B6DC  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1497                             __pushw
                                 __submi  2,__stack
       06:B6DE  48                 pha
       06:B6DF  38                 sec
       06:B6E0  A5 00              lda    <__stack
       06:B6E2  E9 02              sbc    #low(2)
       06:B6E4  85 00              sta    <__stack
       06:B6E6  A5 01              lda    <__stack+1
       06:B6E8  E9 00              sbc    #high(2)
       06:B6EA  85 01              sta    <__stack+1
       06:B6EC  68                 pla
       06:B6ED  22                 sax
       06:B6EE  92 00              sta    [__stack]
       06:B6F0  22                 sax
       06:B6F1  A0 01              ldy    #1
       06:B6F3  91 00              sta    [__stack],Y
 1498                             __ldwi  0
       06:B6F5  A2 00              ldx    #low(0)
       06:B6F7  A9 00              lda    #high(0)
 1499                             __stbps
                                 __stw    <__temp
       06:B6F9  86 03              stx    <__temp
       06:B6FB  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B6FD  B2 00              lda    [__stack]
       06:B6FF  AA                 tax
       06:B700  A0 01              ldy    #1
       06:B702  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B704  86 0B              stx    <__ptr
       06:B706  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B708  A6 03              ldx    <__temp
       06:B70A  A5 04              lda    <__temp+1
                                  .endif
       06:B70C  22                 sax
       06:B70D  92 0B              sta    [__ptr]
       06:B70F  22                 sax
                                 __addmi  2,__stack
       06:B710  48                 pha
       06:B711  18                 clc
       06:B712  A5 00              lda    <__stack
       06:B714  69 02              adc    #low(2)
       06:B716  85 00              sta    <__stack
       06:B718  A5 01              lda    <__stack+1
       06:B71A  69 00              adc    #high(2)
       06:B71C  85 01              sta    <__stack+1
       06:B71E  68                 pla
 1500                             __ldwi  _lfo_cnt
       06:B71F  A2 34              ldx    #low(_lfo_cnt)
       06:B721  A9 2A              lda    #high(_lfo_cnt)
 1501                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B723  A0 06              ldy    #6
       06:B725  18                 clc
       06:B726  22                 sax
       06:B727  71 00              adc    [__sp],Y
       06:B729  22                 sax
       06:B72A  C8                 iny
       06:B72B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1502                             __pushw
                                 __submi  2,__stack
       06:B72D  48                 pha
       06:B72E  38                 sec
       06:B72F  A5 00              lda    <__stack
       06:B731  E9 02              sbc    #low(2)
       06:B733  85 00              sta    <__stack
       06:B735  A5 01              lda    <__stack+1
       06:B737  E9 00              sbc    #high(2)
       06:B739  85 01              sta    <__stack+1
       06:B73B  68                 pla
       06:B73C  22                 sax
       06:B73D  92 00              sta    [__stack]
       06:B73F  22                 sax
       06:B740  A0 01              ldy    #1
       06:B742  91 00              sta    [__stack],Y
 1503                             __ldwi  _sound_dat
       06:B744  A2 00              ldx    #low(_sound_dat)
       06:B746  A9 44              lda    #high(_sound_dat)
 1504                             __addwi 12
       06:B748  18                 clc
       06:B749  22                 sax
       06:B74A  69 0C              adc    #low(12)
       06:B74C  22                 sax
       06:B74D  69 00              adc    #high(12)
 1505                             __stw   __ptr
       06:B74F  8E 0B 20           stx    __ptr
       06:B752  8D 0C 20           sta    __ptr+1
 1506                             __ldwp  __ptr
       06:B755  B2 0B              lda    [__ptr]
       06:B757  AA                 tax
       06:B758  A0 01              ldy    #1
       06:B75A  B1 0B              lda    [__ptr],Y
 1507                             __pushw
                                 __submi  2,__stack
       06:B75C  48                 pha
       06:B75D  38                 sec
       06:B75E  A5 00              lda    <__stack
       06:B760  E9 02              sbc    #low(2)
       06:B762  85 00              sta    <__stack
       06:B764  A5 01              lda    <__stack+1
       06:B766  E9 00              sbc    #high(2)
       06:B768  85 01              sta    <__stack+1
       06:B76A  68                 pla
       06:B76B  22                 sax
       06:B76C  92 00              sta    [__stack]
       06:B76E  22                 sax
       06:B76F  A0 01              ldy    #1
       06:B771  91 00              sta    [__stack],Y
 1508                             __ldwi  _lfo_num
       06:B773  A2 2C              ldx    #low(_lfo_num)
       06:B775  A9 2A              lda    #high(_lfo_num)
 1509                             __addw_s        10
                0001              .if (10 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B777  A0 0A              ldy    #10
       06:B779  18                 clc
       06:B77A  22                 sax
       06:B77B  71 00              adc    [__sp],Y
       06:B77D  22                 sax
       06:B77E  C8                 iny
       06:B77F  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1510                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B781  86 0B              stx    <__ptr
       06:B783  85 0C              sta    <__ptr+1
       06:B785  B2 0B              lda    [__ptr]
       06:B787  AA                 tax
       06:B788  62                 cla
                          ;        bpl    .x_02078   ; signed
                          ;        dec    A
                          ;.x_02078:
 1511                             __pushw
                                 __submi  2,__stack
       06:B789  48                 pha
       06:B78A  38                 sec
       06:B78B  A5 00              lda    <__stack
       06:B78D  E9 02              sbc    #low(2)
       06:B78F  85 00              sta    <__stack
       06:B791  A5 01              lda    <__stack+1
       06:B793  E9 00              sbc    #high(2)
       06:B795  85 01              sta    <__stack+1
       06:B797  68                 pla
       06:B798  22                 sax
       06:B799  92 00              sta    [__stack]
       06:B79B  22                 sax
       06:B79C  A0 01              ldy    #1
       06:B79E  91 00              sta    [__stack],Y
 1512                             __ldwi  2
       06:B7A0  A2 02              ldx    #low(2)
       06:B7A2  A9 00              lda    #high(2)
 1513  06:B7A4  20 60 EA            jsr   asl
 1514                             __addws
       06:B7A7  22                 sax
       06:B7A8  18                 clc
       06:B7A9  72 00              adc    [__stack]
       06:B7AB  22                 sax
       06:B7AC  A0 01              ldy    #1
       06:B7AE  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B7B0  48                 pha
       06:B7B1  18                 clc
       06:B7B2  A5 00              lda    <__stack
       06:B7B4  69 02              adc    #low(2)
       06:B7B6  85 00              sta    <__stack
       06:B7B8  A5 01              lda    <__stack+1
       06:B7BA  69 00              adc    #high(2)
       06:B7BC  85 01              sta    <__stack+1
       06:B7BE  68                 pla
 1515                             __stw   __ptr
       06:B7BF  8E 0B 20           stx    __ptr
       06:B7C2  8D 0C 20           sta    __ptr+1
 1516                             __ldwp  __ptr
       06:B7C5  B2 0B              lda    [__ptr]
       06:B7C7  AA                 tax
       06:B7C8  A0 01              ldy    #1
       06:B7CA  B1 0B              lda    [__ptr],Y
 1517                             __stbps
                                 __stw    <__temp
       06:B7CC  86 03              stx    <__temp
       06:B7CE  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B7D0  B2 00              lda    [__stack]
       06:B7D2  AA                 tax
       06:B7D3  A0 01              ldy    #1
       06:B7D5  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B7D7  86 0B              stx    <__ptr
       06:B7D9  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B7DB  A6 03              ldx    <__temp
       06:B7DD  A5 04              lda    <__temp+1
                                  .endif
       06:B7DF  22                 sax
       06:B7E0  92 0B              sta    [__ptr]
       06:B7E2  22                 sax
                                 __addmi  2,__stack
       06:B7E3  48                 pha
       06:B7E4  18                 clc
       06:B7E5  A5 00              lda    <__stack
       06:B7E7  69 02              adc    #low(2)
       06:B7E9  85 00              sta    <__stack
       06:B7EB  A5 01              lda    <__stack+1
       06:B7ED  69 00              adc    #high(2)
       06:B7EF  85 01              sta    <__stack+1
       06:B7F1  68                 pla
 1518                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B7F2  A0 06               ldy   #6
       06:B7F4  B1 00               lda   [__sp],Y
       06:B7F6  AA                  tax
       06:B7F7  C8                  iny
       06:B7F8  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1519                             __pushw
                                 __submi  2,__stack
       06:B7FA  48                 pha
       06:B7FB  38                 sec
       06:B7FC  A5 00              lda    <__stack
       06:B7FE  E9 02              sbc    #low(2)
       06:B800  85 00              sta    <__stack
       06:B802  A5 01              lda    <__stack+1
       06:B804  E9 00              sbc    #high(2)
       06:B806  85 01              sta    <__stack+1
       06:B808  68                 pla
       06:B809  22                 sax
       06:B80A  92 00              sta    [__stack]
       06:B80C  22                 sax
       06:B80D  A0 01              ldy    #1
       06:B80F  91 00              sta    [__stack],Y
 1520                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B811  A0 06               ldy   #6
       06:B813  B1 00               lda   [__sp],Y
       06:B815  AA                  tax
       06:B816  C8                  iny
       06:B817  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1521  06:B819  20 7E 80            call  _set_note
 1522                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       06:B81C  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_02097
                          ;        dec    A
                          ;.x_02097:
       06:B81F  62                 cla    ; unsigned
                                  .endif
 1523  06:B820  20 00 80            call  _chg_cbank
 1524                             __ldwi  _detune
       06:B823  A2 BA              ldx    #low(_detune)
       06:B825  A9 29              lda    #high(_detune)
 1525                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B827  A0 06              ldy    #6
       06:B829  18                 clc
       06:B82A  22                 sax
       06:B82B  71 00              adc    [__sp],Y
       06:B82D  22                 sax
       06:B82E  C8                 iny
       06:B82F  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1526                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B831  86 0B              stx    <__ptr
       06:B833  85 0C              sta    <__ptr+1
       06:B835  B2 0B              lda    [__ptr]
       06:B837  AA                 tax
       06:B838  62                 cla
                          ;        bpl    .x_02100   ; signed
                          ;        dec    A
                          ;.x_02100:
 1527                             __tstw
                                   ; pha
       06:B839  86 03              stx    <__temp
       06:B83B  05 03              ora    <__temp
                                   ; pla
 1528                             __lbeq  LL78
       06:B83D  D0 03              bne    .x02102
       06:B83F  4C C9 B9           jmp    LL78
       06:B842            .x02102
 1529                             __ldwi  _detune
       06:B842  A2 BA              ldx    #low(_detune)
       06:B844  A9 29              lda    #high(_detune)
 1530                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B846  A0 06              ldy    #6
       06:B848  18                 clc
       06:B849  22                 sax
       06:B84A  71 00              adc    [__sp],Y
       06:B84C  22                 sax
       06:B84D  C8                 iny
       06:B84E  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1531                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B850  86 0B              stx    <__ptr
       06:B852  85 0C              sta    <__ptr+1
       06:B854  B2 0B              lda    [__ptr]
       06:B856  AA                 tax
       06:B857  62                 cla
                          ;        bpl    .x_02105   ; signed
                          ;        dec    A
                          ;.x_02105:
 1532                             __andwi 128
       06:B858  22                 sax
       06:B859  29 80              and    #low(128)
       06:B85B  22                 sax
       06:B85C  29 00              and    #high(128)
 1533                             __tstw
                                   ; pha
       06:B85E  86 03              stx    <__temp
       06:B860  05 03              ora    <__temp
                                   ; pla
 1534                             __lbeq  LL79
       06:B862  D0 03              bne    .x02108
       06:B864  4C 1D B9           jmp    LL79
       06:B867            .x02108
 1535                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B867  A0 06               ldy   #6
       06:B869  B1 00               lda   [__sp],Y
       06:B86B  AA                  tax
       06:B86C  C8                  iny
       06:B86D  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1536                             __aslw
       06:B86F  22                 sax
       06:B870  0A                 asl    A
       06:B871  22                 sax
       06:B872  2A                 rol    A
 1537                             __addwi _seq_freq
       06:B873  18                 clc
       06:B874  22                 sax
       06:B875  69 E4              adc    #low(_seq_freq)
       06:B877  22                 sax
       06:B878  69 29              adc    #high(_seq_freq)
 1538                             __pushw
                                 __submi  2,__stack
       06:B87A  48                 pha
       06:B87B  38                 sec
       06:B87C  A5 00              lda    <__stack
       06:B87E  E9 02              sbc    #low(2)
       06:B880  85 00              sta    <__stack
       06:B882  A5 01              lda    <__stack+1
       06:B884  E9 00              sbc    #high(2)
       06:B886  85 01              sta    <__stack+1
       06:B888  68                 pla
       06:B889  22                 sax
       06:B88A  92 00              sta    [__stack]
       06:B88C  22                 sax
       06:B88D  A0 01              ldy    #1
       06:B88F  91 00              sta    [__stack],Y
 1539                             __stw   __ptr
       06:B891  8E 0B 20           stx    __ptr
       06:B894  8D 0C 20           sta    __ptr+1
 1540                             __ldwp  __ptr
       06:B897  B2 0B              lda    [__ptr]
       06:B899  AA                 tax
       06:B89A  A0 01              ldy    #1
       06:B89C  B1 0B              lda    [__ptr],Y
 1541                             __pushw
                                 __submi  2,__stack
       06:B89E  48                 pha
       06:B89F  38                 sec
       06:B8A0  A5 00              lda    <__stack
       06:B8A2  E9 02              sbc    #low(2)
       06:B8A4  85 00              sta    <__stack
       06:B8A6  A5 01              lda    <__stack+1
       06:B8A8  E9 00              sbc    #high(2)
       06:B8AA  85 01              sta    <__stack+1
       06:B8AC  68                 pla
       06:B8AD  22                 sax
       06:B8AE  92 00              sta    [__stack]
       06:B8B0  22                 sax
       06:B8B1  A0 01              ldy    #1
       06:B8B3  91 00              sta    [__stack],Y
 1542                             __ldwi  _detune
       06:B8B5  A2 BA              ldx    #low(_detune)
       06:B8B7  A9 29              lda    #high(_detune)
 1543                             __addw_s        10
                0001              .if (10 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B8B9  A0 0A              ldy    #10
       06:B8BB  18                 clc
       06:B8BC  22                 sax
       06:B8BD  71 00              adc    [__sp],Y
       06:B8BF  22                 sax
       06:B8C0  C8                 iny
       06:B8C1  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1544                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B8C3  86 0B              stx    <__ptr
       06:B8C5  85 0C              sta    <__ptr+1
       06:B8C7  B2 0B              lda    [__ptr]
       06:B8C9  AA                 tax
       06:B8CA  62                 cla
                          ;        bpl    .x_02120   ; signed
                          ;        dec    A
                          ;.x_02120:
 1545                             __andwi 127
       06:B8CB  22                 sax
       06:B8CC  29 7F              and    #low(127)
       06:B8CE  22                 sax
       06:B8CF  29 00              and    #high(127)
 1546                             __subws
       06:B8D1  86 03             stx     <__temp
       06:B8D3  85 04             sta     <__temp+1
       06:B8D5  38                sec
       06:B8D6  B2 00             lda     [__stack]
       06:B8D8  E5 03             sbc     <__temp
       06:B8DA  AA                tax
       06:B8DB  A0 01             ldy     #1
       06:B8DD  B1 00             lda     [__stack],Y
       06:B8DF  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       06:B8E1  48                 pha
       06:B8E2  18                 clc
       06:B8E3  A5 00              lda    <__stack
       06:B8E5  69 02              adc    #low(2)
       06:B8E7  85 00              sta    <__stack
       06:B8E9  A5 01              lda    <__stack+1
       06:B8EB  69 00              adc    #high(2)
       06:B8ED  85 01              sta    <__stack+1
       06:B8EF  68                 pla
 1547                             __stwps
                                 __stw    <__temp
       06:B8F0  86 03              stx    <__temp
       06:B8F2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B8F4  B2 00              lda    [__stack]
       06:B8F6  AA                 tax
       06:B8F7  A0 01              ldy    #1
       06:B8F9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B8FB  86 0B              stx    <__ptr
       06:B8FD  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B8FF  A6 03              ldx    <__temp
       06:B901  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:B903  22                 sax
       06:B904  92 0B              sta    [__ptr]
       06:B906  22                 sax
       06:B907  A0 01              ldy    #1
       06:B909  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:B90B  48                 pha
       06:B90C  18                 clc
       06:B90D  A5 00              lda    <__stack
       06:B90F  69 02              adc    #low(2)
       06:B911  85 00              sta    <__stack
       06:B913  A5 01              lda    <__stack+1
       06:B915  69 00              adc    #high(2)
       06:B917  85 01              sta    <__stack+1
       06:B919  68                 pla
 1548                             __lbra  LL80
       06:B91A  4C C9 B9           jmp    LL80
 1549  06:B91D            LL79:
 1550                     
 1551                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B91D  A0 06               ldy   #6
       06:B91F  B1 00               lda   [__sp],Y
       06:B921  AA                  tax
       06:B922  C8                  iny
       06:B923  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1552                             __aslw
       06:B925  22                 sax
       06:B926  0A                 asl    A
       06:B927  22                 sax
       06:B928  2A                 rol    A
 1553                             __addwi _seq_freq
       06:B929  18                 clc
       06:B92A  22                 sax
       06:B92B  69 E4              adc    #low(_seq_freq)
       06:B92D  22                 sax
       06:B92E  69 29              adc    #high(_seq_freq)
 1554                             __pushw
                                 __submi  2,__stack
       06:B930  48                 pha
       06:B931  38                 sec
       06:B932  A5 00              lda    <__stack
       06:B934  E9 02              sbc    #low(2)
       06:B936  85 00              sta    <__stack
       06:B938  A5 01              lda    <__stack+1
       06:B93A  E9 00              sbc    #high(2)
       06:B93C  85 01              sta    <__stack+1
       06:B93E  68                 pla
       06:B93F  22                 sax
       06:B940  92 00              sta    [__stack]
       06:B942  22                 sax
       06:B943  A0 01              ldy    #1
       06:B945  91 00              sta    [__stack],Y
 1555                             __stw   __ptr
       06:B947  8E 0B 20           stx    __ptr
       06:B94A  8D 0C 20           sta    __ptr+1
 1556                             __ldwp  __ptr
       06:B94D  B2 0B              lda    [__ptr]
       06:B94F  AA                 tax
       06:B950  A0 01              ldy    #1
       06:B952  B1 0B              lda    [__ptr],Y
 1557                             __pushw
                                 __submi  2,__stack
       06:B954  48                 pha
       06:B955  38                 sec
       06:B956  A5 00              lda    <__stack
       06:B958  E9 02              sbc    #low(2)
       06:B95A  85 00              sta    <__stack
       06:B95C  A5 01              lda    <__stack+1
       06:B95E  E9 00              sbc    #high(2)
       06:B960  85 01              sta    <__stack+1
       06:B962  68                 pla
       06:B963  22                 sax
       06:B964  92 00              sta    [__stack]
       06:B966  22                 sax
       06:B967  A0 01              ldy    #1
       06:B969  91 00              sta    [__stack],Y
 1558                             __ldwi  _detune
       06:B96B  A2 BA              ldx    #low(_detune)
       06:B96D  A9 29              lda    #high(_detune)
 1559                             __addw_s        10
                0001              .if (10 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:B96F  A0 0A              ldy    #10
       06:B971  18                 clc
       06:B972  22                 sax
       06:B973  71 00              adc    [__sp],Y
       06:B975  22                 sax
       06:B976  C8                 iny
       06:B977  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1560                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:B979  86 0B              stx    <__ptr
       06:B97B  85 0C              sta    <__ptr+1
       06:B97D  B2 0B              lda    [__ptr]
       06:B97F  AA                 tax
       06:B980  62                 cla
                          ;        bpl    .x_02143   ; signed
                          ;        dec    A
                          ;.x_02143:
 1561                             __andwi 127
       06:B981  22                 sax
       06:B982  29 7F              and    #low(127)
       06:B984  22                 sax
       06:B985  29 00              and    #high(127)
 1562                             __addws
       06:B987  22                 sax
       06:B988  18                 clc
       06:B989  72 00              adc    [__stack]
       06:B98B  22                 sax
       06:B98C  A0 01              ldy    #1
       06:B98E  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:B990  48                 pha
       06:B991  18                 clc
       06:B992  A5 00              lda    <__stack
       06:B994  69 02              adc    #low(2)
       06:B996  85 00              sta    <__stack
       06:B998  A5 01              lda    <__stack+1
       06:B99A  69 00              adc    #high(2)
       06:B99C  85 01              sta    <__stack+1
       06:B99E  68                 pla
 1563                             __stwps
                                 __stw    <__temp
       06:B99F  86 03              stx    <__temp
       06:B9A1  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:B9A3  B2 00              lda    [__stack]
       06:B9A5  AA                 tax
       06:B9A6  A0 01              ldy    #1
       06:B9A8  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:B9AA  86 0B              stx    <__ptr
       06:B9AC  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:B9AE  A6 03              ldx    <__temp
       06:B9B0  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       06:B9B2  22                 sax
       06:B9B3  92 0B              sta    [__ptr]
       06:B9B5  22                 sax
       06:B9B6  A0 01              ldy    #1
       06:B9B8  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       06:B9BA  48                 pha
       06:B9BB  18                 clc
       06:B9BC  A5 00              lda    <__stack
       06:B9BE  69 02              adc    #low(2)
       06:B9C0  85 00              sta    <__stack
       06:B9C2  A5 01              lda    <__stack+1
       06:B9C4  69 00              adc    #high(2)
       06:B9C6  85 01              sta    <__stack+1
       06:B9C8  68                 pla
 1564  06:B9C9            LL80:
 1565                     
 1566  06:B9C9            LL78:
 1567                     
 1568                             __ldwi  2051
       06:B9C9  A2 03              ldx    #low(2051)
       06:B9CB  A9 08              lda    #high(2051)
 1569                             __stw   _bx
       06:B9CD  8E FA 20           stx    _bx
       06:B9D0  8D FB 20           sta    _bx+1
 1570                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:B9D3  A0 06               ldy   #6
       06:B9D5  B1 00               lda   [__sp],Y
       06:B9D7  AA                  tax
       06:B9D8  C8                  iny
       06:B9D9  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1571                             __aslw
       06:B9DB  22                 sax
       06:B9DC  0A                 asl    A
       06:B9DD  22                 sax
       06:B9DE  2A                 rol    A
 1572                             __addwi _seq_freq
       06:B9DF  18                 clc
       06:B9E0  22                 sax
       06:B9E1  69 E4              adc    #low(_seq_freq)
       06:B9E3  22                 sax
       06:B9E4  69 29              adc    #high(_seq_freq)
 1573                             __stw   __ptr
       06:B9E6  8E 0B 20           stx    __ptr
       06:B9E9  8D 0C 20           sta    __ptr+1
 1574                             __ldwp  __ptr
       06:B9EC  B2 0B              lda    [__ptr]
       06:B9EE  AA                 tax
       06:B9EF  A0 01              ldy    #1
       06:B9F1  B1 0B              lda    [__ptr],Y
 1575                             __pushw
                                 __submi  2,__stack
       06:B9F3  48                 pha
       06:B9F4  38                 sec
       06:B9F5  A5 00              lda    <__stack
       06:B9F7  E9 02              sbc    #low(2)
       06:B9F9  85 00              sta    <__stack
       06:B9FB  A5 01              lda    <__stack+1
       06:B9FD  E9 00              sbc    #high(2)
       06:B9FF  85 01              sta    <__stack+1
       06:BA01  68                 pla
       06:BA02  22                 sax
       06:BA03  92 00              sta    [__stack]
       06:BA05  22                 sax
       06:BA06  A0 01              ldy    #1
       06:BA08  91 00              sta    [__stack],Y
 1576                             __ldwi  8
       06:BA0A  A2 08              ldx    #low(8)
       06:BA0C  A9 00              lda    #high(8)
 1577  06:BA0E  20 89 EA            jsr   asr
 1578                             __andwi 15
       06:BA11  22                 sax
       06:BA12  29 0F              and    #low(15)
       06:BA14  22                 sax
       06:BA15  29 00              and    #high(15)
 1579  06:BA17  20 A4 FB            call  _poke.2
 1580                             __ldwi  2050
       06:BA1A  A2 02              ldx    #low(2050)
       06:BA1C  A9 08              lda    #high(2050)
 1581                             __stw   _bx
       06:BA1E  8E FA 20           stx    _bx
       06:BA21  8D FB 20           sta    _bx+1
 1582                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:BA24  A0 06               ldy   #6
       06:BA26  B1 00               lda   [__sp],Y
       06:BA28  AA                  tax
       06:BA29  C8                  iny
       06:BA2A  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1583                             __aslw
       06:BA2C  22                 sax
       06:BA2D  0A                 asl    A
       06:BA2E  22                 sax
       06:BA2F  2A                 rol    A
 1584                             __addwi _seq_freq
       06:BA30  18                 clc
       06:BA31  22                 sax
       06:BA32  69 E4              adc    #low(_seq_freq)
       06:BA34  22                 sax
       06:BA35  69 29              adc    #high(_seq_freq)
 1585                             __stw   __ptr
       06:BA37  8E 0B 20           stx    __ptr
       06:BA3A  8D 0C 20           sta    __ptr+1
 1586                             __ldwp  __ptr
       06:BA3D  B2 0B              lda    [__ptr]
       06:BA3F  AA                 tax
       06:BA40  A0 01              ldy    #1
       06:BA42  B1 0B              lda    [__ptr],Y
 1587                             __andwi 255
       06:BA44  22                 sax
       06:BA45  29 FF              and    #low(255)
       06:BA47  22                 sax
       06:BA48  29 00              and    #high(255)
 1588  06:BA4A  20 A4 FB            call  _poke.2
 1589                             incw    _seq_ptr
       06:BA4D  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:BA50  D0 03              bne    .x_02173           ; location
       06:BA52  EE D3 29           inc    _seq_ptr+1
       06:BA55            .x_02173:
 1590                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:BA55  AE D2 29           ldx    _seq_ptr
       06:BA58  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1591                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:BA5B  86 0B              stx    <__ptr
       06:BA5D  85 0C              sta    <__ptr+1
       06:BA5F  B2 0B              lda    [__ptr]
       06:BA61  AA                 tax
       06:BA62  62                 cla
                          ;        bpl    .x_02175   ; signed
                          ;        dec    A
                          ;.x_02175:
 1592                             __stw   _j
       06:BA63  8E 26 2A           stx    _j
       06:BA66  8D 27 2A           sta    _j+1
 1593                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       06:BA69  AE D2 29           ldx    _seq_ptr
       06:BA6C  AD D3 29           lda    _seq_ptr+1
                                  .endif
 1594                             incw    _seq_ptr
       06:BA6F  EE D2 29           inc    _seq_ptr              ; value at stated memory
       06:BA72  D0 03              bne    .x_02178           ; location
       06:BA74  EE D3 29           inc    _seq_ptr+1
       06:BA77            .x_02178:
 1595                             __ldwi  _ch_cnt
       06:BA77  A2 88              ldx    #low(_ch_cnt)
       06:BA79  A9 29              lda    #high(_ch_cnt)
 1596                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:BA7B  A0 06              ldy    #6
       06:BA7D  18                 clc
       06:BA7E  22                 sax
       06:BA7F  71 00              adc    [__sp],Y
       06:BA81  22                 sax
       06:BA82  C8                 iny
       06:BA83  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1597                             __pushw
                                 __submi  2,__stack
       06:BA85  48                 pha
       06:BA86  38                 sec
       06:BA87  A5 00              lda    <__stack
       06:BA89  E9 02              sbc    #low(2)
       06:BA8B  85 00              sta    <__stack
       06:BA8D  A5 01              lda    <__stack+1
       06:BA8F  E9 00              sbc    #high(2)
       06:BA91  85 01              sta    <__stack+1
       06:BA93  68                 pla
       06:BA94  22                 sax
       06:BA95  92 00              sta    [__stack]
       06:BA97  22                 sax
       06:BA98  A0 01              ldy    #1
       06:BA9A  91 00              sta    [__stack],Y
 1598                             __ldw   _j
                0000              .if (1 = 2)
                                  .else
       06:BA9C  AE 26 2A           ldx    _j
       06:BA9F  AD 27 2A           lda    _j+1
                                  .endif
 1599                             __stbps
                                 __stw    <__temp
       06:BAA2  86 03              stx    <__temp
       06:BAA4  85 04              sta    <__temp+1
                                 __ldwp    __stack
       06:BAA6  B2 00              lda    [__stack]
       06:BAA8  AA                 tax
       06:BAA9  A0 01              ldy    #1
       06:BAAB  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       06:BAAD  86 0B              stx    <__ptr
       06:BAAF  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       06:BAB1  A6 03              ldx    <__temp
       06:BAB3  A5 04              lda    <__temp+1
                                  .endif
       06:BAB5  22                 sax
       06:BAB6  92 0B              sta    [__ptr]
       06:BAB8  22                 sax
                                 __addmi  2,__stack
       06:BAB9  48                 pha
       06:BABA  18                 clc
       06:BABB  A5 00              lda    <__stack
       06:BABD  69 02              adc    #low(2)
       06:BABF  85 00              sta    <__stack
       06:BAC1  A5 01              lda    <__stack+1
       06:BAC3  69 00              adc    #high(2)
       06:BAC5  85 01              sta    <__stack+1
       06:BAC7  68                 pla
 1600                             __ldw_s 6
                0001              .if (6 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (6 = 0)
                                   .else
       06:BAC8  A0 06               ldy   #6
       06:BACA  B1 00               lda   [__sp],Y
       06:BACC  AA                  tax
       06:BACD  C8                  iny
       06:BACE  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1601                             __pushw
                                 __submi  2,__stack
       06:BAD0  48                 pha
       06:BAD1  38                 sec
       06:BAD2  A5 00              lda    <__stack
       06:BAD4  E9 02              sbc    #low(2)
       06:BAD6  85 00              sta    <__stack
       06:BAD8  A5 01              lda    <__stack+1
       06:BADA  E9 00              sbc    #high(2)
       06:BADC  85 01              sta    <__stack+1
       06:BADE  68                 pla
       06:BADF  22                 sax
       06:BAE0  92 00              sta    [__stack]
       06:BAE2  22                 sax
       06:BAE3  A0 01              ldy    #1
       06:BAE5  91 00              sta    [__stack],Y
 1602                             __ldwi  _ch_vol
       06:BAE7  A2 90              ldx    #low(_ch_vol)
       06:BAE9  A9 29              lda    #high(_ch_vol)
 1603                             __addw_s        8
                0001              .if (8 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       06:BAEB  A0 08              ldy    #8
       06:BAED  18                 clc
       06:BAEE  22                 sax
       06:BAEF  71 00              adc    [__sp],Y
       06:BAF1  22                 sax
       06:BAF2  C8                 iny
       06:BAF3  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1604                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       06:BAF5  86 0B              stx    <__ptr
       06:BAF7  85 0C              sta    <__ptr+1
       06:BAF9  B2 0B              lda    [__ptr]
       06:BAFB  AA                 tax
       06:BAFC  62                 cla
                          ;        bpl    .x_02195   ; signed
                          ;        dec    A
                          ;.x_02195:
 1605  06:BAFD  20 12 80            call  _set_vol
 1606  06:BB00            LL69:
 1607                     
 1608  06:BB00            LL45:
 1609                     
 1610                             __addmi 8,__stack
       06:BB00  48                 pha
       06:BB01  18                 clc
       06:BB02  A5 00              lda    <__stack
       06:BB04  69 08              adc    #low(8)
       06:BB06  85 00              sta    <__stack
       06:BB08  A5 01              lda    <__stack+1
       06:BB0A  69 00              adc    #high(8)
       06:BB0C  85 01              sta    <__stack+1
       06:BB0E  68                 pla
 1611  06:BB0F  60                  rts
 1612                             .endp
 1613                     
 1614  00:FDD3            _seqproc:
 1615  00:FDD3  5B AB             dw   SEQ_EC
 1616  00:FDD5  EA AA             dw   SEQ_ED
 1617  00:FDD7  2C AA             dw   SEQ_EE
 1618  00:FDD9  C9 A9             dw   SEQ_EF
 1619  00:FDDB  37 A9             dw   SEQ_F0
 1620  00:FDDD  D3 A8             dw   SEQ_F1
 1621  00:FDDF  64 A7             dw   SEQ_F2
 1622  00:FDE1  99 AB             dw   endpoint ; f3
 1623  00:FDE3  E5 A6             dw   SEQ_F4
 1624  00:FDE5  99 AB             dw   endpoint ; f5
 1625  00:FDE7  99 AB             dw   endpoint ; f6
 1626  00:FDE9  66 A6             dw   SEQ_F7   ; f7
 1627  00:FDEB  E7 A5             dw   SEQ_F8
 1628  00:FDED  91 A1             dw   SEQ_F9
 1629  00:FDEF  00 A5             dw   SEQ_FA
 1630  00:FDF1  61 A3             dw   SEQ_FB
 1631  00:FDF3  4F A2             dw   SEQ_FC
 1632  00:FDF5  A8 A1             dw   SEQ_FD
 1633  00:FDF7  7A A1             dw   SEQ_FE
 1634  00:FDF9  B6 A0             dw   SEQ_FF
 1635  06:5B10                    .proc _divxt
 1636                             __pushw
                                 __submi  2,__stack
       06:BB10  48                 pha
       06:BB11  38                 sec
       06:BB12  A5 00              lda    <__stack
       06:BB14  E9 02              sbc    #low(2)
       06:BB16  85 00              sta    <__stack
       06:BB18  A5 01              lda    <__stack+1
       06:BB1A  E9 00              sbc    #high(2)
       06:BB1C  85 01              sta    <__stack+1
       06:BB1E  68                 pla
       06:BB1F  22                 sax
       06:BB20  92 00              sta    [__stack]
       06:BB22  22                 sax
       06:BB23  A0 01              ldy    #1
       06:BB25  91 00              sta    [__stack],Y
 1637                             __addmi -4,__stack
       06:BB27  48                 pha
       06:BB28  18                 clc
       06:BB29  A5 00              lda    <__stack
       06:BB2B  69 FC              adc    #low(-4)
       06:BB2D  85 00              sta    <__stack
       06:BB2F  A5 01              lda    <__stack+1
       06:BB31  69 FF              adc    #high(-4)
       06:BB33  85 01              sta    <__stack+1
       06:BB35  68                 pla
 1638                             __stwi_s        0,0
                0001              .if (0 < 255)
                                   ; short index (bytes : 12, cycles : 24)
                          
       06:BB36  A9 00              lda    #LOW(0)
       06:BB38  A0 00              ldy    #0
       06:BB3A  91 00              sta    [__sp],Y
       06:BB3C  AA                 tax
       06:BB3D  A9 00              lda    #HIGH(0)
       06:BB3F  C8                 iny
       06:BB40  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1639                             __stwi_s        0,2
                0001              .if (2 < 255)
                                   ; short index (bytes : 12, cycles : 24)
                          
       06:BB42  A9 00              lda    #LOW(0)
       06:BB44  A0 02              ldy    #2
       06:BB46  91 00              sta    [__sp],Y
       06:BB48  AA                 tax
       06:BB49  A9 00              lda    #HIGH(0)
       06:BB4B  C8                 iny
       06:BB4C  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1640  06:BB4E            LL82:
 1641                     
 1642                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       06:BB4E  B2 00               lda   [__sp]
       06:BB50  AA                  tax
       06:BB51  A0 01               ldy   #1
       06:BB53  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 1643                             __pushw
                                 __submi  2,__stack
       06:BB55  48                 pha
       06:BB56  38                 sec
       06:BB57  A5 00              lda    <__stack
       06:BB59  E9 02              sbc    #low(2)
       06:BB5B  85 00              sta    <__stack
       06:BB5D  A5 01              lda    <__stack+1
       06:BB5F  E9 00              sbc    #high(2)
       06:BB61  85 01              sta    <__stack+1
       06:BB63  68                 pla
       06:BB64  22                 sax
       06:BB65  92 00              sta    [__stack]
       06:BB67  22                 sax
       06:BB68  A0 01              ldy    #1
       06:BB6A  91 00              sta    [__stack],Y
 1644                             __ldb_s 8
                0001              .if (8 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       06:BB6C  A0 08              ldy    #8
       06:BB6E  B1 00              lda    [__sp],Y
       06:BB70  AA                 tax
       06:BB71  62                 cla
                          ;        bpl    .x_02205   ; signed
                          ;        dec    A
                          ;.x_02205:
                                  .else
                                  .endif
 1645  06:BB72  20 0D E9            jsr   lt
 1646                             __lbne  LL84
       06:BB75  F0 03              beq    .x02206
       06:BB77  4C 98 BB           jmp    LL84
       06:BB7A            .x02206
 1647                             __lbra  LL85
       06:BB7A  4C E0 BB           jmp    LL85
 1648  06:BB7D            LL83:
 1649                     
 1650                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       06:BB7D  A0 02               ldy   #2
       06:BB7F  B1 00               lda   [__sp],Y
       06:BB81  AA                  tax
       06:BB82  C8                  iny
       06:BB83  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1651                             __incw_s        2
                                   ; (bytes : 16, cycles : 24/40)
                          
       06:BB85  48                 pha
       06:BB86  A0 02              ldy    #2
       06:BB88  8A                 txa
       06:BB89  1A                 inc    A
       06:BB8A  91 00              sta    [__sp],Y
       06:BB8C  D0 06              bne    .x_02209
       06:BB8E  C8                 iny
       06:BB8F  B1 00              lda    [__sp],Y
       06:BB91  1A                 inc    A
       06:BB92  91 00              sta    [__sp],Y
       06:BB94            .x_02209:
       06:BB94  68                 pla
 1652                             __lbra  LL82
       06:BB95  4C 4E BB           jmp    LL82
 1653  06:BB98            LL84:
 1654                     
 1655                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       06:BB98  B2 00               lda   [__sp]
       06:BB9A  AA                  tax
       06:BB9B  A0 01               ldy   #1
       06:BB9D  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 1656                             __pushw
                                 __submi  2,__stack
       06:BB9F  48                 pha
       06:BBA0  38                 sec
       06:BBA1  A5 00              lda    <__stack
       06:BBA3  E9 02              sbc    #low(2)
       06:BBA5  85 00              sta    <__stack
       06:BBA7  A5 01              lda    <__stack+1
       06:BBA9  E9 00              sbc    #high(2)
       06:BBAB  85 01              sta    <__stack+1
       06:BBAD  68                 pla
       06:BBAE  22                 sax
       06:BBAF  92 00              sta    [__stack]
       06:BBB1  22                 sax
       06:BBB2  A0 01              ldy    #1
       06:BBB4  91 00              sta    [__stack],Y
 1657                             __ldb_s 6
                0001              .if (6 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       06:BBB6  A0 06              ldy    #6
       06:BBB8  B1 00              lda    [__sp],Y
       06:BBBA  AA                 tax
       06:BBBB  62                 cla
                          ;        bpl    .x_02214   ; signed
                          ;        dec    A
                          ;.x_02214:
                                  .else
                                  .endif
 1658                             __addws
       06:BBBC  22                 sax
       06:BBBD  18                 clc
       06:BBBE  72 00              adc    [__stack]
       06:BBC0  22                 sax
       06:BBC1  A0 01              ldy    #1
       06:BBC3  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       06:BBC5  48                 pha
       06:BBC6  18                 clc
       06:BBC7  A5 00              lda    <__stack
       06:BBC9  69 02              adc    #low(2)
       06:BBCB  85 00              sta    <__stack
       06:BBCD  A5 01              lda    <__stack+1
       06:BBCF  69 00              adc    #high(2)
       06:BBD1  85 01              sta    <__stack+1
       06:BBD3  68                 pla
 1659                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       06:BBD4  22                 sax
       06:BBD5  A0 00              ldy    #0
       06:BBD7  91 00              sta    [__sp],Y
       06:BBD9  22                 sax
       06:BBDA  C8                 iny
       06:BBDB  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1660                             __lbra  LL83
       06:BBDD  4C 7D BB           jmp    LL83
 1661  06:BBE0            LL85:
 1662                     
 1663                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       06:BBE0  A0 02               ldy   #2
       06:BBE2  B1 00               lda   [__sp],Y
       06:BBE4  AA                  tax
       06:BBE5  C8                  iny
       06:BBE6  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1664                             __lbra  LL81
       06:BBE8  4C EB BB           jmp    LL81
 1665  06:BBEB            LL81:
 1666                     
 1667                             __addmi 8,__stack
       06:BBEB  48                 pha
       06:BBEC  18                 clc
       06:BBED  A5 00              lda    <__stack
       06:BBEF  69 08              adc    #low(8)
       06:BBF1  85 00              sta    <__stack
       06:BBF3  A5 01              lda    <__stack+1
       06:BBF5  69 00              adc    #high(8)
       06:BBF7  85 01              sta    <__stack+1
       06:BBF9  68                 pla
 1668  06:BBFA  60                  rts
 1669                             .endp
 1670                     
 1671  07:4000                    .proc _drv_pitchenv
 1672                             __pushw
                                 __submi  2,__stack
       07:A000  48                 pha
       07:A001  38                 sec
       07:A002  A5 00              lda    <__stack
       07:A004  E9 02              sbc    #low(2)
       07:A006  85 00              sta    <__stack
       07:A008  A5 01              lda    <__stack+1
       07:A00A  E9 00              sbc    #high(2)
       07:A00C  85 01              sta    <__stack+1
       07:A00E  68                 pla
       07:A00F  22                 sax
       07:A010  92 00              sta    [__stack]
       07:A012  22                 sax
       07:A013  A0 01              ldy    #1
       07:A015  91 00              sta    [__stack],Y
 1673                             __addmi -1,__stack
       07:A017  48                 pha
       07:A018  18                 clc
       07:A019  A5 00              lda    <__stack
       07:A01B  69 FF              adc    #low(-1)
       07:A01D  85 00              sta    <__stack
       07:A01F  A5 01              lda    <__stack+1
       07:A021  69 FF              adc    #high(-1)
       07:A023  85 01              sta    <__stack+1
       07:A025  68                 pla
 1674                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A026  A0 01               ldy   #1
       07:A028  B1 00               lda   [__sp],Y
       07:A02A  AA                  tax
       07:A02B  C8                  iny
       07:A02C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1675                             __aslw
       07:A02E  22                 sax
       07:A02F  0A                 asl    A
       07:A030  22                 sax
       07:A031  2A                 rol    A
 1676                             __addwi _pitch_envadr
       07:A032  18                 clc
       07:A033  22                 sax
       07:A034  69 F4              adc    #low(_pitch_envadr)
       07:A036  22                 sax
       07:A037  69 29              adc    #high(_pitch_envadr)
 1677                             __stw   __ptr
       07:A039  8E 0B 20           stx    __ptr
       07:A03C  8D 0C 20           sta    __ptr+1
 1678                             __ldwp  __ptr
       07:A03F  B2 0B              lda    [__ptr]
       07:A041  AA                 tax
       07:A042  A0 01              ldy    #1
       07:A044  B1 0B              lda    [__ptr],Y
 1679                             __tstw
                                   ; pha
       07:A046  86 03              stx    <__temp
       07:A048  05 03              ora    <__temp
                                   ; pla
 1680                             __lbeq  LL87
       07:A04A  D0 03              bne    .x02231
       07:A04C  4C FA A6           jmp    LL87
       07:A04F            .x02231
 1681                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A04F  A0 01               ldy   #1
       07:A051  B1 00               lda   [__sp],Y
       07:A053  AA                  tax
       07:A054  C8                  iny
       07:A055  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1682                             __aslw
       07:A057  22                 sax
       07:A058  0A                 asl    A
       07:A059  22                 sax
       07:A05A  2A                 rol    A
 1683                             __addwi _pitch_envadr
       07:A05B  18                 clc
       07:A05C  22                 sax
       07:A05D  69 F4              adc    #low(_pitch_envadr)
       07:A05F  22                 sax
       07:A060  69 29              adc    #high(_pitch_envadr)
 1684                             __stw   __ptr
       07:A062  8E 0B 20           stx    __ptr
       07:A065  8D 0C 20           sta    __ptr+1
 1685                             __ldwp  __ptr
       07:A068  B2 0B              lda    [__ptr]
       07:A06A  AA                 tax
       07:A06B  A0 01              ldy    #1
       07:A06D  B1 0B              lda    [__ptr],Y
 1686                             __stw   __ptr
       07:A06F  8E 0B 20           stx    __ptr
       07:A072  8D 0C 20           sta    __ptr+1
 1687                             __ldwp  __ptr
       07:A075  B2 0B              lda    [__ptr]
       07:A077  AA                 tax
       07:A078  A0 01              ldy    #1
       07:A07A  B1 0B              lda    [__ptr],Y
 1688                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       07:A07C  22                 sax
       07:A07D  A0 00              ldy    #0
       07:A07F  91 00              sta    [__sp],Y
       07:A081  22                 sax
                                  .else
                                  .endif
 1689                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A082  A0 01               ldy   #1
       07:A084  B1 00               lda   [__sp],Y
       07:A086  AA                  tax
       07:A087  C8                  iny
       07:A088  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1690                             __aslw
       07:A08A  22                 sax
       07:A08B  0A                 asl    A
       07:A08C  22                 sax
       07:A08D  2A                 rol    A
 1691                             __addwi _pitch_envadr
       07:A08E  18                 clc
       07:A08F  22                 sax
       07:A090  69 F4              adc    #low(_pitch_envadr)
       07:A092  22                 sax
       07:A093  69 29              adc    #high(_pitch_envadr)
 1692                             __pushw
                                 __submi  2,__stack
       07:A095  48                 pha
       07:A096  38                 sec
       07:A097  A5 00              lda    <__stack
       07:A099  E9 02              sbc    #low(2)
       07:A09B  85 00              sta    <__stack
       07:A09D  A5 01              lda    <__stack+1
       07:A09F  E9 00              sbc    #high(2)
       07:A0A1  85 01              sta    <__stack+1
       07:A0A3  68                 pla
       07:A0A4  22                 sax
       07:A0A5  92 00              sta    [__stack]
       07:A0A7  22                 sax
       07:A0A8  A0 01              ldy    #1
       07:A0AA  91 00              sta    [__stack],Y
 1693                             __stw   __ptr
       07:A0AC  8E 0B 20           stx    __ptr
       07:A0AF  8D 0C 20           sta    __ptr+1
 1694                             __ldwp  __ptr
       07:A0B2  B2 0B              lda    [__ptr]
       07:A0B4  AA                 tax
       07:A0B5  A0 01              ldy    #1
       07:A0B7  B1 0B              lda    [__ptr],Y
 1695                             __addwi 1
       07:A0B9  18                 clc
       07:A0BA  22                 sax
       07:A0BB  69 01              adc    #low(1)
       07:A0BD  22                 sax
       07:A0BE  69 00              adc    #high(1)
 1696                             __stwps
                                 __stw    <__temp
       07:A0C0  86 03              stx    <__temp
       07:A0C2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A0C4  B2 00              lda    [__stack]
       07:A0C6  AA                 tax
       07:A0C7  A0 01              ldy    #1
       07:A0C9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A0CB  86 0B              stx    <__ptr
       07:A0CD  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A0CF  A6 03              ldx    <__temp
       07:A0D1  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:A0D3  22                 sax
       07:A0D4  92 0B              sta    [__ptr]
       07:A0D6  22                 sax
       07:A0D7  A0 01              ldy    #1
       07:A0D9  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:A0DB  48                 pha
       07:A0DC  18                 clc
       07:A0DD  A5 00              lda    <__stack
       07:A0DF  69 02              adc    #low(2)
       07:A0E1  85 00              sta    <__stack
       07:A0E3  A5 01              lda    <__stack+1
       07:A0E5  69 00              adc    #high(2)
       07:A0E7  85 01              sta    <__stack+1
       07:A0E9  68                 pla
 1697                             __subwi 1
       07:A0EA  38                 sec
       07:A0EB  22                 sax
       07:A0EC  E9 01              sbc    #low(1)
       07:A0EE  22                 sax
       07:A0EF  E9 00              sbc    #high(1)
 1698                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A0F1  A0 00              ldy    #0
       07:A0F3  B1 00              lda    [__sp],Y
       07:A0F5  AA                 tax
       07:A0F6  62                 cla
                          ;        bpl    .x_02256   ; signed
                          ;        dec    A
                          ;.x_02256:
                                  .else
                                  .endif
 1699                             __stw   <__temp
       07:A0F7  86 03              stx    <__temp
       07:A0F9  85 04              sta    <__temp+1
 1700                             __ldwi  255
       07:A0FB  A2 FF              ldx    #low(255)
       07:A0FD  A9 00              lda    #high(255)
 1701  07:A0FF  20 FC E8            jsr   eqzp
 1702                             __lbeq  LL88
       07:A102  D0 03              bne    .x02259
       07:A104  4C 85 A2           jmp    LL88
       07:A107            .x02259
 1703                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A107  A0 01               ldy   #1
       07:A109  B1 00               lda   [__sp],Y
       07:A10B  AA                  tax
       07:A10C  C8                  iny
       07:A10D  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1704                             __aslw
       07:A10F  22                 sax
       07:A110  0A                 asl    A
       07:A111  22                 sax
       07:A112  2A                 rol    A
 1705                             __addwi _pitch_envadr
       07:A113  18                 clc
       07:A114  22                 sax
       07:A115  69 F4              adc    #low(_pitch_envadr)
       07:A117  22                 sax
       07:A118  69 29              adc    #high(_pitch_envadr)
 1706                             __pushw
                                 __submi  2,__stack
       07:A11A  48                 pha
       07:A11B  38                 sec
       07:A11C  A5 00              lda    <__stack
       07:A11E  E9 02              sbc    #low(2)
       07:A120  85 00              sta    <__stack
       07:A122  A5 01              lda    <__stack+1
       07:A124  E9 00              sbc    #high(2)
       07:A126  85 01              sta    <__stack+1
       07:A128  68                 pla
       07:A129  22                 sax
       07:A12A  92 00              sta    [__stack]
       07:A12C  22                 sax
       07:A12D  A0 01              ldy    #1
       07:A12F  91 00              sta    [__stack],Y
 1707                             __ldwi  _sound_dat
       07:A131  A2 00              ldx    #low(_sound_dat)
       07:A133  A9 44              lda    #high(_sound_dat)
 1708                             __addwi 10
       07:A135  18                 clc
       07:A136  22                 sax
       07:A137  69 0A              adc    #low(10)
       07:A139  22                 sax
       07:A13A  69 00              adc    #high(10)
 1709                             __stw   __ptr
       07:A13C  8E 0B 20           stx    __ptr
       07:A13F  8D 0C 20           sta    __ptr+1
 1710                             __ldwp  __ptr
       07:A142  B2 0B              lda    [__ptr]
       07:A144  AA                 tax
       07:A145  A0 01              ldy    #1
       07:A147  B1 0B              lda    [__ptr],Y
 1711                             __pushw
                                 __submi  2,__stack
       07:A149  48                 pha
       07:A14A  38                 sec
       07:A14B  A5 00              lda    <__stack
       07:A14D  E9 02              sbc    #low(2)
       07:A14F  85 00              sta    <__stack
       07:A151  A5 01              lda    <__stack+1
       07:A153  E9 00              sbc    #high(2)
       07:A155  85 01              sta    <__stack+1
       07:A157  68                 pla
       07:A158  22                 sax
       07:A159  92 00              sta    [__stack]
       07:A15B  22                 sax
       07:A15C  A0 01              ldy    #1
       07:A15E  91 00              sta    [__stack],Y
 1712                             __ldwi  _pitch_sw
       07:A160  A2 AA              ldx    #low(_pitch_sw)
       07:A162  A9 29              lda    #high(_pitch_sw)
 1713                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A164  A0 05              ldy    #5
       07:A166  18                 clc
       07:A167  22                 sax
       07:A168  71 00              adc    [__sp],Y
       07:A16A  22                 sax
       07:A16B  C8                 iny
       07:A16C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1714                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A16E  86 0B              stx    <__ptr
       07:A170  85 0C              sta    <__ptr+1
       07:A172  B2 0B              lda    [__ptr]
       07:A174  AA                 tax
       07:A175  62                 cla
                          ;        bpl    .x_02273   ; signed
                          ;        dec    A
                          ;.x_02273:
 1715                             __pushw
                                 __submi  2,__stack
       07:A176  48                 pha
       07:A177  38                 sec
       07:A178  A5 00              lda    <__stack
       07:A17A  E9 02              sbc    #low(2)
       07:A17C  85 00              sta    <__stack
       07:A17E  A5 01              lda    <__stack+1
       07:A180  E9 00              sbc    #high(2)
       07:A182  85 01              sta    <__stack+1
       07:A184  68                 pla
       07:A185  22                 sax
       07:A186  92 00              sta    [__stack]
       07:A188  22                 sax
       07:A189  A0 01              ldy    #1
       07:A18B  91 00              sta    [__stack],Y
 1716                             __ldwi  1
       07:A18D  A2 01              ldx    #low(1)
       07:A18F  A9 00              lda    #high(1)
 1717  07:A191  20 60 EA            jsr   asl
 1718                             __addws
       07:A194  22                 sax
       07:A195  18                 clc
       07:A196  72 00              adc    [__stack]
       07:A198  22                 sax
       07:A199  A0 01              ldy    #1
       07:A19B  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A19D  48                 pha
       07:A19E  18                 clc
       07:A19F  A5 00              lda    <__stack
       07:A1A1  69 02              adc    #low(2)
       07:A1A3  85 00              sta    <__stack
       07:A1A5  A5 01              lda    <__stack+1
       07:A1A7  69 00              adc    #high(2)
       07:A1A9  85 01              sta    <__stack+1
       07:A1AB  68                 pla
 1719                             __stw   __ptr
       07:A1AC  8E 0B 20           stx    __ptr
       07:A1AF  8D 0C 20           sta    __ptr+1
 1720                             __ldwp  __ptr
       07:A1B2  B2 0B              lda    [__ptr]
       07:A1B4  AA                 tax
       07:A1B5  A0 01              ldy    #1
       07:A1B7  B1 0B              lda    [__ptr],Y
 1721                             __stwps
                                 __stw    <__temp
       07:A1B9  86 03              stx    <__temp
       07:A1BB  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A1BD  B2 00              lda    [__stack]
       07:A1BF  AA                 tax
       07:A1C0  A0 01              ldy    #1
       07:A1C2  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A1C4  86 0B              stx    <__ptr
       07:A1C6  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A1C8  A6 03              ldx    <__temp
       07:A1CA  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:A1CC  22                 sax
       07:A1CD  92 0B              sta    [__ptr]
       07:A1CF  22                 sax
       07:A1D0  A0 01              ldy    #1
       07:A1D2  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:A1D4  48                 pha
       07:A1D5  18                 clc
       07:A1D6  A5 00              lda    <__stack
       07:A1D8  69 02              adc    #low(2)
       07:A1DA  85 00              sta    <__stack
       07:A1DC  A5 01              lda    <__stack+1
       07:A1DE  69 00              adc    #high(2)
       07:A1E0  85 01              sta    <__stack+1
       07:A1E2  68                 pla
 1722                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A1E3  A0 01               ldy   #1
       07:A1E5  B1 00               lda   [__sp],Y
       07:A1E7  AA                  tax
       07:A1E8  C8                  iny
       07:A1E9  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1723                             __aslw
       07:A1EB  22                 sax
       07:A1EC  0A                 asl    A
       07:A1ED  22                 sax
       07:A1EE  2A                 rol    A
 1724                             __addwi _pitch_envadr
       07:A1EF  18                 clc
       07:A1F0  22                 sax
       07:A1F1  69 F4              adc    #low(_pitch_envadr)
       07:A1F3  22                 sax
       07:A1F4  69 29              adc    #high(_pitch_envadr)
 1725                             __stw   __ptr
       07:A1F6  8E 0B 20           stx    __ptr
       07:A1F9  8D 0C 20           sta    __ptr+1
 1726                             __ldwp  __ptr
       07:A1FC  B2 0B              lda    [__ptr]
       07:A1FE  AA                 tax
       07:A1FF  A0 01              ldy    #1
       07:A201  B1 0B              lda    [__ptr],Y
 1727                             __stw   __ptr
       07:A203  8E 0B 20           stx    __ptr
       07:A206  8D 0C 20           sta    __ptr+1
 1728                             __ldwp  __ptr
       07:A209  B2 0B              lda    [__ptr]
       07:A20B  AA                 tax
       07:A20C  A0 01              ldy    #1
       07:A20E  B1 0B              lda    [__ptr],Y
 1729                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       07:A210  22                 sax
       07:A211  A0 00              ldy    #0
       07:A213  91 00              sta    [__sp],Y
       07:A215  22                 sax
                                  .else
                                  .endif
 1730                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A216  A0 01               ldy   #1
       07:A218  B1 00               lda   [__sp],Y
       07:A21A  AA                  tax
       07:A21B  C8                  iny
       07:A21C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1731                             __aslw
       07:A21E  22                 sax
       07:A21F  0A                 asl    A
       07:A220  22                 sax
       07:A221  2A                 rol    A
 1732                             __addwi _pitch_envadr
       07:A222  18                 clc
       07:A223  22                 sax
       07:A224  69 F4              adc    #low(_pitch_envadr)
       07:A226  22                 sax
       07:A227  69 29              adc    #high(_pitch_envadr)
 1733                             __pushw
                                 __submi  2,__stack
       07:A229  48                 pha
       07:A22A  38                 sec
       07:A22B  A5 00              lda    <__stack
       07:A22D  E9 02              sbc    #low(2)
       07:A22F  85 00              sta    <__stack
       07:A231  A5 01              lda    <__stack+1
       07:A233  E9 00              sbc    #high(2)
       07:A235  85 01              sta    <__stack+1
       07:A237  68                 pla
       07:A238  22                 sax
       07:A239  92 00              sta    [__stack]
       07:A23B  22                 sax
       07:A23C  A0 01              ldy    #1
       07:A23E  91 00              sta    [__stack],Y
 1734                             __stw   __ptr
       07:A240  8E 0B 20           stx    __ptr
       07:A243  8D 0C 20           sta    __ptr+1
 1735                             __ldwp  __ptr
       07:A246  B2 0B              lda    [__ptr]
       07:A248  AA                 tax
       07:A249  A0 01              ldy    #1
       07:A24B  B1 0B              lda    [__ptr],Y
 1736                             __addwi 1
       07:A24D  18                 clc
       07:A24E  22                 sax
       07:A24F  69 01              adc    #low(1)
       07:A251  22                 sax
       07:A252  69 00              adc    #high(1)
 1737                             __stwps
                                 __stw    <__temp
       07:A254  86 03              stx    <__temp
       07:A256  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A258  B2 00              lda    [__stack]
       07:A25A  AA                 tax
       07:A25B  A0 01              ldy    #1
       07:A25D  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A25F  86 0B              stx    <__ptr
       07:A261  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A263  A6 03              ldx    <__temp
       07:A265  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:A267  22                 sax
       07:A268  92 0B              sta    [__ptr]
       07:A26A  22                 sax
       07:A26B  A0 01              ldy    #1
       07:A26D  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:A26F  48                 pha
       07:A270  18                 clc
       07:A271  A5 00              lda    <__stack
       07:A273  69 02              adc    #low(2)
       07:A275  85 00              sta    <__stack
       07:A277  A5 01              lda    <__stack+1
       07:A279  69 00              adc    #high(2)
       07:A27B  85 01              sta    <__stack+1
       07:A27D  68                 pla
 1738                             __subwi 1
       07:A27E  38                 sec
       07:A27F  22                 sax
       07:A280  E9 01              sbc    #low(1)
       07:A282  22                 sax
       07:A283  E9 00              sbc    #high(1)
 1739  07:A285            LL88:
 1740                     
 1741                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A285  A0 01               ldy   #1
       07:A287  B1 00               lda   [__sp],Y
       07:A289  AA                  tax
       07:A28A  C8                  iny
       07:A28B  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1742                             __stw   <__temp
       07:A28D  86 03              stx    <__temp
       07:A28F  85 04              sta    <__temp+1
 1743                             __ldwi  3
       07:A291  A2 03              ldx    #low(3)
       07:A293  A9 00              lda    #high(3)
 1744  07:A295  20 CC E9            jsr   gtzp
 1745                             __lbeq  LL90
       07:A298  D0 03              bne    .x02315
       07:A29A  4C E7 A2           jmp    LL90
       07:A29D            .x02315
 1746                             __ldwi  _noise_sw
       07:A29D  A2 2A              ldx    #low(_noise_sw)
       07:A29F  A9 2A              lda    #high(_noise_sw)
 1747                             __pushw
                                 __submi  2,__stack
       07:A2A1  48                 pha
       07:A2A2  38                 sec
       07:A2A3  A5 00              lda    <__stack
       07:A2A5  E9 02              sbc    #low(2)
       07:A2A7  85 00              sta    <__stack
       07:A2A9  A5 01              lda    <__stack+1
       07:A2AB  E9 00              sbc    #high(2)
       07:A2AD  85 01              sta    <__stack+1
       07:A2AF  68                 pla
       07:A2B0  22                 sax
       07:A2B1  92 00              sta    [__stack]
       07:A2B3  22                 sax
       07:A2B4  A0 01              ldy    #1
       07:A2B6  91 00              sta    [__stack],Y
 1748                             __ldw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (3 = 0)
                                   .else
       07:A2B8  A0 03               ldy   #3
       07:A2BA  B1 00               lda   [__sp],Y
       07:A2BC  AA                  tax
       07:A2BD  C8                  iny
       07:A2BE  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1749                             __subwi 4
       07:A2C0  38                 sec
       07:A2C1  22                 sax
       07:A2C2  E9 04              sbc    #low(4)
       07:A2C4  22                 sax
       07:A2C5  E9 00              sbc    #high(4)
 1750                             __addws
       07:A2C7  22                 sax
       07:A2C8  18                 clc
       07:A2C9  72 00              adc    [__stack]
       07:A2CB  22                 sax
       07:A2CC  A0 01              ldy    #1
       07:A2CE  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A2D0  48                 pha
       07:A2D1  18                 clc
       07:A2D2  A5 00              lda    <__stack
       07:A2D4  69 02              adc    #low(2)
       07:A2D6  85 00              sta    <__stack
       07:A2D8  A5 01              lda    <__stack+1
       07:A2DA  69 00              adc    #high(2)
       07:A2DC  85 01              sta    <__stack+1
       07:A2DE  68                 pla
 1751                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A2DF  86 0B              stx    <__ptr
       07:A2E1  85 0C              sta    <__ptr+1
       07:A2E3  B2 0B              lda    [__ptr]
       07:A2E5  AA                 tax
       07:A2E6  62                 cla
                          ;        bpl    .x_02323   ; signed
                          ;        dec    A
                          ;.x_02323:
 1752  07:A2E7            LL90:
 1753                     
 1754                             __boolw
       07:A2E7  86 03              stx    <__temp
       07:A2E9  05 03              ora    <__temp
       07:A2EB  82                 clx
       07:A2EC  F0 01              beq    .x02324
       07:A2EE  E8                 inx
       07:A2EF  62        .x02324     cla
 1755                             __tstw
                                   ; pha
       07:A2F0  86 03              stx    <__temp
       07:A2F2  05 03              ora    <__temp
                                   ; pla
 1756                             __lbeq  LL89
       07:A2F4  D0 03              bne    .x02326
       07:A2F6  4C 25 A5           jmp    LL89
       07:A2F9            .x02326
 1757                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A2F9  A0 00              ldy    #0
       07:A2FB  B1 00              lda    [__sp],Y
       07:A2FD  AA                 tax
       07:A2FE  62                 cla
                          ;        bpl    .x_02327   ; signed
                          ;        dec    A
                          ;.x_02327:
                                  .else
                                  .endif
 1758                             __andwi 128
       07:A2FF  22                 sax
       07:A300  29 80              and    #low(128)
       07:A302  22                 sax
       07:A303  29 00              and    #high(128)
 1759                             __tstw
                                   ; pha
       07:A305  86 03              stx    <__temp
       07:A307  05 03              ora    <__temp
                                   ; pla
 1760                             __lbeq  LL91
       07:A309  D0 03              bne    .x02330
       07:A30B  4C DA A3           jmp    LL91
       07:A30E            .x02330
 1761                             __ldwi  _noise_freq
       07:A30E  A2 28              ldx    #low(_noise_freq)
       07:A310  A9 2A              lda    #high(_noise_freq)
 1762                             __pushw
                                 __submi  2,__stack
       07:A312  48                 pha
       07:A313  38                 sec
       07:A314  A5 00              lda    <__stack
       07:A316  E9 02              sbc    #low(2)
       07:A318  85 00              sta    <__stack
       07:A31A  A5 01              lda    <__stack+1
       07:A31C  E9 00              sbc    #high(2)
       07:A31E  85 01              sta    <__stack+1
       07:A320  68                 pla
       07:A321  22                 sax
       07:A322  92 00              sta    [__stack]
       07:A324  22                 sax
       07:A325  A0 01              ldy    #1
       07:A327  91 00              sta    [__stack],Y
 1763                             __ldw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (3 = 0)
                                   .else
       07:A329  A0 03               ldy   #3
       07:A32B  B1 00               lda   [__sp],Y
       07:A32D  AA                  tax
       07:A32E  C8                  iny
       07:A32F  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1764                             __subwi 4
       07:A331  38                 sec
       07:A332  22                 sax
       07:A333  E9 04              sbc    #low(4)
       07:A335  22                 sax
       07:A336  E9 00              sbc    #high(4)
 1765                             __addws
       07:A338  22                 sax
       07:A339  18                 clc
       07:A33A  72 00              adc    [__stack]
       07:A33C  22                 sax
       07:A33D  A0 01              ldy    #1
       07:A33F  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A341  48                 pha
       07:A342  18                 clc
       07:A343  A5 00              lda    <__stack
       07:A345  69 02              adc    #low(2)
       07:A347  85 00              sta    <__stack
       07:A349  A5 01              lda    <__stack+1
       07:A34B  69 00              adc    #high(2)
       07:A34D  85 01              sta    <__stack+1
       07:A34F  68                 pla
 1766                             __pushw
                                 __submi  2,__stack
       07:A350  48                 pha
       07:A351  38                 sec
       07:A352  A5 00              lda    <__stack
       07:A354  E9 02              sbc    #low(2)
       07:A356  85 00              sta    <__stack
       07:A358  A5 01              lda    <__stack+1
       07:A35A  E9 00              sbc    #high(2)
       07:A35C  85 01              sta    <__stack+1
       07:A35E  68                 pla
       07:A35F  22                 sax
       07:A360  92 00              sta    [__stack]
       07:A362  22                 sax
       07:A363  A0 01              ldy    #1
       07:A365  91 00              sta    [__stack],Y
 1767                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A367  86 0B              stx    <__ptr
       07:A369  85 0C              sta    <__ptr+1
       07:A36B  B2 0B              lda    [__ptr]
       07:A36D  AA                 tax
       07:A36E  62                 cla
                          ;        bpl    .x_02340   ; signed
                          ;        dec    A
                          ;.x_02340:
 1768                             __pushw
                                 __submi  2,__stack
       07:A36F  48                 pha
       07:A370  38                 sec
       07:A371  A5 00              lda    <__stack
       07:A373  E9 02              sbc    #low(2)
       07:A375  85 00              sta    <__stack
       07:A377  A5 01              lda    <__stack+1
       07:A379  E9 00              sbc    #high(2)
       07:A37B  85 01              sta    <__stack+1
       07:A37D  68                 pla
       07:A37E  22                 sax
       07:A37F  92 00              sta    [__stack]
       07:A381  22                 sax
       07:A382  A0 01              ldy    #1
       07:A384  91 00              sta    [__stack],Y
 1769                             __ldb_s 4
                0001              .if (4 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A386  A0 04              ldy    #4
       07:A388  B1 00              lda    [__sp],Y
       07:A38A  AA                 tax
       07:A38B  62                 cla
                          ;        bpl    .x_02343   ; signed
                          ;        dec    A
                          ;.x_02343:
                                  .else
                                  .endif
 1770                             __andwi 127
       07:A38C  22                 sax
       07:A38D  29 7F              and    #low(127)
       07:A38F  22                 sax
       07:A390  29 00              and    #high(127)
 1771                             __subws
       07:A392  86 03             stx     <__temp
       07:A394  85 04             sta     <__temp+1
       07:A396  38                sec
       07:A397  B2 00             lda     [__stack]
       07:A399  E5 03             sbc     <__temp
       07:A39B  AA                tax
       07:A39C  A0 01             ldy     #1
       07:A39E  B1 00             lda     [__stack],Y
       07:A3A0  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       07:A3A2  48                 pha
       07:A3A3  18                 clc
       07:A3A4  A5 00              lda    <__stack
       07:A3A6  69 02              adc    #low(2)
       07:A3A8  85 00              sta    <__stack
       07:A3AA  A5 01              lda    <__stack+1
       07:A3AC  69 00              adc    #high(2)
       07:A3AE  85 01              sta    <__stack+1
       07:A3B0  68                 pla
 1772                             __stbps
                                 __stw    <__temp
       07:A3B1  86 03              stx    <__temp
       07:A3B3  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A3B5  B2 00              lda    [__stack]
       07:A3B7  AA                 tax
       07:A3B8  A0 01              ldy    #1
       07:A3BA  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A3BC  86 0B              stx    <__ptr
       07:A3BE  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A3C0  A6 03              ldx    <__temp
       07:A3C2  A5 04              lda    <__temp+1
                                  .endif
       07:A3C4  22                 sax
       07:A3C5  92 0B              sta    [__ptr]
       07:A3C7  22                 sax
                                 __addmi  2,__stack
       07:A3C8  48                 pha
       07:A3C9  18                 clc
       07:A3CA  A5 00              lda    <__stack
       07:A3CC  69 02              adc    #low(2)
       07:A3CE  85 00              sta    <__stack
       07:A3D0  A5 01              lda    <__stack+1
       07:A3D2  69 00              adc    #high(2)
       07:A3D4  85 01              sta    <__stack+1
       07:A3D6  68                 pla
 1773                             __lbra  LL92
       07:A3D7  4C 96 A4           jmp    LL92
 1774  07:A3DA            LL91:
 1775                     
 1776                             __ldwi  _noise_freq
       07:A3DA  A2 28              ldx    #low(_noise_freq)
       07:A3DC  A9 2A              lda    #high(_noise_freq)
 1777                             __pushw
                                 __submi  2,__stack
       07:A3DE  48                 pha
       07:A3DF  38                 sec
       07:A3E0  A5 00              lda    <__stack
       07:A3E2  E9 02              sbc    #low(2)
       07:A3E4  85 00              sta    <__stack
       07:A3E6  A5 01              lda    <__stack+1
       07:A3E8  E9 00              sbc    #high(2)
       07:A3EA  85 01              sta    <__stack+1
       07:A3EC  68                 pla
       07:A3ED  22                 sax
       07:A3EE  92 00              sta    [__stack]
       07:A3F0  22                 sax
       07:A3F1  A0 01              ldy    #1
       07:A3F3  91 00              sta    [__stack],Y
 1778                             __ldw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (3 = 0)
                                   .else
       07:A3F5  A0 03               ldy   #3
       07:A3F7  B1 00               lda   [__sp],Y
       07:A3F9  AA                  tax
       07:A3FA  C8                  iny
       07:A3FB  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1779                             __subwi 4
       07:A3FD  38                 sec
       07:A3FE  22                 sax
       07:A3FF  E9 04              sbc    #low(4)
       07:A401  22                 sax
       07:A402  E9 00              sbc    #high(4)
 1780                             __addws
       07:A404  22                 sax
       07:A405  18                 clc
       07:A406  72 00              adc    [__stack]
       07:A408  22                 sax
       07:A409  A0 01              ldy    #1
       07:A40B  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A40D  48                 pha
       07:A40E  18                 clc
       07:A40F  A5 00              lda    <__stack
       07:A411  69 02              adc    #low(2)
       07:A413  85 00              sta    <__stack
       07:A415  A5 01              lda    <__stack+1
       07:A417  69 00              adc    #high(2)
       07:A419  85 01              sta    <__stack+1
       07:A41B  68                 pla
 1781                             __pushw
                                 __submi  2,__stack
       07:A41C  48                 pha
       07:A41D  38                 sec
       07:A41E  A5 00              lda    <__stack
       07:A420  E9 02              sbc    #low(2)
       07:A422  85 00              sta    <__stack
       07:A424  A5 01              lda    <__stack+1
       07:A426  E9 00              sbc    #high(2)
       07:A428  85 01              sta    <__stack+1
       07:A42A  68                 pla
       07:A42B  22                 sax
       07:A42C  92 00              sta    [__stack]
       07:A42E  22                 sax
       07:A42F  A0 01              ldy    #1
       07:A431  91 00              sta    [__stack],Y
 1782                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A433  86 0B              stx    <__ptr
       07:A435  85 0C              sta    <__ptr+1
       07:A437  B2 0B              lda    [__ptr]
       07:A439  AA                 tax
       07:A43A  62                 cla
                          ;        bpl    .x_02363   ; signed
                          ;        dec    A
                          ;.x_02363:
 1783                             __pushw
                                 __submi  2,__stack
       07:A43B  48                 pha
       07:A43C  38                 sec
       07:A43D  A5 00              lda    <__stack
       07:A43F  E9 02              sbc    #low(2)
       07:A441  85 00              sta    <__stack
       07:A443  A5 01              lda    <__stack+1
       07:A445  E9 00              sbc    #high(2)
       07:A447  85 01              sta    <__stack+1
       07:A449  68                 pla
       07:A44A  22                 sax
       07:A44B  92 00              sta    [__stack]
       07:A44D  22                 sax
       07:A44E  A0 01              ldy    #1
       07:A450  91 00              sta    [__stack],Y
 1784                             __ldb_s 4
                0001              .if (4 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A452  A0 04              ldy    #4
       07:A454  B1 00              lda    [__sp],Y
       07:A456  AA                 tax
       07:A457  62                 cla
                          ;        bpl    .x_02366   ; signed
                          ;        dec    A
                          ;.x_02366:
                                  .else
                                  .endif
 1785                             __addws
       07:A458  22                 sax
       07:A459  18                 clc
       07:A45A  72 00              adc    [__stack]
       07:A45C  22                 sax
       07:A45D  A0 01              ldy    #1
       07:A45F  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A461  48                 pha
       07:A462  18                 clc
       07:A463  A5 00              lda    <__stack
       07:A465  69 02              adc    #low(2)
       07:A467  85 00              sta    <__stack
       07:A469  A5 01              lda    <__stack+1
       07:A46B  69 00              adc    #high(2)
       07:A46D  85 01              sta    <__stack+1
       07:A46F  68                 pla
 1786                             __stbps
                                 __stw    <__temp
       07:A470  86 03              stx    <__temp
       07:A472  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A474  B2 00              lda    [__stack]
       07:A476  AA                 tax
       07:A477  A0 01              ldy    #1
       07:A479  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A47B  86 0B              stx    <__ptr
       07:A47D  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A47F  A6 03              ldx    <__temp
       07:A481  A5 04              lda    <__temp+1
                                  .endif
       07:A483  22                 sax
       07:A484  92 0B              sta    [__ptr]
       07:A486  22                 sax
                                 __addmi  2,__stack
       07:A487  48                 pha
       07:A488  18                 clc
       07:A489  A5 00              lda    <__stack
       07:A48B  69 02              adc    #low(2)
       07:A48D  85 00              sta    <__stack
       07:A48F  A5 01              lda    <__stack+1
       07:A491  69 00              adc    #high(2)
       07:A493  85 01              sta    <__stack+1
       07:A495  68                 pla
 1787  07:A496            LL92:
 1788                     
 1789                             __ldwi  2055
       07:A496  A2 07              ldx    #low(2055)
       07:A498  A9 08              lda    #high(2055)
 1790                             __stw   _bx
       07:A49A  8E FA 20           stx    _bx
       07:A49D  8D FB 20           sta    _bx+1
 1791                             __ldwi  128
       07:A4A0  A2 80              ldx    #low(128)
       07:A4A2  A9 00              lda    #high(128)
 1792                             __pushw
                                 __submi  2,__stack
       07:A4A4  48                 pha
       07:A4A5  38                 sec
       07:A4A6  A5 00              lda    <__stack
       07:A4A8  E9 02              sbc    #low(2)
       07:A4AA  85 00              sta    <__stack
       07:A4AC  A5 01              lda    <__stack+1
       07:A4AE  E9 00              sbc    #high(2)
       07:A4B0  85 01              sta    <__stack+1
       07:A4B2  68                 pla
       07:A4B3  22                 sax
       07:A4B4  92 00              sta    [__stack]
       07:A4B6  22                 sax
       07:A4B7  A0 01              ldy    #1
       07:A4B9  91 00              sta    [__stack],Y
 1793                             __ldwi  _noise_freq
       07:A4BB  A2 28              ldx    #low(_noise_freq)
       07:A4BD  A9 2A              lda    #high(_noise_freq)
 1794                             __pushw
                                 __submi  2,__stack
       07:A4BF  48                 pha
       07:A4C0  38                 sec
       07:A4C1  A5 00              lda    <__stack
       07:A4C3  E9 02              sbc    #low(2)
       07:A4C5  85 00              sta    <__stack
       07:A4C7  A5 01              lda    <__stack+1
       07:A4C9  E9 00              sbc    #high(2)
       07:A4CB  85 01              sta    <__stack+1
       07:A4CD  68                 pla
       07:A4CE  22                 sax
       07:A4CF  92 00              sta    [__stack]
       07:A4D1  22                 sax
       07:A4D2  A0 01              ldy    #1
       07:A4D4  91 00              sta    [__stack],Y
 1795                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       07:A4D6  A0 05               ldy   #5
       07:A4D8  B1 00               lda   [__sp],Y
       07:A4DA  AA                  tax
       07:A4DB  C8                  iny
       07:A4DC  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1796                             __subwi 4
       07:A4DE  38                 sec
       07:A4DF  22                 sax
       07:A4E0  E9 04              sbc    #low(4)
       07:A4E2  22                 sax
       07:A4E3  E9 00              sbc    #high(4)
 1797                             __addws
       07:A4E5  22                 sax
       07:A4E6  18                 clc
       07:A4E7  72 00              adc    [__stack]
       07:A4E9  22                 sax
       07:A4EA  A0 01              ldy    #1
       07:A4EC  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A4EE  48                 pha
       07:A4EF  18                 clc
       07:A4F0  A5 00              lda    <__stack
       07:A4F2  69 02              adc    #low(2)
       07:A4F4  85 00              sta    <__stack
       07:A4F6  A5 01              lda    <__stack+1
       07:A4F8  69 00              adc    #high(2)
       07:A4FA  85 01              sta    <__stack+1
       07:A4FC  68                 pla
 1798                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A4FD  86 0B              stx    <__ptr
       07:A4FF  85 0C              sta    <__ptr+1
       07:A501  B2 0B              lda    [__ptr]
       07:A503  AA                 tax
       07:A504  62                 cla
                          ;        bpl    .x_02387   ; signed
                          ;        dec    A
                          ;.x_02387:
 1799                             __andwi 31
       07:A505  22                 sax
       07:A506  29 1F              and    #low(31)
       07:A508  22                 sax
       07:A509  29 00              and    #high(31)
 1800                             __orws
       07:A50B  22                 sax
       07:A50C  12 00              ora    [__stack]
       07:A50E  22                 sax
       07:A50F  A0 01              ldy    #1
       07:A511  11 00              ora    [__stack],Y
                                 __addmi  2,__stack
       07:A513  48                 pha
       07:A514  18                 clc
       07:A515  A5 00              lda    <__stack
       07:A517  69 02              adc    #low(2)
       07:A519  85 00              sta    <__stack
       07:A51B  A5 01              lda    <__stack+1
       07:A51D  69 00              adc    #high(2)
       07:A51F  85 01              sta    <__stack+1
       07:A521  68                 pla
 1801  07:A522  20 A4 FB            call  _poke.2
 1802  07:A525            LL89:
 1803                     
 1804                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A525  A0 00              ldy    #0
       07:A527  B1 00              lda    [__sp],Y
       07:A529  AA                 tax
       07:A52A  62                 cla
                          ;        bpl    .x_02391   ; signed
                          ;        dec    A
                          ;.x_02391:
                                  .else
                                  .endif
 1805                             __andwi 128
       07:A52B  22                 sax
       07:A52C  29 80              and    #low(128)
       07:A52E  22                 sax
       07:A52F  29 00              and    #high(128)
 1806                             __tstw
                                   ; pha
       07:A531  86 03              stx    <__temp
       07:A533  05 03              ora    <__temp
                                   ; pla
 1807                             __lbeq  LL93
       07:A535  D0 03              bne    .x02394
       07:A537  4C E0 A5           jmp    LL93
       07:A53A            .x02394
 1808                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A53A  A0 01               ldy   #1
       07:A53C  B1 00               lda   [__sp],Y
       07:A53E  AA                  tax
       07:A53F  C8                  iny
       07:A540  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1809                             __aslw
       07:A542  22                 sax
       07:A543  0A                 asl    A
       07:A544  22                 sax
       07:A545  2A                 rol    A
 1810                             __addwi _seq_freq
       07:A546  18                 clc
       07:A547  22                 sax
       07:A548  69 E4              adc    #low(_seq_freq)
       07:A54A  22                 sax
       07:A54B  69 29              adc    #high(_seq_freq)
 1811                             __pushw
                                 __submi  2,__stack
       07:A54D  48                 pha
       07:A54E  38                 sec
       07:A54F  A5 00              lda    <__stack
       07:A551  E9 02              sbc    #low(2)
       07:A553  85 00              sta    <__stack
       07:A555  A5 01              lda    <__stack+1
       07:A557  E9 00              sbc    #high(2)
       07:A559  85 01              sta    <__stack+1
       07:A55B  68                 pla
       07:A55C  22                 sax
       07:A55D  92 00              sta    [__stack]
       07:A55F  22                 sax
       07:A560  A0 01              ldy    #1
       07:A562  91 00              sta    [__stack],Y
 1812                             __stw   __ptr
       07:A564  8E 0B 20           stx    __ptr
       07:A567  8D 0C 20           sta    __ptr+1
 1813                             __ldwp  __ptr
       07:A56A  B2 0B              lda    [__ptr]
       07:A56C  AA                 tax
       07:A56D  A0 01              ldy    #1
       07:A56F  B1 0B              lda    [__ptr],Y
 1814                             __pushw
                                 __submi  2,__stack
       07:A571  48                 pha
       07:A572  38                 sec
       07:A573  A5 00              lda    <__stack
       07:A575  E9 02              sbc    #low(2)
       07:A577  85 00              sta    <__stack
       07:A579  A5 01              lda    <__stack+1
       07:A57B  E9 00              sbc    #high(2)
       07:A57D  85 01              sta    <__stack+1
       07:A57F  68                 pla
       07:A580  22                 sax
       07:A581  92 00              sta    [__stack]
       07:A583  22                 sax
       07:A584  A0 01              ldy    #1
       07:A586  91 00              sta    [__stack],Y
 1815                             __ldb_s 4
                0001              .if (4 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A588  A0 04              ldy    #4
       07:A58A  B1 00              lda    [__sp],Y
       07:A58C  AA                 tax
       07:A58D  62                 cla
                          ;        bpl    .x_02404   ; signed
                          ;        dec    A
                          ;.x_02404:
                                  .else
                                  .endif
 1816                             __andwi 127
       07:A58E  22                 sax
       07:A58F  29 7F              and    #low(127)
       07:A591  22                 sax
       07:A592  29 00              and    #high(127)
 1817                             __subws
       07:A594  86 03             stx     <__temp
       07:A596  85 04             sta     <__temp+1
       07:A598  38                sec
       07:A599  B2 00             lda     [__stack]
       07:A59B  E5 03             sbc     <__temp
       07:A59D  AA                tax
       07:A59E  A0 01             ldy     #1
       07:A5A0  B1 00             lda     [__stack],Y
       07:A5A2  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       07:A5A4  48                 pha
       07:A5A5  18                 clc
       07:A5A6  A5 00              lda    <__stack
       07:A5A8  69 02              adc    #low(2)
       07:A5AA  85 00              sta    <__stack
       07:A5AC  A5 01              lda    <__stack+1
       07:A5AE  69 00              adc    #high(2)
       07:A5B0  85 01              sta    <__stack+1
       07:A5B2  68                 pla
 1818                             __stwps
                                 __stw    <__temp
       07:A5B3  86 03              stx    <__temp
       07:A5B5  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A5B7  B2 00              lda    [__stack]
       07:A5B9  AA                 tax
       07:A5BA  A0 01              ldy    #1
       07:A5BC  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A5BE  86 0B              stx    <__ptr
       07:A5C0  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A5C2  A6 03              ldx    <__temp
       07:A5C4  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:A5C6  22                 sax
       07:A5C7  92 0B              sta    [__ptr]
       07:A5C9  22                 sax
       07:A5CA  A0 01              ldy    #1
       07:A5CC  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:A5CE  48                 pha
       07:A5CF  18                 clc
       07:A5D0  A5 00              lda    <__stack
       07:A5D2  69 02              adc    #low(2)
       07:A5D4  85 00              sta    <__stack
       07:A5D6  A5 01              lda    <__stack+1
       07:A5D8  69 00              adc    #high(2)
       07:A5DA  85 01              sta    <__stack+1
       07:A5DC  68                 pla
 1819                             __lbra  LL94
       07:A5DD  4C 76 A6           jmp    LL94
 1820  07:A5E0            LL93:
 1821                     
 1822                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A5E0  A0 01               ldy   #1
       07:A5E2  B1 00               lda   [__sp],Y
       07:A5E4  AA                  tax
       07:A5E5  C8                  iny
       07:A5E6  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1823                             __aslw
       07:A5E8  22                 sax
       07:A5E9  0A                 asl    A
       07:A5EA  22                 sax
       07:A5EB  2A                 rol    A
 1824                             __addwi _seq_freq
       07:A5EC  18                 clc
       07:A5ED  22                 sax
       07:A5EE  69 E4              adc    #low(_seq_freq)
       07:A5F0  22                 sax
       07:A5F1  69 29              adc    #high(_seq_freq)
 1825                             __pushw
                                 __submi  2,__stack
       07:A5F3  48                 pha
       07:A5F4  38                 sec
       07:A5F5  A5 00              lda    <__stack
       07:A5F7  E9 02              sbc    #low(2)
       07:A5F9  85 00              sta    <__stack
       07:A5FB  A5 01              lda    <__stack+1
       07:A5FD  E9 00              sbc    #high(2)
       07:A5FF  85 01              sta    <__stack+1
       07:A601  68                 pla
       07:A602  22                 sax
       07:A603  92 00              sta    [__stack]
       07:A605  22                 sax
       07:A606  A0 01              ldy    #1
       07:A608  91 00              sta    [__stack],Y
 1826                             __stw   __ptr
       07:A60A  8E 0B 20           stx    __ptr
       07:A60D  8D 0C 20           sta    __ptr+1
 1827                             __ldwp  __ptr
       07:A610  B2 0B              lda    [__ptr]
       07:A612  AA                 tax
       07:A613  A0 01              ldy    #1
       07:A615  B1 0B              lda    [__ptr],Y
 1828                             __pushw
                                 __submi  2,__stack
       07:A617  48                 pha
       07:A618  38                 sec
       07:A619  A5 00              lda    <__stack
       07:A61B  E9 02              sbc    #low(2)
       07:A61D  85 00              sta    <__stack
       07:A61F  A5 01              lda    <__stack+1
       07:A621  E9 00              sbc    #high(2)
       07:A623  85 01              sta    <__stack+1
       07:A625  68                 pla
       07:A626  22                 sax
       07:A627  92 00              sta    [__stack]
       07:A629  22                 sax
       07:A62A  A0 01              ldy    #1
       07:A62C  91 00              sta    [__stack],Y
 1829                             __ldb_s 4
                0001              .if (4 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       07:A62E  A0 04              ldy    #4
       07:A630  B1 00              lda    [__sp],Y
       07:A632  AA                 tax
       07:A633  62                 cla
                          ;        bpl    .x_02425   ; signed
                          ;        dec    A
                          ;.x_02425:
                                  .else
                                  .endif
 1830                             __addws
       07:A634  22                 sax
       07:A635  18                 clc
       07:A636  72 00              adc    [__stack]
       07:A638  22                 sax
       07:A639  A0 01              ldy    #1
       07:A63B  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A63D  48                 pha
       07:A63E  18                 clc
       07:A63F  A5 00              lda    <__stack
       07:A641  69 02              adc    #low(2)
       07:A643  85 00              sta    <__stack
       07:A645  A5 01              lda    <__stack+1
       07:A647  69 00              adc    #high(2)
       07:A649  85 01              sta    <__stack+1
       07:A64B  68                 pla
 1831                             __stwps
                                 __stw    <__temp
       07:A64C  86 03              stx    <__temp
       07:A64E  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:A650  B2 00              lda    [__stack]
       07:A652  AA                 tax
       07:A653  A0 01              ldy    #1
       07:A655  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:A657  86 0B              stx    <__ptr
       07:A659  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:A65B  A6 03              ldx    <__temp
       07:A65D  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:A65F  22                 sax
       07:A660  92 0B              sta    [__ptr]
       07:A662  22                 sax
       07:A663  A0 01              ldy    #1
       07:A665  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:A667  48                 pha
       07:A668  18                 clc
       07:A669  A5 00              lda    <__stack
       07:A66B  69 02              adc    #low(2)
       07:A66D  85 00              sta    <__stack
       07:A66F  A5 01              lda    <__stack+1
       07:A671  69 00              adc    #high(2)
       07:A673  85 01              sta    <__stack+1
       07:A675  68                 pla
 1832  07:A676            LL94:
 1833                     
 1834                             __ldwi  2051
       07:A676  A2 03              ldx    #low(2051)
       07:A678  A9 08              lda    #high(2051)
 1835                             __stw   _bx
       07:A67A  8E FA 20           stx    _bx
       07:A67D  8D FB 20           sta    _bx+1
 1836                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A680  A0 01               ldy   #1
       07:A682  B1 00               lda   [__sp],Y
       07:A684  AA                  tax
       07:A685  C8                  iny
       07:A686  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1837                             __aslw
       07:A688  22                 sax
       07:A689  0A                 asl    A
       07:A68A  22                 sax
       07:A68B  2A                 rol    A
 1838                             __addwi _seq_freq
       07:A68C  18                 clc
       07:A68D  22                 sax
       07:A68E  69 E4              adc    #low(_seq_freq)
       07:A690  22                 sax
       07:A691  69 29              adc    #high(_seq_freq)
 1839                             __stw   __ptr
       07:A693  8E 0B 20           stx    __ptr
       07:A696  8D 0C 20           sta    __ptr+1
 1840                             __ldwp  __ptr
       07:A699  B2 0B              lda    [__ptr]
       07:A69B  AA                 tax
       07:A69C  A0 01              ldy    #1
       07:A69E  B1 0B              lda    [__ptr],Y
 1841                             __pushw
                                 __submi  2,__stack
       07:A6A0  48                 pha
       07:A6A1  38                 sec
       07:A6A2  A5 00              lda    <__stack
       07:A6A4  E9 02              sbc    #low(2)
       07:A6A6  85 00              sta    <__stack
       07:A6A8  A5 01              lda    <__stack+1
       07:A6AA  E9 00              sbc    #high(2)
       07:A6AC  85 01              sta    <__stack+1
       07:A6AE  68                 pla
       07:A6AF  22                 sax
       07:A6B0  92 00              sta    [__stack]
       07:A6B2  22                 sax
       07:A6B3  A0 01              ldy    #1
       07:A6B5  91 00              sta    [__stack],Y
 1842                             __ldwi  8
       07:A6B7  A2 08              ldx    #low(8)
       07:A6B9  A9 00              lda    #high(8)
 1843  07:A6BB  20 89 EA            jsr   asr
 1844                             __andwi 15
       07:A6BE  22                 sax
       07:A6BF  29 0F              and    #low(15)
       07:A6C1  22                 sax
       07:A6C2  29 00              and    #high(15)
 1845  07:A6C4  20 A4 FB            call  _poke.2
 1846                             __ldwi  2050
       07:A6C7  A2 02              ldx    #low(2050)
       07:A6C9  A9 08              lda    #high(2050)
 1847                             __stw   _bx
       07:A6CB  8E FA 20           stx    _bx
       07:A6CE  8D FB 20           sta    _bx+1
 1848                             __ldw_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (1 = 0)
                                   .else
       07:A6D1  A0 01               ldy   #1
       07:A6D3  B1 00               lda   [__sp],Y
       07:A6D5  AA                  tax
       07:A6D6  C8                  iny
       07:A6D7  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1849                             __aslw
       07:A6D9  22                 sax
       07:A6DA  0A                 asl    A
       07:A6DB  22                 sax
       07:A6DC  2A                 rol    A
 1850                             __addwi _seq_freq
       07:A6DD  18                 clc
       07:A6DE  22                 sax
       07:A6DF  69 E4              adc    #low(_seq_freq)
       07:A6E1  22                 sax
       07:A6E2  69 29              adc    #high(_seq_freq)
 1851                             __stw   __ptr
       07:A6E4  8E 0B 20           stx    __ptr
       07:A6E7  8D 0C 20           sta    __ptr+1
 1852                             __ldwp  __ptr
       07:A6EA  B2 0B              lda    [__ptr]
       07:A6EC  AA                 tax
       07:A6ED  A0 01              ldy    #1
       07:A6EF  B1 0B              lda    [__ptr],Y
 1853                             __andwi 255
       07:A6F1  22                 sax
       07:A6F2  29 FF              and    #low(255)
       07:A6F4  22                 sax
       07:A6F5  29 00              and    #high(255)
 1854  07:A6F7  20 A4 FB            call  _poke.2
 1855  07:A6FA            LL87:
 1856                     
 1857  07:A6FA            LL86:
 1858                     
 1859                             __addmi 3,__stack
       07:A6FA  48                 pha
       07:A6FB  18                 clc
       07:A6FC  A5 00              lda    <__stack
       07:A6FE  69 03              adc    #low(3)
       07:A700  85 00              sta    <__stack
       07:A702  A5 01              lda    <__stack+1
       07:A704  69 00              adc    #high(3)
       07:A706  85 01              sta    <__stack+1
       07:A708  68                 pla
 1860  07:A709  60                  rts
 1861                             .endp
 1862                     
 1863  07:470A                    .proc _drv_lfoseq
 1864                             __pushw
                                 __submi  2,__stack
       07:A70A  48                 pha
       07:A70B  38                 sec
       07:A70C  A5 00              lda    <__stack
       07:A70E  E9 02              sbc    #low(2)
       07:A710  85 00              sta    <__stack
       07:A712  A5 01              lda    <__stack+1
       07:A714  E9 00              sbc    #high(2)
       07:A716  85 01              sta    <__stack+1
       07:A718  68                 pla
       07:A719  22                 sax
       07:A71A  92 00              sta    [__stack]
       07:A71C  22                 sax
       07:A71D  A0 01              ldy    #1
       07:A71F  91 00              sta    [__stack],Y
 1865                             __addmi -2,__stack
       07:A721  48                 pha
       07:A722  18                 clc
       07:A723  A5 00              lda    <__stack
       07:A725  69 FE              adc    #low(-2)
       07:A727  85 00              sta    <__stack
       07:A729  A5 01              lda    <__stack+1
       07:A72B  69 FF              adc    #high(-2)
       07:A72D  85 01              sta    <__stack+1
       07:A72F  68                 pla
 1866                             __ldwi  _lfo_num
       07:A730  A2 2C              ldx    #low(_lfo_num)
       07:A732  A9 2A              lda    #high(_lfo_num)
 1867                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A734  A0 02              ldy    #2
       07:A736  18                 clc
       07:A737  22                 sax
       07:A738  71 00              adc    [__sp],Y
       07:A73A  22                 sax
       07:A73B  C8                 iny
       07:A73C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1868                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A73E  86 0B              stx    <__ptr
       07:A740  85 0C              sta    <__ptr+1
       07:A742  B2 0B              lda    [__ptr]
       07:A744  AA                 tax
       07:A745  62                 cla
                          ;        bpl    .x_02460   ; signed
                          ;        dec    A
                          ;.x_02460:
 1869                             __stw   <__temp
       07:A746  86 03              stx    <__temp
       07:A748  85 04              sta    <__temp+1
 1870                             __ldwi  255
       07:A74A  A2 FF              ldx    #low(255)
       07:A74C  A9 00              lda    #high(255)
 1871  07:A74E  20 39 EA            jsr   nezp
 1872                             __lbeq  LL96
       07:A751  D0 03              bne    .x02463
       07:A753  4C 77 B9           jmp    LL96
       07:A756            .x02463
 1873                             __ldwi  _sound_dat
       07:A756  A2 00              ldx    #low(_sound_dat)
       07:A758  A9 44              lda    #high(_sound_dat)
 1874                             __addwi 12
       07:A75A  18                 clc
       07:A75B  22                 sax
       07:A75C  69 0C              adc    #low(12)
       07:A75E  22                 sax
       07:A75F  69 00              adc    #high(12)
 1875                             __stw   __ptr
       07:A761  8E 0B 20           stx    __ptr
       07:A764  8D 0C 20           sta    __ptr+1
 1876                             __ldwp  __ptr
       07:A767  B2 0B              lda    [__ptr]
       07:A769  AA                 tax
       07:A76A  A0 01              ldy    #1
       07:A76C  B1 0B              lda    [__ptr],Y
 1877                             __pushw
                                 __submi  2,__stack
       07:A76E  48                 pha
       07:A76F  38                 sec
       07:A770  A5 00              lda    <__stack
       07:A772  E9 02              sbc    #low(2)
       07:A774  85 00              sta    <__stack
       07:A776  A5 01              lda    <__stack+1
       07:A778  E9 00              sbc    #high(2)
       07:A77A  85 01              sta    <__stack+1
       07:A77C  68                 pla
       07:A77D  22                 sax
       07:A77E  92 00              sta    [__stack]
       07:A780  22                 sax
       07:A781  A0 01              ldy    #1
       07:A783  91 00              sta    [__stack],Y
 1878                             __ldwi  _lfo_num
       07:A785  A2 2C              ldx    #low(_lfo_num)
       07:A787  A9 2A              lda    #high(_lfo_num)
 1879                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A789  A0 04              ldy    #4
       07:A78B  18                 clc
       07:A78C  22                 sax
       07:A78D  71 00              adc    [__sp],Y
       07:A78F  22                 sax
       07:A790  C8                 iny
       07:A791  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1880                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A793  86 0B              stx    <__ptr
       07:A795  85 0C              sta    <__ptr+1
       07:A797  B2 0B              lda    [__ptr]
       07:A799  AA                 tax
       07:A79A  62                 cla
                          ;        bpl    .x_02472   ; signed
                          ;        dec    A
                          ;.x_02472:
 1881                             __pushw
                                 __submi  2,__stack
       07:A79B  48                 pha
       07:A79C  38                 sec
       07:A79D  A5 00              lda    <__stack
       07:A79F  E9 02              sbc    #low(2)
       07:A7A1  85 00              sta    <__stack
       07:A7A3  A5 01              lda    <__stack+1
       07:A7A5  E9 00              sbc    #high(2)
       07:A7A7  85 01              sta    <__stack+1
       07:A7A9  68                 pla
       07:A7AA  22                 sax
       07:A7AB  92 00              sta    [__stack]
       07:A7AD  22                 sax
       07:A7AE  A0 01              ldy    #1
       07:A7B0  91 00              sta    [__stack],Y
 1882                             __ldwi  2
       07:A7B2  A2 02              ldx    #low(2)
       07:A7B4  A9 00              lda    #high(2)
 1883  07:A7B6  20 60 EA            jsr   asl
 1884                             __addws
       07:A7B9  22                 sax
       07:A7BA  18                 clc
       07:A7BB  72 00              adc    [__stack]
       07:A7BD  22                 sax
       07:A7BE  A0 01              ldy    #1
       07:A7C0  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A7C2  48                 pha
       07:A7C3  18                 clc
       07:A7C4  A5 00              lda    <__stack
       07:A7C6  69 02              adc    #low(2)
       07:A7C8  85 00              sta    <__stack
       07:A7CA  A5 01              lda    <__stack+1
       07:A7CC  69 00              adc    #high(2)
       07:A7CE  85 01              sta    <__stack+1
       07:A7D0  68                 pla
 1885                             __stw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       07:A7D1  22                 sax
       07:A7D2  A0 00              ldy    #0
       07:A7D4  91 00              sta    [__sp],Y
       07:A7D6  22                 sax
       07:A7D7  C8                 iny
       07:A7D8  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 1886                             __ldwi  _lfo_lev
       07:A7DA  A2 4C              ldx    #low(_lfo_lev)
       07:A7DC  A9 2A              lda    #high(_lfo_lev)
 1887                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A7DE  A0 02              ldy    #2
       07:A7E0  18                 clc
       07:A7E1  22                 sax
       07:A7E2  71 00              adc    [__sp],Y
       07:A7E4  22                 sax
       07:A7E5  C8                 iny
       07:A7E6  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1888                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A7E8  86 0B              stx    <__ptr
       07:A7EA  85 0C              sta    <__ptr+1
       07:A7EC  B2 0B              lda    [__ptr]
       07:A7EE  AA                 tax
       07:A7EF  62                 cla
                          ;        bpl    .x_02481   ; signed
                          ;        dec    A
                          ;.x_02481:
 1889                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       07:A7F0  A8                 tay
       07:A7F1  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       07:A7F3  18                 clc
       07:A7F4  69 04              adc    #4
                                  .endif
       07:A7F6  85 02              sta    <__arg_idx
       07:A7F8  42                 say
                                  .else
                                  .endif
                          
       07:A7F9  99 60 2A           sta    __arg-(4),Y
       07:A7FC  8A                 txa
       07:A7FD  99 61 2A           sta    __arg-(4-1),Y
 1890                             __ldwi  2
       07:A800  A2 02              ldx    #low(2)
       07:A802  A9 00              lda    #high(2)
 1891                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       07:A804  A4 02              ldy    <__arg_idx
                                  .endif
                          
       07:A806  8A                 txa
       07:A807  99 62 2A           sta    __arg-(2),Y
 1892                             __ldwi  5
       07:A80A  A2 05              ldx    #low(5)
       07:A80C  A9 00              lda    #high(5)
 1893                             __pushw
                                 __submi  2,__stack
       07:A80E  48                 pha
       07:A80F  38                 sec
       07:A810  A5 00              lda    <__stack
       07:A812  E9 02              sbc    #low(2)
       07:A814  85 00              sta    <__stack
       07:A816  A5 01              lda    <__stack+1
       07:A818  E9 00              sbc    #high(2)
       07:A81A  85 01              sta    <__stack+1
       07:A81C  68                 pla
       07:A81D  22                 sax
       07:A81E  92 00              sta    [__stack]
       07:A820  22                 sax
       07:A821  A0 01              ldy    #1
       07:A823  91 00              sta    [__stack],Y
 1894                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       07:A825  A0 04               ldy   #4
       07:A827  B1 00               lda   [__sp],Y
       07:A829  AA                  tax
       07:A82A  C8                  iny
       07:A82B  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1895                             __pushw
                                 __submi  2,__stack
       07:A82D  48                 pha
       07:A82E  38                 sec
       07:A82F  A5 00              lda    <__stack
       07:A831  E9 02              sbc    #low(2)
       07:A833  85 00              sta    <__stack
       07:A835  A5 01              lda    <__stack+1
       07:A837  E9 00              sbc    #high(2)
       07:A839  85 01              sta    <__stack+1
       07:A83B  68                 pla
       07:A83C  22                 sax
       07:A83D  92 00              sta    [__stack]
       07:A83F  22                 sax
       07:A840  A0 01              ldy    #1
       07:A842  91 00              sta    [__stack],Y
 1896                             __ldwi  2
       07:A844  A2 02              ldx    #low(2)
       07:A846  A9 00              lda    #high(2)
 1897  07:A848  20 60 EA            jsr   asl
 1898                             __addws
       07:A84B  22                 sax
       07:A84C  18                 clc
       07:A84D  72 00              adc    [__stack]
       07:A84F  22                 sax
       07:A850  A0 01              ldy    #1
       07:A852  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A854  48                 pha
       07:A855  18                 clc
       07:A856  A5 00              lda    <__stack
       07:A858  69 02              adc    #low(2)
       07:A85A  85 00              sta    <__stack
       07:A85C  A5 01              lda    <__stack+1
       07:A85E  69 00              adc    #high(2)
       07:A860  85 01              sta    <__stack+1
       07:A862  68                 pla
 1899                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       07:A863  A4 02              ldy    <__arg_idx
                                  .endif
                          
       07:A865  8A                 txa
       07:A866  99 63 2A           sta    __arg-(1),Y
 1900                             __ldwi  15
       07:A869  A2 0F              ldx    #low(15)
       07:A86B  A9 00              lda    #high(15)
 1901  07:A86D  20 2F EF            call  _put_hex.4
 1902                             __ldwi  _lfo_cnt
       07:A870  A2 34              ldx    #low(_lfo_cnt)
       07:A872  A9 2A              lda    #high(_lfo_cnt)
 1903                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A874  A0 02              ldy    #2
       07:A876  18                 clc
       07:A877  22                 sax
       07:A878  71 00              adc    [__sp],Y
       07:A87A  22                 sax
       07:A87B  C8                 iny
       07:A87C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1904                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A87E  86 0B              stx    <__ptr
       07:A880  85 0C              sta    <__ptr+1
       07:A882  B2 0B              lda    [__ptr]
       07:A884  AA                 tax
       07:A885  62                 cla
                          ;        bpl    .x_02499   ; signed
                          ;        dec    A
                          ;.x_02499:
 1905                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       07:A886  A8                 tay
       07:A887  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       07:A889  18                 clc
       07:A88A  69 04              adc    #4
                                  .endif
       07:A88C  85 02              sta    <__arg_idx
       07:A88E  42                 say
                                  .else
                                  .endif
                          
       07:A88F  99 60 2A           sta    __arg-(4),Y
       07:A892  8A                 txa
       07:A893  99 61 2A           sta    __arg-(4-1),Y
 1906                             __ldwi  2
       07:A896  A2 02              ldx    #low(2)
       07:A898  A9 00              lda    #high(2)
 1907                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       07:A89A  A4 02              ldy    <__arg_idx
                                  .endif
                          
       07:A89C  8A                 txa
       07:A89D  99 62 2A           sta    __arg-(2),Y
 1908                             __ldwi  5
       07:A8A0  A2 05              ldx    #low(5)
       07:A8A2  A9 00              lda    #high(5)
 1909                             __pushw
                                 __submi  2,__stack
       07:A8A4  48                 pha
       07:A8A5  38                 sec
       07:A8A6  A5 00              lda    <__stack
       07:A8A8  E9 02              sbc    #low(2)
       07:A8AA  85 00              sta    <__stack
       07:A8AC  A5 01              lda    <__stack+1
       07:A8AE  E9 00              sbc    #high(2)
       07:A8B0  85 01              sta    <__stack+1
       07:A8B2  68                 pla
       07:A8B3  22                 sax
       07:A8B4  92 00              sta    [__stack]
       07:A8B6  22                 sax
       07:A8B7  A0 01              ldy    #1
       07:A8B9  91 00              sta    [__stack],Y
 1910                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       07:A8BB  A0 04               ldy   #4
       07:A8BD  B1 00               lda   [__sp],Y
       07:A8BF  AA                  tax
       07:A8C0  C8                  iny
       07:A8C1  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1911                             __pushw
                                 __submi  2,__stack
       07:A8C3  48                 pha
       07:A8C4  38                 sec
       07:A8C5  A5 00              lda    <__stack
       07:A8C7  E9 02              sbc    #low(2)
       07:A8C9  85 00              sta    <__stack
       07:A8CB  A5 01              lda    <__stack+1
       07:A8CD  E9 00              sbc    #high(2)
       07:A8CF  85 01              sta    <__stack+1
       07:A8D1  68                 pla
       07:A8D2  22                 sax
       07:A8D3  92 00              sta    [__stack]
       07:A8D5  22                 sax
       07:A8D6  A0 01              ldy    #1
       07:A8D8  91 00              sta    [__stack],Y
 1912                             __ldwi  2
       07:A8DA  A2 02              ldx    #low(2)
       07:A8DC  A9 00              lda    #high(2)
 1913  07:A8DE  20 60 EA            jsr   asl
 1914                             __addws
       07:A8E1  22                 sax
       07:A8E2  18                 clc
       07:A8E3  72 00              adc    [__stack]
       07:A8E5  22                 sax
       07:A8E6  A0 01              ldy    #1
       07:A8E8  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A8EA  48                 pha
       07:A8EB  18                 clc
       07:A8EC  A5 00              lda    <__stack
       07:A8EE  69 02              adc    #low(2)
       07:A8F0  85 00              sta    <__stack
       07:A8F2  A5 01              lda    <__stack+1
       07:A8F4  69 00              adc    #high(2)
       07:A8F6  85 01              sta    <__stack+1
       07:A8F8  68                 pla
 1915                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       07:A8F9  A4 02              ldy    <__arg_idx
                                  .endif
                          
       07:A8FB  8A                 txa
       07:A8FC  99 63 2A           sta    __arg-(1),Y
 1916                             __ldwi  16
       07:A8FF  A2 10              ldx    #low(16)
       07:A901  A9 00              lda    #high(16)
 1917  07:A903  20 2F EF            call  _put_hex.4
 1918                             __ldwi  _lfo_ct2
       07:A906  A2 3C              ldx    #low(_lfo_ct2)
       07:A908  A9 2A              lda    #high(_lfo_ct2)
 1919                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A90A  A0 02              ldy    #2
       07:A90C  18                 clc
       07:A90D  22                 sax
       07:A90E  71 00              adc    [__sp],Y
       07:A910  22                 sax
       07:A911  C8                 iny
       07:A912  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1920                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A914  86 0B              stx    <__ptr
       07:A916  85 0C              sta    <__ptr+1
       07:A918  B2 0B              lda    [__ptr]
       07:A91A  AA                 tax
       07:A91B  62                 cla
                          ;        bpl    .x_02517   ; signed
                          ;        dec    A
                          ;.x_02517:
 1921                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       07:A91C  A8                 tay
       07:A91D  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       07:A91F  18                 clc
       07:A920  69 04              adc    #4
                                  .endif
       07:A922  85 02              sta    <__arg_idx
       07:A924  42                 say
                                  .else
                                  .endif
                          
       07:A925  99 60 2A           sta    __arg-(4),Y
       07:A928  8A                 txa
       07:A929  99 61 2A           sta    __arg-(4-1),Y
 1922                             __ldwi  2
       07:A92C  A2 02              ldx    #low(2)
       07:A92E  A9 00              lda    #high(2)
 1923                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       07:A930  A4 02              ldy    <__arg_idx
                                  .endif
                          
       07:A932  8A                 txa
       07:A933  99 62 2A           sta    __arg-(2),Y
 1924                             __ldwi  5
       07:A936  A2 05              ldx    #low(5)
       07:A938  A9 00              lda    #high(5)
 1925                             __pushw
                                 __submi  2,__stack
       07:A93A  48                 pha
       07:A93B  38                 sec
       07:A93C  A5 00              lda    <__stack
       07:A93E  E9 02              sbc    #low(2)
       07:A940  85 00              sta    <__stack
       07:A942  A5 01              lda    <__stack+1
       07:A944  E9 00              sbc    #high(2)
       07:A946  85 01              sta    <__stack+1
       07:A948  68                 pla
       07:A949  22                 sax
       07:A94A  92 00              sta    [__stack]
       07:A94C  22                 sax
       07:A94D  A0 01              ldy    #1
       07:A94F  91 00              sta    [__stack],Y
 1926                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       07:A951  A0 04               ldy   #4
       07:A953  B1 00               lda   [__sp],Y
       07:A955  AA                  tax
       07:A956  C8                  iny
       07:A957  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1927                             __pushw
                                 __submi  2,__stack
       07:A959  48                 pha
       07:A95A  38                 sec
       07:A95B  A5 00              lda    <__stack
       07:A95D  E9 02              sbc    #low(2)
       07:A95F  85 00              sta    <__stack
       07:A961  A5 01              lda    <__stack+1
       07:A963  E9 00              sbc    #high(2)
       07:A965  85 01              sta    <__stack+1
       07:A967  68                 pla
       07:A968  22                 sax
       07:A969  92 00              sta    [__stack]
       07:A96B  22                 sax
       07:A96C  A0 01              ldy    #1
       07:A96E  91 00              sta    [__stack],Y
 1928                             __ldwi  2
       07:A970  A2 02              ldx    #low(2)
       07:A972  A9 00              lda    #high(2)
 1929  07:A974  20 60 EA            jsr   asl
 1930                             __addws
       07:A977  22                 sax
       07:A978  18                 clc
       07:A979  72 00              adc    [__stack]
       07:A97B  22                 sax
       07:A97C  A0 01              ldy    #1
       07:A97E  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:A980  48                 pha
       07:A981  18                 clc
       07:A982  A5 00              lda    <__stack
       07:A984  69 02              adc    #low(2)
       07:A986  85 00              sta    <__stack
       07:A988  A5 01              lda    <__stack+1
       07:A98A  69 00              adc    #high(2)
       07:A98C  85 01              sta    <__stack+1
       07:A98E  68                 pla
 1931                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       07:A98F  A4 02              ldy    <__arg_idx
                                  .endif
                          
       07:A991  8A                 txa
       07:A992  99 63 2A           sta    __arg-(1),Y
 1932                             __ldwi  17
       07:A995  A2 11              ldx    #low(17)
       07:A997  A9 00              lda    #high(17)
 1933  07:A999  20 2F EF            call  _put_hex.4
 1934                             __ldwi  LL97
       07:A99C  A2 DB              ldx    #low(LL97)
       07:A99E  A9 B8              lda    #high(LL97)
 1935                             __pushw
                                 __submi  2,__stack
       07:A9A0  48                 pha
       07:A9A1  38                 sec
       07:A9A2  A5 00              lda    <__stack
       07:A9A4  E9 02              sbc    #low(2)
       07:A9A6  85 00              sta    <__stack
       07:A9A8  A5 01              lda    <__stack+1
       07:A9AA  E9 00              sbc    #high(2)
       07:A9AC  85 01              sta    <__stack+1
       07:A9AE  68                 pla
       07:A9AF  22                 sax
       07:A9B0  92 00              sta    [__stack]
       07:A9B2  22                 sax
       07:A9B3  A0 01              ldy    #1
       07:A9B5  91 00              sta    [__stack],Y
 1936                             __ldwi  _lfo_sw
       07:A9B7  A2 54              ldx    #low(_lfo_sw)
       07:A9B9  A9 2A              lda    #high(_lfo_sw)
 1937                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A9BB  A0 04              ldy    #4
       07:A9BD  18                 clc
       07:A9BE  22                 sax
       07:A9BF  71 00              adc    [__sp],Y
       07:A9C1  22                 sax
       07:A9C2  C8                 iny
       07:A9C3  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1938                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A9C5  86 0B              stx    <__ptr
       07:A9C7  85 0C              sta    <__ptr+1
       07:A9C9  B2 0B              lda    [__ptr]
       07:A9CB  AA                 tax
       07:A9CC  62                 cla
                          ;        bpl    .x_02538   ; signed
                          ;        dec    A
                          ;.x_02538:
 1939  07:A9CD  4C 4C EC            jmp   ___case
 1940  07:A9D0            LL99:
 1941                     
 1942                             __ldwi  _lfo_cnt
       07:A9D0  A2 34              ldx    #low(_lfo_cnt)
       07:A9D2  A9 2A              lda    #high(_lfo_cnt)
 1943                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A9D4  A0 02              ldy    #2
       07:A9D6  18                 clc
       07:A9D7  22                 sax
       07:A9D8  71 00              adc    [__sp],Y
       07:A9DA  22                 sax
       07:A9DB  C8                 iny
       07:A9DC  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1944                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:A9DE  86 0B              stx    <__ptr
       07:A9E0  85 0C              sta    <__ptr+1
       07:A9E2  B2 0B              lda    [__ptr]
       07:A9E4  AA                 tax
       07:A9E5  62                 cla
                          ;        bpl    .x_02541   ; signed
                          ;        dec    A
                          ;.x_02541:
 1945                             __tstw
                                   ; pha
       07:A9E6  86 03              stx    <__temp
       07:A9E8  05 03              ora    <__temp
                                   ; pla
 1946                             __lbeq  LL100
       07:A9EA  D0 03              bne    .x02543
       07:A9EC  4C 53 AA           jmp    LL100
       07:A9EF            .x02543
 1947                             __ldwi  _lfo_cnt
       07:A9EF  A2 34              ldx    #low(_lfo_cnt)
       07:A9F1  A9 2A              lda    #high(_lfo_cnt)
 1948                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:A9F3  A0 02              ldy    #2
       07:A9F5  18                 clc
       07:A9F6  22                 sax
       07:A9F7  71 00              adc    [__sp],Y
       07:A9F9  22                 sax
       07:A9FA  C8                 iny
       07:A9FB  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1949                             __pushw
                                 __submi  2,__stack
       07:A9FD  48                 pha
       07:A9FE  38                 sec
       07:A9FF  A5 00              lda    <__stack
       07:AA01  E9 02              sbc    #low(2)
       07:AA03  85 00              sta    <__stack
       07:AA05  A5 01              lda    <__stack+1
       07:AA07  E9 00              sbc    #high(2)
       07:AA09  85 01              sta    <__stack+1
       07:AA0B  68                 pla
       07:AA0C  22                 sax
       07:AA0D  92 00              sta    [__stack]
       07:AA0F  22                 sax
       07:AA10  A0 01              ldy    #1
       07:AA12  91 00              sta    [__stack],Y
 1950                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:AA14  86 0B              stx    <__ptr
       07:AA16  85 0C              sta    <__ptr+1
       07:AA18  B2 0B              lda    [__ptr]
       07:AA1A  AA                 tax
       07:AA1B  62                 cla
                          ;        bpl    .x_02548   ; signed
                          ;        dec    A
                          ;.x_02548:
 1951                             __subwi 1
       07:AA1C  38                 sec
       07:AA1D  22                 sax
       07:AA1E  E9 01              sbc    #low(1)
       07:AA20  22                 sax
       07:AA21  E9 00              sbc    #high(1)
 1952                             __stbps
                                 __stw    <__temp
       07:AA23  86 03              stx    <__temp
       07:AA25  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AA27  B2 00              lda    [__stack]
       07:AA29  AA                 tax
       07:AA2A  A0 01              ldy    #1
       07:AA2C  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AA2E  86 0B              stx    <__ptr
       07:AA30  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AA32  A6 03              ldx    <__temp
       07:AA34  A5 04              lda    <__temp+1
                                  .endif
       07:AA36  22                 sax
       07:AA37  92 0B              sta    [__ptr]
       07:AA39  22                 sax
                                 __addmi  2,__stack
       07:AA3A  48                 pha
       07:AA3B  18                 clc
       07:AA3C  A5 00              lda    <__stack
       07:AA3E  69 02              adc    #low(2)
       07:AA40  85 00              sta    <__stack
       07:AA42  A5 01              lda    <__stack+1
       07:AA44  69 00              adc    #high(2)
       07:AA46  85 01              sta    <__stack+1
       07:AA48  68                 pla
 1953                             __addwi 1
       07:AA49  18                 clc
       07:AA4A  22                 sax
       07:AA4B  69 01              adc    #low(1)
       07:AA4D  22                 sax
       07:AA4E  69 00              adc    #high(1)
 1954                             __lbra  LL101
       07:AA50  4C 1B AD           jmp    LL101
 1955  07:AA53            LL100:
 1956                     
 1957                             __ldwi  _lfo_sw
       07:AA53  A2 54              ldx    #low(_lfo_sw)
       07:AA55  A9 2A              lda    #high(_lfo_sw)
 1958                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AA57  A0 02              ldy    #2
       07:AA59  18                 clc
       07:AA5A  22                 sax
       07:AA5B  71 00              adc    [__sp],Y
       07:AA5D  22                 sax
       07:AA5E  C8                 iny
       07:AA5F  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1959                             __pushw
                                 __submi  2,__stack
       07:AA61  48                 pha
       07:AA62  38                 sec
       07:AA63  A5 00              lda    <__stack
       07:AA65  E9 02              sbc    #low(2)
       07:AA67  85 00              sta    <__stack
       07:AA69  A5 01              lda    <__stack+1
       07:AA6B  E9 00              sbc    #high(2)
       07:AA6D  85 01              sta    <__stack+1
       07:AA6F  68                 pla
       07:AA70  22                 sax
       07:AA71  92 00              sta    [__stack]
       07:AA73  22                 sax
       07:AA74  A0 01              ldy    #1
       07:AA76  91 00              sta    [__stack],Y
 1960                             __ldwi  1
       07:AA78  A2 01              ldx    #low(1)
       07:AA7A  A9 00              lda    #high(1)
 1961                             __stbps
                                 __stw    <__temp
       07:AA7C  86 03              stx    <__temp
       07:AA7E  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AA80  B2 00              lda    [__stack]
       07:AA82  AA                 tax
       07:AA83  A0 01              ldy    #1
       07:AA85  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AA87  86 0B              stx    <__ptr
       07:AA89  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AA8B  A6 03              ldx    <__temp
       07:AA8D  A5 04              lda    <__temp+1
                                  .endif
       07:AA8F  22                 sax
       07:AA90  92 0B              sta    [__ptr]
       07:AA92  22                 sax
                                 __addmi  2,__stack
       07:AA93  48                 pha
       07:AA94  18                 clc
       07:AA95  A5 00              lda    <__stack
       07:AA97  69 02              adc    #low(2)
       07:AA99  85 00              sta    <__stack
       07:AA9B  A5 01              lda    <__stack+1
       07:AA9D  69 00              adc    #high(2)
       07:AA9F  85 01              sta    <__stack+1
       07:AAA1  68                 pla
 1962                             __ldwi  _lfo_cnt
       07:AAA2  A2 34              ldx    #low(_lfo_cnt)
       07:AAA4  A9 2A              lda    #high(_lfo_cnt)
 1963                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AAA6  A0 02              ldy    #2
       07:AAA8  18                 clc
       07:AAA9  22                 sax
       07:AAAA  71 00              adc    [__sp],Y
       07:AAAC  22                 sax
       07:AAAD  C8                 iny
       07:AAAE  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1964                             __pushw
                                 __submi  2,__stack
       07:AAB0  48                 pha
       07:AAB1  38                 sec
       07:AAB2  A5 00              lda    <__stack
       07:AAB4  E9 02              sbc    #low(2)
       07:AAB6  85 00              sta    <__stack
       07:AAB8  A5 01              lda    <__stack+1
       07:AABA  E9 00              sbc    #high(2)
       07:AABC  85 01              sta    <__stack+1
       07:AABE  68                 pla
       07:AABF  22                 sax
       07:AAC0  92 00              sta    [__stack]
       07:AAC2  22                 sax
       07:AAC3  A0 01              ldy    #1
       07:AAC5  91 00              sta    [__stack],Y
 1965                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:AAC7  A0 02               ldy   #2
       07:AAC9  B1 00               lda   [__sp],Y
       07:AACB  AA                  tax
       07:AACC  C8                  iny
       07:AACD  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1966                             __addwi 1
       07:AACF  18                 clc
       07:AAD0  22                 sax
       07:AAD1  69 01              adc    #low(1)
       07:AAD3  22                 sax
       07:AAD4  69 00              adc    #high(1)
 1967                             __stw   __ptr
       07:AAD6  8E 0B 20           stx    __ptr
       07:AAD9  8D 0C 20           sta    __ptr+1
 1968                             __ldwp  __ptr
       07:AADC  B2 0B              lda    [__ptr]
       07:AADE  AA                 tax
       07:AADF  A0 01              ldy    #1
       07:AAE1  B1 0B              lda    [__ptr],Y
 1969                             __stbps
                                 __stw    <__temp
       07:AAE3  86 03              stx    <__temp
       07:AAE5  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AAE7  B2 00              lda    [__stack]
       07:AAE9  AA                 tax
       07:AAEA  A0 01              ldy    #1
       07:AAEC  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AAEE  86 0B              stx    <__ptr
       07:AAF0  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AAF2  A6 03              ldx    <__temp
       07:AAF4  A5 04              lda    <__temp+1
                                  .endif
       07:AAF6  22                 sax
       07:AAF7  92 0B              sta    [__ptr]
       07:AAF9  22                 sax
                                 __addmi  2,__stack
       07:AAFA  48                 pha
       07:AAFB  18                 clc
       07:AAFC  A5 00              lda    <__stack
       07:AAFE  69 02              adc    #low(2)
       07:AB00  85 00              sta    <__stack
       07:AB02  A5 01              lda    <__stack+1
       07:AB04  69 00              adc    #high(2)
       07:AB06  85 01              sta    <__stack+1
       07:AB08  68                 pla
 1970                             __ldwi  _lfo_ct2
       07:AB09  A2 3C              ldx    #low(_lfo_ct2)
       07:AB0B  A9 2A              lda    #high(_lfo_ct2)
 1971                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AB0D  A0 02              ldy    #2
       07:AB0F  18                 clc
       07:AB10  22                 sax
       07:AB11  71 00              adc    [__sp],Y
       07:AB13  22                 sax
       07:AB14  C8                 iny
       07:AB15  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1972                             __pushw
                                 __submi  2,__stack
       07:AB17  48                 pha
       07:AB18  38                 sec
       07:AB19  A5 00              lda    <__stack
       07:AB1B  E9 02              sbc    #low(2)
       07:AB1D  85 00              sta    <__stack
       07:AB1F  A5 01              lda    <__stack+1
       07:AB21  E9 00              sbc    #high(2)
       07:AB23  85 01              sta    <__stack+1
       07:AB25  68                 pla
       07:AB26  22                 sax
       07:AB27  92 00              sta    [__stack]
       07:AB29  22                 sax
       07:AB2A  A0 01              ldy    #1
       07:AB2C  91 00              sta    [__stack],Y
 1973                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:AB2E  A0 02               ldy   #2
       07:AB30  B1 00               lda   [__sp],Y
       07:AB32  AA                  tax
       07:AB33  C8                  iny
       07:AB34  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1974                             __addwi 1
       07:AB36  18                 clc
       07:AB37  22                 sax
       07:AB38  69 01              adc    #low(1)
       07:AB3A  22                 sax
       07:AB3B  69 00              adc    #high(1)
 1975                             __stw   __ptr
       07:AB3D  8E 0B 20           stx    __ptr
       07:AB40  8D 0C 20           sta    __ptr+1
 1976                             __ldwp  __ptr
       07:AB43  B2 0B              lda    [__ptr]
       07:AB45  AA                 tax
       07:AB46  A0 01              ldy    #1
       07:AB48  B1 0B              lda    [__ptr],Y
 1977                             __pushw
                                 __submi  2,__stack
       07:AB4A  48                 pha
       07:AB4B  38                 sec
       07:AB4C  A5 00              lda    <__stack
       07:AB4E  E9 02              sbc    #low(2)
       07:AB50  85 00              sta    <__stack
       07:AB52  A5 01              lda    <__stack+1
       07:AB54  E9 00              sbc    #high(2)
       07:AB56  85 01              sta    <__stack+1
       07:AB58  68                 pla
       07:AB59  22                 sax
       07:AB5A  92 00              sta    [__stack]
       07:AB5C  22                 sax
       07:AB5D  A0 01              ldy    #1
       07:AB5F  91 00              sta    [__stack],Y
 1978                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       07:AB61  A0 04               ldy   #4
       07:AB63  B1 00               lda   [__sp],Y
       07:AB65  AA                  tax
       07:AB66  C8                  iny
       07:AB67  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1979                             __addwi 2
       07:AB69  18                 clc
       07:AB6A  22                 sax
       07:AB6B  69 02              adc    #low(2)
       07:AB6D  22                 sax
       07:AB6E  69 00              adc    #high(2)
 1980                             __stw   __ptr
       07:AB70  8E 0B 20           stx    __ptr
       07:AB73  8D 0C 20           sta    __ptr+1
 1981                             __ldwp  __ptr
       07:AB76  B2 0B              lda    [__ptr]
       07:AB78  AA                 tax
       07:AB79  A0 01              ldy    #1
       07:AB7B  B1 0B              lda    [__ptr],Y
 1982  07:AB7D  20 90 80            call  _divxt
 1983                             __stbps
                                 __stw    <__temp
       07:AB80  86 03              stx    <__temp
       07:AB82  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AB84  B2 00              lda    [__stack]
       07:AB86  AA                 tax
       07:AB87  A0 01              ldy    #1
       07:AB89  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AB8B  86 0B              stx    <__ptr
       07:AB8D  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AB8F  A6 03              ldx    <__temp
       07:AB91  A5 04              lda    <__temp+1
                                  .endif
       07:AB93  22                 sax
       07:AB94  92 0B              sta    [__ptr]
       07:AB96  22                 sax
                                 __addmi  2,__stack
       07:AB97  48                 pha
       07:AB98  18                 clc
       07:AB99  A5 00              lda    <__stack
       07:AB9B  69 02              adc    #low(2)
       07:AB9D  85 00              sta    <__stack
       07:AB9F  A5 01              lda    <__stack+1
       07:ABA1  69 00              adc    #high(2)
       07:ABA3  85 01              sta    <__stack+1
       07:ABA5  68                 pla
 1984                             __ldwi  _lfo_stp
       07:ABA6  A2 44              ldx    #low(_lfo_stp)
       07:ABA8  A9 2A              lda    #high(_lfo_stp)
 1985                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:ABAA  A0 02              ldy    #2
       07:ABAC  18                 clc
       07:ABAD  22                 sax
       07:ABAE  71 00              adc    [__sp],Y
       07:ABB0  22                 sax
       07:ABB1  C8                 iny
       07:ABB2  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1986                             __pushw
                                 __submi  2,__stack
       07:ABB4  48                 pha
       07:ABB5  38                 sec
       07:ABB6  A5 00              lda    <__stack
       07:ABB8  E9 02              sbc    #low(2)
       07:ABBA  85 00              sta    <__stack
       07:ABBC  A5 01              lda    <__stack+1
       07:ABBE  E9 00              sbc    #high(2)
       07:ABC0  85 01              sta    <__stack+1
       07:ABC2  68                 pla
       07:ABC3  22                 sax
       07:ABC4  92 00              sta    [__stack]
       07:ABC6  22                 sax
       07:ABC7  A0 01              ldy    #1
       07:ABC9  91 00              sta    [__stack],Y
 1987                             __ldwi  _lfo_ct2
       07:ABCB  A2 3C              ldx    #low(_lfo_ct2)
       07:ABCD  A9 2A              lda    #high(_lfo_ct2)
 1988                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:ABCF  A0 04              ldy    #4
       07:ABD1  18                 clc
       07:ABD2  22                 sax
       07:ABD3  71 00              adc    [__sp],Y
       07:ABD5  22                 sax
       07:ABD6  C8                 iny
       07:ABD7  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1989                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:ABD9  86 0B              stx    <__ptr
       07:ABDB  85 0C              sta    <__ptr+1
       07:ABDD  B2 0B              lda    [__ptr]
       07:ABDF  AA                 tax
       07:ABE0  62                 cla
                          ;        bpl    .x_02609   ; signed
                          ;        dec    A
                          ;.x_02609:
 1990                             __stbps
                                 __stw    <__temp
       07:ABE1  86 03              stx    <__temp
       07:ABE3  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:ABE5  B2 00              lda    [__stack]
       07:ABE7  AA                 tax
       07:ABE8  A0 01              ldy    #1
       07:ABEA  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:ABEC  86 0B              stx    <__ptr
       07:ABEE  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:ABF0  A6 03              ldx    <__temp
       07:ABF2  A5 04              lda    <__temp+1
                                  .endif
       07:ABF4  22                 sax
       07:ABF5  92 0B              sta    [__ptr]
       07:ABF7  22                 sax
                                 __addmi  2,__stack
       07:ABF8  48                 pha
       07:ABF9  18                 clc
       07:ABFA  A5 00              lda    <__stack
       07:ABFC  69 02              adc    #low(2)
       07:ABFE  85 00              sta    <__stack
       07:AC00  A5 01              lda    <__stack+1
       07:AC02  69 00              adc    #high(2)
       07:AC04  85 01              sta    <__stack+1
       07:AC06  68                 pla
 1991                             __ldwi  _lfo_lev
       07:AC07  A2 4C              ldx    #low(_lfo_lev)
       07:AC09  A9 2A              lda    #high(_lfo_lev)
 1992                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AC0B  A0 02              ldy    #2
       07:AC0D  18                 clc
       07:AC0E  22                 sax
       07:AC0F  71 00              adc    [__sp],Y
       07:AC11  22                 sax
       07:AC12  C8                 iny
       07:AC13  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 1993                             __pushw
                                 __submi  2,__stack
       07:AC15  48                 pha
       07:AC16  38                 sec
       07:AC17  A5 00              lda    <__stack
       07:AC19  E9 02              sbc    #low(2)
       07:AC1B  85 00              sta    <__stack
       07:AC1D  A5 01              lda    <__stack+1
       07:AC1F  E9 00              sbc    #high(2)
       07:AC21  85 01              sta    <__stack+1
       07:AC23  68                 pla
       07:AC24  22                 sax
       07:AC25  92 00              sta    [__stack]
       07:AC27  22                 sax
       07:AC28  A0 01              ldy    #1
       07:AC2A  91 00              sta    [__stack],Y
 1994                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:AC2C  A0 02               ldy   #2
       07:AC2E  B1 00               lda   [__sp],Y
       07:AC30  AA                  tax
       07:AC31  C8                  iny
       07:AC32  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 1995                             __addwi 2
       07:AC34  18                 clc
       07:AC35  22                 sax
       07:AC36  69 02              adc    #low(2)
       07:AC38  22                 sax
       07:AC39  69 00              adc    #high(2)
 1996                             __stw   __ptr
       07:AC3B  8E 0B 20           stx    __ptr
       07:AC3E  8D 0C 20           sta    __ptr+1
 1997                             __ldwp  __ptr
       07:AC41  B2 0B              lda    [__ptr]
       07:AC43  AA                 tax
       07:AC44  A0 01              ldy    #1
       07:AC46  B1 0B              lda    [__ptr],Y
 1998                             __pushw
                                 __submi  2,__stack
       07:AC48  48                 pha
       07:AC49  38                 sec
       07:AC4A  A5 00              lda    <__stack
       07:AC4C  E9 02              sbc    #low(2)
       07:AC4E  85 00              sta    <__stack
       07:AC50  A5 01              lda    <__stack+1
       07:AC52  E9 00              sbc    #high(2)
       07:AC54  85 01              sta    <__stack+1
       07:AC56  68                 pla
       07:AC57  22                 sax
       07:AC58  92 00              sta    [__stack]
       07:AC5A  22                 sax
       07:AC5B  A0 01              ldy    #1
       07:AC5D  91 00              sta    [__stack],Y
 1999                             __ldw_s 4
                0001              .if (4 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (4 = 0)
                                   .else
       07:AC5F  A0 04               ldy   #4
       07:AC61  B1 00               lda   [__sp],Y
       07:AC63  AA                  tax
       07:AC64  C8                  iny
       07:AC65  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2000                             __addwi 1
       07:AC67  18                 clc
       07:AC68  22                 sax
       07:AC69  69 01              adc    #low(1)
       07:AC6B  22                 sax
       07:AC6C  69 00              adc    #high(1)
 2001                             __stw   __ptr
       07:AC6E  8E 0B 20           stx    __ptr
       07:AC71  8D 0C 20           sta    __ptr+1
 2002                             __ldwp  __ptr
       07:AC74  B2 0B              lda    [__ptr]
       07:AC76  AA                 tax
       07:AC77  A0 01              ldy    #1
       07:AC79  B1 0B              lda    [__ptr],Y
 2003  07:AC7B  20 90 80            call  _divxt
 2004                             __stbps
                                 __stw    <__temp
       07:AC7E  86 03              stx    <__temp
       07:AC80  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AC82  B2 00              lda    [__stack]
       07:AC84  AA                 tax
       07:AC85  A0 01              ldy    #1
       07:AC87  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AC89  86 0B              stx    <__ptr
       07:AC8B  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AC8D  A6 03              ldx    <__temp
       07:AC8F  A5 04              lda    <__temp+1
                                  .endif
       07:AC91  22                 sax
       07:AC92  92 0B              sta    [__ptr]
       07:AC94  22                 sax
                                 __addmi  2,__stack
       07:AC95  48                 pha
       07:AC96  18                 clc
       07:AC97  A5 00              lda    <__stack
       07:AC99  69 02              adc    #low(2)
       07:AC9B  85 00              sta    <__stack
       07:AC9D  A5 01              lda    <__stack+1
       07:AC9F  69 00              adc    #high(2)
       07:ACA1  85 01              sta    <__stack+1
       07:ACA3  68                 pla
 2005                             __ldwi  _lfo_lev
       07:ACA4  A2 4C              ldx    #low(_lfo_lev)
       07:ACA6  A9 2A              lda    #high(_lfo_lev)
 2006                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:ACA8  A0 02              ldy    #2
       07:ACAA  18                 clc
       07:ACAB  22                 sax
       07:ACAC  71 00              adc    [__sp],Y
       07:ACAE  22                 sax
       07:ACAF  C8                 iny
       07:ACB0  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2007                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:ACB2  86 0B              stx    <__ptr
       07:ACB4  85 0C              sta    <__ptr+1
       07:ACB6  B2 0B              lda    [__ptr]
       07:ACB8  AA                 tax
       07:ACB9  62                 cla
                          ;        bpl    .x_02638   ; signed
                          ;        dec    A
                          ;.x_02638:
 2008                             __notw
       07:ACBA  86 03              stx    <__temp
       07:ACBC  05 03              ora    <__temp
       07:ACBE  82                 clx
       07:ACBF  D0 01              bne    .x02639
       07:ACC1  E8                 inx
       07:ACC2  62        .x02639     cla
 2009                             __tstw
                                   ; pha
       07:ACC3  86 03              stx    <__temp
       07:ACC5  05 03              ora    <__temp
                                   ; pla
 2010                             __lbeq  LL102
       07:ACC7  D0 03              bne    .x02641
       07:ACC9  4C 1B AD           jmp    LL102
       07:ACCC            .x02641
 2011                             __ldwi  _lfo_lev
       07:ACCC  A2 4C              ldx    #low(_lfo_lev)
       07:ACCE  A9 2A              lda    #high(_lfo_lev)
 2012                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:ACD0  A0 02              ldy    #2
       07:ACD2  18                 clc
       07:ACD3  22                 sax
       07:ACD4  71 00              adc    [__sp],Y
       07:ACD6  22                 sax
       07:ACD7  C8                 iny
       07:ACD8  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2013                             __pushw
                                 __submi  2,__stack
       07:ACDA  48                 pha
       07:ACDB  38                 sec
       07:ACDC  A5 00              lda    <__stack
       07:ACDE  E9 02              sbc    #low(2)
       07:ACE0  85 00              sta    <__stack
       07:ACE2  A5 01              lda    <__stack+1
       07:ACE4  E9 00              sbc    #high(2)
       07:ACE6  85 01              sta    <__stack+1
       07:ACE8  68                 pla
       07:ACE9  22                 sax
       07:ACEA  92 00              sta    [__stack]
       07:ACEC  22                 sax
       07:ACED  A0 01              ldy    #1
       07:ACEF  91 00              sta    [__stack],Y
 2014                             __ldwi  1
       07:ACF1  A2 01              ldx    #low(1)
       07:ACF3  A9 00              lda    #high(1)
 2015                             __stbps
                                 __stw    <__temp
       07:ACF5  86 03              stx    <__temp
       07:ACF7  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:ACF9  B2 00              lda    [__stack]
       07:ACFB  AA                 tax
       07:ACFC  A0 01              ldy    #1
       07:ACFE  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AD00  86 0B              stx    <__ptr
       07:AD02  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AD04  A6 03              ldx    <__temp
       07:AD06  A5 04              lda    <__temp+1
                                  .endif
       07:AD08  22                 sax
       07:AD09  92 0B              sta    [__ptr]
       07:AD0B  22                 sax
                                 __addmi  2,__stack
       07:AD0C  48                 pha
       07:AD0D  18                 clc
       07:AD0E  A5 00              lda    <__stack
       07:AD10  69 02              adc    #low(2)
       07:AD12  85 00              sta    <__stack
       07:AD14  A5 01              lda    <__stack+1
       07:AD16  69 00              adc    #high(2)
       07:AD18  85 01              sta    <__stack+1
       07:AD1A  68                 pla
 2016  07:AD1B            LL102:
 2017                     
 2018  07:AD1B            LL101:
 2019                     
 2020                             __lbra  LL98
       07:AD1B  4C F3 B8           jmp    LL98
 2021  07:AD1E            LL103:
 2022                     
 2023                             __ldwi  _lfo_cnt
       07:AD1E  A2 34              ldx    #low(_lfo_cnt)
       07:AD20  A9 2A              lda    #high(_lfo_cnt)
 2024                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AD22  A0 02              ldy    #2
       07:AD24  18                 clc
       07:AD25  22                 sax
       07:AD26  71 00              adc    [__sp],Y
       07:AD28  22                 sax
       07:AD29  C8                 iny
       07:AD2A  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2025                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:AD2C  86 0B              stx    <__ptr
       07:AD2E  85 0C              sta    <__ptr+1
       07:AD30  B2 0B              lda    [__ptr]
       07:AD32  AA                 tax
       07:AD33  62                 cla
                          ;        bpl    .x_02656   ; signed
                          ;        dec    A
                          ;.x_02656:
 2026                             __tstw
                                   ; pha
       07:AD34  86 03              stx    <__temp
       07:AD36  05 03              ora    <__temp
                                   ; pla
 2027                             __lbeq  LL104
       07:AD38  D0 03              bne    .x02658
       07:AD3A  4C 9E AD           jmp    LL104
       07:AD3D            .x02658
 2028                             __ldwi  _lfo_cnt
       07:AD3D  A2 34              ldx    #low(_lfo_cnt)
       07:AD3F  A9 2A              lda    #high(_lfo_cnt)
 2029                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AD41  A0 02              ldy    #2
       07:AD43  18                 clc
       07:AD44  22                 sax
       07:AD45  71 00              adc    [__sp],Y
       07:AD47  22                 sax
       07:AD48  C8                 iny
       07:AD49  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2030                             __pushw
                                 __submi  2,__stack
       07:AD4B  48                 pha
       07:AD4C  38                 sec
       07:AD4D  A5 00              lda    <__stack
       07:AD4F  E9 02              sbc    #low(2)
       07:AD51  85 00              sta    <__stack
       07:AD53  A5 01              lda    <__stack+1
       07:AD55  E9 00              sbc    #high(2)
       07:AD57  85 01              sta    <__stack+1
       07:AD59  68                 pla
       07:AD5A  22                 sax
       07:AD5B  92 00              sta    [__stack]
       07:AD5D  22                 sax
       07:AD5E  A0 01              ldy    #1
       07:AD60  91 00              sta    [__stack],Y
 2031                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:AD62  86 0B              stx    <__ptr
       07:AD64  85 0C              sta    <__ptr+1
       07:AD66  B2 0B              lda    [__ptr]
       07:AD68  AA                 tax
       07:AD69  62                 cla
                          ;        bpl    .x_02663   ; signed
                          ;        dec    A
                          ;.x_02663:
 2032                             __subwi 1
       07:AD6A  38                 sec
       07:AD6B  22                 sax
       07:AD6C  E9 01              sbc    #low(1)
       07:AD6E  22                 sax
       07:AD6F  E9 00              sbc    #high(1)
 2033                             __stbps
                                 __stw    <__temp
       07:AD71  86 03              stx    <__temp
       07:AD73  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AD75  B2 00              lda    [__stack]
       07:AD77  AA                 tax
       07:AD78  A0 01              ldy    #1
       07:AD7A  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AD7C  86 0B              stx    <__ptr
       07:AD7E  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AD80  A6 03              ldx    <__temp
       07:AD82  A5 04              lda    <__temp+1
                                  .endif
       07:AD84  22                 sax
       07:AD85  92 0B              sta    [__ptr]
       07:AD87  22                 sax
                                 __addmi  2,__stack
       07:AD88  48                 pha
       07:AD89  18                 clc
       07:AD8A  A5 00              lda    <__stack
       07:AD8C  69 02              adc    #low(2)
       07:AD8E  85 00              sta    <__stack
       07:AD90  A5 01              lda    <__stack+1
       07:AD92  69 00              adc    #high(2)
       07:AD94  85 01              sta    <__stack+1
       07:AD96  68                 pla
 2034                             __addwi 1
       07:AD97  18                 clc
       07:AD98  22                 sax
       07:AD99  69 01              adc    #low(1)
       07:AD9B  22                 sax
       07:AD9C  69 00              adc    #high(1)
 2035  07:AD9E            LL104:
 2036                     
 2037                             __ldwi  _lfo_ct2
       07:AD9E  A2 3C              ldx    #low(_lfo_ct2)
       07:ADA0  A9 2A              lda    #high(_lfo_ct2)
 2038                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:ADA2  A0 02              ldy    #2
       07:ADA4  18                 clc
       07:ADA5  22                 sax
       07:ADA6  71 00              adc    [__sp],Y
       07:ADA8  22                 sax
       07:ADA9  C8                 iny
       07:ADAA  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2039                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:ADAC  86 0B              stx    <__ptr
       07:ADAE  85 0C              sta    <__ptr+1
       07:ADB0  B2 0B              lda    [__ptr]
       07:ADB2  AA                 tax
       07:ADB3  62                 cla
                          ;        bpl    .x_02674   ; signed
                          ;        dec    A
                          ;.x_02674:
 2040                             __tstw
                                   ; pha
       07:ADB4  86 03              stx    <__temp
       07:ADB6  05 03              ora    <__temp
                                   ; pla
 2041                             __lbeq  LL105
       07:ADB8  D0 03              bne    .x02676
       07:ADBA  4C 21 AE           jmp    LL105
       07:ADBD            .x02676
 2042                             __ldwi  _lfo_ct2
       07:ADBD  A2 3C              ldx    #low(_lfo_ct2)
       07:ADBF  A9 2A              lda    #high(_lfo_ct2)
 2043                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:ADC1  A0 02              ldy    #2
       07:ADC3  18                 clc
       07:ADC4  22                 sax
       07:ADC5  71 00              adc    [__sp],Y
       07:ADC7  22                 sax
       07:ADC8  C8                 iny
       07:ADC9  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2044                             __pushw
                                 __submi  2,__stack
       07:ADCB  48                 pha
       07:ADCC  38                 sec
       07:ADCD  A5 00              lda    <__stack
       07:ADCF  E9 02              sbc    #low(2)
       07:ADD1  85 00              sta    <__stack
       07:ADD3  A5 01              lda    <__stack+1
       07:ADD5  E9 00              sbc    #high(2)
       07:ADD7  85 01              sta    <__stack+1
       07:ADD9  68                 pla
       07:ADDA  22                 sax
       07:ADDB  92 00              sta    [__stack]
       07:ADDD  22                 sax
       07:ADDE  A0 01              ldy    #1
       07:ADE0  91 00              sta    [__stack],Y
 2045                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:ADE2  86 0B              stx    <__ptr
       07:ADE4  85 0C              sta    <__ptr+1
       07:ADE6  B2 0B              lda    [__ptr]
       07:ADE8  AA                 tax
       07:ADE9  62                 cla
                          ;        bpl    .x_02681   ; signed
                          ;        dec    A
                          ;.x_02681:
 2046                             __subwi 1
       07:ADEA  38                 sec
       07:ADEB  22                 sax
       07:ADEC  E9 01              sbc    #low(1)
       07:ADEE  22                 sax
       07:ADEF  E9 00              sbc    #high(1)
 2047                             __stbps
                                 __stw    <__temp
       07:ADF1  86 03              stx    <__temp
       07:ADF3  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:ADF5  B2 00              lda    [__stack]
       07:ADF7  AA                 tax
       07:ADF8  A0 01              ldy    #1
       07:ADFA  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:ADFC  86 0B              stx    <__ptr
       07:ADFE  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AE00  A6 03              ldx    <__temp
       07:AE02  A5 04              lda    <__temp+1
                                  .endif
       07:AE04  22                 sax
       07:AE05  92 0B              sta    [__ptr]
       07:AE07  22                 sax
                                 __addmi  2,__stack
       07:AE08  48                 pha
       07:AE09  18                 clc
       07:AE0A  A5 00              lda    <__stack
       07:AE0C  69 02              adc    #low(2)
       07:AE0E  85 00              sta    <__stack
       07:AE10  A5 01              lda    <__stack+1
       07:AE12  69 00              adc    #high(2)
       07:AE14  85 01              sta    <__stack+1
       07:AE16  68                 pla
 2048                             __addwi 1
       07:AE17  18                 clc
       07:AE18  22                 sax
       07:AE19  69 01              adc    #low(1)
       07:AE1B  22                 sax
       07:AE1C  69 00              adc    #high(1)
 2049                             __lbra  LL106
       07:AE1E  4C 0D B0           jmp    LL106
 2050  07:AE21            LL105:
 2051                     
 2052                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:AE21  A0 02               ldy   #2
       07:AE23  B1 00               lda   [__sp],Y
       07:AE25  AA                  tax
       07:AE26  C8                  iny
       07:AE27  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2053                             __aslw
       07:AE29  22                 sax
       07:AE2A  0A                 asl    A
       07:AE2B  22                 sax
       07:AE2C  2A                 rol    A
 2054                             __addwi _seq_freq
       07:AE2D  18                 clc
       07:AE2E  22                 sax
       07:AE2F  69 E4              adc    #low(_seq_freq)
       07:AE31  22                 sax
       07:AE32  69 29              adc    #high(_seq_freq)
 2055                             __pushw
                                 __submi  2,__stack
       07:AE34  48                 pha
       07:AE35  38                 sec
       07:AE36  A5 00              lda    <__stack
       07:AE38  E9 02              sbc    #low(2)
       07:AE3A  85 00              sta    <__stack
       07:AE3C  A5 01              lda    <__stack+1
       07:AE3E  E9 00              sbc    #high(2)
       07:AE40  85 01              sta    <__stack+1
       07:AE42  68                 pla
       07:AE43  22                 sax
       07:AE44  92 00              sta    [__stack]
       07:AE46  22                 sax
       07:AE47  A0 01              ldy    #1
       07:AE49  91 00              sta    [__stack],Y
 2056                             __stw   __ptr
       07:AE4B  8E 0B 20           stx    __ptr
       07:AE4E  8D 0C 20           sta    __ptr+1
 2057                             __ldwp  __ptr
       07:AE51  B2 0B              lda    [__ptr]
       07:AE53  AA                 tax
       07:AE54  A0 01              ldy    #1
       07:AE56  B1 0B              lda    [__ptr],Y
 2058                             __pushw
                                 __submi  2,__stack
       07:AE58  48                 pha
       07:AE59  38                 sec
       07:AE5A  A5 00              lda    <__stack
       07:AE5C  E9 02              sbc    #low(2)
       07:AE5E  85 00              sta    <__stack
       07:AE60  A5 01              lda    <__stack+1
       07:AE62  E9 00              sbc    #high(2)
       07:AE64  85 01              sta    <__stack+1
       07:AE66  68                 pla
       07:AE67  22                 sax
       07:AE68  92 00              sta    [__stack]
       07:AE6A  22                 sax
       07:AE6B  A0 01              ldy    #1
       07:AE6D  91 00              sta    [__stack],Y
 2059                             __ldwi  _lfo_lev
       07:AE6F  A2 4C              ldx    #low(_lfo_lev)
       07:AE71  A9 2A              lda    #high(_lfo_lev)
 2060                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AE73  A0 06              ldy    #6
       07:AE75  18                 clc
       07:AE76  22                 sax
       07:AE77  71 00              adc    [__sp],Y
       07:AE79  22                 sax
       07:AE7A  C8                 iny
       07:AE7B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2061                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:AE7D  86 0B              stx    <__ptr
       07:AE7F  85 0C              sta    <__ptr+1
       07:AE81  B2 0B              lda    [__ptr]
       07:AE83  AA                 tax
       07:AE84  62                 cla
                          ;        bpl    .x_02702   ; signed
                          ;        dec    A
                          ;.x_02702:
 2062                             __subws
       07:AE85  86 03             stx     <__temp
       07:AE87  85 04             sta     <__temp+1
       07:AE89  38                sec
       07:AE8A  B2 00             lda     [__stack]
       07:AE8C  E5 03             sbc     <__temp
       07:AE8E  AA                tax
       07:AE8F  A0 01             ldy     #1
       07:AE91  B1 00             lda     [__stack],Y
       07:AE93  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       07:AE95  48                 pha
       07:AE96  18                 clc
       07:AE97  A5 00              lda    <__stack
       07:AE99  69 02              adc    #low(2)
       07:AE9B  85 00              sta    <__stack
       07:AE9D  A5 01              lda    <__stack+1
       07:AE9F  69 00              adc    #high(2)
       07:AEA1  85 01              sta    <__stack+1
       07:AEA3  68                 pla
 2063                             __stwps
                                 __stw    <__temp
       07:AEA4  86 03              stx    <__temp
       07:AEA6  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AEA8  B2 00              lda    [__stack]
       07:AEAA  AA                 tax
       07:AEAB  A0 01              ldy    #1
       07:AEAD  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AEAF  86 0B              stx    <__ptr
       07:AEB1  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AEB3  A6 03              ldx    <__temp
       07:AEB5  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:AEB7  22                 sax
       07:AEB8  92 0B              sta    [__ptr]
       07:AEBA  22                 sax
       07:AEBB  A0 01              ldy    #1
       07:AEBD  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:AEBF  48                 pha
       07:AEC0  18                 clc
       07:AEC1  A5 00              lda    <__stack
       07:AEC3  69 02              adc    #low(2)
       07:AEC5  85 00              sta    <__stack
       07:AEC7  A5 01              lda    <__stack+1
       07:AEC9  69 00              adc    #high(2)
       07:AECB  85 01              sta    <__stack+1
       07:AECD  68                 pla
 2064                             __ldwi  _lfo_ct2
       07:AECE  A2 3C              ldx    #low(_lfo_ct2)
       07:AED0  A9 2A              lda    #high(_lfo_ct2)
 2065                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AED2  A0 02              ldy    #2
       07:AED4  18                 clc
       07:AED5  22                 sax
       07:AED6  71 00              adc    [__sp],Y
       07:AED8  22                 sax
       07:AED9  C8                 iny
       07:AEDA  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2066                             __pushw
                                 __submi  2,__stack
       07:AEDC  48                 pha
       07:AEDD  38                 sec
       07:AEDE  A5 00              lda    <__stack
       07:AEE0  E9 02              sbc    #low(2)
       07:AEE2  85 00              sta    <__stack
       07:AEE4  A5 01              lda    <__stack+1
       07:AEE6  E9 00              sbc    #high(2)
       07:AEE8  85 01              sta    <__stack+1
       07:AEEA  68                 pla
       07:AEEB  22                 sax
       07:AEEC  92 00              sta    [__stack]
       07:AEEE  22                 sax
       07:AEEF  A0 01              ldy    #1
       07:AEF1  91 00              sta    [__stack],Y
 2067                             __ldwi  _lfo_stp
       07:AEF3  A2 44              ldx    #low(_lfo_stp)
       07:AEF5  A9 2A              lda    #high(_lfo_stp)
 2068                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AEF7  A0 04              ldy    #4
       07:AEF9  18                 clc
       07:AEFA  22                 sax
       07:AEFB  71 00              adc    [__sp],Y
       07:AEFD  22                 sax
       07:AEFE  C8                 iny
       07:AEFF  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2069                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:AF01  86 0B              stx    <__ptr
       07:AF03  85 0C              sta    <__ptr+1
       07:AF05  B2 0B              lda    [__ptr]
       07:AF07  AA                 tax
       07:AF08  62                 cla
                          ;        bpl    .x_02718   ; signed
                          ;        dec    A
                          ;.x_02718:
 2070                             __stbps
                                 __stw    <__temp
       07:AF09  86 03              stx    <__temp
       07:AF0B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AF0D  B2 00              lda    [__stack]
       07:AF0F  AA                 tax
       07:AF10  A0 01              ldy    #1
       07:AF12  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AF14  86 0B              stx    <__ptr
       07:AF16  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AF18  A6 03              ldx    <__temp
       07:AF1A  A5 04              lda    <__temp+1
                                  .endif
       07:AF1C  22                 sax
       07:AF1D  92 0B              sta    [__ptr]
       07:AF1F  22                 sax
                                 __addmi  2,__stack
       07:AF20  48                 pha
       07:AF21  18                 clc
       07:AF22  A5 00              lda    <__stack
       07:AF24  69 02              adc    #low(2)
       07:AF26  85 00              sta    <__stack
       07:AF28  A5 01              lda    <__stack+1
       07:AF2A  69 00              adc    #high(2)
       07:AF2C  85 01              sta    <__stack+1
       07:AF2E  68                 pla
 2071                             __ldwi  _lfo_cnt
       07:AF2F  A2 34              ldx    #low(_lfo_cnt)
       07:AF31  A9 2A              lda    #high(_lfo_cnt)
 2072                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AF33  A0 02              ldy    #2
       07:AF35  18                 clc
       07:AF36  22                 sax
       07:AF37  71 00              adc    [__sp],Y
       07:AF39  22                 sax
       07:AF3A  C8                 iny
       07:AF3B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2073                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:AF3D  86 0B              stx    <__ptr
       07:AF3F  85 0C              sta    <__ptr+1
       07:AF41  B2 0B              lda    [__ptr]
       07:AF43  AA                 tax
       07:AF44  62                 cla
                          ;        bpl    .x_02727   ; signed
                          ;        dec    A
                          ;.x_02727:
 2074                             __notw
       07:AF45  86 03              stx    <__temp
       07:AF47  05 03              ora    <__temp
       07:AF49  82                 clx
       07:AF4A  D0 01              bne    .x02728
       07:AF4C  E8                 inx
       07:AF4D  62        .x02728     cla
 2075                             __tstw
                                   ; pha
       07:AF4E  86 03              stx    <__temp
       07:AF50  05 03              ora    <__temp
                                   ; pla
 2076                             __lbeq  LL107
       07:AF52  D0 03              bne    .x02730
       07:AF54  4C 0D B0           jmp    LL107
       07:AF57            .x02730
 2077                             __ldwi  _lfo_cnt
       07:AF57  A2 34              ldx    #low(_lfo_cnt)
       07:AF59  A9 2A              lda    #high(_lfo_cnt)
 2078                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AF5B  A0 02              ldy    #2
       07:AF5D  18                 clc
       07:AF5E  22                 sax
       07:AF5F  71 00              adc    [__sp],Y
       07:AF61  22                 sax
       07:AF62  C8                 iny
       07:AF63  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2079                             __pushw
                                 __submi  2,__stack
       07:AF65  48                 pha
       07:AF66  38                 sec
       07:AF67  A5 00              lda    <__stack
       07:AF69  E9 02              sbc    #low(2)
       07:AF6B  85 00              sta    <__stack
       07:AF6D  A5 01              lda    <__stack+1
       07:AF6F  E9 00              sbc    #high(2)
       07:AF71  85 01              sta    <__stack+1
       07:AF73  68                 pla
       07:AF74  22                 sax
       07:AF75  92 00              sta    [__stack]
       07:AF77  22                 sax
       07:AF78  A0 01              ldy    #1
       07:AF7A  91 00              sta    [__stack],Y
 2080                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:AF7C  A0 02               ldy   #2
       07:AF7E  B1 00               lda   [__sp],Y
       07:AF80  AA                  tax
       07:AF81  C8                  iny
       07:AF82  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2081                             __addwi 1
       07:AF84  18                 clc
       07:AF85  22                 sax
       07:AF86  69 01              adc    #low(1)
       07:AF88  22                 sax
       07:AF89  69 00              adc    #high(1)
 2082                             __stw   __ptr
       07:AF8B  8E 0B 20           stx    __ptr
       07:AF8E  8D 0C 20           sta    __ptr+1
 2083                             __ldwp  __ptr
       07:AF91  B2 0B              lda    [__ptr]
       07:AF93  AA                 tax
       07:AF94  A0 01              ldy    #1
       07:AF96  B1 0B              lda    [__ptr],Y
 2084                             __stbps
                                 __stw    <__temp
       07:AF98  86 03              stx    <__temp
       07:AF9A  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AF9C  B2 00              lda    [__stack]
       07:AF9E  AA                 tax
       07:AF9F  A0 01              ldy    #1
       07:AFA1  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AFA3  86 0B              stx    <__ptr
       07:AFA5  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AFA7  A6 03              ldx    <__temp
       07:AFA9  A5 04              lda    <__temp+1
                                  .endif
       07:AFAB  22                 sax
       07:AFAC  92 0B              sta    [__ptr]
       07:AFAE  22                 sax
                                 __addmi  2,__stack
       07:AFAF  48                 pha
       07:AFB0  18                 clc
       07:AFB1  A5 00              lda    <__stack
       07:AFB3  69 02              adc    #low(2)
       07:AFB5  85 00              sta    <__stack
       07:AFB7  A5 01              lda    <__stack+1
       07:AFB9  69 00              adc    #high(2)
       07:AFBB  85 01              sta    <__stack+1
       07:AFBD  68                 pla
 2085                             __ldwi  _lfo_sw
       07:AFBE  A2 54              ldx    #low(_lfo_sw)
       07:AFC0  A9 2A              lda    #high(_lfo_sw)
 2086                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:AFC2  A0 02              ldy    #2
       07:AFC4  18                 clc
       07:AFC5  22                 sax
       07:AFC6  71 00              adc    [__sp],Y
       07:AFC8  22                 sax
       07:AFC9  C8                 iny
       07:AFCA  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2087                             __pushw
                                 __submi  2,__stack
       07:AFCC  48                 pha
       07:AFCD  38                 sec
       07:AFCE  A5 00              lda    <__stack
       07:AFD0  E9 02              sbc    #low(2)
       07:AFD2  85 00              sta    <__stack
       07:AFD4  A5 01              lda    <__stack+1
       07:AFD6  E9 00              sbc    #high(2)
       07:AFD8  85 01              sta    <__stack+1
       07:AFDA  68                 pla
       07:AFDB  22                 sax
       07:AFDC  92 00              sta    [__stack]
       07:AFDE  22                 sax
       07:AFDF  A0 01              ldy    #1
       07:AFE1  91 00              sta    [__stack],Y
 2088                             __ldwi  2
       07:AFE3  A2 02              ldx    #low(2)
       07:AFE5  A9 00              lda    #high(2)
 2089                             __stbps
                                 __stw    <__temp
       07:AFE7  86 03              stx    <__temp
       07:AFE9  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:AFEB  B2 00              lda    [__stack]
       07:AFED  AA                 tax
       07:AFEE  A0 01              ldy    #1
       07:AFF0  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:AFF2  86 0B              stx    <__ptr
       07:AFF4  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:AFF6  A6 03              ldx    <__temp
       07:AFF8  A5 04              lda    <__temp+1
                                  .endif
       07:AFFA  22                 sax
       07:AFFB  92 0B              sta    [__ptr]
       07:AFFD  22                 sax
                                 __addmi  2,__stack
       07:AFFE  48                 pha
       07:AFFF  18                 clc
       07:B000  A5 00              lda    <__stack
       07:B002  69 02              adc    #low(2)
       07:B004  85 00              sta    <__stack
       07:B006  A5 01              lda    <__stack+1
       07:B008  69 00              adc    #high(2)
       07:B00A  85 01              sta    <__stack+1
       07:B00C  68                 pla
 2090  07:B00D            LL107:
 2091                     
 2092  07:B00D            LL106:
 2093                     
 2094                             __lbra  LL98
       07:B00D  4C F3 B8           jmp    LL98
 2095  07:B010            LL108:
 2096                     
 2097                             __ldwi  _lfo_cnt
       07:B010  A2 34              ldx    #low(_lfo_cnt)
       07:B012  A9 2A              lda    #high(_lfo_cnt)
 2098                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B014  A0 02              ldy    #2
       07:B016  18                 clc
       07:B017  22                 sax
       07:B018  71 00              adc    [__sp],Y
       07:B01A  22                 sax
       07:B01B  C8                 iny
       07:B01C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2099                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B01E  86 0B              stx    <__ptr
       07:B020  85 0C              sta    <__ptr+1
       07:B022  B2 0B              lda    [__ptr]
       07:B024  AA                 tax
       07:B025  62                 cla
                          ;        bpl    .x_02759   ; signed
                          ;        dec    A
                          ;.x_02759:
 2100                             __tstw
                                   ; pha
       07:B026  86 03              stx    <__temp
       07:B028  05 03              ora    <__temp
                                   ; pla
 2101                             __lbeq  LL109
       07:B02A  D0 03              bne    .x02761
       07:B02C  4C 90 B0           jmp    LL109
       07:B02F            .x02761
 2102                             __ldwi  _lfo_cnt
       07:B02F  A2 34              ldx    #low(_lfo_cnt)
       07:B031  A9 2A              lda    #high(_lfo_cnt)
 2103                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B033  A0 02              ldy    #2
       07:B035  18                 clc
       07:B036  22                 sax
       07:B037  71 00              adc    [__sp],Y
       07:B039  22                 sax
       07:B03A  C8                 iny
       07:B03B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2104                             __pushw
                                 __submi  2,__stack
       07:B03D  48                 pha
       07:B03E  38                 sec
       07:B03F  A5 00              lda    <__stack
       07:B041  E9 02              sbc    #low(2)
       07:B043  85 00              sta    <__stack
       07:B045  A5 01              lda    <__stack+1
       07:B047  E9 00              sbc    #high(2)
       07:B049  85 01              sta    <__stack+1
       07:B04B  68                 pla
       07:B04C  22                 sax
       07:B04D  92 00              sta    [__stack]
       07:B04F  22                 sax
       07:B050  A0 01              ldy    #1
       07:B052  91 00              sta    [__stack],Y
 2105                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B054  86 0B              stx    <__ptr
       07:B056  85 0C              sta    <__ptr+1
       07:B058  B2 0B              lda    [__ptr]
       07:B05A  AA                 tax
       07:B05B  62                 cla
                          ;        bpl    .x_02766   ; signed
                          ;        dec    A
                          ;.x_02766:
 2106                             __subwi 1
       07:B05C  38                 sec
       07:B05D  22                 sax
       07:B05E  E9 01              sbc    #low(1)
       07:B060  22                 sax
       07:B061  E9 00              sbc    #high(1)
 2107                             __stbps
                                 __stw    <__temp
       07:B063  86 03              stx    <__temp
       07:B065  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B067  B2 00              lda    [__stack]
       07:B069  AA                 tax
       07:B06A  A0 01              ldy    #1
       07:B06C  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B06E  86 0B              stx    <__ptr
       07:B070  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B072  A6 03              ldx    <__temp
       07:B074  A5 04              lda    <__temp+1
                                  .endif
       07:B076  22                 sax
       07:B077  92 0B              sta    [__ptr]
       07:B079  22                 sax
                                 __addmi  2,__stack
       07:B07A  48                 pha
       07:B07B  18                 clc
       07:B07C  A5 00              lda    <__stack
       07:B07E  69 02              adc    #low(2)
       07:B080  85 00              sta    <__stack
       07:B082  A5 01              lda    <__stack+1
       07:B084  69 00              adc    #high(2)
       07:B086  85 01              sta    <__stack+1
       07:B088  68                 pla
 2108                             __addwi 1
       07:B089  18                 clc
       07:B08A  22                 sax
       07:B08B  69 01              adc    #low(1)
       07:B08D  22                 sax
       07:B08E  69 00              adc    #high(1)
 2109  07:B090            LL109:
 2110                     
 2111                             __ldwi  _lfo_ct2
       07:B090  A2 3C              ldx    #low(_lfo_ct2)
       07:B092  A9 2A              lda    #high(_lfo_ct2)
 2112                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B094  A0 02              ldy    #2
       07:B096  18                 clc
       07:B097  22                 sax
       07:B098  71 00              adc    [__sp],Y
       07:B09A  22                 sax
       07:B09B  C8                 iny
       07:B09C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2113                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B09E  86 0B              stx    <__ptr
       07:B0A0  85 0C              sta    <__ptr+1
       07:B0A2  B2 0B              lda    [__ptr]
       07:B0A4  AA                 tax
       07:B0A5  62                 cla
                          ;        bpl    .x_02777   ; signed
                          ;        dec    A
                          ;.x_02777:
 2114                             __tstw
                                   ; pha
       07:B0A6  86 03              stx    <__temp
       07:B0A8  05 03              ora    <__temp
                                   ; pla
 2115                             __lbeq  LL110
       07:B0AA  D0 03              bne    .x02779
       07:B0AC  4C 13 B1           jmp    LL110
       07:B0AF            .x02779
 2116                             __ldwi  _lfo_ct2
       07:B0AF  A2 3C              ldx    #low(_lfo_ct2)
       07:B0B1  A9 2A              lda    #high(_lfo_ct2)
 2117                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B0B3  A0 02              ldy    #2
       07:B0B5  18                 clc
       07:B0B6  22                 sax
       07:B0B7  71 00              adc    [__sp],Y
       07:B0B9  22                 sax
       07:B0BA  C8                 iny
       07:B0BB  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2118                             __pushw
                                 __submi  2,__stack
       07:B0BD  48                 pha
       07:B0BE  38                 sec
       07:B0BF  A5 00              lda    <__stack
       07:B0C1  E9 02              sbc    #low(2)
       07:B0C3  85 00              sta    <__stack
       07:B0C5  A5 01              lda    <__stack+1
       07:B0C7  E9 00              sbc    #high(2)
       07:B0C9  85 01              sta    <__stack+1
       07:B0CB  68                 pla
       07:B0CC  22                 sax
       07:B0CD  92 00              sta    [__stack]
       07:B0CF  22                 sax
       07:B0D0  A0 01              ldy    #1
       07:B0D2  91 00              sta    [__stack],Y
 2119                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B0D4  86 0B              stx    <__ptr
       07:B0D6  85 0C              sta    <__ptr+1
       07:B0D8  B2 0B              lda    [__ptr]
       07:B0DA  AA                 tax
       07:B0DB  62                 cla
                          ;        bpl    .x_02784   ; signed
                          ;        dec    A
                          ;.x_02784:
 2120                             __subwi 1
       07:B0DC  38                 sec
       07:B0DD  22                 sax
       07:B0DE  E9 01              sbc    #low(1)
       07:B0E0  22                 sax
       07:B0E1  E9 00              sbc    #high(1)
 2121                             __stbps
                                 __stw    <__temp
       07:B0E3  86 03              stx    <__temp
       07:B0E5  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B0E7  B2 00              lda    [__stack]
       07:B0E9  AA                 tax
       07:B0EA  A0 01              ldy    #1
       07:B0EC  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B0EE  86 0B              stx    <__ptr
       07:B0F0  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B0F2  A6 03              ldx    <__temp
       07:B0F4  A5 04              lda    <__temp+1
                                  .endif
       07:B0F6  22                 sax
       07:B0F7  92 0B              sta    [__ptr]
       07:B0F9  22                 sax
                                 __addmi  2,__stack
       07:B0FA  48                 pha
       07:B0FB  18                 clc
       07:B0FC  A5 00              lda    <__stack
       07:B0FE  69 02              adc    #low(2)
       07:B100  85 00              sta    <__stack
       07:B102  A5 01              lda    <__stack+1
       07:B104  69 00              adc    #high(2)
       07:B106  85 01              sta    <__stack+1
       07:B108  68                 pla
 2122                             __addwi 1
       07:B109  18                 clc
       07:B10A  22                 sax
       07:B10B  69 01              adc    #low(1)
       07:B10D  22                 sax
       07:B10E  69 00              adc    #high(1)
 2123                             __lbra  LL111
       07:B110  4C F8 B2           jmp    LL111
 2124  07:B113            LL110:
 2125                     
 2126                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B113  A0 02               ldy   #2
       07:B115  B1 00               lda   [__sp],Y
       07:B117  AA                  tax
       07:B118  C8                  iny
       07:B119  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2127                             __aslw
       07:B11B  22                 sax
       07:B11C  0A                 asl    A
       07:B11D  22                 sax
       07:B11E  2A                 rol    A
 2128                             __addwi _seq_freq
       07:B11F  18                 clc
       07:B120  22                 sax
       07:B121  69 E4              adc    #low(_seq_freq)
       07:B123  22                 sax
       07:B124  69 29              adc    #high(_seq_freq)
 2129                             __pushw
                                 __submi  2,__stack
       07:B126  48                 pha
       07:B127  38                 sec
       07:B128  A5 00              lda    <__stack
       07:B12A  E9 02              sbc    #low(2)
       07:B12C  85 00              sta    <__stack
       07:B12E  A5 01              lda    <__stack+1
       07:B130  E9 00              sbc    #high(2)
       07:B132  85 01              sta    <__stack+1
       07:B134  68                 pla
       07:B135  22                 sax
       07:B136  92 00              sta    [__stack]
       07:B138  22                 sax
       07:B139  A0 01              ldy    #1
       07:B13B  91 00              sta    [__stack],Y
 2130                             __stw   __ptr
       07:B13D  8E 0B 20           stx    __ptr
       07:B140  8D 0C 20           sta    __ptr+1
 2131                             __ldwp  __ptr
       07:B143  B2 0B              lda    [__ptr]
       07:B145  AA                 tax
       07:B146  A0 01              ldy    #1
       07:B148  B1 0B              lda    [__ptr],Y
 2132                             __pushw
                                 __submi  2,__stack
       07:B14A  48                 pha
       07:B14B  38                 sec
       07:B14C  A5 00              lda    <__stack
       07:B14E  E9 02              sbc    #low(2)
       07:B150  85 00              sta    <__stack
       07:B152  A5 01              lda    <__stack+1
       07:B154  E9 00              sbc    #high(2)
       07:B156  85 01              sta    <__stack+1
       07:B158  68                 pla
       07:B159  22                 sax
       07:B15A  92 00              sta    [__stack]
       07:B15C  22                 sax
       07:B15D  A0 01              ldy    #1
       07:B15F  91 00              sta    [__stack],Y
 2133                             __ldwi  _lfo_lev
       07:B161  A2 4C              ldx    #low(_lfo_lev)
       07:B163  A9 2A              lda    #high(_lfo_lev)
 2134                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B165  A0 06              ldy    #6
       07:B167  18                 clc
       07:B168  22                 sax
       07:B169  71 00              adc    [__sp],Y
       07:B16B  22                 sax
       07:B16C  C8                 iny
       07:B16D  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2135                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B16F  86 0B              stx    <__ptr
       07:B171  85 0C              sta    <__ptr+1
       07:B173  B2 0B              lda    [__ptr]
       07:B175  AA                 tax
       07:B176  62                 cla
                          ;        bpl    .x_02805   ; signed
                          ;        dec    A
                          ;.x_02805:
 2136                             __addws
       07:B177  22                 sax
       07:B178  18                 clc
       07:B179  72 00              adc    [__stack]
       07:B17B  22                 sax
       07:B17C  A0 01              ldy    #1
       07:B17E  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:B180  48                 pha
       07:B181  18                 clc
       07:B182  A5 00              lda    <__stack
       07:B184  69 02              adc    #low(2)
       07:B186  85 00              sta    <__stack
       07:B188  A5 01              lda    <__stack+1
       07:B18A  69 00              adc    #high(2)
       07:B18C  85 01              sta    <__stack+1
       07:B18E  68                 pla
 2137                             __stwps
                                 __stw    <__temp
       07:B18F  86 03              stx    <__temp
       07:B191  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B193  B2 00              lda    [__stack]
       07:B195  AA                 tax
       07:B196  A0 01              ldy    #1
       07:B198  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B19A  86 0B              stx    <__ptr
       07:B19C  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B19E  A6 03              ldx    <__temp
       07:B1A0  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:B1A2  22                 sax
       07:B1A3  92 0B              sta    [__ptr]
       07:B1A5  22                 sax
       07:B1A6  A0 01              ldy    #1
       07:B1A8  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:B1AA  48                 pha
       07:B1AB  18                 clc
       07:B1AC  A5 00              lda    <__stack
       07:B1AE  69 02              adc    #low(2)
       07:B1B0  85 00              sta    <__stack
       07:B1B2  A5 01              lda    <__stack+1
       07:B1B4  69 00              adc    #high(2)
       07:B1B6  85 01              sta    <__stack+1
       07:B1B8  68                 pla
 2138                             __ldwi  _lfo_ct2
       07:B1B9  A2 3C              ldx    #low(_lfo_ct2)
       07:B1BB  A9 2A              lda    #high(_lfo_ct2)
 2139                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B1BD  A0 02              ldy    #2
       07:B1BF  18                 clc
       07:B1C0  22                 sax
       07:B1C1  71 00              adc    [__sp],Y
       07:B1C3  22                 sax
       07:B1C4  C8                 iny
       07:B1C5  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2140                             __pushw
                                 __submi  2,__stack
       07:B1C7  48                 pha
       07:B1C8  38                 sec
       07:B1C9  A5 00              lda    <__stack
       07:B1CB  E9 02              sbc    #low(2)
       07:B1CD  85 00              sta    <__stack
       07:B1CF  A5 01              lda    <__stack+1
       07:B1D1  E9 00              sbc    #high(2)
       07:B1D3  85 01              sta    <__stack+1
       07:B1D5  68                 pla
       07:B1D6  22                 sax
       07:B1D7  92 00              sta    [__stack]
       07:B1D9  22                 sax
       07:B1DA  A0 01              ldy    #1
       07:B1DC  91 00              sta    [__stack],Y
 2141                             __ldwi  _lfo_stp
       07:B1DE  A2 44              ldx    #low(_lfo_stp)
       07:B1E0  A9 2A              lda    #high(_lfo_stp)
 2142                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B1E2  A0 04              ldy    #4
       07:B1E4  18                 clc
       07:B1E5  22                 sax
       07:B1E6  71 00              adc    [__sp],Y
       07:B1E8  22                 sax
       07:B1E9  C8                 iny
       07:B1EA  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2143                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B1EC  86 0B              stx    <__ptr
       07:B1EE  85 0C              sta    <__ptr+1
       07:B1F0  B2 0B              lda    [__ptr]
       07:B1F2  AA                 tax
       07:B1F3  62                 cla
                          ;        bpl    .x_02821   ; signed
                          ;        dec    A
                          ;.x_02821:
 2144                             __stbps
                                 __stw    <__temp
       07:B1F4  86 03              stx    <__temp
       07:B1F6  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B1F8  B2 00              lda    [__stack]
       07:B1FA  AA                 tax
       07:B1FB  A0 01              ldy    #1
       07:B1FD  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B1FF  86 0B              stx    <__ptr
       07:B201  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B203  A6 03              ldx    <__temp
       07:B205  A5 04              lda    <__temp+1
                                  .endif
       07:B207  22                 sax
       07:B208  92 0B              sta    [__ptr]
       07:B20A  22                 sax
                                 __addmi  2,__stack
       07:B20B  48                 pha
       07:B20C  18                 clc
       07:B20D  A5 00              lda    <__stack
       07:B20F  69 02              adc    #low(2)
       07:B211  85 00              sta    <__stack
       07:B213  A5 01              lda    <__stack+1
       07:B215  69 00              adc    #high(2)
       07:B217  85 01              sta    <__stack+1
       07:B219  68                 pla
 2145                             __ldwi  _lfo_cnt
       07:B21A  A2 34              ldx    #low(_lfo_cnt)
       07:B21C  A9 2A              lda    #high(_lfo_cnt)
 2146                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B21E  A0 02              ldy    #2
       07:B220  18                 clc
       07:B221  22                 sax
       07:B222  71 00              adc    [__sp],Y
       07:B224  22                 sax
       07:B225  C8                 iny
       07:B226  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2147                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B228  86 0B              stx    <__ptr
       07:B22A  85 0C              sta    <__ptr+1
       07:B22C  B2 0B              lda    [__ptr]
       07:B22E  AA                 tax
       07:B22F  62                 cla
                          ;        bpl    .x_02830   ; signed
                          ;        dec    A
                          ;.x_02830:
 2148                             __notw
       07:B230  86 03              stx    <__temp
       07:B232  05 03              ora    <__temp
       07:B234  82                 clx
       07:B235  D0 01              bne    .x02831
       07:B237  E8                 inx
       07:B238  62        .x02831     cla
 2149                             __tstw
                                   ; pha
       07:B239  86 03              stx    <__temp
       07:B23B  05 03              ora    <__temp
                                   ; pla
 2150                             __lbeq  LL112
       07:B23D  D0 03              bne    .x02833
       07:B23F  4C F8 B2           jmp    LL112
       07:B242            .x02833
 2151                             __ldwi  _lfo_cnt
       07:B242  A2 34              ldx    #low(_lfo_cnt)
       07:B244  A9 2A              lda    #high(_lfo_cnt)
 2152                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B246  A0 02              ldy    #2
       07:B248  18                 clc
       07:B249  22                 sax
       07:B24A  71 00              adc    [__sp],Y
       07:B24C  22                 sax
       07:B24D  C8                 iny
       07:B24E  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2153                             __pushw
                                 __submi  2,__stack
       07:B250  48                 pha
       07:B251  38                 sec
       07:B252  A5 00              lda    <__stack
       07:B254  E9 02              sbc    #low(2)
       07:B256  85 00              sta    <__stack
       07:B258  A5 01              lda    <__stack+1
       07:B25A  E9 00              sbc    #high(2)
       07:B25C  85 01              sta    <__stack+1
       07:B25E  68                 pla
       07:B25F  22                 sax
       07:B260  92 00              sta    [__stack]
       07:B262  22                 sax
       07:B263  A0 01              ldy    #1
       07:B265  91 00              sta    [__stack],Y
 2154                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B267  A0 02               ldy   #2
       07:B269  B1 00               lda   [__sp],Y
       07:B26B  AA                  tax
       07:B26C  C8                  iny
       07:B26D  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2155                             __addwi 1
       07:B26F  18                 clc
       07:B270  22                 sax
       07:B271  69 01              adc    #low(1)
       07:B273  22                 sax
       07:B274  69 00              adc    #high(1)
 2156                             __stw   __ptr
       07:B276  8E 0B 20           stx    __ptr
       07:B279  8D 0C 20           sta    __ptr+1
 2157                             __ldwp  __ptr
       07:B27C  B2 0B              lda    [__ptr]
       07:B27E  AA                 tax
       07:B27F  A0 01              ldy    #1
       07:B281  B1 0B              lda    [__ptr],Y
 2158                             __stbps
                                 __stw    <__temp
       07:B283  86 03              stx    <__temp
       07:B285  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B287  B2 00              lda    [__stack]
       07:B289  AA                 tax
       07:B28A  A0 01              ldy    #1
       07:B28C  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B28E  86 0B              stx    <__ptr
       07:B290  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B292  A6 03              ldx    <__temp
       07:B294  A5 04              lda    <__temp+1
                                  .endif
       07:B296  22                 sax
       07:B297  92 0B              sta    [__ptr]
       07:B299  22                 sax
                                 __addmi  2,__stack
       07:B29A  48                 pha
       07:B29B  18                 clc
       07:B29C  A5 00              lda    <__stack
       07:B29E  69 02              adc    #low(2)
       07:B2A0  85 00              sta    <__stack
       07:B2A2  A5 01              lda    <__stack+1
       07:B2A4  69 00              adc    #high(2)
       07:B2A6  85 01              sta    <__stack+1
       07:B2A8  68                 pla
 2159                             __ldwi  _lfo_sw
       07:B2A9  A2 54              ldx    #low(_lfo_sw)
       07:B2AB  A9 2A              lda    #high(_lfo_sw)
 2160                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B2AD  A0 02              ldy    #2
       07:B2AF  18                 clc
       07:B2B0  22                 sax
       07:B2B1  71 00              adc    [__sp],Y
       07:B2B3  22                 sax
       07:B2B4  C8                 iny
       07:B2B5  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2161                             __pushw
                                 __submi  2,__stack
       07:B2B7  48                 pha
       07:B2B8  38                 sec
       07:B2B9  A5 00              lda    <__stack
       07:B2BB  E9 02              sbc    #low(2)
       07:B2BD  85 00              sta    <__stack
       07:B2BF  A5 01              lda    <__stack+1
       07:B2C1  E9 00              sbc    #high(2)
       07:B2C3  85 01              sta    <__stack+1
       07:B2C5  68                 pla
       07:B2C6  22                 sax
       07:B2C7  92 00              sta    [__stack]
       07:B2C9  22                 sax
       07:B2CA  A0 01              ldy    #1
       07:B2CC  91 00              sta    [__stack],Y
 2162                             __ldwi  3
       07:B2CE  A2 03              ldx    #low(3)
       07:B2D0  A9 00              lda    #high(3)
 2163                             __stbps
                                 __stw    <__temp
       07:B2D2  86 03              stx    <__temp
       07:B2D4  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B2D6  B2 00              lda    [__stack]
       07:B2D8  AA                 tax
       07:B2D9  A0 01              ldy    #1
       07:B2DB  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B2DD  86 0B              stx    <__ptr
       07:B2DF  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B2E1  A6 03              ldx    <__temp
       07:B2E3  A5 04              lda    <__temp+1
                                  .endif
       07:B2E5  22                 sax
       07:B2E6  92 0B              sta    [__ptr]
       07:B2E8  22                 sax
                                 __addmi  2,__stack
       07:B2E9  48                 pha
       07:B2EA  18                 clc
       07:B2EB  A5 00              lda    <__stack
       07:B2ED  69 02              adc    #low(2)
       07:B2EF  85 00              sta    <__stack
       07:B2F1  A5 01              lda    <__stack+1
       07:B2F3  69 00              adc    #high(2)
       07:B2F5  85 01              sta    <__stack+1
       07:B2F7  68                 pla
 2164  07:B2F8            LL112:
 2165                     
 2166  07:B2F8            LL111:
 2167                     
 2168                             __lbra  LL98
       07:B2F8  4C F3 B8           jmp    LL98
 2169  07:B2FB            LL113:
 2170                     
 2171                             __ldwi  _lfo_cnt
       07:B2FB  A2 34              ldx    #low(_lfo_cnt)
       07:B2FD  A9 2A              lda    #high(_lfo_cnt)
 2172                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B2FF  A0 02              ldy    #2
       07:B301  18                 clc
       07:B302  22                 sax
       07:B303  71 00              adc    [__sp],Y
       07:B305  22                 sax
       07:B306  C8                 iny
       07:B307  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2173                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B309  86 0B              stx    <__ptr
       07:B30B  85 0C              sta    <__ptr+1
       07:B30D  B2 0B              lda    [__ptr]
       07:B30F  AA                 tax
       07:B310  62                 cla
                          ;        bpl    .x_02862   ; signed
                          ;        dec    A
                          ;.x_02862:
 2174                             __tstw
                                   ; pha
       07:B311  86 03              stx    <__temp
       07:B313  05 03              ora    <__temp
                                   ; pla
 2175                             __lbeq  LL114
       07:B315  D0 03              bne    .x02864
       07:B317  4C 7B B3           jmp    LL114
       07:B31A            .x02864
 2176                             __ldwi  _lfo_cnt
       07:B31A  A2 34              ldx    #low(_lfo_cnt)
       07:B31C  A9 2A              lda    #high(_lfo_cnt)
 2177                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B31E  A0 02              ldy    #2
       07:B320  18                 clc
       07:B321  22                 sax
       07:B322  71 00              adc    [__sp],Y
       07:B324  22                 sax
       07:B325  C8                 iny
       07:B326  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2178                             __pushw
                                 __submi  2,__stack
       07:B328  48                 pha
       07:B329  38                 sec
       07:B32A  A5 00              lda    <__stack
       07:B32C  E9 02              sbc    #low(2)
       07:B32E  85 00              sta    <__stack
       07:B330  A5 01              lda    <__stack+1
       07:B332  E9 00              sbc    #high(2)
       07:B334  85 01              sta    <__stack+1
       07:B336  68                 pla
       07:B337  22                 sax
       07:B338  92 00              sta    [__stack]
       07:B33A  22                 sax
       07:B33B  A0 01              ldy    #1
       07:B33D  91 00              sta    [__stack],Y
 2179                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B33F  86 0B              stx    <__ptr
       07:B341  85 0C              sta    <__ptr+1
       07:B343  B2 0B              lda    [__ptr]
       07:B345  AA                 tax
       07:B346  62                 cla
                          ;        bpl    .x_02869   ; signed
                          ;        dec    A
                          ;.x_02869:
 2180                             __subwi 1
       07:B347  38                 sec
       07:B348  22                 sax
       07:B349  E9 01              sbc    #low(1)
       07:B34B  22                 sax
       07:B34C  E9 00              sbc    #high(1)
 2181                             __stbps
                                 __stw    <__temp
       07:B34E  86 03              stx    <__temp
       07:B350  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B352  B2 00              lda    [__stack]
       07:B354  AA                 tax
       07:B355  A0 01              ldy    #1
       07:B357  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B359  86 0B              stx    <__ptr
       07:B35B  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B35D  A6 03              ldx    <__temp
       07:B35F  A5 04              lda    <__temp+1
                                  .endif
       07:B361  22                 sax
       07:B362  92 0B              sta    [__ptr]
       07:B364  22                 sax
                                 __addmi  2,__stack
       07:B365  48                 pha
       07:B366  18                 clc
       07:B367  A5 00              lda    <__stack
       07:B369  69 02              adc    #low(2)
       07:B36B  85 00              sta    <__stack
       07:B36D  A5 01              lda    <__stack+1
       07:B36F  69 00              adc    #high(2)
       07:B371  85 01              sta    <__stack+1
       07:B373  68                 pla
 2182                             __addwi 1
       07:B374  18                 clc
       07:B375  22                 sax
       07:B376  69 01              adc    #low(1)
       07:B378  22                 sax
       07:B379  69 00              adc    #high(1)
 2183  07:B37B            LL114:
 2184                     
 2185                             __ldwi  _lfo_ct2
       07:B37B  A2 3C              ldx    #low(_lfo_ct2)
       07:B37D  A9 2A              lda    #high(_lfo_ct2)
 2186                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B37F  A0 02              ldy    #2
       07:B381  18                 clc
       07:B382  22                 sax
       07:B383  71 00              adc    [__sp],Y
       07:B385  22                 sax
       07:B386  C8                 iny
       07:B387  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2187                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B389  86 0B              stx    <__ptr
       07:B38B  85 0C              sta    <__ptr+1
       07:B38D  B2 0B              lda    [__ptr]
       07:B38F  AA                 tax
       07:B390  62                 cla
                          ;        bpl    .x_02880   ; signed
                          ;        dec    A
                          ;.x_02880:
 2188                             __tstw
                                   ; pha
       07:B391  86 03              stx    <__temp
       07:B393  05 03              ora    <__temp
                                   ; pla
 2189                             __lbeq  LL115
       07:B395  D0 03              bne    .x02882
       07:B397  4C FE B3           jmp    LL115
       07:B39A            .x02882
 2190                             __ldwi  _lfo_ct2
       07:B39A  A2 3C              ldx    #low(_lfo_ct2)
       07:B39C  A9 2A              lda    #high(_lfo_ct2)
 2191                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B39E  A0 02              ldy    #2
       07:B3A0  18                 clc
       07:B3A1  22                 sax
       07:B3A2  71 00              adc    [__sp],Y
       07:B3A4  22                 sax
       07:B3A5  C8                 iny
       07:B3A6  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2192                             __pushw
                                 __submi  2,__stack
       07:B3A8  48                 pha
       07:B3A9  38                 sec
       07:B3AA  A5 00              lda    <__stack
       07:B3AC  E9 02              sbc    #low(2)
       07:B3AE  85 00              sta    <__stack
       07:B3B0  A5 01              lda    <__stack+1
       07:B3B2  E9 00              sbc    #high(2)
       07:B3B4  85 01              sta    <__stack+1
       07:B3B6  68                 pla
       07:B3B7  22                 sax
       07:B3B8  92 00              sta    [__stack]
       07:B3BA  22                 sax
       07:B3BB  A0 01              ldy    #1
       07:B3BD  91 00              sta    [__stack],Y
 2193                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B3BF  86 0B              stx    <__ptr
       07:B3C1  85 0C              sta    <__ptr+1
       07:B3C3  B2 0B              lda    [__ptr]
       07:B3C5  AA                 tax
       07:B3C6  62                 cla
                          ;        bpl    .x_02887   ; signed
                          ;        dec    A
                          ;.x_02887:
 2194                             __subwi 1
       07:B3C7  38                 sec
       07:B3C8  22                 sax
       07:B3C9  E9 01              sbc    #low(1)
       07:B3CB  22                 sax
       07:B3CC  E9 00              sbc    #high(1)
 2195                             __stbps
                                 __stw    <__temp
       07:B3CE  86 03              stx    <__temp
       07:B3D0  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B3D2  B2 00              lda    [__stack]
       07:B3D4  AA                 tax
       07:B3D5  A0 01              ldy    #1
       07:B3D7  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B3D9  86 0B              stx    <__ptr
       07:B3DB  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B3DD  A6 03              ldx    <__temp
       07:B3DF  A5 04              lda    <__temp+1
                                  .endif
       07:B3E1  22                 sax
       07:B3E2  92 0B              sta    [__ptr]
       07:B3E4  22                 sax
                                 __addmi  2,__stack
       07:B3E5  48                 pha
       07:B3E6  18                 clc
       07:B3E7  A5 00              lda    <__stack
       07:B3E9  69 02              adc    #low(2)
       07:B3EB  85 00              sta    <__stack
       07:B3ED  A5 01              lda    <__stack+1
       07:B3EF  69 00              adc    #high(2)
       07:B3F1  85 01              sta    <__stack+1
       07:B3F3  68                 pla
 2196                             __addwi 1
       07:B3F4  18                 clc
       07:B3F5  22                 sax
       07:B3F6  69 01              adc    #low(1)
       07:B3F8  22                 sax
       07:B3F9  69 00              adc    #high(1)
 2197                             __lbra  LL116
       07:B3FB  4C E3 B5           jmp    LL116
 2198  07:B3FE            LL115:
 2199                     
 2200                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B3FE  A0 02               ldy   #2
       07:B400  B1 00               lda   [__sp],Y
       07:B402  AA                  tax
       07:B403  C8                  iny
       07:B404  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2201                             __aslw
       07:B406  22                 sax
       07:B407  0A                 asl    A
       07:B408  22                 sax
       07:B409  2A                 rol    A
 2202                             __addwi _seq_freq
       07:B40A  18                 clc
       07:B40B  22                 sax
       07:B40C  69 E4              adc    #low(_seq_freq)
       07:B40E  22                 sax
       07:B40F  69 29              adc    #high(_seq_freq)
 2203                             __pushw
                                 __submi  2,__stack
       07:B411  48                 pha
       07:B412  38                 sec
       07:B413  A5 00              lda    <__stack
       07:B415  E9 02              sbc    #low(2)
       07:B417  85 00              sta    <__stack
       07:B419  A5 01              lda    <__stack+1
       07:B41B  E9 00              sbc    #high(2)
       07:B41D  85 01              sta    <__stack+1
       07:B41F  68                 pla
       07:B420  22                 sax
       07:B421  92 00              sta    [__stack]
       07:B423  22                 sax
       07:B424  A0 01              ldy    #1
       07:B426  91 00              sta    [__stack],Y
 2204                             __stw   __ptr
       07:B428  8E 0B 20           stx    __ptr
       07:B42B  8D 0C 20           sta    __ptr+1
 2205                             __ldwp  __ptr
       07:B42E  B2 0B              lda    [__ptr]
       07:B430  AA                 tax
       07:B431  A0 01              ldy    #1
       07:B433  B1 0B              lda    [__ptr],Y
 2206                             __pushw
                                 __submi  2,__stack
       07:B435  48                 pha
       07:B436  38                 sec
       07:B437  A5 00              lda    <__stack
       07:B439  E9 02              sbc    #low(2)
       07:B43B  85 00              sta    <__stack
       07:B43D  A5 01              lda    <__stack+1
       07:B43F  E9 00              sbc    #high(2)
       07:B441  85 01              sta    <__stack+1
       07:B443  68                 pla
       07:B444  22                 sax
       07:B445  92 00              sta    [__stack]
       07:B447  22                 sax
       07:B448  A0 01              ldy    #1
       07:B44A  91 00              sta    [__stack],Y
 2207                             __ldwi  _lfo_lev
       07:B44C  A2 4C              ldx    #low(_lfo_lev)
       07:B44E  A9 2A              lda    #high(_lfo_lev)
 2208                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B450  A0 06              ldy    #6
       07:B452  18                 clc
       07:B453  22                 sax
       07:B454  71 00              adc    [__sp],Y
       07:B456  22                 sax
       07:B457  C8                 iny
       07:B458  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2209                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B45A  86 0B              stx    <__ptr
       07:B45C  85 0C              sta    <__ptr+1
       07:B45E  B2 0B              lda    [__ptr]
       07:B460  AA                 tax
       07:B461  62                 cla
                          ;        bpl    .x_02908   ; signed
                          ;        dec    A
                          ;.x_02908:
 2210                             __addws
       07:B462  22                 sax
       07:B463  18                 clc
       07:B464  72 00              adc    [__stack]
       07:B466  22                 sax
       07:B467  A0 01              ldy    #1
       07:B469  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       07:B46B  48                 pha
       07:B46C  18                 clc
       07:B46D  A5 00              lda    <__stack
       07:B46F  69 02              adc    #low(2)
       07:B471  85 00              sta    <__stack
       07:B473  A5 01              lda    <__stack+1
       07:B475  69 00              adc    #high(2)
       07:B477  85 01              sta    <__stack+1
       07:B479  68                 pla
 2211                             __stwps
                                 __stw    <__temp
       07:B47A  86 03              stx    <__temp
       07:B47C  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B47E  B2 00              lda    [__stack]
       07:B480  AA                 tax
       07:B481  A0 01              ldy    #1
       07:B483  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B485  86 0B              stx    <__ptr
       07:B487  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B489  A6 03              ldx    <__temp
       07:B48B  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:B48D  22                 sax
       07:B48E  92 0B              sta    [__ptr]
       07:B490  22                 sax
       07:B491  A0 01              ldy    #1
       07:B493  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:B495  48                 pha
       07:B496  18                 clc
       07:B497  A5 00              lda    <__stack
       07:B499  69 02              adc    #low(2)
       07:B49B  85 00              sta    <__stack
       07:B49D  A5 01              lda    <__stack+1
       07:B49F  69 00              adc    #high(2)
       07:B4A1  85 01              sta    <__stack+1
       07:B4A3  68                 pla
 2212                             __ldwi  _lfo_ct2
       07:B4A4  A2 3C              ldx    #low(_lfo_ct2)
       07:B4A6  A9 2A              lda    #high(_lfo_ct2)
 2213                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B4A8  A0 02              ldy    #2
       07:B4AA  18                 clc
       07:B4AB  22                 sax
       07:B4AC  71 00              adc    [__sp],Y
       07:B4AE  22                 sax
       07:B4AF  C8                 iny
       07:B4B0  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2214                             __pushw
                                 __submi  2,__stack
       07:B4B2  48                 pha
       07:B4B3  38                 sec
       07:B4B4  A5 00              lda    <__stack
       07:B4B6  E9 02              sbc    #low(2)
       07:B4B8  85 00              sta    <__stack
       07:B4BA  A5 01              lda    <__stack+1
       07:B4BC  E9 00              sbc    #high(2)
       07:B4BE  85 01              sta    <__stack+1
       07:B4C0  68                 pla
       07:B4C1  22                 sax
       07:B4C2  92 00              sta    [__stack]
       07:B4C4  22                 sax
       07:B4C5  A0 01              ldy    #1
       07:B4C7  91 00              sta    [__stack],Y
 2215                             __ldwi  _lfo_stp
       07:B4C9  A2 44              ldx    #low(_lfo_stp)
       07:B4CB  A9 2A              lda    #high(_lfo_stp)
 2216                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B4CD  A0 04              ldy    #4
       07:B4CF  18                 clc
       07:B4D0  22                 sax
       07:B4D1  71 00              adc    [__sp],Y
       07:B4D3  22                 sax
       07:B4D4  C8                 iny
       07:B4D5  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2217                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B4D7  86 0B              stx    <__ptr
       07:B4D9  85 0C              sta    <__ptr+1
       07:B4DB  B2 0B              lda    [__ptr]
       07:B4DD  AA                 tax
       07:B4DE  62                 cla
                          ;        bpl    .x_02924   ; signed
                          ;        dec    A
                          ;.x_02924:
 2218                             __stbps
                                 __stw    <__temp
       07:B4DF  86 03              stx    <__temp
       07:B4E1  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B4E3  B2 00              lda    [__stack]
       07:B4E5  AA                 tax
       07:B4E6  A0 01              ldy    #1
       07:B4E8  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B4EA  86 0B              stx    <__ptr
       07:B4EC  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B4EE  A6 03              ldx    <__temp
       07:B4F0  A5 04              lda    <__temp+1
                                  .endif
       07:B4F2  22                 sax
       07:B4F3  92 0B              sta    [__ptr]
       07:B4F5  22                 sax
                                 __addmi  2,__stack
       07:B4F6  48                 pha
       07:B4F7  18                 clc
       07:B4F8  A5 00              lda    <__stack
       07:B4FA  69 02              adc    #low(2)
       07:B4FC  85 00              sta    <__stack
       07:B4FE  A5 01              lda    <__stack+1
       07:B500  69 00              adc    #high(2)
       07:B502  85 01              sta    <__stack+1
       07:B504  68                 pla
 2219                             __ldwi  _lfo_cnt
       07:B505  A2 34              ldx    #low(_lfo_cnt)
       07:B507  A9 2A              lda    #high(_lfo_cnt)
 2220                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B509  A0 02              ldy    #2
       07:B50B  18                 clc
       07:B50C  22                 sax
       07:B50D  71 00              adc    [__sp],Y
       07:B50F  22                 sax
       07:B510  C8                 iny
       07:B511  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2221                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B513  86 0B              stx    <__ptr
       07:B515  85 0C              sta    <__ptr+1
       07:B517  B2 0B              lda    [__ptr]
       07:B519  AA                 tax
       07:B51A  62                 cla
                          ;        bpl    .x_02933   ; signed
                          ;        dec    A
                          ;.x_02933:
 2222                             __notw
       07:B51B  86 03              stx    <__temp
       07:B51D  05 03              ora    <__temp
       07:B51F  82                 clx
       07:B520  D0 01              bne    .x02934
       07:B522  E8                 inx
       07:B523  62        .x02934     cla
 2223                             __tstw
                                   ; pha
       07:B524  86 03              stx    <__temp
       07:B526  05 03              ora    <__temp
                                   ; pla
 2224                             __lbeq  LL117
       07:B528  D0 03              bne    .x02936
       07:B52A  4C E3 B5           jmp    LL117
       07:B52D            .x02936
 2225                             __ldwi  _lfo_cnt
       07:B52D  A2 34              ldx    #low(_lfo_cnt)
       07:B52F  A9 2A              lda    #high(_lfo_cnt)
 2226                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B531  A0 02              ldy    #2
       07:B533  18                 clc
       07:B534  22                 sax
       07:B535  71 00              adc    [__sp],Y
       07:B537  22                 sax
       07:B538  C8                 iny
       07:B539  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2227                             __pushw
                                 __submi  2,__stack
       07:B53B  48                 pha
       07:B53C  38                 sec
       07:B53D  A5 00              lda    <__stack
       07:B53F  E9 02              sbc    #low(2)
       07:B541  85 00              sta    <__stack
       07:B543  A5 01              lda    <__stack+1
       07:B545  E9 00              sbc    #high(2)
       07:B547  85 01              sta    <__stack+1
       07:B549  68                 pla
       07:B54A  22                 sax
       07:B54B  92 00              sta    [__stack]
       07:B54D  22                 sax
       07:B54E  A0 01              ldy    #1
       07:B550  91 00              sta    [__stack],Y
 2228                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B552  A0 02               ldy   #2
       07:B554  B1 00               lda   [__sp],Y
       07:B556  AA                  tax
       07:B557  C8                  iny
       07:B558  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2229                             __addwi 1
       07:B55A  18                 clc
       07:B55B  22                 sax
       07:B55C  69 01              adc    #low(1)
       07:B55E  22                 sax
       07:B55F  69 00              adc    #high(1)
 2230                             __stw   __ptr
       07:B561  8E 0B 20           stx    __ptr
       07:B564  8D 0C 20           sta    __ptr+1
 2231                             __ldwp  __ptr
       07:B567  B2 0B              lda    [__ptr]
       07:B569  AA                 tax
       07:B56A  A0 01              ldy    #1
       07:B56C  B1 0B              lda    [__ptr],Y
 2232                             __stbps
                                 __stw    <__temp
       07:B56E  86 03              stx    <__temp
       07:B570  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B572  B2 00              lda    [__stack]
       07:B574  AA                 tax
       07:B575  A0 01              ldy    #1
       07:B577  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B579  86 0B              stx    <__ptr
       07:B57B  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B57D  A6 03              ldx    <__temp
       07:B57F  A5 04              lda    <__temp+1
                                  .endif
       07:B581  22                 sax
       07:B582  92 0B              sta    [__ptr]
       07:B584  22                 sax
                                 __addmi  2,__stack
       07:B585  48                 pha
       07:B586  18                 clc
       07:B587  A5 00              lda    <__stack
       07:B589  69 02              adc    #low(2)
       07:B58B  85 00              sta    <__stack
       07:B58D  A5 01              lda    <__stack+1
       07:B58F  69 00              adc    #high(2)
       07:B591  85 01              sta    <__stack+1
       07:B593  68                 pla
 2233                             __ldwi  _lfo_sw
       07:B594  A2 54              ldx    #low(_lfo_sw)
       07:B596  A9 2A              lda    #high(_lfo_sw)
 2234                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B598  A0 02              ldy    #2
       07:B59A  18                 clc
       07:B59B  22                 sax
       07:B59C  71 00              adc    [__sp],Y
       07:B59E  22                 sax
       07:B59F  C8                 iny
       07:B5A0  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2235                             __pushw
                                 __submi  2,__stack
       07:B5A2  48                 pha
       07:B5A3  38                 sec
       07:B5A4  A5 00              lda    <__stack
       07:B5A6  E9 02              sbc    #low(2)
       07:B5A8  85 00              sta    <__stack
       07:B5AA  A5 01              lda    <__stack+1
       07:B5AC  E9 00              sbc    #high(2)
       07:B5AE  85 01              sta    <__stack+1
       07:B5B0  68                 pla
       07:B5B1  22                 sax
       07:B5B2  92 00              sta    [__stack]
       07:B5B4  22                 sax
       07:B5B5  A0 01              ldy    #1
       07:B5B7  91 00              sta    [__stack],Y
 2236                             __ldwi  4
       07:B5B9  A2 04              ldx    #low(4)
       07:B5BB  A9 00              lda    #high(4)
 2237                             __stbps
                                 __stw    <__temp
       07:B5BD  86 03              stx    <__temp
       07:B5BF  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B5C1  B2 00              lda    [__stack]
       07:B5C3  AA                 tax
       07:B5C4  A0 01              ldy    #1
       07:B5C6  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B5C8  86 0B              stx    <__ptr
       07:B5CA  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B5CC  A6 03              ldx    <__temp
       07:B5CE  A5 04              lda    <__temp+1
                                  .endif
       07:B5D0  22                 sax
       07:B5D1  92 0B              sta    [__ptr]
       07:B5D3  22                 sax
                                 __addmi  2,__stack
       07:B5D4  48                 pha
       07:B5D5  18                 clc
       07:B5D6  A5 00              lda    <__stack
       07:B5D8  69 02              adc    #low(2)
       07:B5DA  85 00              sta    <__stack
       07:B5DC  A5 01              lda    <__stack+1
       07:B5DE  69 00              adc    #high(2)
       07:B5E0  85 01              sta    <__stack+1
       07:B5E2  68                 pla
 2238  07:B5E3            LL117:
 2239                     
 2240  07:B5E3            LL116:
 2241                     
 2242                             __lbra  LL98
       07:B5E3  4C F3 B8           jmp    LL98
 2243  07:B5E6            LL118:
 2244                     
 2245                             __ldwi  _lfo_cnt
       07:B5E6  A2 34              ldx    #low(_lfo_cnt)
       07:B5E8  A9 2A              lda    #high(_lfo_cnt)
 2246                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B5EA  A0 02              ldy    #2
       07:B5EC  18                 clc
       07:B5ED  22                 sax
       07:B5EE  71 00              adc    [__sp],Y
       07:B5F0  22                 sax
       07:B5F1  C8                 iny
       07:B5F2  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2247                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B5F4  86 0B              stx    <__ptr
       07:B5F6  85 0C              sta    <__ptr+1
       07:B5F8  B2 0B              lda    [__ptr]
       07:B5FA  AA                 tax
       07:B5FB  62                 cla
                          ;        bpl    .x_02965   ; signed
                          ;        dec    A
                          ;.x_02965:
 2248                             __tstw
                                   ; pha
       07:B5FC  86 03              stx    <__temp
       07:B5FE  05 03              ora    <__temp
                                   ; pla
 2249                             __lbeq  LL119
       07:B600  D0 03              bne    .x02967
       07:B602  4C 66 B6           jmp    LL119
       07:B605            .x02967
 2250                             __ldwi  _lfo_cnt
       07:B605  A2 34              ldx    #low(_lfo_cnt)
       07:B607  A9 2A              lda    #high(_lfo_cnt)
 2251                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B609  A0 02              ldy    #2
       07:B60B  18                 clc
       07:B60C  22                 sax
       07:B60D  71 00              adc    [__sp],Y
       07:B60F  22                 sax
       07:B610  C8                 iny
       07:B611  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2252                             __pushw
                                 __submi  2,__stack
       07:B613  48                 pha
       07:B614  38                 sec
       07:B615  A5 00              lda    <__stack
       07:B617  E9 02              sbc    #low(2)
       07:B619  85 00              sta    <__stack
       07:B61B  A5 01              lda    <__stack+1
       07:B61D  E9 00              sbc    #high(2)
       07:B61F  85 01              sta    <__stack+1
       07:B621  68                 pla
       07:B622  22                 sax
       07:B623  92 00              sta    [__stack]
       07:B625  22                 sax
       07:B626  A0 01              ldy    #1
       07:B628  91 00              sta    [__stack],Y
 2253                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B62A  86 0B              stx    <__ptr
       07:B62C  85 0C              sta    <__ptr+1
       07:B62E  B2 0B              lda    [__ptr]
       07:B630  AA                 tax
       07:B631  62                 cla
                          ;        bpl    .x_02972   ; signed
                          ;        dec    A
                          ;.x_02972:
 2254                             __subwi 1
       07:B632  38                 sec
       07:B633  22                 sax
       07:B634  E9 01              sbc    #low(1)
       07:B636  22                 sax
       07:B637  E9 00              sbc    #high(1)
 2255                             __stbps
                                 __stw    <__temp
       07:B639  86 03              stx    <__temp
       07:B63B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B63D  B2 00              lda    [__stack]
       07:B63F  AA                 tax
       07:B640  A0 01              ldy    #1
       07:B642  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B644  86 0B              stx    <__ptr
       07:B646  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B648  A6 03              ldx    <__temp
       07:B64A  A5 04              lda    <__temp+1
                                  .endif
       07:B64C  22                 sax
       07:B64D  92 0B              sta    [__ptr]
       07:B64F  22                 sax
                                 __addmi  2,__stack
       07:B650  48                 pha
       07:B651  18                 clc
       07:B652  A5 00              lda    <__stack
       07:B654  69 02              adc    #low(2)
       07:B656  85 00              sta    <__stack
       07:B658  A5 01              lda    <__stack+1
       07:B65A  69 00              adc    #high(2)
       07:B65C  85 01              sta    <__stack+1
       07:B65E  68                 pla
 2256                             __addwi 1
       07:B65F  18                 clc
       07:B660  22                 sax
       07:B661  69 01              adc    #low(1)
       07:B663  22                 sax
       07:B664  69 00              adc    #high(1)
 2257  07:B666            LL119:
 2258                     
 2259                             __ldwi  _lfo_ct2
       07:B666  A2 3C              ldx    #low(_lfo_ct2)
       07:B668  A9 2A              lda    #high(_lfo_ct2)
 2260                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B66A  A0 02              ldy    #2
       07:B66C  18                 clc
       07:B66D  22                 sax
       07:B66E  71 00              adc    [__sp],Y
       07:B670  22                 sax
       07:B671  C8                 iny
       07:B672  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2261                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B674  86 0B              stx    <__ptr
       07:B676  85 0C              sta    <__ptr+1
       07:B678  B2 0B              lda    [__ptr]
       07:B67A  AA                 tax
       07:B67B  62                 cla
                          ;        bpl    .x_02983   ; signed
                          ;        dec    A
                          ;.x_02983:
 2262                             __tstw
                                   ; pha
       07:B67C  86 03              stx    <__temp
       07:B67E  05 03              ora    <__temp
                                   ; pla
 2263                             __lbeq  LL120
       07:B680  D0 03              bne    .x02985
       07:B682  4C E9 B6           jmp    LL120
       07:B685            .x02985
 2264                             __ldwi  _lfo_ct2
       07:B685  A2 3C              ldx    #low(_lfo_ct2)
       07:B687  A9 2A              lda    #high(_lfo_ct2)
 2265                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B689  A0 02              ldy    #2
       07:B68B  18                 clc
       07:B68C  22                 sax
       07:B68D  71 00              adc    [__sp],Y
       07:B68F  22                 sax
       07:B690  C8                 iny
       07:B691  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2266                             __pushw
                                 __submi  2,__stack
       07:B693  48                 pha
       07:B694  38                 sec
       07:B695  A5 00              lda    <__stack
       07:B697  E9 02              sbc    #low(2)
       07:B699  85 00              sta    <__stack
       07:B69B  A5 01              lda    <__stack+1
       07:B69D  E9 00              sbc    #high(2)
       07:B69F  85 01              sta    <__stack+1
       07:B6A1  68                 pla
       07:B6A2  22                 sax
       07:B6A3  92 00              sta    [__stack]
       07:B6A5  22                 sax
       07:B6A6  A0 01              ldy    #1
       07:B6A8  91 00              sta    [__stack],Y
 2267                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B6AA  86 0B              stx    <__ptr
       07:B6AC  85 0C              sta    <__ptr+1
       07:B6AE  B2 0B              lda    [__ptr]
       07:B6B0  AA                 tax
       07:B6B1  62                 cla
                          ;        bpl    .x_02990   ; signed
                          ;        dec    A
                          ;.x_02990:
 2268                             __subwi 1
       07:B6B2  38                 sec
       07:B6B3  22                 sax
       07:B6B4  E9 01              sbc    #low(1)
       07:B6B6  22                 sax
       07:B6B7  E9 00              sbc    #high(1)
 2269                             __stbps
                                 __stw    <__temp
       07:B6B9  86 03              stx    <__temp
       07:B6BB  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B6BD  B2 00              lda    [__stack]
       07:B6BF  AA                 tax
       07:B6C0  A0 01              ldy    #1
       07:B6C2  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B6C4  86 0B              stx    <__ptr
       07:B6C6  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B6C8  A6 03              ldx    <__temp
       07:B6CA  A5 04              lda    <__temp+1
                                  .endif
       07:B6CC  22                 sax
       07:B6CD  92 0B              sta    [__ptr]
       07:B6CF  22                 sax
                                 __addmi  2,__stack
       07:B6D0  48                 pha
       07:B6D1  18                 clc
       07:B6D2  A5 00              lda    <__stack
       07:B6D4  69 02              adc    #low(2)
       07:B6D6  85 00              sta    <__stack
       07:B6D8  A5 01              lda    <__stack+1
       07:B6DA  69 00              adc    #high(2)
       07:B6DC  85 01              sta    <__stack+1
       07:B6DE  68                 pla
 2270                             __addwi 1
       07:B6DF  18                 clc
       07:B6E0  22                 sax
       07:B6E1  69 01              adc    #low(1)
       07:B6E3  22                 sax
       07:B6E4  69 00              adc    #high(1)
 2271                             __lbra  LL121
       07:B6E6  4C D5 B8           jmp    LL121
 2272  07:B6E9            LL120:
 2273                     
 2274                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B6E9  A0 02               ldy   #2
       07:B6EB  B1 00               lda   [__sp],Y
       07:B6ED  AA                  tax
       07:B6EE  C8                  iny
       07:B6EF  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2275                             __aslw
       07:B6F1  22                 sax
       07:B6F2  0A                 asl    A
       07:B6F3  22                 sax
       07:B6F4  2A                 rol    A
 2276                             __addwi _seq_freq
       07:B6F5  18                 clc
       07:B6F6  22                 sax
       07:B6F7  69 E4              adc    #low(_seq_freq)
       07:B6F9  22                 sax
       07:B6FA  69 29              adc    #high(_seq_freq)
 2277                             __pushw
                                 __submi  2,__stack
       07:B6FC  48                 pha
       07:B6FD  38                 sec
       07:B6FE  A5 00              lda    <__stack
       07:B700  E9 02              sbc    #low(2)
       07:B702  85 00              sta    <__stack
       07:B704  A5 01              lda    <__stack+1
       07:B706  E9 00              sbc    #high(2)
       07:B708  85 01              sta    <__stack+1
       07:B70A  68                 pla
       07:B70B  22                 sax
       07:B70C  92 00              sta    [__stack]
       07:B70E  22                 sax
       07:B70F  A0 01              ldy    #1
       07:B711  91 00              sta    [__stack],Y
 2278                             __stw   __ptr
       07:B713  8E 0B 20           stx    __ptr
       07:B716  8D 0C 20           sta    __ptr+1
 2279                             __ldwp  __ptr
       07:B719  B2 0B              lda    [__ptr]
       07:B71B  AA                 tax
       07:B71C  A0 01              ldy    #1
       07:B71E  B1 0B              lda    [__ptr],Y
 2280                             __pushw
                                 __submi  2,__stack
       07:B720  48                 pha
       07:B721  38                 sec
       07:B722  A5 00              lda    <__stack
       07:B724  E9 02              sbc    #low(2)
       07:B726  85 00              sta    <__stack
       07:B728  A5 01              lda    <__stack+1
       07:B72A  E9 00              sbc    #high(2)
       07:B72C  85 01              sta    <__stack+1
       07:B72E  68                 pla
       07:B72F  22                 sax
       07:B730  92 00              sta    [__stack]
       07:B732  22                 sax
       07:B733  A0 01              ldy    #1
       07:B735  91 00              sta    [__stack],Y
 2281                             __ldwi  _lfo_lev
       07:B737  A2 4C              ldx    #low(_lfo_lev)
       07:B739  A9 2A              lda    #high(_lfo_lev)
 2282                             __addw_s        6
                0001              .if (6 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B73B  A0 06              ldy    #6
       07:B73D  18                 clc
       07:B73E  22                 sax
       07:B73F  71 00              adc    [__sp],Y
       07:B741  22                 sax
       07:B742  C8                 iny
       07:B743  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2283                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B745  86 0B              stx    <__ptr
       07:B747  85 0C              sta    <__ptr+1
       07:B749  B2 0B              lda    [__ptr]
       07:B74B  AA                 tax
       07:B74C  62                 cla
                          ;        bpl    .x_03011   ; signed
                          ;        dec    A
                          ;.x_03011:
 2284                             __subws
       07:B74D  86 03             stx     <__temp
       07:B74F  85 04             sta     <__temp+1
       07:B751  38                sec
       07:B752  B2 00             lda     [__stack]
       07:B754  E5 03             sbc     <__temp
       07:B756  AA                tax
       07:B757  A0 01             ldy     #1
       07:B759  B1 00             lda     [__stack],Y
       07:B75B  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       07:B75D  48                 pha
       07:B75E  18                 clc
       07:B75F  A5 00              lda    <__stack
       07:B761  69 02              adc    #low(2)
       07:B763  85 00              sta    <__stack
       07:B765  A5 01              lda    <__stack+1
       07:B767  69 00              adc    #high(2)
       07:B769  85 01              sta    <__stack+1
       07:B76B  68                 pla
 2285                             __stwps
                                 __stw    <__temp
       07:B76C  86 03              stx    <__temp
       07:B76E  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B770  B2 00              lda    [__stack]
       07:B772  AA                 tax
       07:B773  A0 01              ldy    #1
       07:B775  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B777  86 0B              stx    <__ptr
       07:B779  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B77B  A6 03              ldx    <__temp
       07:B77D  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       07:B77F  22                 sax
       07:B780  92 0B              sta    [__ptr]
       07:B782  22                 sax
       07:B783  A0 01              ldy    #1
       07:B785  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       07:B787  48                 pha
       07:B788  18                 clc
       07:B789  A5 00              lda    <__stack
       07:B78B  69 02              adc    #low(2)
       07:B78D  85 00              sta    <__stack
       07:B78F  A5 01              lda    <__stack+1
       07:B791  69 00              adc    #high(2)
       07:B793  85 01              sta    <__stack+1
       07:B795  68                 pla
 2286                             __ldwi  _lfo_ct2
       07:B796  A2 3C              ldx    #low(_lfo_ct2)
       07:B798  A9 2A              lda    #high(_lfo_ct2)
 2287                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B79A  A0 02              ldy    #2
       07:B79C  18                 clc
       07:B79D  22                 sax
       07:B79E  71 00              adc    [__sp],Y
       07:B7A0  22                 sax
       07:B7A1  C8                 iny
       07:B7A2  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2288                             __pushw
                                 __submi  2,__stack
       07:B7A4  48                 pha
       07:B7A5  38                 sec
       07:B7A6  A5 00              lda    <__stack
       07:B7A8  E9 02              sbc    #low(2)
       07:B7AA  85 00              sta    <__stack
       07:B7AC  A5 01              lda    <__stack+1
       07:B7AE  E9 00              sbc    #high(2)
       07:B7B0  85 01              sta    <__stack+1
       07:B7B2  68                 pla
       07:B7B3  22                 sax
       07:B7B4  92 00              sta    [__stack]
       07:B7B6  22                 sax
       07:B7B7  A0 01              ldy    #1
       07:B7B9  91 00              sta    [__stack],Y
 2289                             __ldwi  _lfo_stp
       07:B7BB  A2 44              ldx    #low(_lfo_stp)
       07:B7BD  A9 2A              lda    #high(_lfo_stp)
 2290                             __addw_s        4
                0001              .if (4 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B7BF  A0 04              ldy    #4
       07:B7C1  18                 clc
       07:B7C2  22                 sax
       07:B7C3  71 00              adc    [__sp],Y
       07:B7C5  22                 sax
       07:B7C6  C8                 iny
       07:B7C7  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2291                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B7C9  86 0B              stx    <__ptr
       07:B7CB  85 0C              sta    <__ptr+1
       07:B7CD  B2 0B              lda    [__ptr]
       07:B7CF  AA                 tax
       07:B7D0  62                 cla
                          ;        bpl    .x_03027   ; signed
                          ;        dec    A
                          ;.x_03027:
 2292                             __stbps
                                 __stw    <__temp
       07:B7D1  86 03              stx    <__temp
       07:B7D3  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B7D5  B2 00              lda    [__stack]
       07:B7D7  AA                 tax
       07:B7D8  A0 01              ldy    #1
       07:B7DA  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B7DC  86 0B              stx    <__ptr
       07:B7DE  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B7E0  A6 03              ldx    <__temp
       07:B7E2  A5 04              lda    <__temp+1
                                  .endif
       07:B7E4  22                 sax
       07:B7E5  92 0B              sta    [__ptr]
       07:B7E7  22                 sax
                                 __addmi  2,__stack
       07:B7E8  48                 pha
       07:B7E9  18                 clc
       07:B7EA  A5 00              lda    <__stack
       07:B7EC  69 02              adc    #low(2)
       07:B7EE  85 00              sta    <__stack
       07:B7F0  A5 01              lda    <__stack+1
       07:B7F2  69 00              adc    #high(2)
       07:B7F4  85 01              sta    <__stack+1
       07:B7F6  68                 pla
 2293                             __ldwi  _lfo_cnt
       07:B7F7  A2 34              ldx    #low(_lfo_cnt)
       07:B7F9  A9 2A              lda    #high(_lfo_cnt)
 2294                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B7FB  A0 02              ldy    #2
       07:B7FD  18                 clc
       07:B7FE  22                 sax
       07:B7FF  71 00              adc    [__sp],Y
       07:B801  22                 sax
       07:B802  C8                 iny
       07:B803  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2295                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       07:B805  86 0B              stx    <__ptr
       07:B807  85 0C              sta    <__ptr+1
       07:B809  B2 0B              lda    [__ptr]
       07:B80B  AA                 tax
       07:B80C  62                 cla
                          ;        bpl    .x_03036   ; signed
                          ;        dec    A
                          ;.x_03036:
 2296                             __notw
       07:B80D  86 03              stx    <__temp
       07:B80F  05 03              ora    <__temp
       07:B811  82                 clx
       07:B812  D0 01              bne    .x03037
       07:B814  E8                 inx
       07:B815  62        .x03037     cla
 2297                             __tstw
                                   ; pha
       07:B816  86 03              stx    <__temp
       07:B818  05 03              ora    <__temp
                                   ; pla
 2298                             __lbeq  LL122
       07:B81A  D0 03              bne    .x03039
       07:B81C  4C D5 B8           jmp    LL122
       07:B81F            .x03039
 2299                             __ldwi  _lfo_cnt
       07:B81F  A2 34              ldx    #low(_lfo_cnt)
       07:B821  A9 2A              lda    #high(_lfo_cnt)
 2300                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B823  A0 02              ldy    #2
       07:B825  18                 clc
       07:B826  22                 sax
       07:B827  71 00              adc    [__sp],Y
       07:B829  22                 sax
       07:B82A  C8                 iny
       07:B82B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2301                             __pushw
                                 __submi  2,__stack
       07:B82D  48                 pha
       07:B82E  38                 sec
       07:B82F  A5 00              lda    <__stack
       07:B831  E9 02              sbc    #low(2)
       07:B833  85 00              sta    <__stack
       07:B835  A5 01              lda    <__stack+1
       07:B837  E9 00              sbc    #high(2)
       07:B839  85 01              sta    <__stack+1
       07:B83B  68                 pla
       07:B83C  22                 sax
       07:B83D  92 00              sta    [__stack]
       07:B83F  22                 sax
       07:B840  A0 01              ldy    #1
       07:B842  91 00              sta    [__stack],Y
 2302                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B844  A0 02               ldy   #2
       07:B846  B1 00               lda   [__sp],Y
       07:B848  AA                  tax
       07:B849  C8                  iny
       07:B84A  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2303                             __addwi 1
       07:B84C  18                 clc
       07:B84D  22                 sax
       07:B84E  69 01              adc    #low(1)
       07:B850  22                 sax
       07:B851  69 00              adc    #high(1)
 2304                             __stw   __ptr
       07:B853  8E 0B 20           stx    __ptr
       07:B856  8D 0C 20           sta    __ptr+1
 2305                             __ldwp  __ptr
       07:B859  B2 0B              lda    [__ptr]
       07:B85B  AA                 tax
       07:B85C  A0 01              ldy    #1
       07:B85E  B1 0B              lda    [__ptr],Y
 2306                             __stbps
                                 __stw    <__temp
       07:B860  86 03              stx    <__temp
       07:B862  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B864  B2 00              lda    [__stack]
       07:B866  AA                 tax
       07:B867  A0 01              ldy    #1
       07:B869  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B86B  86 0B              stx    <__ptr
       07:B86D  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B86F  A6 03              ldx    <__temp
       07:B871  A5 04              lda    <__temp+1
                                  .endif
       07:B873  22                 sax
       07:B874  92 0B              sta    [__ptr]
       07:B876  22                 sax
                                 __addmi  2,__stack
       07:B877  48                 pha
       07:B878  18                 clc
       07:B879  A5 00              lda    <__stack
       07:B87B  69 02              adc    #low(2)
       07:B87D  85 00              sta    <__stack
       07:B87F  A5 01              lda    <__stack+1
       07:B881  69 00              adc    #high(2)
       07:B883  85 01              sta    <__stack+1
       07:B885  68                 pla
 2307                             __ldwi  _lfo_sw
       07:B886  A2 54              ldx    #low(_lfo_sw)
       07:B888  A9 2A              lda    #high(_lfo_sw)
 2308                             __addw_s        2
                0001              .if (2 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       07:B88A  A0 02              ldy    #2
       07:B88C  18                 clc
       07:B88D  22                 sax
       07:B88E  71 00              adc    [__sp],Y
       07:B890  22                 sax
       07:B891  C8                 iny
       07:B892  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2309                             __pushw
                                 __submi  2,__stack
       07:B894  48                 pha
       07:B895  38                 sec
       07:B896  A5 00              lda    <__stack
       07:B898  E9 02              sbc    #low(2)
       07:B89A  85 00              sta    <__stack
       07:B89C  A5 01              lda    <__stack+1
       07:B89E  E9 00              sbc    #high(2)
       07:B8A0  85 01              sta    <__stack+1
       07:B8A2  68                 pla
       07:B8A3  22                 sax
       07:B8A4  92 00              sta    [__stack]
       07:B8A6  22                 sax
       07:B8A7  A0 01              ldy    #1
       07:B8A9  91 00              sta    [__stack],Y
 2310                             __ldwi  1
       07:B8AB  A2 01              ldx    #low(1)
       07:B8AD  A9 00              lda    #high(1)
 2311                             __stbps
                                 __stw    <__temp
       07:B8AF  86 03              stx    <__temp
       07:B8B1  85 04              sta    <__temp+1
                                 __ldwp    __stack
       07:B8B3  B2 00              lda    [__stack]
       07:B8B5  AA                 tax
       07:B8B6  A0 01              ldy    #1
       07:B8B8  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       07:B8BA  86 0B              stx    <__ptr
       07:B8BC  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       07:B8BE  A6 03              ldx    <__temp
       07:B8C0  A5 04              lda    <__temp+1
                                  .endif
       07:B8C2  22                 sax
       07:B8C3  92 0B              sta    [__ptr]
       07:B8C5  22                 sax
                                 __addmi  2,__stack
       07:B8C6  48                 pha
       07:B8C7  18                 clc
       07:B8C8  A5 00              lda    <__stack
       07:B8CA  69 02              adc    #low(2)
       07:B8CC  85 00              sta    <__stack
       07:B8CE  A5 01              lda    <__stack+1
       07:B8D0  69 00              adc    #high(2)
       07:B8D2  85 01              sta    <__stack+1
       07:B8D4  68                 pla
 2312  07:B8D5            LL122:
 2313                     
 2314  07:B8D5            LL121:
 2315                     
 2316                             __lbra  LL98
       07:B8D5  4C F3 B8           jmp    LL98
 2317                             __lbra  LL98
       07:B8D8  4C F3 B8           jmp    LL98
 2318  07:B8DB            LL97:
 2319                     
 2320  07:B8DB  00 00             .dw     0,LL99,1,LL103,2,LL108,3,LL113
       07:B8DD  D0 A9     
       07:B8DF  01 00     
       07:B8E1  1E AD     
       07:B8E3  02 00     
       07:B8E5  10 B0     
       07:B8E7  03 00     
       07:B8E9  FB B2     
 2321  07:B8EB  04 00             .dw     4,LL118
       07:B8ED  E6 B5     
 2322  07:B8EF  F3 B8             .dw     LL98,0
       07:B8F1  00 00     
 2323  07:B8F3            LL98:
 2324                     
 2325                             __ldwi  2051
       07:B8F3  A2 03              ldx    #low(2051)
       07:B8F5  A9 08              lda    #high(2051)
 2326                             __stw   _bx
       07:B8F7  8E FA 20           stx    _bx
       07:B8FA  8D FB 20           sta    _bx+1
 2327                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B8FD  A0 02               ldy   #2
       07:B8FF  B1 00               lda   [__sp],Y
       07:B901  AA                  tax
       07:B902  C8                  iny
       07:B903  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2328                             __aslw
       07:B905  22                 sax
       07:B906  0A                 asl    A
       07:B907  22                 sax
       07:B908  2A                 rol    A
 2329                             __addwi _seq_freq
       07:B909  18                 clc
       07:B90A  22                 sax
       07:B90B  69 E4              adc    #low(_seq_freq)
       07:B90D  22                 sax
       07:B90E  69 29              adc    #high(_seq_freq)
 2330                             __stw   __ptr
       07:B910  8E 0B 20           stx    __ptr
       07:B913  8D 0C 20           sta    __ptr+1
 2331                             __ldwp  __ptr
       07:B916  B2 0B              lda    [__ptr]
       07:B918  AA                 tax
       07:B919  A0 01              ldy    #1
       07:B91B  B1 0B              lda    [__ptr],Y
 2332                             __pushw
                                 __submi  2,__stack
       07:B91D  48                 pha
       07:B91E  38                 sec
       07:B91F  A5 00              lda    <__stack
       07:B921  E9 02              sbc    #low(2)
       07:B923  85 00              sta    <__stack
       07:B925  A5 01              lda    <__stack+1
       07:B927  E9 00              sbc    #high(2)
       07:B929  85 01              sta    <__stack+1
       07:B92B  68                 pla
       07:B92C  22                 sax
       07:B92D  92 00              sta    [__stack]
       07:B92F  22                 sax
       07:B930  A0 01              ldy    #1
       07:B932  91 00              sta    [__stack],Y
 2333                             __ldwi  8
       07:B934  A2 08              ldx    #low(8)
       07:B936  A9 00              lda    #high(8)
 2334  07:B938  20 89 EA            jsr   asr
 2335                             __andwi 15
       07:B93B  22                 sax
       07:B93C  29 0F              and    #low(15)
       07:B93E  22                 sax
       07:B93F  29 00              and    #high(15)
 2336  07:B941  20 A4 FB            call  _poke.2
 2337                             __ldwi  2050
       07:B944  A2 02              ldx    #low(2050)
       07:B946  A9 08              lda    #high(2050)
 2338                             __stw   _bx
       07:B948  8E FA 20           stx    _bx
       07:B94B  8D FB 20           sta    _bx+1
 2339                             __ldw_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (2 = 0)
                                   .else
       07:B94E  A0 02               ldy   #2
       07:B950  B1 00               lda   [__sp],Y
       07:B952  AA                  tax
       07:B953  C8                  iny
       07:B954  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2340                             __aslw
       07:B956  22                 sax
       07:B957  0A                 asl    A
       07:B958  22                 sax
       07:B959  2A                 rol    A
 2341                             __addwi _seq_freq
       07:B95A  18                 clc
       07:B95B  22                 sax
       07:B95C  69 E4              adc    #low(_seq_freq)
       07:B95E  22                 sax
       07:B95F  69 29              adc    #high(_seq_freq)
 2342                             __stw   __ptr
       07:B961  8E 0B 20           stx    __ptr
       07:B964  8D 0C 20           sta    __ptr+1
 2343                             __ldwp  __ptr
       07:B967  B2 0B              lda    [__ptr]
       07:B969  AA                 tax
       07:B96A  A0 01              ldy    #1
       07:B96C  B1 0B              lda    [__ptr],Y
 2344                             __andwi 255
       07:B96E  22                 sax
       07:B96F  29 FF              and    #low(255)
       07:B971  22                 sax
       07:B972  29 00              and    #high(255)
 2345  07:B974  20 A4 FB            call  _poke.2
 2346  07:B977            LL96:
 2347                     
 2348  07:B977            LL95:
 2349                     
 2350                             __addmi 4,__stack
       07:B977  48                 pha
       07:B978  18                 clc
       07:B979  A5 00              lda    <__stack
       07:B97B  69 04              adc    #low(4)
       07:B97D  85 00              sta    <__stack
       07:B97F  A5 01              lda    <__stack+1
       07:B981  69 00              adc    #high(4)
       07:B983  85 01              sta    <__stack+1
       07:B985  68                 pla
 2351  07:B986  60                  rts
 2352                             .endp
 2353                     
 2354  08:4000                    .proc _drv_intr
 2355                             __addmi -7,__stack
       08:A000  48                 pha
       08:A001  18                 clc
       08:A002  A5 00              lda    <__stack
       08:A004  69 F9              adc    #low(-7)
       08:A006  85 00              sta    <__stack
       08:A008  A5 01              lda    <__stack+1
       08:A00A  69 FF              adc    #high(-7)
       08:A00C  85 01              sta    <__stack+1
       08:A00E  68                 pla
 2356                             __stwi_s        0,5
                0001              .if (5 < 255)
                                   ; short index (bytes : 12, cycles : 24)
                          
       08:A00F  A9 00              lda    #LOW(0)
       08:A011  A0 05              ldy    #5
       08:A013  91 00              sta    [__sp],Y
       08:A015  AA                 tax
       08:A016  A9 00              lda    #HIGH(0)
       08:A018  C8                 iny
       08:A019  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2357  08:A01B            LL124:
 2358                     
 2359                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A01B  A0 05               ldy   #5
       08:A01D  B1 00               lda   [__sp],Y
       08:A01F  AA                  tax
       08:A020  C8                  iny
       08:A021  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2360                             __stw   <__temp
       08:A023  86 03              stx    <__temp
       08:A025  85 04              sta    <__temp+1
 2361                             __ldwi  6
       08:A027  A2 06              ldx    #low(6)
       08:A029  A9 00              lda    #high(6)
 2362  08:A02B  20 A3 E9            jsr   ltzp
 2363                             __lbne  LL126
       08:A02E  F0 03              beq    .x03092
       08:A030  4C 51 A0           jmp    LL126
       08:A033            .x03092
 2364                             __lbra  LL127
       08:A033  4C 6A AC           jmp    LL127
 2365  08:A036            LL125:
 2366                     
 2367                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A036  A0 05               ldy   #5
       08:A038  B1 00               lda   [__sp],Y
       08:A03A  AA                  tax
       08:A03B  C8                  iny
       08:A03C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2368                             __incw_s        5
                                   ; (bytes : 16, cycles : 24/40)
                          
       08:A03E  48                 pha
       08:A03F  A0 05              ldy    #5
       08:A041  8A                 txa
       08:A042  1A                 inc    A
       08:A043  91 00              sta    [__sp],Y
       08:A045  D0 06              bne    .x_03095
       08:A047  C8                 iny
       08:A048  B1 00              lda    [__sp],Y
       08:A04A  1A                 inc    A
       08:A04B  91 00              sta    [__sp],Y
       08:A04D            .x_03095:
       08:A04D  68                 pla
 2369                             __lbra  LL124
       08:A04E  4C 1B A0           jmp    LL124
 2370  08:A051            LL126:
 2371                     
 2372                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A051  A0 05               ldy   #5
       08:A053  B1 00               lda   [__sp],Y
       08:A055  AA                  tax
       08:A056  C8                  iny
       08:A057  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2373  08:A059  8E 87 29            stx   _reg_ch
 2374                             __ldwi  2048
       08:A05C  A2 00              ldx    #low(2048)
       08:A05E  A9 08              lda    #high(2048)
 2375                             __stw   _bx
       08:A060  8E FA 20           stx    _bx
       08:A063  8D FB 20           sta    _bx+1
 2376                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A066  A0 05               ldy   #5
       08:A068  B1 00               lda   [__sp],Y
       08:A06A  AA                  tax
       08:A06B  C8                  iny
       08:A06C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2377  08:A06E  20 A4 FB            call  _poke.2
 2378                             __ldwi  _ch_cnt
       08:A071  A2 88              ldx    #low(_ch_cnt)
       08:A073  A9 29              lda    #high(_ch_cnt)
 2379                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A075  A0 05              ldy    #5
       08:A077  18                 clc
       08:A078  22                 sax
       08:A079  71 00              adc    [__sp],Y
       08:A07B  22                 sax
       08:A07C  C8                 iny
       08:A07D  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2380                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A07F  86 0B              stx    <__ptr
       08:A081  85 0C              sta    <__ptr+1
       08:A083  B2 0B              lda    [__ptr]
       08:A085  AA                 tax
       08:A086  62                 cla
                          ;        bpl    .x_03103   ; signed
                          ;        dec    A
                          ;.x_03103:
 2381                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       08:A087  A8                 tay
       08:A088  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       08:A08A  18                 clc
       08:A08B  69 04              adc    #4
                                  .endif
       08:A08D  85 02              sta    <__arg_idx
       08:A08F  42                 say
                                  .else
                                  .endif
                          
       08:A090  99 60 2A           sta    __arg-(4),Y
       08:A093  8A                 txa
       08:A094  99 61 2A           sta    __arg-(4-1),Y
 2382                             __ldwi  2
       08:A097  A2 02              ldx    #low(2)
       08:A099  A9 00              lda    #high(2)
 2383                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       08:A09B  A4 02              ldy    <__arg_idx
                                  .endif
                          
       08:A09D  8A                 txa
       08:A09E  99 62 2A           sta    __arg-(2),Y
 2384                             __ldwi  5
       08:A0A1  A2 05              ldx    #low(5)
       08:A0A3  A9 00              lda    #high(5)
 2385                             __pushw
                                 __submi  2,__stack
       08:A0A5  48                 pha
       08:A0A6  38                 sec
       08:A0A7  A5 00              lda    <__stack
       08:A0A9  E9 02              sbc    #low(2)
       08:A0AB  85 00              sta    <__stack
       08:A0AD  A5 01              lda    <__stack+1
       08:A0AF  E9 00              sbc    #high(2)
       08:A0B1  85 01              sta    <__stack+1
       08:A0B3  68                 pla
       08:A0B4  22                 sax
       08:A0B5  92 00              sta    [__stack]
       08:A0B7  22                 sax
       08:A0B8  A0 01              ldy    #1
       08:A0BA  91 00              sta    [__stack],Y
 2386                             __ldw_s 7
                0001              .if (7 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (7 = 0)
                                   .else
       08:A0BC  A0 07               ldy   #7
       08:A0BE  B1 00               lda   [__sp],Y
       08:A0C0  AA                  tax
       08:A0C1  C8                  iny
       08:A0C2  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2387                             __pushw
                                 __submi  2,__stack
       08:A0C4  48                 pha
       08:A0C5  38                 sec
       08:A0C6  A5 00              lda    <__stack
       08:A0C8  E9 02              sbc    #low(2)
       08:A0CA  85 00              sta    <__stack
       08:A0CC  A5 01              lda    <__stack+1
       08:A0CE  E9 00              sbc    #high(2)
       08:A0D0  85 01              sta    <__stack+1
       08:A0D2  68                 pla
       08:A0D3  22                 sax
       08:A0D4  92 00              sta    [__stack]
       08:A0D6  22                 sax
       08:A0D7  A0 01              ldy    #1
       08:A0D9  91 00              sta    [__stack],Y
 2388                             __ldwi  2
       08:A0DB  A2 02              ldx    #low(2)
       08:A0DD  A9 00              lda    #high(2)
 2389  08:A0DF  20 60 EA            jsr   asl
 2390                             __addws
       08:A0E2  22                 sax
       08:A0E3  18                 clc
       08:A0E4  72 00              adc    [__stack]
       08:A0E6  22                 sax
       08:A0E7  A0 01              ldy    #1
       08:A0E9  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       08:A0EB  48                 pha
       08:A0EC  18                 clc
       08:A0ED  A5 00              lda    <__stack
       08:A0EF  69 02              adc    #low(2)
       08:A0F1  85 00              sta    <__stack
       08:A0F3  A5 01              lda    <__stack+1
       08:A0F5  69 00              adc    #high(2)
       08:A0F7  85 01              sta    <__stack+1
       08:A0F9  68                 pla
 2391                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       08:A0FA  A4 02              ldy    <__arg_idx
                                  .endif
                          
       08:A0FC  8A                 txa
       08:A0FD  99 63 2A           sta    __arg-(1),Y
 2392                             __ldwi  12
       08:A100  A2 0C              ldx    #low(12)
       08:A102  A9 00              lda    #high(12)
 2393  08:A104  20 2F EF            call  _put_hex.4
 2394                             __ldwi  _ch_cnt
       08:A107  A2 88              ldx    #low(_ch_cnt)
       08:A109  A9 29              lda    #high(_ch_cnt)
 2395                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A10B  A0 05              ldy    #5
       08:A10D  18                 clc
       08:A10E  22                 sax
       08:A10F  71 00              adc    [__sp],Y
       08:A111  22                 sax
       08:A112  C8                 iny
       08:A113  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2396                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A115  86 0B              stx    <__ptr
       08:A117  85 0C              sta    <__ptr+1
       08:A119  B2 0B              lda    [__ptr]
       08:A11B  AA                 tax
       08:A11C  62                 cla
                          ;        bpl    .x_03121   ; signed
                          ;        dec    A
                          ;.x_03121:
 2397                             __notw
       08:A11D  86 03              stx    <__temp
       08:A11F  05 03              ora    <__temp
       08:A121  82                 clx
       08:A122  D0 01              bne    .x03122
       08:A124  E8                 inx
       08:A125  62        .x03122     cla
 2398                             __tstw
                                   ; pha
       08:A126  86 03              stx    <__temp
       08:A128  05 03              ora    <__temp
                                   ; pla
 2399                             __lbeq  LL128
       08:A12A  D0 03              bne    .x03124
       08:A12C  4C 55 A2           jmp    LL128
       08:A12F            .x03124
 2400                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A12F  A0 05               ldy   #5
       08:A131  B1 00               lda   [__sp],Y
       08:A133  AA                  tax
       08:A134  C8                  iny
       08:A135  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2401                             __aslw
       08:A137  22                 sax
       08:A138  0A                 asl    A
       08:A139  22                 sax
       08:A13A  2A                 rol    A
 2402                             __addwi _seq_pos
       08:A13B  18                 clc
       08:A13C  22                 sax
       08:A13D  69 D4              adc    #low(_seq_pos)
       08:A13F  22                 sax
       08:A140  69 29              adc    #high(_seq_pos)
 2403                             __stw   __ptr
       08:A142  8E 0B 20           stx    __ptr
       08:A145  8D 0C 20           sta    __ptr+1
 2404                             __ldwp  __ptr
       08:A148  B2 0B              lda    [__ptr]
       08:A14A  AA                 tax
       08:A14B  A0 01              ldy    #1
       08:A14D  B1 0B              lda    [__ptr],Y
 2405                             __stw   _seq_ptr
       08:A14F  8E D2 29           stx    _seq_ptr
       08:A152  8D D3 29           sta    _seq_ptr+1
 2406                             __ldwi  _ch_bank
       08:A155  A2 98              ldx    #low(_ch_bank)
       08:A157  A9 29              lda    #high(_ch_bank)
 2407                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A159  A0 05              ldy    #5
       08:A15B  18                 clc
       08:A15C  22                 sax
       08:A15D  71 00              adc    [__sp],Y
       08:A15F  22                 sax
       08:A160  C8                 iny
       08:A161  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2408                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A163  86 0B              stx    <__ptr
       08:A165  85 0C              sta    <__ptr+1
       08:A167  B2 0B              lda    [__ptr]
       08:A169  AA                 tax
       08:A16A  62                 cla
                          ;        bpl    .x_03133   ; signed
                          ;        dec    A
                          ;.x_03133:
 2409  08:A16B  8E A0 29            stx   _ch_nowbank
 2410                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       08:A16E  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_03135
                          ;        dec    A
                          ;.x_03135:
       08:A171  62                 cla    ; unsigned
                                  .endif
 2411  08:A172  20 00 80            call  _chg_cbank
 2412                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A175  A0 05               ldy   #5
       08:A177  B1 00               lda   [__sp],Y
       08:A179  AA                  tax
       08:A17A  C8                  iny
       08:A17B  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2413                             __pushw
                                 __submi  2,__stack
       08:A17D  48                 pha
       08:A17E  38                 sec
       08:A17F  A5 00              lda    <__stack
       08:A181  E9 02              sbc    #low(2)
       08:A183  85 00              sta    <__stack
       08:A185  A5 01              lda    <__stack+1
       08:A187  E9 00              sbc    #high(2)
       08:A189  85 01              sta    <__stack+1
       08:A18B  68                 pla
       08:A18C  22                 sax
       08:A18D  92 00              sta    [__stack]
       08:A18F  22                 sax
       08:A190  A0 01              ldy    #1
       08:A192  91 00              sta    [__stack],Y
 2414                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       08:A194  AE D2 29           ldx    _seq_ptr
       08:A197  AD D3 29           lda    _seq_ptr+1
                                  .endif
 2415                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A19A  86 0B              stx    <__ptr
       08:A19C  85 0C              sta    <__ptr+1
       08:A19E  B2 0B              lda    [__ptr]
       08:A1A0  AA                 tax
       08:A1A1  62                 cla
                          ;        bpl    .x_03140   ; signed
                          ;        dec    A
                          ;.x_03140:
 2416  08:A1A2  20 A2 80            call  _seq
 2417                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A1A5  A0 05               ldy   #5
       08:A1A7  B1 00               lda   [__sp],Y
       08:A1A9  AA                  tax
       08:A1AA  C8                  iny
       08:A1AB  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2418                             __aslw
       08:A1AD  22                 sax
       08:A1AE  0A                 asl    A
       08:A1AF  22                 sax
       08:A1B0  2A                 rol    A
 2419                             __addwi _seq_pos
       08:A1B1  18                 clc
       08:A1B2  22                 sax
       08:A1B3  69 D4              adc    #low(_seq_pos)
       08:A1B5  22                 sax
       08:A1B6  69 29              adc    #high(_seq_pos)
 2420                             __pushw
                                 __submi  2,__stack
       08:A1B8  48                 pha
       08:A1B9  38                 sec
       08:A1BA  A5 00              lda    <__stack
       08:A1BC  E9 02              sbc    #low(2)
       08:A1BE  85 00              sta    <__stack
       08:A1C0  A5 01              lda    <__stack+1
       08:A1C2  E9 00              sbc    #high(2)
       08:A1C4  85 01              sta    <__stack+1
       08:A1C6  68                 pla
       08:A1C7  22                 sax
       08:A1C8  92 00              sta    [__stack]
       08:A1CA  22                 sax
       08:A1CB  A0 01              ldy    #1
       08:A1CD  91 00              sta    [__stack],Y
 2421                             __ldw   _seq_ptr
                0000              .if (1 = 2)
                                  .else
       08:A1CF  AE D2 29           ldx    _seq_ptr
       08:A1D2  AD D3 29           lda    _seq_ptr+1
                                  .endif
 2422                             __stwps
                                 __stw    <__temp
       08:A1D5  86 03              stx    <__temp
       08:A1D7  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A1D9  B2 00              lda    [__stack]
       08:A1DB  AA                 tax
       08:A1DC  A0 01              ldy    #1
       08:A1DE  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A1E0  86 0B              stx    <__ptr
       08:A1E2  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A1E4  A6 03              ldx    <__temp
       08:A1E6  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A1E8  22                 sax
       08:A1E9  92 0B              sta    [__ptr]
       08:A1EB  22                 sax
       08:A1EC  A0 01              ldy    #1
       08:A1EE  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A1F0  48                 pha
       08:A1F1  18                 clc
       08:A1F2  A5 00              lda    <__stack
       08:A1F4  69 02              adc    #low(2)
       08:A1F6  85 00              sta    <__stack
       08:A1F8  A5 01              lda    <__stack+1
       08:A1FA  69 00              adc    #high(2)
       08:A1FC  85 01              sta    <__stack+1
       08:A1FE  68                 pla
 2423                             __ldwi  _ch_bank
       08:A1FF  A2 98              ldx    #low(_ch_bank)
       08:A201  A9 29              lda    #high(_ch_bank)
 2424                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A203  A0 05              ldy    #5
       08:A205  18                 clc
       08:A206  22                 sax
       08:A207  71 00              adc    [__sp],Y
       08:A209  22                 sax
       08:A20A  C8                 iny
       08:A20B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2425                             __pushw
                                 __submi  2,__stack
       08:A20D  48                 pha
       08:A20E  38                 sec
       08:A20F  A5 00              lda    <__stack
       08:A211  E9 02              sbc    #low(2)
       08:A213  85 00              sta    <__stack
       08:A215  A5 01              lda    <__stack+1
       08:A217  E9 00              sbc    #high(2)
       08:A219  85 01              sta    <__stack+1
       08:A21B  68                 pla
       08:A21C  22                 sax
       08:A21D  92 00              sta    [__stack]
       08:A21F  22                 sax
       08:A220  A0 01              ldy    #1
       08:A222  91 00              sta    [__stack],Y
 2426                             __ldb   _ch_nowbank
                0000              .if (1 = 2)
                                  .else
       08:A224  AE A0 29           ldx    _ch_nowbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_03159
                          ;        dec    A
                          ;.x_03159:
       08:A227  62                 cla    ; unsigned
                                  .endif
 2427                             __stbps
                                 __stw    <__temp
       08:A228  86 03              stx    <__temp
       08:A22A  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A22C  B2 00              lda    [__stack]
       08:A22E  AA                 tax
       08:A22F  A0 01              ldy    #1
       08:A231  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A233  86 0B              stx    <__ptr
       08:A235  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A237  A6 03              ldx    <__temp
       08:A239  A5 04              lda    <__temp+1
                                  .endif
       08:A23B  22                 sax
       08:A23C  92 0B              sta    [__ptr]
       08:A23E  22                 sax
                                 __addmi  2,__stack
       08:A23F  48                 pha
       08:A240  18                 clc
       08:A241  A5 00              lda    <__stack
       08:A243  69 02              adc    #low(2)
       08:A245  85 00              sta    <__stack
       08:A247  A5 01              lda    <__stack+1
       08:A249  69 00              adc    #high(2)
       08:A24B  85 01              sta    <__stack+1
       08:A24D  68                 pla
 2428                             __ldb   _ch_topbank
                0000              .if (1 = 2)
                                  .else
       08:A24E  AE A1 29           ldx    _ch_topbank
                                 __extw
                          ;        txa    ; signed
                          ;        cla
                          ;        bpl    .x_03167
                          ;        dec    A
                          ;.x_03167:
       08:A251  62                 cla    ; unsigned
                                  .endif
 2429  08:A252  20 00 80            call  _chg_cbank
 2430  08:A255            LL128:
 2431                     
 2432                             __ldwi  _ch_cnt
       08:A255  A2 88              ldx    #low(_ch_cnt)
       08:A257  A9 29              lda    #high(_ch_cnt)
 2433                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A259  A0 05              ldy    #5
       08:A25B  18                 clc
       08:A25C  22                 sax
       08:A25D  71 00              adc    [__sp],Y
       08:A25F  22                 sax
       08:A260  C8                 iny
       08:A261  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2434                             __pushw
                                 __submi  2,__stack
       08:A263  48                 pha
       08:A264  38                 sec
       08:A265  A5 00              lda    <__stack
       08:A267  E9 02              sbc    #low(2)
       08:A269  85 00              sta    <__stack
       08:A26B  A5 01              lda    <__stack+1
       08:A26D  E9 00              sbc    #high(2)
       08:A26F  85 01              sta    <__stack+1
       08:A271  68                 pla
       08:A272  22                 sax
       08:A273  92 00              sta    [__stack]
       08:A275  22                 sax
       08:A276  A0 01              ldy    #1
       08:A278  91 00              sta    [__stack],Y
 2435                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A27A  86 0B              stx    <__ptr
       08:A27C  85 0C              sta    <__ptr+1
       08:A27E  B2 0B              lda    [__ptr]
       08:A280  AA                 tax
       08:A281  62                 cla
                          ;        bpl    .x_03172   ; signed
                          ;        dec    A
                          ;.x_03172:
 2436                             __subwi 1
       08:A282  38                 sec
       08:A283  22                 sax
       08:A284  E9 01              sbc    #low(1)
       08:A286  22                 sax
       08:A287  E9 00              sbc    #high(1)
 2437                             __stbps
                                 __stw    <__temp
       08:A289  86 03              stx    <__temp
       08:A28B  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A28D  B2 00              lda    [__stack]
       08:A28F  AA                 tax
       08:A290  A0 01              ldy    #1
       08:A292  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A294  86 0B              stx    <__ptr
       08:A296  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A298  A6 03              ldx    <__temp
       08:A29A  A5 04              lda    <__temp+1
                                  .endif
       08:A29C  22                 sax
       08:A29D  92 0B              sta    [__ptr]
       08:A29F  22                 sax
                                 __addmi  2,__stack
       08:A2A0  48                 pha
       08:A2A1  18                 clc
       08:A2A2  A5 00              lda    <__stack
       08:A2A4  69 02              adc    #low(2)
       08:A2A6  85 00              sta    <__stack
       08:A2A8  A5 01              lda    <__stack+1
       08:A2AA  69 00              adc    #high(2)
       08:A2AC  85 01              sta    <__stack+1
       08:A2AE  68                 pla
 2438                             __addwi 1
       08:A2AF  18                 clc
       08:A2B0  22                 sax
       08:A2B1  69 01              adc    #low(1)
       08:A2B3  22                 sax
       08:A2B4  69 00              adc    #high(1)
 2439                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A2B6  A0 05               ldy   #5
       08:A2B8  B1 00               lda   [__sp],Y
       08:A2BA  AA                  tax
       08:A2BB  C8                  iny
       08:A2BC  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2440                             __aslw
       08:A2BE  22                 sax
       08:A2BF  0A                 asl    A
       08:A2C0  22                 sax
       08:A2C1  2A                 rol    A
 2441                             __addwi _volume_envadr
       08:A2C2  18                 clc
       08:A2C3  22                 sax
       08:A2C4  69 04              adc    #low(_volume_envadr)
       08:A2C6  22                 sax
       08:A2C7  69 2A              adc    #high(_volume_envadr)
 2442                             __stw   __ptr
       08:A2C9  8E 0B 20           stx    __ptr
       08:A2CC  8D 0C 20           sta    __ptr+1
 2443                             __ldwp  __ptr
       08:A2CF  B2 0B              lda    [__ptr]
       08:A2D1  AA                 tax
       08:A2D2  A0 01              ldy    #1
       08:A2D4  B1 0B              lda    [__ptr],Y
 2444                             __tstw
                                   ; pha
       08:A2D6  86 03              stx    <__temp
       08:A2D8  05 03              ora    <__temp
                                   ; pla
 2445                             __lbeq  LL129
       08:A2DA  D0 03              bne    .x03187
       08:A2DC  4C 36 A5           jmp    LL129
       08:A2DF            .x03187
 2446                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A2DF  A0 05               ldy   #5
       08:A2E1  B1 00               lda   [__sp],Y
       08:A2E3  AA                  tax
       08:A2E4  C8                  iny
       08:A2E5  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2447                             __aslw
       08:A2E7  22                 sax
       08:A2E8  0A                 asl    A
       08:A2E9  22                 sax
       08:A2EA  2A                 rol    A
 2448                             __addwi _volume_envadr
       08:A2EB  18                 clc
       08:A2EC  22                 sax
       08:A2ED  69 04              adc    #low(_volume_envadr)
       08:A2EF  22                 sax
       08:A2F0  69 2A              adc    #high(_volume_envadr)
 2449                             __stw   __ptr
       08:A2F2  8E 0B 20           stx    __ptr
       08:A2F5  8D 0C 20           sta    __ptr+1
 2450                             __ldwp  __ptr
       08:A2F8  B2 0B              lda    [__ptr]
       08:A2FA  AA                 tax
       08:A2FB  A0 01              ldy    #1
       08:A2FD  B1 0B              lda    [__ptr],Y
 2451                             __stw   __ptr
       08:A2FF  8E 0B 20           stx    __ptr
       08:A302  8D 0C 20           sta    __ptr+1
 2452                             __ldwp  __ptr
       08:A305  B2 0B              lda    [__ptr]
       08:A307  AA                 tax
       08:A308  A0 01              ldy    #1
       08:A30A  B1 0B              lda    [__ptr],Y
 2453                             __stb_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A30C  22                 sax
       08:A30D  A0 02              ldy    #2
       08:A30F  91 00              sta    [__sp],Y
       08:A311  22                 sax
                                  .else
                                  .endif
 2454                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A312  A0 05               ldy   #5
       08:A314  B1 00               lda   [__sp],Y
       08:A316  AA                  tax
       08:A317  C8                  iny
       08:A318  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2455                             __aslw
       08:A31A  22                 sax
       08:A31B  0A                 asl    A
       08:A31C  22                 sax
       08:A31D  2A                 rol    A
 2456                             __addwi _volume_envadr
       08:A31E  18                 clc
       08:A31F  22                 sax
       08:A320  69 04              adc    #low(_volume_envadr)
       08:A322  22                 sax
       08:A323  69 2A              adc    #high(_volume_envadr)
 2457                             __pushw
                                 __submi  2,__stack
       08:A325  48                 pha
       08:A326  38                 sec
       08:A327  A5 00              lda    <__stack
       08:A329  E9 02              sbc    #low(2)
       08:A32B  85 00              sta    <__stack
       08:A32D  A5 01              lda    <__stack+1
       08:A32F  E9 00              sbc    #high(2)
       08:A331  85 01              sta    <__stack+1
       08:A333  68                 pla
       08:A334  22                 sax
       08:A335  92 00              sta    [__stack]
       08:A337  22                 sax
       08:A338  A0 01              ldy    #1
       08:A33A  91 00              sta    [__stack],Y
 2458                             __stw   __ptr
       08:A33C  8E 0B 20           stx    __ptr
       08:A33F  8D 0C 20           sta    __ptr+1
 2459                             __ldwp  __ptr
       08:A342  B2 0B              lda    [__ptr]
       08:A344  AA                 tax
       08:A345  A0 01              ldy    #1
       08:A347  B1 0B              lda    [__ptr],Y
 2460                             __addwi 1
       08:A349  18                 clc
       08:A34A  22                 sax
       08:A34B  69 01              adc    #low(1)
       08:A34D  22                 sax
       08:A34E  69 00              adc    #high(1)
 2461                             __stwps
                                 __stw    <__temp
       08:A350  86 03              stx    <__temp
       08:A352  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A354  B2 00              lda    [__stack]
       08:A356  AA                 tax
       08:A357  A0 01              ldy    #1
       08:A359  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A35B  86 0B              stx    <__ptr
       08:A35D  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A35F  A6 03              ldx    <__temp
       08:A361  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A363  22                 sax
       08:A364  92 0B              sta    [__ptr]
       08:A366  22                 sax
       08:A367  A0 01              ldy    #1
       08:A369  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A36B  48                 pha
       08:A36C  18                 clc
       08:A36D  A5 00              lda    <__stack
       08:A36F  69 02              adc    #low(2)
       08:A371  85 00              sta    <__stack
       08:A373  A5 01              lda    <__stack+1
       08:A375  69 00              adc    #high(2)
       08:A377  85 01              sta    <__stack+1
       08:A379  68                 pla
 2462                             __subwi 1
       08:A37A  38                 sec
       08:A37B  22                 sax
       08:A37C  E9 01              sbc    #low(1)
       08:A37E  22                 sax
       08:A37F  E9 00              sbc    #high(1)
 2463                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A381  A0 02              ldy    #2
       08:A383  B1 00              lda    [__sp],Y
       08:A385  AA                 tax
       08:A386  62                 cla
                          ;        bpl    .x_03212   ; signed
                          ;        dec    A
                          ;.x_03212:
                                  .else
                                  .endif
 2464                             __stw   <__temp
       08:A387  86 03              stx    <__temp
       08:A389  85 04              sta    <__temp+1
 2465                             __ldwi  255
       08:A38B  A2 FF              ldx    #low(255)
       08:A38D  A9 00              lda    #high(255)
 2466  08:A38F  20 FC E8            jsr   eqzp
 2467                             __lbeq  LL130
       08:A392  D0 03              bne    .x03215
       08:A394  4C 27 A5           jmp    LL130
       08:A397            .x03215
 2468                             __ldwi  _ch_vol
       08:A397  A2 90              ldx    #low(_ch_vol)
       08:A399  A9 29              lda    #high(_ch_vol)
 2469                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A39B  A0 05              ldy    #5
       08:A39D  18                 clc
       08:A39E  22                 sax
       08:A39F  71 00              adc    [__sp],Y
       08:A3A1  22                 sax
       08:A3A2  C8                 iny
       08:A3A3  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2470                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A3A5  86 0B              stx    <__ptr
       08:A3A7  85 0C              sta    <__ptr+1
       08:A3A9  B2 0B              lda    [__ptr]
       08:A3AB  AA                 tax
       08:A3AC  62                 cla
                          ;        bpl    .x_03218   ; signed
                          ;        dec    A
                          ;.x_03218:
 2471                             __andwi 127
       08:A3AD  22                 sax
       08:A3AE  29 7F              and    #low(127)
       08:A3B0  22                 sax
       08:A3B1  29 00              and    #high(127)
 2472                             __stb_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A3B3  22                 sax
       08:A3B4  A0 02              ldy    #2
       08:A3B6  91 00              sta    [__sp],Y
       08:A3B8  22                 sax
                                  .else
                                  .endif
 2473                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A3B9  A0 05               ldy   #5
       08:A3BB  B1 00               lda   [__sp],Y
       08:A3BD  AA                  tax
       08:A3BE  C8                  iny
       08:A3BF  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2474                             __aslw
       08:A3C1  22                 sax
       08:A3C2  0A                 asl    A
       08:A3C3  22                 sax
       08:A3C4  2A                 rol    A
 2475                             __addwi _volume_envadr
       08:A3C5  18                 clc
       08:A3C6  22                 sax
       08:A3C7  69 04              adc    #low(_volume_envadr)
       08:A3C9  22                 sax
       08:A3CA  69 2A              adc    #high(_volume_envadr)
 2476                             __pushw
                                 __submi  2,__stack
       08:A3CC  48                 pha
       08:A3CD  38                 sec
       08:A3CE  A5 00              lda    <__stack
       08:A3D0  E9 02              sbc    #low(2)
       08:A3D2  85 00              sta    <__stack
       08:A3D4  A5 01              lda    <__stack+1
       08:A3D6  E9 00              sbc    #high(2)
       08:A3D8  85 01              sta    <__stack+1
       08:A3DA  68                 pla
       08:A3DB  22                 sax
       08:A3DC  92 00              sta    [__stack]
       08:A3DE  22                 sax
       08:A3DF  A0 01              ldy    #1
       08:A3E1  91 00              sta    [__stack],Y
 2477                             __ldwi  _sound_dat
       08:A3E3  A2 00              ldx    #low(_sound_dat)
       08:A3E5  A9 44              lda    #high(_sound_dat)
 2478                             __addwi 6
       08:A3E7  18                 clc
       08:A3E8  22                 sax
       08:A3E9  69 06              adc    #low(6)
       08:A3EB  22                 sax
       08:A3EC  69 00              adc    #high(6)
 2479                             __stw   __ptr
       08:A3EE  8E 0B 20           stx    __ptr
       08:A3F1  8D 0C 20           sta    __ptr+1
 2480                             __ldwp  __ptr
       08:A3F4  B2 0B              lda    [__ptr]
       08:A3F6  AA                 tax
       08:A3F7  A0 01              ldy    #1
       08:A3F9  B1 0B              lda    [__ptr],Y
 2481                             __pushw
                                 __submi  2,__stack
       08:A3FB  48                 pha
       08:A3FC  38                 sec
       08:A3FD  A5 00              lda    <__stack
       08:A3FF  E9 02              sbc    #low(2)
       08:A401  85 00              sta    <__stack
       08:A403  A5 01              lda    <__stack+1
       08:A405  E9 00              sbc    #high(2)
       08:A407  85 01              sta    <__stack+1
       08:A409  68                 pla
       08:A40A  22                 sax
       08:A40B  92 00              sta    [__stack]
       08:A40D  22                 sax
       08:A40E  A0 01              ldy    #1
       08:A410  91 00              sta    [__stack],Y
 2482                             __ldb_s 6
                0001              .if (6 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A412  A0 06              ldy    #6
       08:A414  B1 00              lda    [__sp],Y
       08:A416  AA                 tax
       08:A417  62                 cla
                          ;        bpl    .x_03232   ; signed
                          ;        dec    A
                          ;.x_03232:
                                  .else
                                  .endif
 2483                             __pushw
                                 __submi  2,__stack
       08:A418  48                 pha
       08:A419  38                 sec
       08:A41A  A5 00              lda    <__stack
       08:A41C  E9 02              sbc    #low(2)
       08:A41E  85 00              sta    <__stack
       08:A420  A5 01              lda    <__stack+1
       08:A422  E9 00              sbc    #high(2)
       08:A424  85 01              sta    <__stack+1
       08:A426  68                 pla
       08:A427  22                 sax
       08:A428  92 00              sta    [__stack]
       08:A42A  22                 sax
       08:A42B  A0 01              ldy    #1
       08:A42D  91 00              sta    [__stack],Y
 2484                             __ldwi  1
       08:A42F  A2 01              ldx    #low(1)
       08:A431  A9 00              lda    #high(1)
 2485  08:A433  20 60 EA            jsr   asl
 2486                             __addws
       08:A436  22                 sax
       08:A437  18                 clc
       08:A438  72 00              adc    [__stack]
       08:A43A  22                 sax
       08:A43B  A0 01              ldy    #1
       08:A43D  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       08:A43F  48                 pha
       08:A440  18                 clc
       08:A441  A5 00              lda    <__stack
       08:A443  69 02              adc    #low(2)
       08:A445  85 00              sta    <__stack
       08:A447  A5 01              lda    <__stack+1
       08:A449  69 00              adc    #high(2)
       08:A44B  85 01              sta    <__stack+1
       08:A44D  68                 pla
 2487                             __stw   __ptr
       08:A44E  8E 0B 20           stx    __ptr
       08:A451  8D 0C 20           sta    __ptr+1
 2488                             __ldwp  __ptr
       08:A454  B2 0B              lda    [__ptr]
       08:A456  AA                 tax
       08:A457  A0 01              ldy    #1
       08:A459  B1 0B              lda    [__ptr],Y
 2489                             __stwps
                                 __stw    <__temp
       08:A45B  86 03              stx    <__temp
       08:A45D  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A45F  B2 00              lda    [__stack]
       08:A461  AA                 tax
       08:A462  A0 01              ldy    #1
       08:A464  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A466  86 0B              stx    <__ptr
       08:A468  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A46A  A6 03              ldx    <__temp
       08:A46C  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A46E  22                 sax
       08:A46F  92 0B              sta    [__ptr]
       08:A471  22                 sax
       08:A472  A0 01              ldy    #1
       08:A474  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A476  48                 pha
       08:A477  18                 clc
       08:A478  A5 00              lda    <__stack
       08:A47A  69 02              adc    #low(2)
       08:A47C  85 00              sta    <__stack
       08:A47E  A5 01              lda    <__stack+1
       08:A480  69 00              adc    #high(2)
       08:A482  85 01              sta    <__stack+1
       08:A484  68                 pla
 2490                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A485  A0 05               ldy   #5
       08:A487  B1 00               lda   [__sp],Y
       08:A489  AA                  tax
       08:A48A  C8                  iny
       08:A48B  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2491                             __aslw
       08:A48D  22                 sax
       08:A48E  0A                 asl    A
       08:A48F  22                 sax
       08:A490  2A                 rol    A
 2492                             __addwi _volume_envadr
       08:A491  18                 clc
       08:A492  22                 sax
       08:A493  69 04              adc    #low(_volume_envadr)
       08:A495  22                 sax
       08:A496  69 2A              adc    #high(_volume_envadr)
 2493                             __stw   __ptr
       08:A498  8E 0B 20           stx    __ptr
       08:A49B  8D 0C 20           sta    __ptr+1
 2494                             __ldwp  __ptr
       08:A49E  B2 0B              lda    [__ptr]
       08:A4A0  AA                 tax
       08:A4A1  A0 01              ldy    #1
       08:A4A3  B1 0B              lda    [__ptr],Y
 2495                             __stw   __ptr
       08:A4A5  8E 0B 20           stx    __ptr
       08:A4A8  8D 0C 20           sta    __ptr+1
 2496                             __ldwp  __ptr
       08:A4AB  B2 0B              lda    [__ptr]
       08:A4AD  AA                 tax
       08:A4AE  A0 01              ldy    #1
       08:A4B0  B1 0B              lda    [__ptr],Y
 2497                             __stb_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A4B2  22                 sax
       08:A4B3  A0 02              ldy    #2
       08:A4B5  91 00              sta    [__sp],Y
       08:A4B7  22                 sax
                                  .else
                                  .endif
 2498                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A4B8  A0 05               ldy   #5
       08:A4BA  B1 00               lda   [__sp],Y
       08:A4BC  AA                  tax
       08:A4BD  C8                  iny
       08:A4BE  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2499                             __aslw
       08:A4C0  22                 sax
       08:A4C1  0A                 asl    A
       08:A4C2  22                 sax
       08:A4C3  2A                 rol    A
 2500                             __addwi _volume_envadr
       08:A4C4  18                 clc
       08:A4C5  22                 sax
       08:A4C6  69 04              adc    #low(_volume_envadr)
       08:A4C8  22                 sax
       08:A4C9  69 2A              adc    #high(_volume_envadr)
 2501                             __pushw
                                 __submi  2,__stack
       08:A4CB  48                 pha
       08:A4CC  38                 sec
       08:A4CD  A5 00              lda    <__stack
       08:A4CF  E9 02              sbc    #low(2)
       08:A4D1  85 00              sta    <__stack
       08:A4D3  A5 01              lda    <__stack+1
       08:A4D5  E9 00              sbc    #high(2)
       08:A4D7  85 01              sta    <__stack+1
       08:A4D9  68                 pla
       08:A4DA  22                 sax
       08:A4DB  92 00              sta    [__stack]
       08:A4DD  22                 sax
       08:A4DE  A0 01              ldy    #1
       08:A4E0  91 00              sta    [__stack],Y
 2502                             __stw   __ptr
       08:A4E2  8E 0B 20           stx    __ptr
       08:A4E5  8D 0C 20           sta    __ptr+1
 2503                             __ldwp  __ptr
       08:A4E8  B2 0B              lda    [__ptr]
       08:A4EA  AA                 tax
       08:A4EB  A0 01              ldy    #1
       08:A4ED  B1 0B              lda    [__ptr],Y
 2504                             __addwi 1
       08:A4EF  18                 clc
       08:A4F0  22                 sax
       08:A4F1  69 01              adc    #low(1)
       08:A4F3  22                 sax
       08:A4F4  69 00              adc    #high(1)
 2505                             __stwps
                                 __stw    <__temp
       08:A4F6  86 03              stx    <__temp
       08:A4F8  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A4FA  B2 00              lda    [__stack]
       08:A4FC  AA                 tax
       08:A4FD  A0 01              ldy    #1
       08:A4FF  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A501  86 0B              stx    <__ptr
       08:A503  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A505  A6 03              ldx    <__temp
       08:A507  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A509  22                 sax
       08:A50A  92 0B              sta    [__ptr]
       08:A50C  22                 sax
       08:A50D  A0 01              ldy    #1
       08:A50F  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A511  48                 pha
       08:A512  18                 clc
       08:A513  A5 00              lda    <__stack
       08:A515  69 02              adc    #low(2)
       08:A517  85 00              sta    <__stack
       08:A519  A5 01              lda    <__stack+1
       08:A51B  69 00              adc    #high(2)
       08:A51D  85 01              sta    <__stack+1
       08:A51F  68                 pla
 2506                             __subwi 1
       08:A520  38                 sec
       08:A521  22                 sax
       08:A522  E9 01              sbc    #low(1)
       08:A524  22                 sax
       08:A525  E9 00              sbc    #high(1)
 2507  08:A527            LL130:
 2508                     
 2509                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A527  A0 02              ldy    #2
       08:A529  B1 00              lda    [__sp],Y
       08:A52B  AA                 tax
       08:A52C  62                 cla
                          ;        bpl    .x_03271   ; signed
                          ;        dec    A
                          ;.x_03271:
                                  .else
                                  .endif
 2510                             __andwi 31
       08:A52D  22                 sax
       08:A52E  29 1F              and    #low(31)
       08:A530  22                 sax
       08:A531  29 00              and    #high(31)
 2511  08:A533  20 24 80            call  _mixvol
 2512  08:A536            LL129:
 2513                     
 2514                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A536  A0 05               ldy   #5
       08:A538  B1 00               lda   [__sp],Y
       08:A53A  AA                  tax
       08:A53B  C8                  iny
       08:A53C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2515                             __aslw
       08:A53E  22                 sax
       08:A53F  0A                 asl    A
       08:A540  22                 sax
       08:A541  2A                 rol    A
 2516                             __addwi _note_envadr
       08:A542  18                 clc
       08:A543  22                 sax
       08:A544  69 14              adc    #low(_note_envadr)
       08:A546  22                 sax
       08:A547  69 2A              adc    #high(_note_envadr)
 2517                             __stw   __ptr
       08:A549  8E 0B 20           stx    __ptr
       08:A54C  8D 0C 20           sta    __ptr+1
 2518                             __ldwp  __ptr
       08:A54F  B2 0B              lda    [__ptr]
       08:A551  AA                 tax
       08:A552  A0 01              ldy    #1
       08:A554  B1 0B              lda    [__ptr],Y
 2519                             __tstw
                                   ; pha
       08:A556  86 03              stx    <__temp
       08:A558  05 03              ora    <__temp
                                   ; pla
 2520                             __lbeq  LL131
       08:A55A  D0 03              bne    .x03279
       08:A55C  4C 51 AC           jmp    LL131
       08:A55F            .x03279
 2521                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A55F  A0 05               ldy   #5
       08:A561  B1 00               lda   [__sp],Y
       08:A563  AA                  tax
       08:A564  C8                  iny
       08:A565  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2522                             __aslw
       08:A567  22                 sax
       08:A568  0A                 asl    A
       08:A569  22                 sax
       08:A56A  2A                 rol    A
 2523                             __addwi _note_envadr
       08:A56B  18                 clc
       08:A56C  22                 sax
       08:A56D  69 14              adc    #low(_note_envadr)
       08:A56F  22                 sax
       08:A570  69 2A              adc    #high(_note_envadr)
 2524                             __stw   __ptr
       08:A572  8E 0B 20           stx    __ptr
       08:A575  8D 0C 20           sta    __ptr+1
 2525                             __ldwp  __ptr
       08:A578  B2 0B              lda    [__ptr]
       08:A57A  AA                 tax
       08:A57B  A0 01              ldy    #1
       08:A57D  B1 0B              lda    [__ptr],Y
 2526                             __stw   __ptr
       08:A57F  8E 0B 20           stx    __ptr
       08:A582  8D 0C 20           sta    __ptr+1
 2527                             __ldwp  __ptr
       08:A585  B2 0B              lda    [__ptr]
       08:A587  AA                 tax
       08:A588  A0 01              ldy    #1
       08:A58A  B1 0B              lda    [__ptr],Y
 2528                             __stb_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A58C  22                 sax
       08:A58D  A0 02              ldy    #2
       08:A58F  91 00              sta    [__sp],Y
       08:A591  22                 sax
                                  .else
                                  .endif
 2529                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A592  A0 05               ldy   #5
       08:A594  B1 00               lda   [__sp],Y
       08:A596  AA                  tax
       08:A597  C8                  iny
       08:A598  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2530                             __aslw
       08:A59A  22                 sax
       08:A59B  0A                 asl    A
       08:A59C  22                 sax
       08:A59D  2A                 rol    A
 2531                             __addwi _note_envadr
       08:A59E  18                 clc
       08:A59F  22                 sax
       08:A5A0  69 14              adc    #low(_note_envadr)
       08:A5A2  22                 sax
       08:A5A3  69 2A              adc    #high(_note_envadr)
 2532                             __pushw
                                 __submi  2,__stack
       08:A5A5  48                 pha
       08:A5A6  38                 sec
       08:A5A7  A5 00              lda    <__stack
       08:A5A9  E9 02              sbc    #low(2)
       08:A5AB  85 00              sta    <__stack
       08:A5AD  A5 01              lda    <__stack+1
       08:A5AF  E9 00              sbc    #high(2)
       08:A5B1  85 01              sta    <__stack+1
       08:A5B3  68                 pla
       08:A5B4  22                 sax
       08:A5B5  92 00              sta    [__stack]
       08:A5B7  22                 sax
       08:A5B8  A0 01              ldy    #1
       08:A5BA  91 00              sta    [__stack],Y
 2533                             __stw   __ptr
       08:A5BC  8E 0B 20           stx    __ptr
       08:A5BF  8D 0C 20           sta    __ptr+1
 2534                             __ldwp  __ptr
       08:A5C2  B2 0B              lda    [__ptr]
       08:A5C4  AA                 tax
       08:A5C5  A0 01              ldy    #1
       08:A5C7  B1 0B              lda    [__ptr],Y
 2535                             __addwi 1
       08:A5C9  18                 clc
       08:A5CA  22                 sax
       08:A5CB  69 01              adc    #low(1)
       08:A5CD  22                 sax
       08:A5CE  69 00              adc    #high(1)
 2536                             __stwps
                                 __stw    <__temp
       08:A5D0  86 03              stx    <__temp
       08:A5D2  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A5D4  B2 00              lda    [__stack]
       08:A5D6  AA                 tax
       08:A5D7  A0 01              ldy    #1
       08:A5D9  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A5DB  86 0B              stx    <__ptr
       08:A5DD  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A5DF  A6 03              ldx    <__temp
       08:A5E1  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A5E3  22                 sax
       08:A5E4  92 0B              sta    [__ptr]
       08:A5E6  22                 sax
       08:A5E7  A0 01              ldy    #1
       08:A5E9  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A5EB  48                 pha
       08:A5EC  18                 clc
       08:A5ED  A5 00              lda    <__stack
       08:A5EF  69 02              adc    #low(2)
       08:A5F1  85 00              sta    <__stack
       08:A5F3  A5 01              lda    <__stack+1
       08:A5F5  69 00              adc    #high(2)
       08:A5F7  85 01              sta    <__stack+1
       08:A5F9  68                 pla
 2537                             __subwi 1
       08:A5FA  38                 sec
       08:A5FB  22                 sax
       08:A5FC  E9 01              sbc    #low(1)
       08:A5FE  22                 sax
       08:A5FF  E9 00              sbc    #high(1)
 2538                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A601  A0 02              ldy    #2
       08:A603  B1 00              lda    [__sp],Y
       08:A605  AA                 tax
       08:A606  62                 cla
                          ;        bpl    .x_03304   ; signed
                          ;        dec    A
                          ;.x_03304:
                                  .else
                                  .endif
 2539                             __stw   <__temp
       08:A607  86 03              stx    <__temp
       08:A609  85 04              sta    <__temp+1
 2540                             __ldwi  255
       08:A60B  A2 FF              ldx    #low(255)
       08:A60D  A9 00              lda    #high(255)
 2541  08:A60F  20 FC E8            jsr   eqzp
 2542                             __lbeq  LL132
       08:A612  D0 03              bne    .x03307
       08:A614  4C 95 A7           jmp    LL132
       08:A617            .x03307
 2543                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A617  A0 05               ldy   #5
       08:A619  B1 00               lda   [__sp],Y
       08:A61B  AA                  tax
       08:A61C  C8                  iny
       08:A61D  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2544                             __aslw
       08:A61F  22                 sax
       08:A620  0A                 asl    A
       08:A621  22                 sax
       08:A622  2A                 rol    A
 2545                             __addwi _note_envadr
       08:A623  18                 clc
       08:A624  22                 sax
       08:A625  69 14              adc    #low(_note_envadr)
       08:A627  22                 sax
       08:A628  69 2A              adc    #high(_note_envadr)
 2546                             __pushw
                                 __submi  2,__stack
       08:A62A  48                 pha
       08:A62B  38                 sec
       08:A62C  A5 00              lda    <__stack
       08:A62E  E9 02              sbc    #low(2)
       08:A630  85 00              sta    <__stack
       08:A632  A5 01              lda    <__stack+1
       08:A634  E9 00              sbc    #high(2)
       08:A636  85 01              sta    <__stack+1
       08:A638  68                 pla
       08:A639  22                 sax
       08:A63A  92 00              sta    [__stack]
       08:A63C  22                 sax
       08:A63D  A0 01              ldy    #1
       08:A63F  91 00              sta    [__stack],Y
 2547                             __ldwi  _sound_dat
       08:A641  A2 00              ldx    #low(_sound_dat)
       08:A643  A9 44              lda    #high(_sound_dat)
 2548                             __addwi 20
       08:A645  18                 clc
       08:A646  22                 sax
       08:A647  69 14              adc    #low(20)
       08:A649  22                 sax
       08:A64A  69 00              adc    #high(20)
 2549                             __stw   __ptr
       08:A64C  8E 0B 20           stx    __ptr
       08:A64F  8D 0C 20           sta    __ptr+1
 2550                             __ldwp  __ptr
       08:A652  B2 0B              lda    [__ptr]
       08:A654  AA                 tax
       08:A655  A0 01              ldy    #1
       08:A657  B1 0B              lda    [__ptr],Y
 2551                             __pushw
                                 __submi  2,__stack
       08:A659  48                 pha
       08:A65A  38                 sec
       08:A65B  A5 00              lda    <__stack
       08:A65D  E9 02              sbc    #low(2)
       08:A65F  85 00              sta    <__stack
       08:A661  A5 01              lda    <__stack+1
       08:A663  E9 00              sbc    #high(2)
       08:A665  85 01              sta    <__stack+1
       08:A667  68                 pla
       08:A668  22                 sax
       08:A669  92 00              sta    [__stack]
       08:A66B  22                 sax
       08:A66C  A0 01              ldy    #1
       08:A66E  91 00              sta    [__stack],Y
 2552                             __ldwi  _note_sw
       08:A670  A2 B2              ldx    #low(_note_sw)
       08:A672  A9 29              lda    #high(_note_sw)
 2553                             __addw_s        9
                0001              .if (9 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A674  A0 09              ldy    #9
       08:A676  18                 clc
       08:A677  22                 sax
       08:A678  71 00              adc    [__sp],Y
       08:A67A  22                 sax
       08:A67B  C8                 iny
       08:A67C  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2554                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A67E  86 0B              stx    <__ptr
       08:A680  85 0C              sta    <__ptr+1
       08:A682  B2 0B              lda    [__ptr]
       08:A684  AA                 tax
       08:A685  62                 cla
                          ;        bpl    .x_03321   ; signed
                          ;        dec    A
                          ;.x_03321:
 2555                             __pushw
                                 __submi  2,__stack
       08:A686  48                 pha
       08:A687  38                 sec
       08:A688  A5 00              lda    <__stack
       08:A68A  E9 02              sbc    #low(2)
       08:A68C  85 00              sta    <__stack
       08:A68E  A5 01              lda    <__stack+1
       08:A690  E9 00              sbc    #high(2)
       08:A692  85 01              sta    <__stack+1
       08:A694  68                 pla
       08:A695  22                 sax
       08:A696  92 00              sta    [__stack]
       08:A698  22                 sax
       08:A699  A0 01              ldy    #1
       08:A69B  91 00              sta    [__stack],Y
 2556                             __ldwi  1
       08:A69D  A2 01              ldx    #low(1)
       08:A69F  A9 00              lda    #high(1)
 2557  08:A6A1  20 60 EA            jsr   asl
 2558                             __addws
       08:A6A4  22                 sax
       08:A6A5  18                 clc
       08:A6A6  72 00              adc    [__stack]
       08:A6A8  22                 sax
       08:A6A9  A0 01              ldy    #1
       08:A6AB  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       08:A6AD  48                 pha
       08:A6AE  18                 clc
       08:A6AF  A5 00              lda    <__stack
       08:A6B1  69 02              adc    #low(2)
       08:A6B3  85 00              sta    <__stack
       08:A6B5  A5 01              lda    <__stack+1
       08:A6B7  69 00              adc    #high(2)
       08:A6B9  85 01              sta    <__stack+1
       08:A6BB  68                 pla
 2559                             __stw   __ptr
       08:A6BC  8E 0B 20           stx    __ptr
       08:A6BF  8D 0C 20           sta    __ptr+1
 2560                             __ldwp  __ptr
       08:A6C2  B2 0B              lda    [__ptr]
       08:A6C4  AA                 tax
       08:A6C5  A0 01              ldy    #1
       08:A6C7  B1 0B              lda    [__ptr],Y
 2561                             __stwps
                                 __stw    <__temp
       08:A6C9  86 03              stx    <__temp
       08:A6CB  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A6CD  B2 00              lda    [__stack]
       08:A6CF  AA                 tax
       08:A6D0  A0 01              ldy    #1
       08:A6D2  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A6D4  86 0B              stx    <__ptr
       08:A6D6  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A6D8  A6 03              ldx    <__temp
       08:A6DA  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A6DC  22                 sax
       08:A6DD  92 0B              sta    [__ptr]
       08:A6DF  22                 sax
       08:A6E0  A0 01              ldy    #1
       08:A6E2  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A6E4  48                 pha
       08:A6E5  18                 clc
       08:A6E6  A5 00              lda    <__stack
       08:A6E8  69 02              adc    #low(2)
       08:A6EA  85 00              sta    <__stack
       08:A6EC  A5 01              lda    <__stack+1
       08:A6EE  69 00              adc    #high(2)
       08:A6F0  85 01              sta    <__stack+1
       08:A6F2  68                 pla
 2562                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A6F3  A0 05               ldy   #5
       08:A6F5  B1 00               lda   [__sp],Y
       08:A6F7  AA                  tax
       08:A6F8  C8                  iny
       08:A6F9  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2563                             __aslw
       08:A6FB  22                 sax
       08:A6FC  0A                 asl    A
       08:A6FD  22                 sax
       08:A6FE  2A                 rol    A
 2564                             __addwi _note_envadr
       08:A6FF  18                 clc
       08:A700  22                 sax
       08:A701  69 14              adc    #low(_note_envadr)
       08:A703  22                 sax
       08:A704  69 2A              adc    #high(_note_envadr)
 2565                             __stw   __ptr
       08:A706  8E 0B 20           stx    __ptr
       08:A709  8D 0C 20           sta    __ptr+1
 2566                             __ldwp  __ptr
       08:A70C  B2 0B              lda    [__ptr]
       08:A70E  AA                 tax
       08:A70F  A0 01              ldy    #1
       08:A711  B1 0B              lda    [__ptr],Y
 2567                             __stw   __ptr
       08:A713  8E 0B 20           stx    __ptr
       08:A716  8D 0C 20           sta    __ptr+1
 2568                             __ldwp  __ptr
       08:A719  B2 0B              lda    [__ptr]
       08:A71B  AA                 tax
       08:A71C  A0 01              ldy    #1
       08:A71E  B1 0B              lda    [__ptr],Y
 2569                             __stb_s 2
                0001              .if (2 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A720  22                 sax
       08:A721  A0 02              ldy    #2
       08:A723  91 00              sta    [__sp],Y
       08:A725  22                 sax
                                  .else
                                  .endif
 2570                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A726  A0 05               ldy   #5
       08:A728  B1 00               lda   [__sp],Y
       08:A72A  AA                  tax
       08:A72B  C8                  iny
       08:A72C  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2571                             __aslw
       08:A72E  22                 sax
       08:A72F  0A                 asl    A
       08:A730  22                 sax
       08:A731  2A                 rol    A
 2572                             __addwi _note_envadr
       08:A732  18                 clc
       08:A733  22                 sax
       08:A734  69 14              adc    #low(_note_envadr)
       08:A736  22                 sax
       08:A737  69 2A              adc    #high(_note_envadr)
 2573                             __pushw
                                 __submi  2,__stack
       08:A739  48                 pha
       08:A73A  38                 sec
       08:A73B  A5 00              lda    <__stack
       08:A73D  E9 02              sbc    #low(2)
       08:A73F  85 00              sta    <__stack
       08:A741  A5 01              lda    <__stack+1
       08:A743  E9 00              sbc    #high(2)
       08:A745  85 01              sta    <__stack+1
       08:A747  68                 pla
       08:A748  22                 sax
       08:A749  92 00              sta    [__stack]
       08:A74B  22                 sax
       08:A74C  A0 01              ldy    #1
       08:A74E  91 00              sta    [__stack],Y
 2574                             __stw   __ptr
       08:A750  8E 0B 20           stx    __ptr
       08:A753  8D 0C 20           sta    __ptr+1
 2575                             __ldwp  __ptr
       08:A756  B2 0B              lda    [__ptr]
       08:A758  AA                 tax
       08:A759  A0 01              ldy    #1
       08:A75B  B1 0B              lda    [__ptr],Y
 2576                             __addwi 1
       08:A75D  18                 clc
       08:A75E  22                 sax
       08:A75F  69 01              adc    #low(1)
       08:A761  22                 sax
       08:A762  69 00              adc    #high(1)
 2577                             __stwps
                                 __stw    <__temp
       08:A764  86 03              stx    <__temp
       08:A766  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A768  B2 00              lda    [__stack]
       08:A76A  AA                 tax
       08:A76B  A0 01              ldy    #1
       08:A76D  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A76F  86 0B              stx    <__ptr
       08:A771  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A773  A6 03              ldx    <__temp
       08:A775  A5 04              lda    <__temp+1
                                  .endif
                                 __stwp    __ptr
       08:A777  22                 sax
       08:A778  92 0B              sta    [__ptr]
       08:A77A  22                 sax
       08:A77B  A0 01              ldy    #1
       08:A77D  91 0B              sta    [__ptr],Y
                                 __addmi  2,__stack
       08:A77F  48                 pha
       08:A780  18                 clc
       08:A781  A5 00              lda    <__stack
       08:A783  69 02              adc    #low(2)
       08:A785  85 00              sta    <__stack
       08:A787  A5 01              lda    <__stack+1
       08:A789  69 00              adc    #high(2)
       08:A78B  85 01              sta    <__stack+1
       08:A78D  68                 pla
 2578                             __subwi 1
       08:A78E  38                 sec
       08:A78F  22                 sax
       08:A790  E9 01              sbc    #low(1)
       08:A792  22                 sax
       08:A793  E9 00              sbc    #high(1)
 2579  08:A795            LL132:
 2580                     
 2581                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A795  A0 02              ldy    #2
       08:A797  B1 00              lda    [__sp],Y
       08:A799  AA                 tax
       08:A79A  62                 cla
                          ;        bpl    .x_03360   ; signed
                          ;        dec    A
                          ;.x_03360:
                                  .else
                                  .endif
 2582                             __andwi 128
       08:A79B  22                 sax
       08:A79C  29 80              and    #low(128)
       08:A79E  22                 sax
       08:A79F  29 00              and    #high(128)
 2583                             __tstw
                                   ; pha
       08:A7A1  86 03              stx    <__temp
       08:A7A3  05 03              ora    <__temp
                                   ; pla
 2584                             __lbeq  LL133
       08:A7A5  D0 03              bne    .x03363
       08:A7A7  4C BF A9           jmp    LL133
       08:A7AA            .x03363
 2585                             __ldwi  _note_data
       08:A7AA  A2 A2              ldx    #low(_note_data)
       08:A7AC  A9 29              lda    #high(_note_data)
 2586                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A7AE  A0 05              ldy    #5
       08:A7B0  18                 clc
       08:A7B1  22                 sax
       08:A7B2  71 00              adc    [__sp],Y
       08:A7B4  22                 sax
       08:A7B5  C8                 iny
       08:A7B6  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2587                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A7B8  86 0B              stx    <__ptr
       08:A7BA  85 0C              sta    <__ptr+1
       08:A7BC  B2 0B              lda    [__ptr]
       08:A7BE  AA                 tax
       08:A7BF  62                 cla
                          ;        bpl    .x_03366   ; signed
                          ;        dec    A
                          ;.x_03366:
 2588                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A7C0  22                 sax
       08:A7C1  A0 00              ldy    #0
       08:A7C3  91 00              sta    [__sp],Y
       08:A7C5  22                 sax
                                  .else
                                  .endif
 2589                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A7C6  A0 02              ldy    #2
       08:A7C8  B1 00              lda    [__sp],Y
       08:A7CA  AA                 tax
       08:A7CB  62                 cla
                          ;        bpl    .x_03368   ; signed
                          ;        dec    A
                          ;.x_03368:
                                  .else
                                  .endif
 2590                             __andwi 127
       08:A7CC  22                 sax
       08:A7CD  29 7F              and    #low(127)
       08:A7CF  22                 sax
       08:A7D0  29 00              and    #high(127)
 2591                             __stb_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A7D2  22                 sax
       08:A7D3  A0 01              ldy    #1
       08:A7D5  91 00              sta    [__sp],Y
       08:A7D7  22                 sax
                                  .else
                                  .endif
 2592                             __pushw
                                 __submi  2,__stack
       08:A7D8  48                 pha
       08:A7D9  38                 sec
       08:A7DA  A5 00              lda    <__stack
       08:A7DC  E9 02              sbc    #low(2)
       08:A7DE  85 00              sta    <__stack
       08:A7E0  A5 01              lda    <__stack+1
       08:A7E2  E9 00              sbc    #high(2)
       08:A7E4  85 01              sta    <__stack+1
       08:A7E6  68                 pla
       08:A7E7  22                 sax
       08:A7E8  92 00              sta    [__stack]
       08:A7EA  22                 sax
       08:A7EB  A0 01              ldy    #1
       08:A7ED  91 00              sta    [__stack],Y
 2593                             __ldwi  12
       08:A7EF  A2 0C              ldx    #low(12)
       08:A7F1  A9 00              lda    #high(12)
 2594  08:A7F3  20 6D EB            jsr   sdiv
 2595                             __pushw
                                 __submi  2,__stack
       08:A7F6  48                 pha
       08:A7F7  38                 sec
       08:A7F8  A5 00              lda    <__stack
       08:A7FA  E9 02              sbc    #low(2)
       08:A7FC  85 00              sta    <__stack
       08:A7FE  A5 01              lda    <__stack+1
       08:A800  E9 00              sbc    #high(2)
       08:A802  85 01              sta    <__stack+1
       08:A804  68                 pla
       08:A805  22                 sax
       08:A806  92 00              sta    [__stack]
       08:A808  22                 sax
       08:A809  A0 01              ldy    #1
       08:A80B  91 00              sta    [__stack],Y
 2596                             __ldwi  4
       08:A80D  A2 04              ldx    #low(4)
       08:A80F  A9 00              lda    #high(4)
 2597  08:A811  20 60 EA            jsr   asl
 2598                             __stw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       08:A814  22                 sax
       08:A815  A0 03              ldy    #3
       08:A817  91 00              sta    [__sp],Y
       08:A819  22                 sax
       08:A81A  C8                 iny
       08:A81B  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2599                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A81D  A0 00              ldy    #0
       08:A81F  B1 00              lda    [__sp],Y
       08:A821  AA                 tax
       08:A822  62                 cla
                          ;        bpl    .x_03378   ; signed
                          ;        dec    A
                          ;.x_03378:
                                  .else
                                  .endif
 2600                             __pushw
                                 __submi  2,__stack
       08:A823  48                 pha
       08:A824  38                 sec
       08:A825  A5 00              lda    <__stack
       08:A827  E9 02              sbc    #low(2)
       08:A829  85 00              sta    <__stack
       08:A82B  A5 01              lda    <__stack+1
       08:A82D  E9 00              sbc    #high(2)
       08:A82F  85 01              sta    <__stack+1
       08:A831  68                 pla
       08:A832  22                 sax
       08:A833  92 00              sta    [__stack]
       08:A835  22                 sax
       08:A836  A0 01              ldy    #1
       08:A838  91 00              sta    [__stack],Y
 2601                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A83A  A0 05               ldy   #5
       08:A83C  B1 00               lda   [__sp],Y
       08:A83E  AA                  tax
       08:A83F  C8                  iny
       08:A840  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2602                             __subws
       08:A842  86 03             stx     <__temp
       08:A844  85 04             sta     <__temp+1
       08:A846  38                sec
       08:A847  B2 00             lda     [__stack]
       08:A849  E5 03             sbc     <__temp
       08:A84B  AA                tax
       08:A84C  A0 01             ldy     #1
       08:A84E  B1 00             lda     [__stack],Y
       08:A850  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       08:A852  48                 pha
       08:A853  18                 clc
       08:A854  A5 00              lda    <__stack
       08:A856  69 02              adc    #low(2)
       08:A858  85 00              sta    <__stack
       08:A85A  A5 01              lda    <__stack+1
       08:A85C  69 00              adc    #high(2)
       08:A85E  85 01              sta    <__stack+1
       08:A860  68                 pla
 2603                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A861  22                 sax
       08:A862  A0 00              ldy    #0
       08:A864  91 00              sta    [__sp],Y
       08:A866  22                 sax
                                  .else
                                  .endif
 2604                             __ldb_s 1
                0001              .if (1 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A867  A0 01              ldy    #1
       08:A869  B1 00              lda    [__sp],Y
       08:A86B  AA                 tax
       08:A86C  62                 cla
                          ;        bpl    .x_03385   ; signed
                          ;        dec    A
                          ;.x_03385:
                                  .else
                                  .endif
 2605                             __pushw
                                 __submi  2,__stack
       08:A86D  48                 pha
       08:A86E  38                 sec
       08:A86F  A5 00              lda    <__stack
       08:A871  E9 02              sbc    #low(2)
       08:A873  85 00              sta    <__stack
       08:A875  A5 01              lda    <__stack+1
       08:A877  E9 00              sbc    #high(2)
       08:A879  85 01              sta    <__stack+1
       08:A87B  68                 pla
       08:A87C  22                 sax
       08:A87D  92 00              sta    [__stack]
       08:A87F  22                 sax
       08:A880  A0 01              ldy    #1
       08:A882  91 00              sta    [__stack],Y
 2606                             __ldwi  12
       08:A884  A2 0C              ldx    #low(12)
       08:A886  A9 00              lda    #high(12)
 2607  08:A888  20 07 EC            jsr   smod
 2608                             __stw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       08:A88B  22                 sax
       08:A88C  A0 03              ldy    #3
       08:A88E  91 00              sta    [__sp],Y
       08:A890  22                 sax
       08:A891  C8                 iny
       08:A892  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2609                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A894  A0 00              ldy    #0
       08:A896  B1 00              lda    [__sp],Y
       08:A898  AA                 tax
       08:A899  62                 cla
                          ;        bpl    .x_03390   ; signed
                          ;        dec    A
                          ;.x_03390:
                                  .else
                                  .endif
 2610                             __andwi 15
       08:A89A  22                 sax
       08:A89B  29 0F              and    #low(15)
       08:A89D  22                 sax
       08:A89E  29 00              and    #high(15)
 2611                             __pushw
                                 __submi  2,__stack
       08:A8A0  48                 pha
       08:A8A1  38                 sec
       08:A8A2  A5 00              lda    <__stack
       08:A8A4  E9 02              sbc    #low(2)
       08:A8A6  85 00              sta    <__stack
       08:A8A8  A5 01              lda    <__stack+1
       08:A8AA  E9 00              sbc    #high(2)
       08:A8AC  85 01              sta    <__stack+1
       08:A8AE  68                 pla
       08:A8AF  22                 sax
       08:A8B0  92 00              sta    [__stack]
       08:A8B2  22                 sax
       08:A8B3  A0 01              ldy    #1
       08:A8B5  91 00              sta    [__stack],Y
 2612                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A8B7  A0 05               ldy   #5
       08:A8B9  B1 00               lda   [__sp],Y
       08:A8BB  AA                  tax
       08:A8BC  C8                  iny
       08:A8BD  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2613  08:A8BF  20 F5 E9            jsr   ge
 2614                             __lbeq  LL134
       08:A8C2  D0 03              bne    .x03395
       08:A8C4  4C 14 A9           jmp    LL134
       08:A8C7            .x03395
 2615                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A8C7  A0 00              ldy    #0
       08:A8C9  B1 00              lda    [__sp],Y
       08:A8CB  AA                 tax
       08:A8CC  62                 cla
                          ;        bpl    .x_03396   ; signed
                          ;        dec    A
                          ;.x_03396:
                                  .else
                                  .endif
 2616                             __pushw
                                 __submi  2,__stack
       08:A8CD  48                 pha
       08:A8CE  38                 sec
       08:A8CF  A5 00              lda    <__stack
       08:A8D1  E9 02              sbc    #low(2)
       08:A8D3  85 00              sta    <__stack
       08:A8D5  A5 01              lda    <__stack+1
       08:A8D7  E9 00              sbc    #high(2)
       08:A8D9  85 01              sta    <__stack+1
       08:A8DB  68                 pla
       08:A8DC  22                 sax
       08:A8DD  92 00              sta    [__stack]
       08:A8DF  22                 sax
       08:A8E0  A0 01              ldy    #1
       08:A8E2  91 00              sta    [__stack],Y
 2617                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A8E4  A0 05               ldy   #5
       08:A8E6  B1 00               lda   [__sp],Y
       08:A8E8  AA                  tax
       08:A8E9  C8                  iny
       08:A8EA  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2618                             __subws
       08:A8EC  86 03             stx     <__temp
       08:A8EE  85 04             sta     <__temp+1
       08:A8F0  38                sec
       08:A8F1  B2 00             lda     [__stack]
       08:A8F3  E5 03             sbc     <__temp
       08:A8F5  AA                tax
       08:A8F6  A0 01             ldy     #1
       08:A8F8  B1 00             lda     [__stack],Y
       08:A8FA  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       08:A8FC  48                 pha
       08:A8FD  18                 clc
       08:A8FE  A5 00              lda    <__stack
       08:A900  69 02              adc    #low(2)
       08:A902  85 00              sta    <__stack
       08:A904  A5 01              lda    <__stack+1
       08:A906  69 00              adc    #high(2)
       08:A908  85 01              sta    <__stack+1
       08:A90A  68                 pla
 2619                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A90B  22                 sax
       08:A90C  A0 00              ldy    #0
       08:A90E  91 00              sta    [__sp],Y
       08:A910  22                 sax
                                  .else
                                  .endif
 2620                             __lbra  LL135
       08:A911  4C 6B A9           jmp    LL135
 2621  08:A914            LL134:
 2622                     
 2623                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A914  A0 00              ldy    #0
       08:A916  B1 00              lda    [__sp],Y
       08:A918  AA                 tax
       08:A919  62                 cla
                          ;        bpl    .x_03404   ; signed
                          ;        dec    A
                          ;.x_03404:
                                  .else
                                  .endif
 2624                             __subwi 4
       08:A91A  38                 sec
       08:A91B  22                 sax
       08:A91C  E9 04              sbc    #low(4)
       08:A91E  22                 sax
       08:A91F  E9 00              sbc    #high(4)
 2625                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A921  22                 sax
       08:A922  A0 00              ldy    #0
       08:A924  91 00              sta    [__sp],Y
       08:A926  22                 sax
                                  .else
                                  .endif
 2626                             __pushw
                                 __submi  2,__stack
       08:A927  48                 pha
       08:A928  38                 sec
       08:A929  A5 00              lda    <__stack
       08:A92B  E9 02              sbc    #low(2)
       08:A92D  85 00              sta    <__stack
       08:A92F  A5 01              lda    <__stack+1
       08:A931  E9 00              sbc    #high(2)
       08:A933  85 01              sta    <__stack+1
       08:A935  68                 pla
       08:A936  22                 sax
       08:A937  92 00              sta    [__stack]
       08:A939  22                 sax
       08:A93A  A0 01              ldy    #1
       08:A93C  91 00              sta    [__stack],Y
 2627                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:A93E  A0 05               ldy   #5
       08:A940  B1 00               lda   [__sp],Y
       08:A942  AA                  tax
       08:A943  C8                  iny
       08:A944  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2628                             __subws
       08:A946  86 03             stx     <__temp
       08:A948  85 04             sta     <__temp+1
       08:A94A  38                sec
       08:A94B  B2 00             lda     [__stack]
       08:A94D  E5 03             sbc     <__temp
       08:A94F  AA                tax
       08:A950  A0 01             ldy     #1
       08:A952  B1 00             lda     [__stack],Y
       08:A954  E5 04             sbc     <__temp+1
                                  __addmi 2, __stack
       08:A956  48                 pha
       08:A957  18                 clc
       08:A958  A5 00              lda    <__stack
       08:A95A  69 02              adc    #low(2)
       08:A95C  85 00              sta    <__stack
       08:A95E  A5 01              lda    <__stack+1
       08:A960  69 00              adc    #high(2)
       08:A962  85 01              sta    <__stack+1
       08:A964  68                 pla
 2629                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A965  22                 sax
       08:A966  A0 00              ldy    #0
       08:A968  91 00              sta    [__sp],Y
       08:A96A  22                 sax
                                  .else
                                  .endif
 2630  08:A96B            LL135:
 2631                     
 2632                             __ldwi  _note_data
       08:A96B  A2 A2              ldx    #low(_note_data)
       08:A96D  A9 29              lda    #high(_note_data)
 2633                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A96F  A0 05              ldy    #5
       08:A971  18                 clc
       08:A972  22                 sax
       08:A973  71 00              adc    [__sp],Y
       08:A975  22                 sax
       08:A976  C8                 iny
       08:A977  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2634                             __pushw
                                 __submi  2,__stack
       08:A979  48                 pha
       08:A97A  38                 sec
       08:A97B  A5 00              lda    <__stack
       08:A97D  E9 02              sbc    #low(2)
       08:A97F  85 00              sta    <__stack
       08:A981  A5 01              lda    <__stack+1
       08:A983  E9 00              sbc    #high(2)
       08:A985  85 01              sta    <__stack+1
       08:A987  68                 pla
       08:A988  22                 sax
       08:A989  92 00              sta    [__stack]
       08:A98B  22                 sax
       08:A98C  A0 01              ldy    #1
       08:A98E  91 00              sta    [__stack],Y
 2635                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A990  A0 02              ldy    #2
       08:A992  B1 00              lda    [__sp],Y
       08:A994  AA                 tax
       08:A995  62                 cla
                          ;        bpl    .x_03417   ; signed
                          ;        dec    A
                          ;.x_03417:
                                  .else
                                  .endif
 2636                             __stbps
                                 __stw    <__temp
       08:A996  86 03              stx    <__temp
       08:A998  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:A99A  B2 00              lda    [__stack]
       08:A99C  AA                 tax
       08:A99D  A0 01              ldy    #1
       08:A99F  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:A9A1  86 0B              stx    <__ptr
       08:A9A3  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:A9A5  A6 03              ldx    <__temp
       08:A9A7  A5 04              lda    <__temp+1
                                  .endif
       08:A9A9  22                 sax
       08:A9AA  92 0B              sta    [__ptr]
       08:A9AC  22                 sax
                                 __addmi  2,__stack
       08:A9AD  48                 pha
       08:A9AE  18                 clc
       08:A9AF  A5 00              lda    <__stack
       08:A9B1  69 02              adc    #low(2)
       08:A9B3  85 00              sta    <__stack
       08:A9B5  A5 01              lda    <__stack+1
       08:A9B7  69 00              adc    #high(2)
       08:A9B9  85 01              sta    <__stack+1
       08:A9BB  68                 pla
 2637                             __lbra  LL136
       08:A9BC  4C FF AA           jmp    LL136
 2638  08:A9BF            LL133:
 2639                     
 2640                             __ldwi  _note_data
       08:A9BF  A2 A2              ldx    #low(_note_data)
       08:A9C1  A9 29              lda    #high(_note_data)
 2641                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:A9C3  A0 05              ldy    #5
       08:A9C5  18                 clc
       08:A9C6  22                 sax
       08:A9C7  71 00              adc    [__sp],Y
       08:A9C9  22                 sax
       08:A9CA  C8                 iny
       08:A9CB  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2642                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:A9CD  86 0B              stx    <__ptr
       08:A9CF  85 0C              sta    <__ptr+1
       08:A9D1  B2 0B              lda    [__ptr]
       08:A9D3  AA                 tax
       08:A9D4  62                 cla
                          ;        bpl    .x_03427   ; signed
                          ;        dec    A
                          ;.x_03427:
 2643                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A9D5  22                 sax
       08:A9D6  A0 00              ldy    #0
       08:A9D8  91 00              sta    [__sp],Y
       08:A9DA  22                 sax
                                  .else
                                  .endif
 2644                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:A9DB  A0 02              ldy    #2
       08:A9DD  B1 00              lda    [__sp],Y
       08:A9DF  AA                 tax
       08:A9E0  62                 cla
                          ;        bpl    .x_03429   ; signed
                          ;        dec    A
                          ;.x_03429:
                                  .else
                                  .endif
 2645                             __stb_s 1
                0001              .if (1 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:A9E1  22                 sax
       08:A9E2  A0 01              ldy    #1
       08:A9E4  91 00              sta    [__sp],Y
       08:A9E6  22                 sax
                                  .else
                                  .endif
 2646                             __pushw
                                 __submi  2,__stack
       08:A9E7  48                 pha
       08:A9E8  38                 sec
       08:A9E9  A5 00              lda    <__stack
       08:A9EB  E9 02              sbc    #low(2)
       08:A9ED  85 00              sta    <__stack
       08:A9EF  A5 01              lda    <__stack+1
       08:A9F1  E9 00              sbc    #high(2)
       08:A9F3  85 01              sta    <__stack+1
       08:A9F5  68                 pla
       08:A9F6  22                 sax
       08:A9F7  92 00              sta    [__stack]
       08:A9F9  22                 sax
       08:A9FA  A0 01              ldy    #1
       08:A9FC  91 00              sta    [__stack],Y
 2647                             __ldwi  12
       08:A9FE  A2 0C              ldx    #low(12)
       08:AA00  A9 00              lda    #high(12)
 2648  08:AA02  20 6D EB            jsr   sdiv
 2649                             __pushw
                                 __submi  2,__stack
       08:AA05  48                 pha
       08:AA06  38                 sec
       08:AA07  A5 00              lda    <__stack
       08:AA09  E9 02              sbc    #low(2)
       08:AA0B  85 00              sta    <__stack
       08:AA0D  A5 01              lda    <__stack+1
       08:AA0F  E9 00              sbc    #high(2)
       08:AA11  85 01              sta    <__stack+1
       08:AA13  68                 pla
       08:AA14  22                 sax
       08:AA15  92 00              sta    [__stack]
       08:AA17  22                 sax
       08:AA18  A0 01              ldy    #1
       08:AA1A  91 00              sta    [__stack],Y
 2650                             __ldwi  4
       08:AA1C  A2 04              ldx    #low(4)
       08:AA1E  A9 00              lda    #high(4)
 2651  08:AA20  20 60 EA            jsr   asl
 2652                             __stw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       08:AA23  22                 sax
       08:AA24  A0 03              ldy    #3
       08:AA26  91 00              sta    [__sp],Y
       08:AA28  22                 sax
       08:AA29  C8                 iny
       08:AA2A  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2653                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:AA2C  A0 00              ldy    #0
       08:AA2E  B1 00              lda    [__sp],Y
       08:AA30  AA                 tax
       08:AA31  62                 cla
                          ;        bpl    .x_03438   ; signed
                          ;        dec    A
                          ;.x_03438:
                                  .else
                                  .endif
 2654                             __addw_s        3
                0001              .if (3 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:AA32  A0 03              ldy    #3
       08:AA34  18                 clc
       08:AA35  22                 sax
       08:AA36  71 00              adc    [__sp],Y
       08:AA38  22                 sax
       08:AA39  C8                 iny
       08:AA3A  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2655                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:AA3C  22                 sax
       08:AA3D  A0 00              ldy    #0
       08:AA3F  91 00              sta    [__sp],Y
       08:AA41  22                 sax
                                  .else
                                  .endif
 2656                             __ldb_s 1
                0001              .if (1 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:AA42  A0 01              ldy    #1
       08:AA44  B1 00              lda    [__sp],Y
       08:AA46  AA                 tax
       08:AA47  62                 cla
                          ;        bpl    .x_03441   ; signed
                          ;        dec    A
                          ;.x_03441:
                                  .else
                                  .endif
 2657                             __pushw
                                 __submi  2,__stack
       08:AA48  48                 pha
       08:AA49  38                 sec
       08:AA4A  A5 00              lda    <__stack
       08:AA4C  E9 02              sbc    #low(2)
       08:AA4E  85 00              sta    <__stack
       08:AA50  A5 01              lda    <__stack+1
       08:AA52  E9 00              sbc    #high(2)
       08:AA54  85 01              sta    <__stack+1
       08:AA56  68                 pla
       08:AA57  22                 sax
       08:AA58  92 00              sta    [__stack]
       08:AA5A  22                 sax
       08:AA5B  A0 01              ldy    #1
       08:AA5D  91 00              sta    [__stack],Y
 2658                             __ldwi  12
       08:AA5F  A2 0C              ldx    #low(12)
       08:AA61  A9 00              lda    #high(12)
 2659  08:AA63  20 07 EC            jsr   smod
 2660                             __stw_s 3
                0001              .if (3 < 255)
                                   ; short index (bytes :  9, cycles : 22)
                          
       08:AA66  22                 sax
       08:AA67  A0 03              ldy    #3
       08:AA69  91 00              sta    [__sp],Y
       08:AA6B  22                 sax
       08:AA6C  C8                 iny
       08:AA6D  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2661                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:AA6F  A0 00              ldy    #0
       08:AA71  B1 00              lda    [__sp],Y
       08:AA73  AA                 tax
       08:AA74  62                 cla
                          ;        bpl    .x_03446   ; signed
                          ;        dec    A
                          ;.x_03446:
                                  .else
                                  .endif
 2662                             __addw_s        3
                0001              .if (3 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:AA75  A0 03              ldy    #3
       08:AA77  18                 clc
       08:AA78  22                 sax
       08:AA79  71 00              adc    [__sp],Y
       08:AA7B  22                 sax
       08:AA7C  C8                 iny
       08:AA7D  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2663                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:AA7F  22                 sax
       08:AA80  A0 00              ldy    #0
       08:AA82  91 00              sta    [__sp],Y
       08:AA84  22                 sax
                                  .else
                                  .endif
 2664                             __andwi 15
       08:AA85  22                 sax
       08:AA86  29 0F              and    #low(15)
       08:AA88  22                 sax
       08:AA89  29 00              and    #high(15)
 2665                             __stw   <__temp
       08:AA8B  86 03              stx    <__temp
       08:AA8D  85 04              sta    <__temp+1
 2666                             __ldwi  12
       08:AA8F  A2 0C              ldx    #low(12)
       08:AA91  A9 00              lda    #high(12)
 2667  08:AA93  20 FA E9            jsr   gezp
 2668                             __lbeq  LL137
       08:AA96  D0 03              bne    .x03452
       08:AA98  4C AE AA           jmp    LL137
       08:AA9B            .x03452
 2669                             __ldb_s 0
                0001              .if (0 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:AA9B  A0 00              ldy    #0
       08:AA9D  B1 00              lda    [__sp],Y
       08:AA9F  AA                 tax
       08:AAA0  62                 cla
                          ;        bpl    .x_03453   ; signed
                          ;        dec    A
                          ;.x_03453:
                                  .else
                                  .endif
 2670                             __addwi 4
       08:AAA1  18                 clc
       08:AAA2  22                 sax
       08:AAA3  69 04              adc    #low(4)
       08:AAA5  22                 sax
       08:AAA6  69 00              adc    #high(4)
 2671                             __stb_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  6, cycles : 13)
                          
       08:AAA8  22                 sax
       08:AAA9  A0 00              ldy    #0
       08:AAAB  91 00              sta    [__sp],Y
       08:AAAD  22                 sax
                                  .else
                                  .endif
 2672  08:AAAE            LL137:
 2673                     
 2674                             __ldwi  _note_data
       08:AAAE  A2 A2              ldx    #low(_note_data)
       08:AAB0  A9 29              lda    #high(_note_data)
 2675                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:AAB2  A0 05              ldy    #5
       08:AAB4  18                 clc
       08:AAB5  22                 sax
       08:AAB6  71 00              adc    [__sp],Y
       08:AAB8  22                 sax
       08:AAB9  C8                 iny
       08:AABA  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2676                             __pushw
                                 __submi  2,__stack
       08:AABC  48                 pha
       08:AABD  38                 sec
       08:AABE  A5 00              lda    <__stack
       08:AAC0  E9 02              sbc    #low(2)
       08:AAC2  85 00              sta    <__stack
       08:AAC4  A5 01              lda    <__stack+1
       08:AAC6  E9 00              sbc    #high(2)
       08:AAC8  85 01              sta    <__stack+1
       08:AACA  68                 pla
       08:AACB  22                 sax
       08:AACC  92 00              sta    [__stack]
       08:AACE  22                 sax
       08:AACF  A0 01              ldy    #1
       08:AAD1  91 00              sta    [__stack],Y
 2677                             __ldb_s 2
                0001              .if (2 < 256)
                                   ; short index (bytes :  9, cycles : 13/17)
                          
       08:AAD3  A0 02              ldy    #2
       08:AAD5  B1 00              lda    [__sp],Y
       08:AAD7  AA                 tax
       08:AAD8  62                 cla
                          ;        bpl    .x_03460   ; signed
                          ;        dec    A
                          ;.x_03460:
                                  .else
                                  .endif
 2678                             __stbps
                                 __stw    <__temp
       08:AAD9  86 03              stx    <__temp
       08:AADB  85 04              sta    <__temp+1
                                 __ldwp    __stack
       08:AADD  B2 00              lda    [__stack]
       08:AADF  AA                 tax
       08:AAE0  A0 01              ldy    #1
       08:AAE2  B1 00              lda    [__stack],Y
                                 __stw    <__ptr
       08:AAE4  86 0B              stx    <__ptr
       08:AAE6  85 0C              sta    <__ptr+1
                                 __ldw    <__temp
                0000              .if (1 = 2)
                                  .else
       08:AAE8  A6 03              ldx    <__temp
       08:AAEA  A5 04              lda    <__temp+1
                                  .endif
       08:AAEC  22                 sax
       08:AAED  92 0B              sta    [__ptr]
       08:AAEF  22                 sax
                                 __addmi  2,__stack
       08:AAF0  48                 pha
       08:AAF1  18                 clc
       08:AAF2  A5 00              lda    <__stack
       08:AAF4  69 02              adc    #low(2)
       08:AAF6  85 00              sta    <__stack
       08:AAF8  A5 01              lda    <__stack+1
       08:AAFA  69 00              adc    #high(2)
       08:AAFC  85 01              sta    <__stack+1
       08:AAFE  68                 pla
 2679  08:AAFF            LL136:
 2680                     
 2681                             __ldwi  _note_data
       08:AAFF  A2 A2              ldx    #low(_note_data)
       08:AB01  A9 29              lda    #high(_note_data)
 2682                             __addw_s        5
                0001              .if (5 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:AB03  A0 05              ldy    #5
       08:AB05  18                 clc
       08:AB06  22                 sax
       08:AB07  71 00              adc    [__sp],Y
       08:AB09  22                 sax
       08:AB0A  C8                 iny
       08:AB0B  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2683                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:AB0D  86 0B              stx    <__ptr
       08:AB0F  85 0C              sta    <__ptr+1
       08:AB11  B2 0B              lda    [__ptr]
       08:AB13  AA                 tax
       08:AB14  62                 cla
                          ;        bpl    .x_03469   ; signed
                          ;        dec    A
                          ;.x_03469:
 2684                             __phw   4,4
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       08:AB15  A8                 tay
       08:AB16  A5 02              lda    <__arg_idx
                                   add    #4
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       08:AB18  18                 clc
       08:AB19  69 04              adc    #4
                                  .endif
       08:AB1B  85 02              sta    <__arg_idx
       08:AB1D  42                 say
                                  .else
                                  .endif
                          
       08:AB1E  99 60 2A           sta    __arg-(4),Y
       08:AB21  8A                 txa
       08:AB22  99 61 2A           sta    __arg-(4-1),Y
 2685                             __ldwi  2
       08:AB25  A2 02              ldx    #low(2)
       08:AB27  A9 00              lda    #high(2)
 2686                             __phb   2
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       08:AB29  A4 02              ldy    <__arg_idx
                                  .endif
                          
       08:AB2B  8A                 txa
       08:AB2C  99 62 2A           sta    __arg-(2),Y
 2687                             __ldwi  5
       08:AB2F  A2 05              ldx    #low(5)
       08:AB31  A9 00              lda    #high(5)
 2688                             __pushw
                                 __submi  2,__stack
       08:AB33  48                 pha
       08:AB34  38                 sec
       08:AB35  A5 00              lda    <__stack
       08:AB37  E9 02              sbc    #low(2)
       08:AB39  85 00              sta    <__stack
       08:AB3B  A5 01              lda    <__stack+1
       08:AB3D  E9 00              sbc    #high(2)
       08:AB3F  85 01              sta    <__stack+1
       08:AB41  68                 pla
       08:AB42  22                 sax
       08:AB43  92 00              sta    [__stack]
       08:AB45  22                 sax
       08:AB46  A0 01              ldy    #1
       08:AB48  91 00              sta    [__stack],Y
 2689                             __ldw_s 7
                0001              .if (7 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (7 = 0)
                                   .else
       08:AB4A  A0 07               ldy   #7
       08:AB4C  B1 00               lda   [__sp],Y
       08:AB4E  AA                  tax
       08:AB4F  C8                  iny
       08:AB50  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2690                             __pushw
                                 __submi  2,__stack
       08:AB52  48                 pha
       08:AB53  38                 sec
       08:AB54  A5 00              lda    <__stack
       08:AB56  E9 02              sbc    #low(2)
       08:AB58  85 00              sta    <__stack
       08:AB5A  A5 01              lda    <__stack+1
       08:AB5C  E9 00              sbc    #high(2)
       08:AB5E  85 01              sta    <__stack+1
       08:AB60  68                 pla
       08:AB61  22                 sax
       08:AB62  92 00              sta    [__stack]
       08:AB64  22                 sax
       08:AB65  A0 01              ldy    #1
       08:AB67  91 00              sta    [__stack],Y
 2691                             __ldwi  2
       08:AB69  A2 02              ldx    #low(2)
       08:AB6B  A9 00              lda    #high(2)
 2692  08:AB6D  20 60 EA            jsr   asl
 2693                             __addws
       08:AB70  22                 sax
       08:AB71  18                 clc
       08:AB72  72 00              adc    [__stack]
       08:AB74  22                 sax
       08:AB75  A0 01              ldy    #1
       08:AB77  71 00              adc    [__stack],Y
                                 __addmi 2, __stack
       08:AB79  48                 pha
       08:AB7A  18                 clc
       08:AB7B  A5 00              lda    <__stack
       08:AB7D  69 02              adc    #low(2)
       08:AB7F  85 00              sta    <__stack
       08:AB81  A5 01              lda    <__stack+1
       08:AB83  69 00              adc    #high(2)
       08:AB85  85 01              sta    <__stack+1
       08:AB87  68                 pla
 2694                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       08:AB88  A4 02              ldy    <__arg_idx
                                  .endif
                          
       08:AB8A  8A                 txa
       08:AB8B  99 63 2A           sta    __arg-(1),Y
 2695                             __ldwi  11
       08:AB8E  A2 0B              ldx    #low(11)
       08:AB90  A9 00              lda    #high(11)
 2696  08:AB92  20 2F EF            call  _put_hex.4
 2697                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:AB95  A0 05               ldy   #5
       08:AB97  B1 00               lda   [__sp],Y
       08:AB99  AA                  tax
       08:AB9A  C8                  iny
       08:AB9B  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2698                             __pushw
                                 __submi  2,__stack
       08:AB9D  48                 pha
       08:AB9E  38                 sec
       08:AB9F  A5 00              lda    <__stack
       08:ABA1  E9 02              sbc    #low(2)
       08:ABA3  85 00              sta    <__stack
       08:ABA5  A5 01              lda    <__stack+1
       08:ABA7  E9 00              sbc    #high(2)
       08:ABA9  85 01              sta    <__stack+1
       08:ABAB  68                 pla
       08:ABAC  22                 sax
       08:ABAD  92 00              sta    [__stack]
       08:ABAF  22                 sax
       08:ABB0  A0 01              ldy    #1
       08:ABB2  91 00              sta    [__stack],Y
 2699                             __ldwi  _note_data
       08:ABB4  A2 A2              ldx    #low(_note_data)
       08:ABB6  A9 29              lda    #high(_note_data)
 2700                             __addw_s        7
                0001              .if (7 < 255)
                                   ; short index (bytes : 10, cycles : 24)
                          
       08:ABB8  A0 07              ldy    #7
       08:ABBA  18                 clc
       08:ABBB  22                 sax
       08:ABBC  71 00              adc    [__sp],Y
       08:ABBE  22                 sax
       08:ABBF  C8                 iny
       08:ABC0  71 00              adc    [__sp],Y
                                  .else
                                  .endif
 2701                             __ldb_p
                                   ; (bytes : 11, cycles : 19/23)
       08:ABC2  86 0B              stx    <__ptr
       08:ABC4  85 0C              sta    <__ptr+1
       08:ABC6  B2 0B              lda    [__ptr]
       08:ABC8  AA                 tax
       08:ABC9  62                 cla
                          ;        bpl    .x_03490   ; signed
                          ;        dec    A
                          ;.x_03490:
 2702  08:ABCA  20 7E 80            call  _set_note
 2703                             __ldwi  2051
       08:ABCD  A2 03              ldx    #low(2051)
       08:ABCF  A9 08              lda    #high(2051)
 2704                             __stw   _bx
       08:ABD1  8E FA 20           stx    _bx
       08:ABD4  8D FB 20           sta    _bx+1
 2705                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:ABD7  A0 05               ldy   #5
       08:ABD9  B1 00               lda   [__sp],Y
       08:ABDB  AA                  tax
       08:ABDC  C8                  iny
       08:ABDD  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2706                             __aslw
       08:ABDF  22                 sax
       08:ABE0  0A                 asl    A
       08:ABE1  22                 sax
       08:ABE2  2A                 rol    A
 2707                             __addwi _seq_freq
       08:ABE3  18                 clc
       08:ABE4  22                 sax
       08:ABE5  69 E4              adc    #low(_seq_freq)
       08:ABE7  22                 sax
       08:ABE8  69 29              adc    #high(_seq_freq)
 2708                             __stw   __ptr
       08:ABEA  8E 0B 20           stx    __ptr
       08:ABED  8D 0C 20           sta    __ptr+1
 2709                             __ldwp  __ptr
       08:ABF0  B2 0B              lda    [__ptr]
       08:ABF2  AA                 tax
       08:ABF3  A0 01              ldy    #1
       08:ABF5  B1 0B              lda    [__ptr],Y
 2710                             __pushw
                                 __submi  2,__stack
       08:ABF7  48                 pha
       08:ABF8  38                 sec
       08:ABF9  A5 00              lda    <__stack
       08:ABFB  E9 02              sbc    #low(2)
       08:ABFD  85 00              sta    <__stack
       08:ABFF  A5 01              lda    <__stack+1
       08:AC01  E9 00              sbc    #high(2)
       08:AC03  85 01              sta    <__stack+1
       08:AC05  68                 pla
       08:AC06  22                 sax
       08:AC07  92 00              sta    [__stack]
       08:AC09  22                 sax
       08:AC0A  A0 01              ldy    #1
       08:AC0C  91 00              sta    [__stack],Y
 2711                             __ldwi  8
       08:AC0E  A2 08              ldx    #low(8)
       08:AC10  A9 00              lda    #high(8)
 2712  08:AC12  20 89 EA            jsr   asr
 2713                             __andwi 15
       08:AC15  22                 sax
       08:AC16  29 0F              and    #low(15)
       08:AC18  22                 sax
       08:AC19  29 00              and    #high(15)
 2714  08:AC1B  20 A4 FB            call  _poke.2
 2715                             __ldwi  2050
       08:AC1E  A2 02              ldx    #low(2050)
       08:AC20  A9 08              lda    #high(2050)
 2716                             __stw   _bx
       08:AC22  8E FA 20           stx    _bx
       08:AC25  8D FB 20           sta    _bx+1
 2717                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:AC28  A0 05               ldy   #5
       08:AC2A  B1 00               lda   [__sp],Y
       08:AC2C  AA                  tax
       08:AC2D  C8                  iny
       08:AC2E  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2718                             __aslw
       08:AC30  22                 sax
       08:AC31  0A                 asl    A
       08:AC32  22                 sax
       08:AC33  2A                 rol    A
 2719                             __addwi _seq_freq
       08:AC34  18                 clc
       08:AC35  22                 sax
       08:AC36  69 E4              adc    #low(_seq_freq)
       08:AC38  22                 sax
       08:AC39  69 29              adc    #high(_seq_freq)
 2720                             __stw   __ptr
       08:AC3B  8E 0B 20           stx    __ptr
       08:AC3E  8D 0C 20           sta    __ptr+1
 2721                             __ldwp  __ptr
       08:AC41  B2 0B              lda    [__ptr]
       08:AC43  AA                 tax
       08:AC44  A0 01              ldy    #1
       08:AC46  B1 0B              lda    [__ptr],Y
 2722                             __andwi 255
       08:AC48  22                 sax
       08:AC49  29 FF              and    #low(255)
       08:AC4B  22                 sax
       08:AC4C  29 00              and    #high(255)
 2723  08:AC4E  20 A4 FB            call  _poke.2
 2724  08:AC51            LL131:
 2725                     
 2726                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:AC51  A0 05               ldy   #5
       08:AC53  B1 00               lda   [__sp],Y
       08:AC55  AA                  tax
       08:AC56  C8                  iny
       08:AC57  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2727  08:AC59  20 B4 80            call  _drv_pitchenv
 2728                             __ldw_s 5
                0001              .if (5 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0000               .if (5 = 0)
                                   .else
       08:AC5C  A0 05               ldy   #5
       08:AC5E  B1 00               lda   [__sp],Y
       08:AC60  AA                  tax
       08:AC61  C8                  iny
       08:AC62  B1 00               lda   [__sp],Y
                                   .endif
                                  .else
                                  .endif
 2729  08:AC64  20 C6 80            call  _drv_lfoseq
 2730                             __lbra  LL125
       08:AC67  4C 36 A0           jmp    LL125
 2731  08:AC6A            LL127:
 2732                     
 2733  08:AC6A            LL123:
 2734                     
 2735                             __addmi 7,__stack
       08:AC6A  48                 pha
       08:AC6B  18                 clc
       08:AC6C  A5 00              lda    <__stack
       08:AC6E  69 07              adc    #low(7)
       08:AC70  85 00              sta    <__stack
       08:AC72  A5 01              lda    <__stack+1
       08:AC74  69 00              adc    #high(7)
       08:AC76  85 01              sta    <__stack+1
       08:AC78  68                 pla
 2736  08:AC79  60                  rts
 2737                             .endp
 2738                     
 2739  08:4C7A                    .proc _main
 2740                             __addmi -4,__stack
       08:AC7A  48                 pha
       08:AC7B  18                 clc
       08:AC7C  A5 00              lda    <__stack
       08:AC7E  69 FC              adc    #low(-4)
       08:AC80  85 00              sta    <__stack
       08:AC82  A5 01              lda    <__stack+1
       08:AC84  69 FF              adc    #high(-4)
       08:AC86  85 01              sta    <__stack+1
       08:AC88  68                 pla
 2741                             __stwi_s        0,2
                0001              .if (2 < 255)
                                   ; short index (bytes : 12, cycles : 24)
                          
       08:AC89  A9 00              lda    #LOW(0)
       08:AC8B  A0 02              ldy    #2
       08:AC8D  91 00              sta    [__sp],Y
       08:AC8F  AA                 tax
       08:AC90  A9 00              lda    #HIGH(0)
       08:AC92  C8                 iny
       08:AC93  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2742  08:AC95  20 A2 FC            call  _disp_off
 2743  08:AC98  20 62 ED            call  _cls
 2744                             __stwi_s        1,0
                0001              .if (0 < 255)
                                   ; short index (bytes : 12, cycles : 24)
                          
       08:AC9B  A9 01              lda    #LOW(1)
       08:AC9D  A0 00              ldy    #0
       08:AC9F  91 00              sta    [__sp],Y
       08:ACA1  AA                 tax
       08:ACA2  A9 00              lda    #HIGH(1)
       08:ACA4  C8                 iny
       08:ACA5  91 00              sta    [__sp],Y
                                  .else
                                  .endif
 2745  08:ACA7            LL139:
 2746                     
 2747                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       08:ACA7  B2 00               lda   [__sp]
       08:ACA9  AA                  tax
       08:ACAA  A0 01               ldy   #1
       08:ACAC  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 2748                             __stw   <__temp
       08:ACAE  86 03              stx    <__temp
       08:ACB0  85 04              sta    <__temp+1
 2749                             __ldwi  15
       08:ACB2  A2 0F              ldx    #low(15)
       08:ACB4  A9 00              lda    #high(15)
 2750  08:ACB6  20 A3 E9            jsr   ltzp
 2751                             __lbne  LL141
       08:ACB9  F0 03              beq    .x03520
       08:ACBB  4C DB AC           jmp    LL141
       08:ACBE            .x03520
 2752                             __lbra  LL142
       08:ACBE  4C F5 AC           jmp    LL142
 2753  08:ACC1            LL140:
 2754                     
 2755                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       08:ACC1  B2 00               lda   [__sp]
       08:ACC3  AA                  tax
       08:ACC4  A0 01               ldy   #1
       08:ACC6  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 2756                             __incw_s        0
                                   ; (bytes : 16, cycles : 24/40)
                          
       08:ACC8  48                 pha
       08:ACC9  A0 00              ldy    #0
       08:ACCB  8A                 txa
       08:ACCC  1A                 inc    A
       08:ACCD  91 00              sta    [__sp],Y
       08:ACCF  D0 06              bne    .x_03523
       08:ACD1  C8                 iny
       08:ACD2  B1 00              lda    [__sp],Y
       08:ACD4  1A                 inc    A
       08:ACD5  91 00              sta    [__sp],Y
       08:ACD7            .x_03523:
       08:ACD7  68                 pla
 2757                             __lbra  LL139
       08:ACD8  4C A7 AC           jmp    LL139
 2758  08:ACDB            LL141:
 2759                     
 2760                             __ldw_s 0
                0001              .if (0 < 255)
                                   ; short index (bytes :  7/8, cycles : 18/20)
                0001               .if (0 = 0)
       08:ACDB  B2 00               lda   [__sp]
       08:ACDD  AA                  tax
       08:ACDE  A0 01               ldy   #1
       08:ACE0  B1 00               lda   [__sp],Y
                                   .else
                                   .endif
                                  .else
                                  .endif
 2761                             __stw   _color_reg
       08:ACE2  8E 02 04           stx    _color_reg
       08:ACE5  8D 03 04           sta    _color_reg+1
 2762                             __ldwi  511
       08:ACE8  A2 FF              ldx    #low(511)
       08:ACEA  A9 01              lda    #high(511)
 2763                             __stw   _color_data
       08:ACEC  8E 04 04           stx    _color_data
       08:ACEF  8D 05 04           sta    _color_data+1
 2764                             __lbra  LL140
       08:ACF2  4C C1 AC           jmp    LL140
 2765  08:ACF5            LL142:
 2766                     
 2767  08:ACF5  20 F0 ED            call  _load_default_font
 2768  08:ACF8  20 98 FC            call  _disp_on
 2769                             __ldwi  LL0+0
       08:ACFB  A2 00              ldx    #low(LL0+0)
       08:ACFD  A9 40              lda    #high(LL0+0)
 2770                             __phw   3,3
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       08:ACFF  A8                 tay
       08:AD00  A5 02              lda    <__arg_idx
                                   add    #3
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       08:AD02  18                 clc
       08:AD03  69 03              adc    #3
                                  .endif
       08:AD05  85 02              sta    <__arg_idx
       08:AD07  42                 say
                                  .else
                                  .endif
                          
       08:AD08  99 61 2A           sta    __arg-(3),Y
       08:AD0B  8A                 txa
       08:AD0C  99 62 2A           sta    __arg-(3-1),Y
 2771                             __ldwi  5
       08:AD0F  A2 05              ldx    #low(5)
       08:AD11  A9 00              lda    #high(5)
 2772                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       08:AD13  A4 02              ldy    <__arg_idx
                                  .endif
                          
       08:AD15  8A                 txa
       08:AD16  99 63 2A           sta    __arg-(1),Y
 2773                             __ldwi  5
       08:AD19  A2 05              ldx    #low(5)
       08:AD1B  A9 00              lda    #high(5)
 2774  08:AD1D  20 91 EF            call  _put_string.3
 2775  08:AD20  20 D8 80            call  _drv_init
 2776                             __ldwi  LL0+25
       08:AD23  A2 19              ldx    #low(LL0+25)
       08:AD25  A9 40              lda    #high(LL0+25)
 2777                             __phw   3,3
                                   ; #1 (bytes :  9, cycles : 16)
                                   ; #2 (bytes : 16, cycles : 28)
                          
                0001              .if (2 = 2)
       08:AD27  A8                 tay
       08:AD28  A5 02              lda    <__arg_idx
                                   add    #3
                0000              .if (1 = 2)            ; register A (handle carry
                                  .else
       08:AD2A  18                 clc
       08:AD2B  69 03              adc    #3
                                  .endif
       08:AD2D  85 02              sta    <__arg_idx
       08:AD2F  42                 say
                                  .else
                                  .endif
                          
       08:AD30  99 61 2A           sta    __arg-(3),Y
       08:AD33  8A                 txa
       08:AD34  99 62 2A           sta    __arg-(3-1),Y
 2778                             __ldwi  5
       08:AD37  A2 05              ldx    #low(5)
       08:AD39  A9 00              lda    #high(5)
 2779                             __phb   1
                                   ; #1 (bytes :  6, cycles : 11)
                                   ; #2 (bytes : 12, cycles : 21)
                          
                0000              .if (1 = 2)
                                  .else
       08:AD3B  A4 02              ldy    <__arg_idx
                                  .endif
                          
       08:AD3D  8A                 txa
       08:AD3E  99 63 2A           sta    __arg-(1),Y
 2780                             __ldwi  6
       08:AD41  A2 06              ldx    #low(6)
       08:AD43  A9 00              lda    #high(6)
 2781  08:AD45  20 91 EF            call  _put_string.3
 2782  08:AD48            LL143:
 2783                     
 2784                             __ldwi  1
       08:AD48  A2 01              ldx    #low(1)
       08:AD4A  A9 00              lda    #high(1)
 2785                             __tstw
                                   ; pha
       08:AD4C  86 03              stx    <__temp
       08:AD4E  05 03              ora    <__temp
                                   ; pla
 2786                             __lbeq  LL144
       08:AD50  D0 03              bne    .x03544
       08:AD52  4C 5D AD           jmp    LL144
       08:AD55            .x03544
 2787  08:AD55  A0 00               ldy   #0
 2788  08:AD57  20 D3 EF            call  _vsync
 2789                             __lbra  LL143
       08:AD5A  4C 48 AD           jmp    LL143
 2790  08:AD5D            LL144:
 2791                     
 2792  08:AD5D            LL138:
 2793                     
 2794                             __addmi 4,__stack
       08:AD5D  48                 pha
       08:AD5E  18                 clc
       08:AD5F  A5 00              lda    <__stack
       08:AD61  69 04              adc    #low(4)
       08:AD63  85 00              sta    <__stack
       08:AD65  A5 01              lda    <__stack+1
       08:AD67  69 00              adc    #high(4)
       08:AD69  85 01              sta    <__stack+1
       08:AD6B  68                 pla
 2795  08:AD6C  60                  rts
 2796                             .endp
 2797                     
 2798           48A1              .data
 2799           0003              .bank CONST_BANK
 2800           4000              .org $4000
 2801  03:4000            LL0:
 2802  03:4000  49 4E 49          .db     73,78,73,84,73,65,76,73
       03:4003  54 49 41  
       03:4006  4C 49     
 2803  03:4008  5A 45 53          .db     90,69,83,32,72,117,83,73
       03:400B  20 48 75  
       03:400E  53 49     
 2804  03:4010  43 20 44          .db     67,32,68,82,73,86,69,82
       03:4013  52 49 56  
       03:4016  45 52     
 2805  03:4018  00 4F 4B          .db     0,79,75,0
       03:401B  00        
 2806  03:401C            _freq:
 2807  03:401C  E4 0F             .dw     4068
 2808  03:401E  FF 0E             .dw     3839
 2809  03:4020  28 0E             .dw     3624
 2810  03:4022  5C 0D             .dw     3420
 2811  03:4024  9C 0C             .dw     3228
 2812  03:4026  E7 0B             .dw     3047
 2813  03:4028  3C 0B             .dw     2876
 2814  03:402A  9B 0A             .dw     2715
 2815  03:402C  02 0A             .dw     2562
 2816  03:402E  73 09             .dw     2419
 2817  03:4030  EB 08             .dw     2283
 2818  03:4032  6B 08             .dw     2155
 2819  03:4034  F2 07             .dw     2034
 2820  03:4036  80 07             .dw     1920
 2821  03:4038  14 07             .dw     1812
 2822  03:403A  AE 06             .dw     1710
 2823                     
 2824           2987              .bss
 2825  --:2987            _reg_ch:                .ds     1
 2826  --:2988            _ch_cnt:                .ds     8
 2827  --:2990            _ch_vol:                .ds     8
 2828  --:2998            _ch_bank:               .ds     8
 2829  --:29A0            _ch_nowbank:            .ds     1
 2830  --:29A1            _ch_topbank:            .ds     1
 2831  --:29A2            _note_data:             .ds     8
 2832  --:29AA            _pitch_sw:              .ds     8
 2833  --:29B2            _note_sw:               .ds     8
 2834  --:29BA            _detune:                .ds     8
 2835  --:29C2            _panpod:                .ds     8
 2836  --:29CA            _loop_cnt:              .ds     8
 2837  --:29D2            _seq_ptr:               .ds     2
 2838  --:29D4            _seq_pos:               .ds     16
 2839  --:29E4            _seq_freq:              .ds     16
 2840  --:29F4            _pitch_envadr:          .ds     16
 2841  --:2A04            _volume_envadr:         .ds     16
 2842  --:2A14            _note_envadr:           .ds     16
 2843  --:2A24            _i:             .ds     2
 2844  --:2A26            _j:             .ds     2
 2845  --:2A28            _noise_freq:            .ds     2
 2846  --:2A2A            _noise_sw:              .ds     2
 2847  --:2A2C            _lfo_num:               .ds     8
 2848  --:2A34            _lfo_cnt:               .ds     8
 2849  --:2A3C            _lfo_ct2:               .ds     8
 2850  --:2A44            _lfo_stp:               .ds     8
 2851  --:2A4C            _lfo_lev:               .ds     8
 2852  --:2A54            _lfo_sw:                .ds     8
 2853  --:2A5C            _xpcm_addr:             .ds     2
 2854  --:2A5E            _xpcm_len:              .ds     2
 2855  --:2A60            _xpcm_bank:             .ds     1
 2856  --:2A61            _xpcm_mode:             .ds     1
 2857  --:2A62            _xpcm_sw:               .ds     1
 2858  --:2A63            _xpcm_sp:               .ds     1
 2859  --:2A64            __arg:
 2860                     
 2861                     ;0 error(s) in compilation
 2862                     ;       literal pool:28
 2863                     ;       constant pool:32
 2864                     ;       global pool:2496
 2865                     ;       Macro pool:1235
#[1]   makehes.s
